"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[196],{35196:(Rr,Et,p)=>{p.r(Et),p.d(Et,{default:()=>Ua}),p(87708);var ne=p(21462),A=p(59699),S=p(58054),g=p(55885),ie=p(13686),X=p(26056),oe=p(86810),P=p(12997),Ee=p(56160),B=p(29175),$t=p(69237),Q=p(93358),me=p(90290),le=p(17088),It=p(99740),Ie=p(17324),Gt=p(18747),he=p(48982),F=p(49311),Xi=p(69486),Yi=p(95888);let zt=class extends P.JT{constructor(e,t,i,s,r,n,a){super(),this.modelService=e,this.editorService=t,this.telemetryService=i,this.logService=s,this.extensionService=r,this.fileService=n,this.uriIdentityService=a,this.fileSearchProviders=new Map,this.textSearchProviders=new Map,this.deferredFileSearchesByScheme=new Map,this.deferredTextSearchesByScheme=new Map,this.loggedSchemesMissingProviders=new Set}registerSearchResultProvider(e,t,i){let s,r;if(0===t)s=this.fileSearchProviders,r=this.deferredFileSearchesByScheme;else{if(1!==t)throw new Error("Unknown SearchProviderType");s=this.textSearchProviders,r=this.deferredTextSearchesByScheme}return s.set(e,i),r.has(e)&&(r.get(e).complete(i),r.delete(e)),(0,P.OF)(()=>{s.delete(e)})}textSearch(e,t,i,s){var r=this;return(0,S.Z)(function*(){const n=r.getLocalResults(e);i&&ie.kX([...n.results.values()]).forEach(i);const c=yield r.doSearch(e,t,h=>{(0,A.Es)(h)?!n.results.has(h.resource)&&!(s&&s.has(h.resource))&&i&&i(h):i&&i(h),(0,A.d3)(h)&&r.logService.debug("SearchService#search",h.message)});return{...c,limitHit:c.limitHit||n.limitHit,results:[...c.results,...ie.kX([...n.results.values()])]}})()}fileSearch(e,t){return this.doSearch(e,t)}doSearch(e,t,i){var s=this;this.logService.trace("SearchService#search",JSON.stringify(e));const r=this.getSchemesInQuery(e),n=[Promise.resolve(null)];r.forEach(c=>n.push(this.extensionService.activateByEvent(`onSearch:${c}`))),n.push(this.extensionService.activateByEvent("onSearch:file"));const a=(0,S.Z)(function*(){if(yield Promise.all(n),yield s.extensionService.whenInstalledExtensionsRegistered(),t&&t.isCancellationRequested)return Promise.reject(new oe.FU);const h=yield Promise.all(e.folderQueries.map(d=>s.fileService.exists(d.folder)));e.folderQueries=e.folderQueries.filter((d,m)=>h[m]);let u=yield s.searchWithProviders(e,d=>{t&&t.isCancellationRequested||i?.(d)},t);return u=ie.kX(u),u.length?{limitHit:u[0]&&u[0].limitHit,stats:u[0].stats,messages:ie.kX(ie.xH(u.map(d=>d.messages))).filter(ie.In(d=>d.type+d.text+d.trusted)),results:ie.xH(u.map(d=>d.results))}:{limitHit:!1,results:[],messages:[]}})();return new Promise((c,h)=>{t&&t.onCancellationRequested(()=>{h(new oe.FU)}),a.then(c,h)})}getSchemesInQuery(e){const t=new Set;return e.folderQueries?.forEach(i=>t.add(i.folder.scheme)),e.extraFileResources?.forEach(i=>t.add(i.scheme)),t}waitForProvider(e,t){var i=this;return(0,S.Z)(function*(){const s=1===e?i.deferredFileSearchesByScheme:i.deferredTextSearchesByScheme;if(s.has(t))return s.get(t).p;{const r=new X.CR;return s.set(t,r),r.p}})()}searchWithProviders(e,t,i){var s=this;return(0,S.Z)(function*(){const r=$t.G.create(!1),n=[],a=s.groupFolderQueriesByScheme(e),c=[...a.keys()].some(h=>1===e.type?s.fileSearchProviders.has(h):s.textSearchProviders.has(h));return yield Promise.all([...a.keys()].map(function(){var h=(0,S.Z)(function*(u){const d=a.get(u);let m=1===e.type?s.fileSearchProviders.get(u):s.textSearchProviders.get(u);if(!m){if(c)return void(s.loggedSchemesMissingProviders.has(u)||(s.logService.warn(`No search provider registered for scheme: ${u}. Another scheme has a provider, not waiting for ${u}`),s.loggedSchemesMissingProviders.add(u)));s.loggedSchemesMissingProviders.has(u)||(s.logService.warn(`No search provider registered for scheme: ${u}, waiting`),s.loggedSchemesMissingProviders.add(u)),m=yield s.waitForProvider(e.type,u)}const C={...e,folderQueries:d};n.push(1===e.type?m.fileSearch(C,i):m.textSearch(C,t,i))});return function(u){return h.apply(this,arguments)}}())),Promise.all(n).then(h=>{const u=r.elapsed();return s.logService.trace(`SearchService#search: ${u}ms`),h.forEach(d=>{s.sendTelemetry(e,u,d)}),h},h=>{const u=r.elapsed();s.logService.trace(`SearchService#search: ${u}ms`);const d=(0,A.qe)(h);throw s.logService.trace(`SearchService#searchError: ${d.message}`),s.sendTelemetry(e,u,void 0,d),d})})()}groupFolderQueriesByScheme(e){const t=new Map;return e.folderQueries.forEach(i=>{const s=t.get(i.folder.scheme)||[];s.push(i),t.set(i.folder.scheme,s)}),t}sendTelemetry(e,t,i,s){const r=e.folderQueries.every(c=>c.folder.scheme===B.lg.file),n=e.folderQueries.every(c=>c.folder.scheme!==B.lg.file),a=r?B.lg.file:n?"other":"mixed";if(1===e.type&&i&&i.stats){const c=i.stats;if(c.fromCache){const h=c.detailStats;this.telemetryService.publicLog2("cachedSearchComplete",{reason:e._reason,resultCount:c.resultCount,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,sortingTime:c.sortingTime,cacheWasResolved:h.cacheWasResolved,cacheLookupTime:h.cacheLookupTime,cacheFilterTime:h.cacheFilterTime,cacheEntryCount:h.cacheEntryCount,scheme:a})}else{const h=c.detailStats;this.telemetryService.publicLog2("searchComplete",{reason:e._reason,resultCount:c.resultCount,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,sortingTime:c.sortingTime,fileWalkTime:h.fileWalkTime,directoriesWalked:h.directoriesWalked,filesWalked:h.filesWalked,cmdTime:h.cmdTime,cmdResultCount:h.cmdResultCount,scheme:a})}}else if(2===e.type){let c;s&&(c=s.code===A.eq.regexParseError?"regex":s.code===A.eq.unknownEncoding?"encoding":s.code===A.eq.globParseError?"glob":s.code===A.eq.invalidLiteral?"literal":s.code===A.eq.other?"other":s.code===A.eq.canceled?"canceled":"unknown"),this.telemetryService.publicLog2("textSearchComplete",{reason:e._reason,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,scheme:a,error:c})}}getLocalResults(e){const t=new Ee.Y9(s=>this.uriIdentityService.extUri.getComparisonKey(s));let i=!1;if(2===e.type){const s=new Ee.Y9;for(const n of this.editorService.editors){const a=he.zK.getCanonicalUri(n,{supportSideBySide:he.YX.PRIMARY}),c=he.zK.getOriginalUri(n,{supportSideBySide:he.YX.PRIMARY});a&&s.set(a,c??a)}this.modelService.getModels().forEach(n=>{const a=n.uri;if(!a||i)return;const c=s.get(a);if(!c||"search-result"===n.getLanguageId()&&(!e.includePattern||!e.includePattern["**/*.code-search"])||c.scheme!==B.lg.untitled&&!this.fileService.hasProvider(c)||"git"===c.scheme||!this.matches(c,e))return;const h=(0,Q.hj)(e.maxResults)?e.maxResults+1:Number.MAX_SAFE_INTEGER;let u=n.findMatches(e.contentPattern.pattern,!1,!!e.contentPattern.isRegExp,!!e.contentPattern.isCaseSensitive,e.contentPattern.isWordMatch?e.contentPattern.wordSeparators:null,!1,h);if(u.length){h&&u.length>=h&&(i=!0,u=u.slice(0,h-1));const d=new A.ut(c);t.set(c,d);const m=(0,Yi.X)(u,n,e.previewOptions);d.results=(0,Yi.Z)(m,n,e)}else t.set(c,null)})}return{results:t,limitHit:i}}matches(e,t){return(0,A.tQ)(t,e.fsPath)}clearCache(e){var t=this;return(0,S.Z)(function*(){const i=Array.from(t.fileSearchProviders.values()).map(s=>s&&s.clearCache(e));yield Promise.all(i)})()}};zt=(0,g.gn)([(0,g.fM)(0,me.q),(0,g.fM)(1,F.AR),(0,g.fM)(2,Ie.bU),(0,g.fM)(3,It.VZ),(0,g.fM)(4,Xi.QS),(0,g.fM)(5,le.sn),(0,g.fM)(6,Gt.v)],zt);var y=p(99954),Rt=p(39018),Ft=p(96089),l=p(12829),it=p(49698),kt=p(56980),V=p(82344),ji=p(16342),Mt=p(4866),Ji=p(37923),ve=p(84761),Fr=p(542),Se=p(82927),Y=p(70473),kr=p(23052),Mr=p(77140);const _i="replacePreview",es=o=>o.with({scheme:B.lg.internal,fragment:_i,query:JSON.stringify({scheme:o.scheme})});let Xt=class{constructor(e,t){this.instantiationService=e,this.textModelResolverService=t,this.textModelResolverService.registerTextModelContentProvider(B.lg.internal,this)}provideTextContent(e){return e.fragment===_i?this.instantiationService.createInstance(Yt).resolve(e):null}};Xt=(0,g.gn)([(0,g.fM)(0,V.TG),(0,g.fM)(1,kt.S)],Xt);let Yt=class extends P.JT{constructor(e,t,i,s,r){super(),this.modelService=e,this.languageService=t,this.textModelResolverService=i,this.replaceService=s,this.searchWorkbenchService=r}resolve(e){var t=this;return(0,S.Z)(function*(){const i=(o=e).with({scheme:JSON.parse(o.query).scheme,fragment:"",query:""}),s=t.searchWorkbenchService.searchModel.searchResult.matches().filter(h=>h.resource.toString()===i.toString())[0],n=t._register(yield t.textModelResolverService.createModelReference(i)).object.textEditorModel,a=n.getLanguageId(),c=t.modelService.createModel((0,ji.N1)(n.createSnapshot()),t.languageService.createById(a),e);var o;return t._register(s.onChange(({forceUpdateModel:h})=>t.update(n,c,s,h))),t._register(t.searchWorkbenchService.searchModel.onReplaceTermChanged(()=>t.update(n,c,s))),t._register(s.onDispose(()=>c.dispose())),t._register(c.onWillDispose(()=>t.dispose())),t._register(n.onWillDispose(()=>t.dispose())),c})()}update(e,t,i,s=!1){!e.isDisposed()&&!t.isDisposed()&&this.replaceService.updateReplacePreview(i,s)}};Yt=(0,g.gn)([(0,g.fM)(0,me.q),(0,g.fM)(1,it.O),(0,g.fM)(2,kt.S),(0,g.fM)(3,Ft.H),(0,g.fM)(4,y.Zj)],Yt);let Pt=class $i{constructor(e,t,i,s,r,n){this.textFileService=e,this.editorService=t,this.textModelResolverService=i,this.bulkEditorService=s,this.labelService=r,this.notebookEditorModelResolverService=n}replace(e,t=void 0,i=null){var s=this;return(0,S.Z)(function*(){const r=s.createEdits(e,i);yield s.bulkEditorService.apply(r,{progress:t});const n=r.map(function(){var a=(0,S.Z)(function*(c){if(c.resource.scheme!==B.lg.vscodeNotebookCell)return s.textFileService.files.get(c.resource)?.save({source:$i.REPLACE_SAVE_SOURCE});{const h=kr.Uu.parse(c.resource)?.notebook;if(h){let u;try{u=yield s.notebookEditorModelResolverService.resolve(h),yield u.object.save({source:$i.REPLACE_SAVE_SOURCE})}finally{u?.dispose()}}}});return function(c){return a.apply(this,arguments)}}());return X.jT.settled(n)})()}openReplacePreview(e,t,i,s){var r=this;return(0,S.Z)(function*(){const n=e instanceof y.qE?e.parent():e,a=yield r.editorService.openEditor({original:{resource:n.resource},modified:{resource:es(n.resource)},label:l.NC("fileReplaceChanges","{0} \u2194 {1} (Replace Preview)",n.name(),n.name()),description:r.labelService.getUriLabel((0,Y.XX)(n.resource),{relative:!0}),options:{preserveFocus:t,pinned:s,revealIfVisible:!0}}),c=a?.input,h=n.onDispose(()=>{c?.dispose(),h.dispose()});if(yield r.updateReplacePreview(n),a){const u=a.getControl();e instanceof y.qE&&u&&u.revealLineInCenter(e.range().startLineNumber,1)}})()}updateReplacePreview(e,t=!1){var i=this;return(0,S.Z)(function*(){const s=es(e.resource),[r,n]=yield Promise.all([i.textModelResolverService.createModelReference(e.resource),i.textModelResolverService.createModelReference(s)]),a=r.object.textEditorModel,c=n.object.textEditorModel;try{a&&c&&(t?c.setValue(a.getValue()):c.undo(),i.applyEditsToPreview(e,c))}finally{r.dispose(),n.dispose()}})()}applyEditsToPreview(e,t){const i=this.createEdits(e,t.uri),s=[];for(const r of i)s.push(Fr.h.replaceMove(ve.e.lift(r.textEdit.range),r.textEdit.text));t.pushEditOperations([],s.sort((r,n)=>ve.e.compareRangesUsingStarts(r.range,n.range)),()=>[])}createEdits(e,t=null){const i=[];return e instanceof y.qE&&(e instanceof y.YT?e.isWebviewMatch()||i.push(this.createEdit(e,e.replaceString,e.cell.uri)):i.push(this.createEdit(e,e.replaceString,t))),e instanceof y.ut&&(e=[e]),e instanceof Array&&e.forEach(s=>{const r=s;r.count()>0&&i.push(...r.matches().flatMap(n=>this.createEdits(n,t)))}),i}createEdit(e,t,i=null){const s=e.parent();return new Ji.Gl(i??s.resource,{range:e.range(),text:t},void 0,void 0)}};Pt.REPLACE_SAVE_SOURCE=he.dY.registerSource("searchReplace.source",l.NC("searchReplace.source","Search and Replace")),Pt=(0,g.gn)([(0,g.fM)(0,Mt.MM),(0,g.fM)(1,F.AR),(0,g.fM)(2,kt.S),(0,g.fM)(3,Ji.vu),(0,g.fM)(4,Se.e),(0,g.fM)(5,Mr.M)],Pt);var Ne=p(84621),Ar=p(93334),Tr=p(84776),w=p(76972),jt=p(70958),Re=p(33562),Nr=p(48780),Lr=p(6640),k=p(73059),ue=p(79026),At=p(19401),H=p(31719),Wr=p(19409),f=p(73317),ae=p(26684),Jt=p(53083),Or=p(59626),Fe=p(54239),_t=p(59796),Dr=p(79243),Br=p(42217);let se=class Sr extends At.S{constructor(e,t,i,s,r,n){super(s,n,{openSideBySideDirection:()=>this.configuration.openSideBySideDirection}),this.editorService=e,this.editorGroupService=t,this.configurationService=i,this.outlineService=r,this.onDidActiveTextEditorControlChange=this.editorService.onDidActiveEditorChange}get configuration(){const e=this.configurationService.getValue().workbench?.editor;return{openEditorPinned:!e?.enablePreviewFromQuickOpen||!e?.enablePreview,openSideBySideDirection:e?.openSideBySideDirection}}get activeTextEditorControl(){if(!(0,Fe.sd)(this.editorService.activeEditorPane?.getControl()))return this.editorService.activeTextEditorControl}gotoLocation(e,t){(t.keyMods.alt||this.configuration.openEditorPinned&&t.keyMods.ctrlCmd||t.forceSideBySide)&&this.editorService.activeEditor?(e.restoreViewState?.(),this.editorGroupService.sideGroup.openEditor(this.editorService.activeEditor,{selection:t.range,pinned:t.keyMods.ctrlCmd||this.configuration.openEditorPinned,preserveFocus:t.preserveFocus})):super.gotoLocation(e,t)}getSymbolPicks(e,t,i,s,r){var n=this;return(0,S.Z)(function*(){return!(yield Promise.race([n.waitForLanguageSymbolRegistry(e,s),(0,X.Vs)(Sr.SYMBOL_PICKS_TIMEOUT)]))||r.isCancellationRequested?[]:n.doGetSymbolPicks(n.getDocumentSymbols(e,r),(0,ae.AO)(t),i,r)})()}provideWithoutTextEditor(e){return this.canPickWithOutlineService()?this.doGetOutlinePicks(e):super.provideWithoutTextEditor(e)}canPickWithOutlineService(){return!!this.editorService.activeEditorPane&&this.outlineService.canCreateOutline(this.editorService.activeEditorPane)}doGetOutlinePicks(e){const t=this.editorService.activeEditorPane;if(!t)return P.JT.None;const i=new Wr.A,s=new P.SL;return s.add((0,P.OF)(()=>i.dispose(!0))),e.busy=!0,this.outlineService.createOutline(t,4,i.token).then(r=>{if(!r)return;if(i.token.isCancellationRequested)return void r.dispose();s.add(r);const n=r.captureViewState();s.add((0,P.OF)(()=>{0===e.selectedItems.length&&n.dispose()}));const a=r.config.quickPickDataSource.getQuickPickElements(),c=a.map((d,m)=>({kind:0,index:m,score:0,label:d.label,description:d.description,ariaLabel:d.ariaLabel,iconClasses:d.iconClasses}));s.add(e.onDidAccept(()=>{e.hide();const[d]=e.selectedItems;d&&a[d.index]&&r.reveal(a[d.index].element,{},!1)}));const h=()=>{const d=c.filter(m=>{if("@"===e.value)return m.score=0,m.highlights=void 0,!0;const C=(0,Jt.EW)(e.value,e.value.toLowerCase(),1,m.label,m.label.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return!!C&&(m.score=C[1],m.highlights={label:(0,Jt.mB)(C)},!0)});if(0===d.length){const m=(0,l.NC)("empty","No matching entries");e.items=[{label:m,index:-1,kind:14}],e.ariaLabel=m}else e.items=d};h(),s.add(e.onDidChangeValue(h));const u=new P.XK;s.add(u),s.add(e.onDidChangeActive(()=>{const[d]=e.activeItems;d&&a[d.index]?u.value=r.preview(a[d.index].element):u.clear()}))}).catch(r=>{(0,oe.dL)(r),e.hide()}).finally(()=>{e.busy=!1}),s}};se.SYMBOL_PICKS_TIMEOUT=8e3,se=(0,g.gn)([(0,g.fM)(0,F.AR),(0,g.fM)(1,_t.Qw),(0,g.fM)(2,H.Ui),(0,g.fM)(3,Br.p),(0,g.fM)(4,Or.h),(0,g.fM)(5,Dr.Je)],se);let ts=(()=>{class o extends f.Ke{constructor(){super({id:o.ID,title:{value:(0,l.NC)("gotoSymbol","Go to Symbol in Editor..."),mnemonicTitle:(0,l.NC)({key:"miGotoSymbolInEditor",comment:["&& denotes a mnemonic"]},"Go to &&Symbol in Editor..."),original:"Go to Symbol in Editor..."},f1:!0,keybinding:{when:void 0,weight:200,primary:3117},menu:[{id:f.eH.MenubarGoMenu,group:"4_symbol_nav",order:1}]})}run(t){t.get(ue.eJ).quickAccess.show(se.PREFIX,{itemActivation:ue.jG.NONE})}}return o.ID="workbench.action.gotoSymbol",o})();(0,f.r1)(ts),Re.B.as(jt.IP.Quickaccess).registerQuickAccessProvider({ctor:se,prefix:At.S.PREFIX,contextKey:"inFileSymbolsPicker",placeholder:(0,l.NC)("gotoSymbolQuickAccessPlaceholder","Type the name of a symbol to go to."),helpEntries:[{description:(0,l.NC)("gotoSymbolQuickAccess","Go to Symbol in Editor"),prefix:At.S.PREFIX,commandId:ts.ID},{description:(0,l.NC)("gotoSymbolByCategoryQuickAccess","Go to Symbol in Editor by Category"),prefix:At.S.PREFIX_BY_CATEGORY}]});var Tt=p(96970);(0,Tt.Z)('.quick-input-list .quick-input-list-entry.has-actions:hover .quick-input-list-entry-action-bar .action-label.dirty-anything:before{content:"\\ea76"}',{});var ye=p(10434),Nt=p(90043),q=p(25480),Ce=p(39108),Hr=p(74486),is=p(31096),Le=p(58535),Kr=p(9590),Qr=p(43764),ss=p(67018),Ur=p(75390),rs=p(94927),K=(()=>((K=K||{})[K.Created=1]="Created",K[K.Loading=2]="Loading",K[K.Loaded=3]="Loaded",K[K.Errored=4]="Errored",K[K.Disposed=5]="Disposed",K))();class Zr{get cacheKey(){return this.loadingPhase!==K.Loaded&&this.previousCacheState?this.previousCacheState.cacheKey:this._cacheKey}get isLoaded(){const e=this.loadingPhase===K.Loaded;return e||!this.previousCacheState?e:this.previousCacheState.isLoaded}get isUpdating(){const e=this.loadingPhase===K.Loading;return e||!this.previousCacheState?e:this.previousCacheState.isUpdating}constructor(e,t,i,s){if(this.cacheQuery=e,this.loadFn=t,this.disposeFn=i,this.previousCacheState=s,this._cacheKey=Ur.a.nextId(),this.query=this.cacheQuery(this._cacheKey),this.loadingPhase=K.Created,this.previousCacheState){const r=Object.assign({},this.query,{cacheKey:null}),n=Object.assign({},this.previousCacheState.query,{cacheKey:null});(0,rs.fS)(r,n)||(this.previousCacheState.dispose(),this.previousCacheState=void 0)}}load(){var e=this;return this.isUpdating||(this.loadingPhase=K.Loading,this.loadPromise=(0,S.Z)(function*(){try{yield e.loadFn(e.query),e.loadingPhase=K.Loaded,e.previousCacheState&&(e.previousCacheState.dispose(),e.previousCacheState=void 0)}catch(t){throw e.loadingPhase=K.Errored,t}})()),this}dispose(){var e=this;this.loadPromise?(0,S.Z)(function*(){try{yield e.loadPromise}catch{}e.loadingPhase=K.Disposed,e.disposeFn(e._cacheKey)})():this.loadingPhase=K.Disposed,this.previousCacheState&&(this.previousCacheState.dispose(),this.previousCacheState=void 0)}}var ei=p(95126),qr=p(51870),ti=p(87808),Lt=p(12292),ns=p(69046),os=p(34569),N=p(62981),G=p(52786);let ke=class qt extends ye.${get defaultFilterValue(){const e=this.codeEditorService.getFocusedCodeEditor();if(e)return(0,Q.f6)((0,os.getSelectionSearchString)(e))}constructor(e,t,i,s,r){super(qt.PREFIX,{canAcceptInBackground:!0,noResultsPick:{label:(0,l.NC)("noSymbolResults","No matching workspace symbols")}}),this.labelService=e,this.openerService=t,this.editorService=i,this.configurationService=s,this.codeEditorService=r,this.delayer=this._register(new X.rH(qt.TYPING_SEARCH_DELAY))}get configuration(){const e=this.configurationService.getValue().workbench?.editor;return{openEditorPinned:!e?.enablePreviewFromQuickOpen||!e?.enablePreview,openSideBySideDirection:e?.openSideBySideDirection}}_getPicks(e,t,i){return this.getSymbolPicks(e,void 0,i)}getSymbolPicks(e,t,i){var s=this;return(0,S.Z)(function*(){return s.delayer.trigger((0,S.Z)(function*(){return i.isCancellationRequested?[]:s.doGetSymbolPicks((0,ae.AO)(e),t,i)}),t?.delay)})()}doGetSymbolPicks(e,t,i){var s=this;return(0,S.Z)(function*(){let r,n;e.values&&e.values.length>1?(r=(0,ae.Ic)(e.values[0]),n=(0,ae.Ic)(e.values.slice(1))):r=e;const a=yield(0,q.$g)(r.original,i);if(i.isCancellationRequested)return[];const c=[],h=s.configuration.openSideBySideDirection;for(const{symbol:u,provider:d}of a){if(t?.skipLocal&&!qt.TREAT_AS_GLOBAL_SYMBOL_TYPES.has(u.kind)&&u.containerName)continue;const m=u.name,C=`$(${ti.uZ.toIcon(u.kind).id}) ${m}`,b=C.length-m.length;let x,I,R=!1;if(r.original.length>0&&(r!==e&&([x,I]=(0,ae.mt)(C,{...e,values:void 0},0,b),"number"==typeof x&&(R=!0)),"number"!=typeof x&&([x,I]=(0,ae.mt)(C,r,0,b),"number"!=typeof x)))continue;const E=u.location.uri;let D,ee,be;if(E){const Z=s.labelService.getUriLabel(E,{relative:!0});D=u.containerName?`${u.containerName} \u2022 ${Z}`:Z}if(!R&&n&&n.original.length>0){if(D&&([ee,be]=(0,ae.mt)(D,n)),"number"!=typeof ee)continue;"number"==typeof x&&(x+=ee)}const W=!!u.tags&&u.tags.indexOf(1)>=0;c.push({symbol:u,resource:E,score:x,label:C,ariaLabel:m,highlights:W?void 0:{label:I,description:be},description:D,strikethrough:W,buttons:[{iconClass:G.kS.asClassName("right"===h?N.lA.splitHorizontal:N.lA.splitVertical),tooltip:"right"===h?(0,l.NC)("openToSide","Open to the Side"):(0,l.NC)("openToBottom","Open to the Bottom")}],trigger:(Z,pe)=>(s.openSymbol(d,u,i,{keyMods:pe,forceOpenSideBySide:!0}),ye.L.CLOSE_PICKER),accept:function(){var Z=(0,S.Z)(function*(pe,xt){return s.openSymbol(d,u,i,{keyMods:pe,preserveFocus:xt.inBackground,forcePinned:xt.inBackground})});return function(xt,vr){return Z.apply(this,arguments)}}()})}return t?.skipSorting||c.sort((u,d)=>s.compareSymbols(u,d)),c})()}openSymbol(e,t,i,s){var r=this;return(0,S.Z)(function*(){let n=t;"function"==typeof e.resolveWorkspaceSymbol&&(n=(yield e.resolveWorkspaceSymbol(t,i))||t,i.isCancellationRequested)||(n.location.uri.scheme===B.lg.http||n.location.uri.scheme===B.lg.https?yield r.openerService.open(n.location.uri,{fromUserGesture:!0,allowContributedOpeners:!0}):yield r.editorService.openEditor({resource:n.location.uri,options:{preserveFocus:s?.preserveFocus,pinned:s.keyMods.ctrlCmd||s.forcePinned||r.configuration.openEditorPinned,selection:n.location.range?ve.e.collapseToStart(n.location.range):void 0}},s.keyMods.alt||r.configuration.openEditorPinned&&s.keyMods.ctrlCmd||s?.forceOpenSideBySide?F.O3:F.LP))})()}compareSymbols(e,t){if("number"==typeof e.score&&"number"==typeof t.score){if(e.score>t.score)return-1;if(e.score<t.score)return 1}if(e.symbol&&t.symbol){const i=e.symbol.name.toLowerCase(),s=t.symbol.name.toLowerCase(),r=i.localeCompare(s);if(0!==r)return r}if(e.symbol&&t.symbol){const i=ti.uZ.toIcon(e.symbol.kind).id,s=ti.uZ.toIcon(t.symbol.kind).id;return i.localeCompare(s)}return 0}};ke.PREFIX="#",ke.TYPING_SEARCH_DELAY=200,ke.TREAT_AS_GLOBAL_SYMBOL_TYPES=new Set([4,9,0,10,2,3,1]),ke=(0,g.gn)([(0,g.fM)(0,Se.e),(0,g.fM)(1,Lt.v4),(0,g.fM)(2,F.AR),(0,g.fM)(3,H.Ui),(0,g.fM)(4,ns.$)],ke);var as=p(383),$r=p(82755),cs=p(24247),Gr=p(39924),zr=p(91243),ls=p(16170);const hs="settings",us="$customized";var o,$e,te=(()=>((te=te||{})[te.Shell=1]="Shell",te[te.Process=2]="Process",te[te.CustomExecution=3]="CustomExecution",te))();(o=te||(te={})).fromString=function e(i){switch(i.toLowerCase()){case"shell":return o.Shell;case"process":default:return o.Process;case"customExecution":return o.CustomExecution}},o.toString=function t(i){switch(i){case o.Shell:return"shell";case o.Process:return"process";case o.CustomExecution:return"customExecution";default:return"process"}},function(o){o.Workspace="workspace",o.Extension="extension",o.InMemory="inMemory",o.WorkspaceFile="workspaceFile",o.User="user",o.toConfigurationTarget=function e(t){switch(t){case o.User:return 2;case o.WorkspaceFile:return 5;default:return 6}}}($e||($e={}));class ii{constructor(e,t,i,s,r,n){this._label="",this._id=e,t&&(this._label=t),i&&(this.type=i),this.runOptions=s,this.configurationProperties=r,this._source=n}getDefinition(e){}getMapKey(){return this._id}getRecentlyUsedKey(){}getCommonTaskId(){const e={folder:this.getFolderId(),id:this._id};return JSON.stringify(e)}clone(){return this.fromObject(Object.assign({},this))}getWorkspaceFolder(){}getWorkspaceFileName(){}getTelemetryKind(){return"unknown"}matches(e,t=!1){if(void 0===e)return!1;if(Q.HD(e))return e===this._label||e===this.configurationProperties.identifier||t&&e===this._id;const i=this.getDefinition(!0);return void 0!==i&&i._key===e._key}getQualifiedLabel(){const e=this.getWorkspaceFolder();return e?`${this._label} (${e.name})`:this._label}getTaskExecution(){return{id:this._id,task:this}}addTaskLoadMessages(e){void 0===this._taskLoadMessages&&(this._taskLoadMessages=[]),e&&(this._taskLoadMessages=this._taskLoadMessages.concat(e))}get taskLoadMessages(){return this._taskLoadMessages}}class Ge extends ii{constructor(e,t,i,s,r,n,a,c){super(e,i,void 0,a,c,t),this.command={},this._source=t,this.hasDefinedMatchers=n,r&&(this.command=r)}clone(){return new Ge(this._id,this._source,this._label,this.type,this.command,this.hasDefinedMatchers,this.runOptions,this.configurationProperties)}customizes(){if(this._source&&this._source.customizes)return this._source.customizes}getDefinition(e=!1){if(e&&void 0!==this._source.customizes)return this._source.customizes;{let t;switch(this.command?this.command.runtime:void 0){case te.Shell:t="shell";break;case te.Process:t="process";break;case te.CustomExecution:t="customExecution";break;case void 0:t="$composite";break;default:throw new Error("Unexpected task runtime")}return{type:t,_key:this._id,id:this._id}}}static is(e){return e instanceof Ge}getMapKey(){const e=this._source.config.workspaceFolder;return e?`${e.uri.toString()}|${this._id}|${this.instance}`:`${this._id}|${this.instance}`}getFolderId(){return this._source.kind===$e.User?hs:this._source.config.workspaceFolder?.uri.toString()}getCommonTaskId(){return this._source.customizes?super.getCommonTaskId():this.getRecentlyUsedKey()??super.getCommonTaskId()}getRecentlyUsedKey(){const e=this.getFolderId();if(!e)return;let t=this.configurationProperties.identifier;return this._source.kind!==$e.Workspace&&(t+=this._source.kind),JSON.stringify({type:us,folder:e,id:t})}getWorkspaceFolder(){return this._source.config.workspaceFolder}getWorkspaceFileName(){return this._source.config.workspace&&this._source.config.workspace.configuration?Y.EZ(this._source.config.workspace.configuration):void 0}getTelemetryKind(){return this._source.customizes?"workspace>extension":"workspace"}fromObject(e){return new Ge(e._id,e._source,e._label,e.type,e.command,e.hasDefinedMatchers,e.runOptions,e.configurationProperties)}}class We extends ii{constructor(e,t,i,s,r,n,a){super(e,i,s,n,a,t),this._source=t,this.configures=r}static is(e){return e instanceof We}fromObject(e){return e}getDefinition(){return this.configures}getWorkspaceFileName(){return this._source.config.workspace&&this._source.config.workspace.configuration?Y.EZ(this._source.config.workspace.configuration):void 0}getWorkspaceFolder(){return this._source.config.workspaceFolder}getFolderId(){return this._source.kind===$e.User?hs:this._source.config.workspaceFolder?.uri.toString()}getRecentlyUsedKey(){const e=this.getFolderId();if(!e)return;let t=this.configurationProperties.identifier;return this._source.kind!==$e.Workspace&&(t+=this._source.kind),JSON.stringify({type:us,folder:e,id:t})}}class ze extends ii{constructor(e,t,i,s,r,n,a,c,h){super(e,i,s,c,h,t),this.defines=r,this.hasDefinedMatchers=a,this.command=n,this.icon=h.icon,this.hide=h.hide}clone(){return new ze(this._id,this._source,this._label,this.type,this.defines,this.command,this.hasDefinedMatchers,this.runOptions,this.configurationProperties)}getDefinition(){return this.defines}static is(e){return e instanceof ze}getMapKey(){const e=this._source.workspaceFolder;return e?`${this._source.scope.toString()}|${e.uri.toString()}|${this._id}|${this.instance}`:`${this._source.scope.toString()}|${this._id}|${this.instance}`}getFolderId(){if(3===this._source.scope&&this._source.workspaceFolder)return this._source.workspaceFolder.uri.toString()}getRecentlyUsedKey(){const e={type:"contributed",scope:this._source.scope,id:this._id};return e.folder=this.getFolderId(),JSON.stringify(e)}getWorkspaceFolder(){return this._source.workspaceFolder}getTelemetryKind(){return"extension"}fromObject(e){return new ze(e._id,e._source,e._label,e.type,e.defines,e.command,e.hasDefinedMatchers,e.runOptions,e.configurationProperties)}}var O=p(13683),st=p(51776),rt=p(32064),$=p(37202),Wt=p(89295),ds=p(4865),Xr=p(90457),Xe=p(58571);const si=l.NC("taskQuickPick.showAll","Show All Tasks..."),gs=(0,$.q5)("tasks-list-configure",N.lA.gear,l.NC("configureTaskIcon","Configuration icon in the tasks selection list.")),ps=(0,$.q5)("tasks-remove",N.lA.close,l.NC("removeTaskIcon","Icon for remove in the tasks selection list."));let ri=class Te extends P.JT{constructor(e,t,i,s,r,n,a){super(),this._taskService=e,this._configurationService=t,this._quickInputService=i,this._notificationService=s,this._themeService=r,this._dialogService=n,this._storageService=a,this._sorter=this._taskService.createSorter()}_showDetail(){return!!this._configurationService.getValue("task.quickOpen.detail")}_guessTaskLabel(e){if(e._label)return e._label;if(We.is(e)){let t=e.configures.type;const i=rs.I8(e.configures);return delete i._key,delete i.type,Object.keys(i).forEach(s=>t+=`: ${i[s]}`),t}return""}static getTaskLabelWithIcon(e,t){const i=t||e._label,s=e.configurationProperties.icon;return s?s.id?`$(${s.id}) ${i}`:`$(${N.lA.tools.id}) ${i}`:`${i}`}static applyColorStyles(e,t,i){if(e.configurationProperties.icon?.color){const s=i.getColorTheme(),r=(0,ds.m5)(s);t.iconClasses=[(0,ds.pv)(e.configurationProperties.icon.color)],document.body.appendChild(r)}}_createTaskEntry(e,t=[]){const i=[{iconClass:G.kS.asClassName(gs),tooltip:l.NC("configureTask","Configure Task")},...t],s={label:Te.getTaskLabelWithIcon(e,this._guessTaskLabel(e)),description:this._taskService.getTaskDescription(e),task:e,detail:this._showDetail()?e.configurationProperties.detail:void 0,buttons:i};return Te.applyColorStyles(e,s,this._themeService),s}_createEntriesForGroup(e,t,i,s=[]){e.push({type:"separator",label:i}),t.forEach(r=>{r.configurationProperties.hide||e.push(this._createTaskEntry(r,s))})}_createTypeEntries(e,t){e.push({type:"separator",label:l.NC("contributedTasks","contributed")}),t.forEach(i=>{e.push({label:`$(folder) ${i}`,task:i,ariaLabel:l.NC("taskType","All {0} tasks",i)})}),e.push({label:si,task:si,alwaysShow:!0})}_handleFolderTaskResult(e){const t=[];return Array.from(e).forEach(([i,s])=>{if(s.set&&t.push(...s.set.tasks),s.configurations)for(const r in s.configurations.byIdentifier)t.push(s.configurations.byIdentifier[r])}),t}_dedupeConfiguredAndRecent(e,t){let i=[];const s=Array(e.length).fill(!1);for(let n=0;n<t.length;n++){const a=t[n].getWorkspaceFolder()?.uri.toString(),c=t[n].getDefinition()?._key,h=t[n].type,u=t[n]._label,d=t[n].getRecentlyUsedKey(),m=e.findIndex(C=>a&&c&&C.getWorkspaceFolder()?.uri.toString()===a&&(C.getDefinition()?._key===c||C.type===h&&C._label===u)||d&&C.getRecentlyUsedKey()===d);-1===m?i.push(t[n]):(e[m]=t[n],s[m]=!0)}i=i.sort((n,a)=>this._sorter.compare(n,a));const r=[];for(let n=0;n<e.length;n++)(s[n]||We.is(e[n]))&&r.push(e[n]);return{configuredTasks:i,recentTasks:r}}getTopLevelEntries(e){var t=this;return(0,S.Z)(function*(){if(void 0!==t._topLevelEntries)return{entries:t._topLevelEntries};let i=(yield t._taskService.getSavedTasks("historical")).reverse();const s=t._handleFolderTaskResult(yield t._taskService.getWorkspaceTasks()),r=t._taskService.taskTypes();t._topLevelEntries=[];const n=t._dedupeConfiguredAndRecent(i,s),a=n.configuredTasks;if(i=n.recentTasks,i.length>0){const c={iconClass:G.kS.asClassName(ps),tooltip:l.NC("removeRecent","Remove Recently Used Task")};t._createEntriesForGroup(t._topLevelEntries,i,l.NC("recentlyUsed","recently used"),[c])}return s.length>0&&a.length>0&&t._createEntriesForGroup(t._topLevelEntries,a,l.NC("configured","configured")),e&&0===s.length&&(t._topLevelEntries.push({type:"separator",label:l.NC("configured","configured")}),t._topLevelEntries.push(e)),r.length>0&&t._createTypeEntries(t._topLevelEntries,r),{entries:t._topLevelEntries,isSingleConfigured:1===s.length?s[0]:void 0}})()}handleSettingOption(e){var t=this;return(0,S.Z)(function*(){const{confirmed:i}=yield t._dialogService.confirm({type:st.zb.Warning,message:l.NC("TaskQuickPick.changeSettingDetails","Task detection for {0} tasks causes files in any workspace you open to be run as code. Enabling {0} task detection is a user setting and will apply to any workspace you open. \n\n Do you want to enable {0} task detection for all workspaces?",e),cancelButton:l.NC("TaskQuickPick.changeSettingNo","No")});if(i)return yield t._configurationService.updateValue(`${e}.autoDetect`,"on"),yield new Promise(s=>setTimeout(()=>s(),100)),t.show(l.NC("TaskService.pickRunTask","Select the task to run"),void 0,e)})()}show(e,t,i,s){var r=this;return(0,S.Z)(function*(){const n=r._quickInputService.createQuickPick();n.placeholder=e,n.matchOnDescription=!0,n.ignoreFocusOut=!1,n.onDidTriggerItemButton(function(){var c=(0,S.Z)(function*(h){const u=h.item.task;if(h.button.iconClass===G.kS.asClassName(ps)){const d=u&&!Q.HD(u)?u.getRecentlyUsedKey():void 0;d&&r._taskService.removeRecentlyUsedTask(d);const m=n.items.indexOf(h.item);m>=0&&(n.items=[...n.items.slice(0,m),...n.items.slice(m+1)])}else if(h.button.iconClass===G.kS.asClassName(gs))if(r._quickInputService.cancel(),ze.is(u))r._taskService.customize(u,void 0,!0);else if(Ge.is(u)||We.is(u)){let d=!1;try{d=yield r._taskService.openConfig(u)}catch{}d||r._taskService.customize(u,void 0,!0)}});return function(h){return c.apply(this,arguments)}}()),s&&(n.value=s);let a=i;if(!a){const c=yield r.getTopLevelEntries(t);if(c.isSingleConfigured&&r._configurationService.getValue("task.quickOpen.skip"))return n.dispose(),r._toTask(c.isSingleConfigured);const h=c.entries;a=yield r._doPickerFirstLevel(n,h)}for(;;){if(!Q.HD(a))return a?(n.dispose(),r._toTask(a)):(n.dispose(),a);{if(s)return yield r._doPickerFirstLevel(n,(yield r.getTopLevelEntries(t)).entries),void n.dispose();const c=yield r.doPickerSecondLevel(n,a);if(!c||c.settingType||null!==c.task)return c&&Q.HD(c.settingType)?(n.dispose(),r.handleSettingOption(c.settingType)):(n.dispose(),c?.task&&!Q.HD(c?.task)?r._toTask(c?.task):void 0);n.value="",a=yield r._doPickerFirstLevel(n,(yield r.getTopLevelEntries(t)).entries)}}})()}_doPickerFirstLevel(e,t){var i=this;return(0,S.Z)(function*(){return e.items=t,(0,Xr.N)(i._storageService,"runTaskStorageKey",e,!0),(yield new Promise(r=>{O.ju.once(e.onDidAccept)((0,S.Z)(function*(){r(e.selectedItems?e.selectedItems[0]:void 0)}))}))?.task})()}doPickerSecondLevel(e,t,i){var s=this;return(0,S.Z)(function*(){if(e.busy=!0,t===si){const n=(yield s._taskService.tasks()).filter(a=>!a.configurationProperties.hide).sort((a,c)=>s._sorter.compare(a,c)).map(a=>s._createTaskEntry(a));n.push(...Te.allSettingEntries(s._configurationService)),e.items=n}else e.value=i||"",e.items=yield s._getEntriesForProvider(t);return yield e.show(),e.busy=!1,yield new Promise(n=>{O.ju.once(e.onDidAccept)((0,S.Z)(function*(){n(e.selectedItems?e.selectedItems[0]:void 0)}))})})()}static allSettingEntries(e){const t=[],i=Te.getSettingEntry(e,"grunt");i&&t.push(i);const s=Te.getSettingEntry(e,"gulp");s&&t.push(s);const r=Te.getSettingEntry(e,"jake");return r&&t.push(r),t}static getSettingEntry(e,t){if("off"===e.getValue(`${t}.autoDetect`))return{label:l.NC("TaskQuickPick.changeSettingsOptions","$(gear) {0} task detection is turned off. Enable {1} task detection...",t[0].toUpperCase()+t.slice(1),t),task:null,settingType:t,alwaysShow:!0}}_getEntriesForProvider(e){var t=this;return(0,S.Z)(function*(){const i=(yield t._taskService.tasks({type:e})).sort((n,a)=>t._sorter.compare(n,a));let s=[];if(i.length>0){for(const n of i)n.configurationProperties.hide||s.push(t._createTaskEntry(n));s.push({type:"separator"},{label:l.NC("TaskQuickPick.goBack","Go back \u21a9"),task:null,alwaysShow:!0})}else s=[{label:l.NC("TaskQuickPick.noTasksForType","No {0} tasks found. Go back \u21a9",e),task:null,alwaysShow:!0}];const r=Te.getSettingEntry(t._configurationService,e);return r&&s.push(r),s})()}_toTask(e){var t=this;return(0,S.Z)(function*(){if(!We.is(e))return e;const i=yield t._taskService.tryResolveTask(e);return i||t._notificationService.error(l.NC("noProviderForTask",'There is no task provider registered for tasks of type "{0}".',e.type)),i})()}};ri=(0,g.gn)([(0,g.fM)(0,ls.mh),(0,g.fM)(1,H.Ui),(0,g.fM)(2,ue.eJ),(0,g.fM)(3,st.lT),(0,g.fM)(4,rt.XE),(0,g.fM)(5,Wt.Ss),(0,g.fM)(6,Xe.Uy)],ri);let Ot=class yr extends ye.${constructor(e,t,i,s,r,n,a,c){super(yr.PREFIX,{noResultsPick:{label:(0,l.NC)("noTaskResults","No matching tasks")}}),this._taskService=t,this._configurationService=i,this._quickInputService=s,this._notificationService=r,this._dialogService=n,this._themeService=a,this._storageService=c}_getPicks(e,t,i){var s=this;return(0,S.Z)(function*(){if(i.isCancellationRequested)return[];const r=new ri(s._taskService,s._configurationService,s._quickInputService,s._notificationService,s._themeService,s._dialogService,s._storageService),n=yield r.getTopLevelEntries(),a=[];for(const c of n.entries){const h=(0,Jt.Oh)(e,c.label);if(!h)continue;"separator"===c.type&&a.push(c);const u=c.task,d=c;d.highlights={label:h},d.trigger=m=>{if(1===m&&2===d.buttons?.length){const C=u&&!(0,Q.HD)(u)?u.getRecentlyUsedKey():void 0;return C&&s._taskService.removeRecentlyUsedTask(C),ye.L.REFRESH_PICKER}return ze.is(u)?s._taskService.customize(u,void 0,!0):Ge.is(u)&&s._taskService.openConfig(u),ye.L.CLOSE_PICKER},d.accept=(0,S.Z)(function*(){if((0,Q.HD)(u)){const m=yield r.show((0,l.NC)("TaskService.pickRunTask","Select the task to run"),void 0,u);m&&s._taskService.run(m,{attachProblemMatcher:!0})}else s._taskService.run(yield s._toTask(u),{attachProblemMatcher:!0})}),a.push(d)}return a})()}_toTask(e){var t=this;return(0,S.Z)(function*(){return We.is(e)?t._taskService.tryResolveTask(e):e})()}};Ot.PREFIX="task ",Ot=(0,g.gn)([(0,g.fM)(0,Xi.QS),(0,g.fM)(1,ls.mh),(0,g.fM)(2,H.Ui),(0,g.fM)(3,ue.eJ),(0,g.fM)(4,st.lT),(0,g.fM)(5,Wt.Ss),(0,g.fM)(6,rt.XE),(0,g.fM)(7,Xe.Uy)],Ot);var fs=p(7387);function ni(o){const e=o;return!!e?.range&&!!e.resource}let we=class fe extends ye.${get defaultFilterValue(){if(this.configuration.preserveInput)return jt.Ry.LAST}constructor(e,t,i,s,r,n,a,c,h,u,d,m,C,b,x,I,R){super(fe.PREFIX,{canAcceptInBackground:!0,noResultsPick:fe.NO_RESULTS_PICK}),this.instantiationService=e,this.searchService=t,this.contextService=i,this.pathService=s,this.environmentService=r,this.fileService=n,this.labelService=a,this.modelService=c,this.languageService=h,this.workingCopyService=u,this.configurationService=d,this.editorService=m,this.historyService=C,this.filesConfigurationService=b,this.textModelService=x,this.uriIdentityService=I,this.quickInputService=R,this.pickState=new class{constructor(E,D){this.provider=E,this.editorService=D,this.picker=void 0,this.editorViewState=void 0,this.scorerCache=Object.create(null),this.fileQueryCache=void 0,this.lastOriginalFilter=void 0,this.lastFilter=void 0,this.lastRange=void 0,this.lastGlobalPicks=void 0,this.isQuickNavigating=void 0}set(E){this.picker=E,(0,as.I)(E.onDispose)(()=>{E===this.picker&&(this.picker=void 0)});const D=!!E.quickNavigate;D||(this.fileQueryCache=this.provider.createFileQueryCache(),this.scorerCache=Object.create(null)),this.isQuickNavigating=D,this.lastOriginalFilter=void 0,this.lastFilter=void 0,this.lastRange=void 0,this.lastGlobalPicks=void 0,this.editorViewState=void 0}rememberEditorViewState(){if(this.editorViewState)return;const E=this.editorService.activeEditorPane;E&&(this.editorViewState={group:E.group,editor:E.input,state:(0,Q.f6)((0,Fe.aq)(E.getControl())?.saveViewState())})}restoreEditorViewState(){var E=this;return(0,S.Z)(function*(){if(E.editorViewState){const D={viewState:E.editorViewState.state,preserveFocus:!0};yield E.editorViewState.group.openEditor(E.editorViewState.editor,D)}})()}}(this,this.editorService),this.labelOnlyEditorHistoryPickAccessor=new ue.oP({skipDescription:!0}),this.fileQueryDelayer=this._register(new X.rH(fe.TYPING_SEARCH_DELAY)),this.fileQueryBuilder=this.instantiationService.createInstance(Nt.z),this.helpQuickAccess=this.instantiationService.createInstance(cs.p),this.workspaceSymbolsQuickAccess=this._register(this.instantiationService.createInstance(ke)),this.editorSymbolsQuickAccess=this.instantiationService.createInstance(se)}get configuration(){const e=this.configurationService.getValue().workbench?.editor,t=this.configurationService.getValue().search,i=this.configurationService.getValue().workbench.quickOpen;return{openEditorPinned:!e?.enablePreviewFromQuickOpen||!e?.enablePreview,openSideBySideDirection:e?.openSideBySideDirection,includeSymbols:t?.quickOpen.includeSymbols,includeHistory:t?.quickOpen.includeHistory,historyFilterSortOrder:t?.quickOpen.history.filterSortOrder,shortAutoSaveDelay:1===this.filesConfigurationService.getAutoSaveMode(),preserveInput:i.preserveInput}}provide(e,t,i){const s=new P.SL;this.pickState.set(e);const r=s.add(new P.XK);return s.add(e.onDidChangeActive(()=>{r.value=void 0;const[n]=e.activeItems;ni(n)&&(r.value=this.decorateAndRevealSymbolRange(n))})),s.add((0,as.I)(e.onDidHide)(({reason:n})=>{n===ue.Jq.Gesture&&this.pickState.restoreEditorViewState()})),s.add(super.provide(e,t,i)),s}decorateAndRevealSymbolRange(e){const t=this.editorService.activeEditor;if(!this.uriIdentityService.extUri.isEqual(e.resource,t?.resource))return P.JT.None;const i=this.editorService.activeTextEditorControl;return i?(this.pickState.rememberEditorViewState(),i.revealRangeInCenter(e.range.selection,0),this.addDecorations(i,e.range.decoration),(0,P.OF)(()=>this.clearDecorations(i))):P.JT.None}_getPicks(e,t,i,s){const r=(0,q.Mm)(e,[se.PREFIX]);let n;if(n=r?r.filter:e,this.pickState.lastRange=r?.range,e!==this.pickState.lastOriginalFilter&&n===this.pickState.lastFilter)return null;const a=!!this.pickState.lastOriginalFilter;this.pickState.lastOriginalFilter=e,this.pickState.lastFilter=n;const c=this.pickState.picker?.items,h=this.pickState.picker?.activeItems[0];if(c&&h){const u=ni(h),d=h===fe.NO_RESULTS_PICK&&n.indexOf(se.PREFIX)>=0;!u&&!d&&(this.pickState.lastGlobalPicks={items:c,active:h})}return this.doGetPicks(n,{enableEditorSymbolSearch:a,includeHelp:s?.includeHelp,from:s?.from},t,i)}doGetPicks(e,t,i,s){var r=this;const n=(0,ae.AO)(e);if(t.enableEditorSymbolSearch){const u=this.getEditorSymbolPicks(n,i,s);if(u)return u}const a=this.pickState.picker?.activeItems[0];if(ni(a)&&this.pickState.lastGlobalPicks)return this.pickState.lastGlobalPicks;const c=this.getEditorHistoryPicks(n);let h;return this.pickState.isQuickNavigating?h=c:(h=[],t.includeHelp&&h.push(...this.getHelpPicks(n,s,t)),0!==c.length&&(h.push({type:"separator",label:(0,l.NC)("recentlyOpenedSeparator","recently opened")}),h.push(...c))),{picks:h,additionalPicks:(0,S.Z)(function*(){const u=new Ee.Y9;for(const m of c)m.resource&&u.set(m.resource,!0);const d=yield r.getAdditionalPicks(n,u,s);return s.isCancellationRequested?[]:d.length>0?[{type:"separator",label:r.configuration.includeSymbols?(0,l.NC)("fileAndSymbolResultsSeparator","file and symbol results"):(0,l.NC)("fileResultsSeparator","file results")},...d]:[]})(),mergeDelay:fe.SYMBOL_PICKS_MERGE_DELAY}}getAdditionalPicks(e,t,i){var s=this;return(0,S.Z)(function*(){const[r,n]=yield Promise.all([s.getFilePicks(e,t,i),s.getWorkspaceSymbolPicks(e,i)]);if(i.isCancellationRequested)return[];const a=(0,ie.we)([...r,...n],(h,u)=>(0,ae.wq)(h,u,e,!0,ue.pe,s.pickState.scorerCache),fe.MAX_RESULTS),c=[];for(const h of a)if(h.highlights)c.push(h);else{const{score:u,labelMatch:d,descriptionMatch:m}=(0,ae.EF)(h,e,!0,ue.pe,s.pickState.scorerCache);if(!u)continue;h.highlights={label:d,description:m},c.push(h)}return c})()}getEditorHistoryPicks(e){const t=this.configuration;if(!e.normalized)return this.historyService.getHistory().map(r=>this.createAnythingPick(r,t));if(!this.configuration.includeHistory)return[];const i=e.containsPathSeparator?ue.pe:this.labelOnlyEditorHistoryPickAccessor,s=[];for(const r of this.historyService.getHistory()){const n=r.resource;if(!n||!this.fileService.hasProvider(n)&&n.scheme!==B.lg.untitled&&n.scheme!==B.lg.vscodeTerminal)continue;const a=this.createAnythingPick(r,t),{score:c,labelMatch:h,descriptionMatch:u}=(0,ae.EF)(a,e,!1,i,this.pickState.scorerCache);c&&(a.highlights={label:h,description:u},s.push(a))}return"recency"===this.configuration.historyFilterSortOrder?s:s.sort((r,n)=>(0,ae.wq)(r,n,e,!1,i,this.pickState.scorerCache))}createFileQueryCache(){return new Zr(e=>this.fileQueryBuilder.file(this.contextService.getWorkspace().folders,this.getFileQueryOptions({cacheKey:e})),e=>this.searchService.fileSearch(e),e=>this.searchService.clearCache(e),this.pickState.fileQueryCache).load()}getFilePicks(e,t,i){var s=this;return(0,S.Z)(function*(){if(!e.normalized)return[];const r=yield s.getAbsolutePathFileResult(e,i);if(i.isCancellationRequested)return[];let n;if(r){if(t.has(r))return[];const c=s.createAnythingPick(r,s.configuration);return c.highlights={label:[{start:0,end:c.label.length}],description:c.description?[{start:0,end:c.description.length}]:void 0},[c]}if(n=s.pickState.fileQueryCache?.isLoaded?yield s.doFileSearch(e,i):yield s.fileQueryDelayer.trigger((0,S.Z)(function*(){return i.isCancellationRequested?[]:s.doFileSearch(e,i)})),i.isCancellationRequested)return[];const a=s.configuration;return n.filter(c=>!t.has(c)).map(c=>s.createAnythingPick(c,a))})()}doFileSearch(e,t){var i=this;return(0,S.Z)(function*(){const[s,r]=yield Promise.all([i.getFileSearchResults(e,t),i.getRelativePathFileResults(e,t)]);if(t.isCancellationRequested)return[];if(!r)return s;const n=new Ee.Y9;for(const a of r)n.set(a,!0);return[...s.filter(a=>!n.has(a)),...r]})()}getFileSearchResults(e,t){var i=this;return(0,S.Z)(function*(){let s="";s=e.values&&e.values.length>1?e.values[0].original:e.original;const r=yield i.doGetFileSearchResults(s,t);if(t.isCancellationRequested)return[];if(r.limitHit&&e.values&&e.values.length>1){const n=yield i.doGetFileSearchResults(e.original,t);if(t.isCancellationRequested)return[];const a=new Ee.Y9;for(const c of r.results)a.set(c.resource,!0);for(const c of n.results)a.has(c.resource)||r.results.push(c)}return r.results.map(n=>n.resource)})()}doGetFileSearchResults(e,t){return this.searchService.fileSearch(this.fileQueryBuilder.file(this.contextService.getWorkspace().folders,this.getFileQueryOptions({filePattern:e,cacheKey:this.pickState.fileQueryCache?.cacheKey,maxResults:fe.MAX_RESULTS})),t)}getFileQueryOptions(e){return{_reason:"openFileHandler",extraFileResources:this.instantiationService.invokeFunction(q.ek),filePattern:e.filePattern||"",cacheKey:e.cacheKey,maxResults:e.maxResults||0,sortByScore:!0}}getAbsolutePathFileResult(e,t){var i=this;return(0,S.Z)(function*(){if(!e.containsPathSeparator)return;const s=yield i.pathService.userHome(),r=(0,Hr.QC)(e.original,s.scheme===B.lg.file?s.fsPath:s.path);if(t.isCancellationRequested)return;const n=(yield i.pathService.path).isAbsolute(r);if(!t.isCancellationRequested&&n){const a=(0,Y.bK)(yield i.pathService.fileURI(r),i.environmentService.remoteAuthority,i.pathService.defaultUriScheme);if(t.isCancellationRequested)return;try{if((yield i.fileService.stat(a)).isFile)return a}catch{}}})()}getRelativePathFileResults(e,t){var i=this;return(0,S.Z)(function*(){if(e.containsPathSeparator&&!(yield i.pathService.path).isAbsolute(e.original)){const r=[];for(const n of i.contextService.getWorkspace().folders){if(t.isCancellationRequested)break;const a=(0,Y.bK)(n.toResource(e.original),i.environmentService.remoteAuthority,i.pathService.defaultUriScheme);try{(yield i.fileService.stat(a)).isFile&&r.push(a)}catch{}}return r}})()}getHelpPicks(e,t,i){if(e.normalized)return[];const s=this.helpQuickAccess.getQuickAccessProviders(),r=new Map;for(const c of s)r.set(c.prefix,c);const n=[],a=(c,h={})=>{if(r.has(c)){const u=r.get(c);u.label=u.description,u.description=u.prefix;const d={...i,includeHelp:u.prefix!==fe.PREFIX&&i?.includeHelp};n.push({...r.get(c),...h,accept:()=>{this.quickInputService.quickAccess.show(u.prefix,{preserveValue:!0,providerOptions:d})}})}};return a(fe.PREFIX),a(Gr.LF.PREFIX),a(se.PREFIX),a(zr.uT),a(Ot.PREFIX),a(cs.p.PREFIX,{label:(0,l.NC)("more","More")}),n}getWorkspaceSymbolPicks(e,t){var i=this;return(0,S.Z)(function*(){return e.normalized&&i.configuration.includeSymbols&&!i.pickState.lastRange?i.workspaceSymbolsQuickAccess.getSymbolPicks(e.original,{skipLocal:!0,skipSorting:!0,delay:fe.TYPING_SEARCH_DELAY},t):[]})()}getEditorSymbolPicks(e,t,i){const s=e.original.split(se.PREFIX),r=s.length>1?s[s.length-1].trim():void 0;if("string"!=typeof r)return null;const n=this.pickState.lastGlobalPicks?.active;if(!n)return null;const a=n.resource;return!a||!this.fileService.hasProvider(a)&&a.scheme!==B.lg.untitled||(n.label.includes(se.PREFIX)||n.description?.includes(se.PREFIX))&&s.length<3?null:this.doGetEditorSymbolPicks(n,a,r,t,i)}doGetEditorSymbolPicks(e,t,i,s,r){var n=this;return(0,S.Z)(function*(){try{n.pickState.rememberEditorViewState(),yield n.editorService.openEditor({resource:t,options:{preserveFocus:!0,revealIfOpened:!0,ignoreError:!0}})}catch{return[]}if(r.isCancellationRequested)return[];let a=n.modelService.getModel(t);if(!a)try{const h=s.add(yield n.textModelService.createModelReference(t));if(r.isCancellationRequested)return[];a=h.object.textEditorModel}catch{return[]}const c=yield n.editorSymbolsQuickAccess.getSymbolPicks(a,i,{extraContainerLabel:(0,$r.x$)(e.label)},s,r);return r.isCancellationRequested?[]:c.map(h=>"separator"===h.type?h:{...h,resource:t,description:h.description,trigger:(u,d)=>(n.openAnything(t,{keyMods:d,range:h.range?.selection,forceOpenSideBySide:!0}),ye.L.CLOSE_PICKER),accept:(u,d)=>n.openAnything(t,{keyMods:u,range:h.range?.selection,preserveFocus:d.inBackground,forcePinned:d.inBackground})})})()}addDecorations(e,t){this.editorSymbolsQuickAccess.addDecorations(e,t)}clearDecorations(e){this.editorSymbolsQuickAccess.clearDecorations(e)}createAnythingPick(e,t){const i=!Le.ov.isUri(e);let s,r,n,a,c;(0,he.Xl)(e)?(s=he.zK.getOriginalUri(e),r=e.getName(),n=e.getDescription(),a=e.isDirty()&&!e.isSaving(),c=e.getLabelExtraClasses()):(s=Le.ov.isUri(e)?e:e.resource,r=(0,Y.Hx)(s),n=this.labelService.getUriLabel((0,Y.XX)(s),{relative:!0}),a=this.workingCopyService.isDirty(s)&&!t.shortAutoSaveDelay,c=[]);const h=n?`${r} ${n}`:r,u=new fs.o(()=>(0,Qr.r)(this.modelService,this.languageService,s).concat(c)),d=new fs.o(()=>{const m=t.openSideBySideDirection,C=[];return C.push({iconClass:G.kS.asClassName("right"===m?N.lA.splitHorizontal:N.lA.splitVertical),tooltip:"right"===m?(0,l.NC)({key:"openToSide",comment:["Open this file in a split editor on the left/right side"]},"Open to the Side"):(0,l.NC)({key:"openToBottom",comment:["Open this file in a split editor on the bottom"]},"Open to the Bottom")}),i&&C.push({iconClass:a?"dirty-anything "+G.kS.asClassName(N.lA.circleFilled):G.kS.asClassName(N.lA.close),tooltip:(0,l.NC)("closeEditor","Remove from Recently Opened"),alwaysVisible:a}),C});return{resource:s,label:r,ariaLabel:a?(0,l.NC)("filePickAriaLabelDirty","{0} unsaved changes",h):h,description:n,get iconClasses(){return u.value},get buttons(){return d.value},trigger:(m,C)=>{switch(m){case 0:return this.openAnything(e,{keyMods:C,range:this.pickState.lastRange,forceOpenSideBySide:!0}),ye.L.CLOSE_PICKER;case 1:if(!Le.ov.isUri(e))return this.historyService.removeFromHistory(e),ye.L.REMOVE_ITEM}return ye.L.NO_ACTION},accept:(m,C)=>this.openAnything(e,{keyMods:m,range:this.pickState.lastRange,preserveFocus:C.inBackground,forcePinned:C.inBackground})}}openAnything(e,t){var i=this;return(0,S.Z)(function*(){const s={preserveFocus:t.preserveFocus,pinned:t.keyMods?.ctrlCmd||t.forcePinned||i.configuration.openEditorPinned,selection:t.range?ve.e.collapseToStart(t.range):void 0},r=t.keyMods?.alt||i.configuration.openEditorPinned&&t.keyMods?.ctrlCmd||t.forceOpenSideBySide?F.O3:F.LP;if(r===F.O3&&(yield i.pickState.restoreEditorViewState()),(0,he.Xl)(e))yield i.editorService.openEditor(e,s,r);else{let n;n=Le.ov.isUri(e)?{resource:e,options:s}:{...e,options:{...e.options,...s}},yield i.editorService.openEditor(n,r)}})()}};we.PREFIX="",we.NO_RESULTS_PICK={label:(0,l.NC)("noAnythingResults","No matching results")},we.MAX_RESULTS=512,we.TYPING_SEARCH_DELAY=200,we.SYMBOL_PICKS_MERGE_DELAY=200,we=(0,g.gn)([(0,g.fM)(0,V.TG),(0,g.fM)(1,A.x1),(0,g.fM)(2,Ce.ec),(0,g.fM)(3,is.a),(0,g.fM)(4,Kr.n),(0,g.fM)(5,le.sn),(0,g.fM)(6,Se.e),(0,g.fM)(7,me.q),(0,g.fM)(8,it.O),(0,g.fM)(9,ss.C),(0,g.fM)(10,H.Ui),(0,g.fM)(11,F.AR),(0,g.fM)(12,ei.C),(0,g.fM)(13,qr.LM),(0,g.fM)(14,kt.S),(0,g.fM)(15,Gt.v),(0,g.fM)(16,ue.eJ)],we);var ms=p(94014);const vs=(0,$.q5)("search-details",N.lA.ellipsis,(0,l.NC)("searchDetailsIcon","Icon to make search details visible.")),en=(0,$.q5)("search-show-context",N.lA.listSelection,(0,l.NC)("searchShowContextIcon","Icon for toggle the context in the search editor.")),oi=(0,$.q5)("search-hide-replace",N.lA.chevronRight,(0,l.NC)("searchHideReplaceIcon","Icon to collapse the replace section in the search view.")),Ss=(0,$.q5)("search-show-replace",N.lA.chevronDown,(0,l.NC)("searchShowReplaceIcon","Icon to expand the replace section in the search view.")),tn=(0,$.q5)("search-replace-all",N.lA.replaceAll,(0,l.NC)("searchReplaceAllIcon","Icon for replace all in the search view.")),ai=(0,$.q5)("search-replace",N.lA.replace,(0,l.NC)("searchReplaceIcon","Icon for replace in the search view.")),sn=(0,$.q5)("search-remove",N.lA.close,(0,l.NC)("searchRemoveIcon","Icon to remove a search result.")),ys=(0,$.q5)("search-refresh",N.lA.refresh,(0,l.NC)("searchRefreshIcon","Icon for refresh in the search view.")),rn=(0,$.q5)("search-collapse-results",N.lA.collapseAll,(0,l.NC)("searchCollapseAllIcon","Icon for collapse results in the search view.")),nn=(0,$.q5)("search-expand-results",N.lA.expandAll,(0,l.NC)("searchExpandAllIcon","Icon for expand results in the search view.")),on=(0,$.q5)("search-tree",N.lA.listTree,(0,l.NC)("searchShowAsTree","Icon for viewing results as a tree in the search view.")),an=(0,$.q5)("search-list",N.lA.listFlat,(0,l.NC)("searchShowAsList","Icon for viewing results as a list in the search view.")),cn=(0,$.q5)("search-clear-results",N.lA.clearAll,(0,l.NC)("searchClearIcon","Icon for clear results in the search view.")),ln=(0,$.q5)("search-stop",N.lA.searchStop,(0,l.NC)("searchStopIcon","Icon for stop in the search view.")),Cs=(0,$.q5)("search-view-icon",N.lA.search,(0,l.NC)("searchViewIcon","View icon of the search view.")),hn=(0,$.q5)("search-new-editor",N.lA.newFile,(0,l.NC)("searchNewEditorIcon","Icon for the action to open a new search editor."));var v=p(6418),nt=p(6262),Ye=p(33798),ws=p(3345),ci=p(76606),un=p(16003);(0,Tt.Z)(".search-view{display:flex;flex-direction:column;height:100%}.search-view .results{flex-grow:1;min-height:0}.search-view .search-widgets-container{margin:0 12px 0 2px;padding-bottom:6px;padding-top:6px}.search-view .search-widget .toggle-replace-button{align-items:center;background-position:50%;background-repeat:no-repeat;box-sizing:border-box;color:inherit;cursor:pointer;display:flex;height:100%;justify-content:center;left:0;position:absolute;top:0;width:16px}.monaco-workbench .search-view .search-widget .toggle-replace-button:hover{background-color:var(--vscode-toolbar-hoverBackground)}.monaco-workbench .search-view .search-widget .toggle-replace-button:active{background-color:var(--vscode-toolbar-activeBackground)}.search-view .search-widget .replace-container,.search-view .search-widget .search-container{margin-left:18px}.search-view .search-widget .monaco-inputbox>.ibwrapper{height:100%}.search-view .search-widget .monaco-inputbox>.ibwrapper>.mirror,.search-view .search-widget .monaco-inputbox>.ibwrapper>textarea.input{padding:3px 0 3px 6px}.search-view .search-widget .monaco-inputbox>.ibwrapper>textarea.input{height:26px;overflow:initial}.search-view .search-widget .monaco-findInput .monaco-scrollable-element .scrollbar{opacity:0}.search-view .monaco-inputbox>.ibwrapper>textarea.input{scrollbar-width:none}.search-view .monaco-inputbox>.ibwrapper>textarea.input::-webkit-scrollbar{display:none}.search-view .monaco-findInput{display:inline-block;vertical-align:middle;width:100%}.search-view .search-widget .replace-container{display:inline-flex;margin-top:6px;position:relative}.search-view .search-widget .replace-input{display:flex;position:relative;vertical-align:middle;width:auto!important}.search-view .search-widget .replace-input>.controls{position:absolute;right:2px;top:3px}.search-view .search-widget .replace-container.disabled{display:none}.search-view .search-widget .replace-container .monaco-action-bar{height:25px;margin-left:4px}.search-view .query-details{margin:0 0 0 18px;min-height:1em;position:relative}.search-view .query-details .more{color:inherit;cursor:pointer;height:16px;position:absolute;right:-2px;width:25px;z-index:2}.search-view .query-details .file-types{display:none}.search-view .query-details .file-types>.monaco-inputbox{height:25px;width:100%}.search-view .query-details.more .file-types{display:inherit}.search-view .query-details.more .file-types:last-child{padding-bottom:4px}.search-view .query-details.more h4{font-size:11px;font-weight:400;margin:0;overflow:hidden;padding:4px 0 0;text-overflow:ellipsis;white-space:nowrap}.search-view .messages{color:var(--vscode-search-resultsInfoForeground);cursor:default;margin-top:-5px}.search-view .message{overflow-wrap:break-word;padding:0 22px 8px}.search-view .message p:first-child{margin-bottom:0;margin-top:0;padding-bottom:4px;user-select:text;-webkit-user-select:text}.search-view .message a{color:var(--vscode-textLink-foreground)}.search-view .message a:active,.search-view .message a:hover{color:var(--vscode-textLink-activeForeground)}.search-view .filematch,.search-view .foldermatch{display:flex;height:100%;line-height:22px;padding:0;position:relative}.pane-body:not(.wide) .search-view .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .foldermatch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row.focused .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row.focused .foldermatch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .foldermatch .monaco-icon-label{flex:1}.pane-body.wide .search-view .filematch .badge,.pane-body.wide .search-view .foldermatch .badge{margin-left:10px}.search-view .linematch{display:flex;line-height:22px;overflow:hidden;position:relative}.search-view .linematch>.match{overflow:hidden;text-overflow:ellipsis;white-space:pre}.search-view .linematch .matchLineNum{display:none;font-size:.9em;margin-left:7px;margin-right:4px;opacity:.7}.search-view .linematch .matchLineNum.show{display:block}.pane-body.wide .search-view .monaco-list .monaco-list-row .filematch .actionBarContainer,.pane-body.wide .search-view .monaco-list .monaco-list-row .foldermatch .actionBarContainer,.search-view .monaco-list .monaco-list-row .linematch .actionBarContainer{flex:1 0 auto}.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .filematch .actionBarContainer,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .foldermatch .actionBarContainer{flex:0 0 auto}.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .linematch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .filematch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .foldermatch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .linematch .actionBarContainer{text-align:right}.search-view .monaco-list .monaco-list-row .monaco-action-bar{display:none;line-height:1em;padding:0 .8em 0 .4em}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-item{margin:0}.search-view .monaco-list .monaco-list-row.focused .monaco-action-bar,.search-view .monaco-list .monaco-list-row.selected .monaco-action-bar,.search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .monaco-action-bar{display:inline-block}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-item{margin-right:.2em}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label{padding:2px}.monaco-workbench.hc-black .search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label,.monaco-workbench.hc-light .search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label{margin-top:2px}.search-view .monaco-count-badge{margin-right:12px}.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .filematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .foldermatch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .linematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .filematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .foldermatch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .linematch .monaco-count-badge{display:none}.search-view .replace.findInFileMatch{background-color:var(--vscode-diffEditor-removedTextBackground);border:1px solid var(--vscode-diffEditor-removedTextBackground);text-decoration:line-through}.monaco-workbench.hc-dark .search-view .replace.findInFileMatch,.monaco-workbench.hc-light .search-view .replace.findInFileMatch{border:1px dashed var(--vscode-diffEditor-removedTextBackground)}.search-view .findInFileMatch,.search-view .replaceMatch{white-space:pre}.search-view .findInFileMatch{background-color:var(--vscode-editor-findMatchHighlightBackground);border:1px solid var(--vscode-editor-findMatchHighlightBorder)}.monaco-workbench.hc-dark .search-view .findInFileMatch,.monaco-workbench.hc-light .search-view .findInFileMatch{border:1px dashed var(--vscode-editor-findMatchHighlightBorder)}.search-view .replaceMatch{background-color:var(--vscode-diffEditor-insertedTextBackground)}.monaco-workbench.hc-black .search-view .findInFileMatch,.monaco-workbench.hc-black .search-view .replaceMatch,.monaco-workbench.hc-light .search-view .findInFileMatch,.monaco-workbench.hc-light .search-view .replaceMatch{background:none!important;box-sizing:border-box}.search-view .replaceMatch:not(:empty){border:1px solid var(--vscode-diffEditor-insertedLineBackground)}.monaco-workbench.hc-dark .search-view .replaceMatch:not(:empty),.monaco-workbench.hc-light .search-view .replaceMatch:not(:empty){border:1px dashed var(--vscode-diffEditor-insertedLineBackground)}.monaco-workbench.hc-black .search-view .filematch,.monaco-workbench.hc-black .search-view .foldermatch,.monaco-workbench.hc-black .search-view .linematch,.monaco-workbench.hc-light .search-view .filematch,.monaco-workbench.hc-light .search-view .foldermatch,.monaco-workbench.hc-light .search-view .linematch{line-height:20px}.monaco-workbench.vs .search-panel .search-view .monaco-inputbox{border:1px solid transparent}.text-search-provider-messages .providerMessage{padding-top:4px}.text-search-provider-messages .providerMessage .codicon{padding-right:3px;position:relative;top:3px}.monaco-workbench .search-view .monaco-list.element-focused .monaco-list-row.focused.selected:not(.highlighted) .action-label:focus{outline-color:var(--vscode-list-activeSelectionForeground)}.monaco-workbench .search-container .monaco-custom-toggle.disabled{background-color:inherit!important;cursor:default;opacity:.3;pointer-events:none;user-select:none;-webkit-user-select:none}.monaco-workbench .search-container .find-filter-button{box-sizing:border-box;color:inherit;cursor:pointer;float:left;margin-left:2px;user-select:none;-webkit-user-select:none}",{});var gn=p(48698),li=p(49462),pn=p(59493),hi=p(62465),Oe=p(13141),je=p(54922),ot=p(49052),at=p(53091),de=p(45414),ui=p(7003),ce=p(470),xs=p(12246),fn=p(86200),mn=p(32304),vn=p(11113),di=p(8742);class Sn{}var gi=p(29637),bs=p(55459),pi=p(15364),fi=p(37329);let ct=class extends bs.${constructor(e,t,i,s,r,n){super(),this.contextViewProvider=t,this.contextKeyService=s,this.configurationService=r,this.keybindingService=n,this._onSubmit=this._register(new O.Q5),this.onSubmit=this._onSubmit.event,this._onCancel=this._register(new O.Q5),this.onCancel=this._onCancel.event,i={ariaLabel:l.NC("defaultLabel","input"),...i},this.width=i.width??100,this.render(i),e.appendChild(this.domNode)}dispose(){super.dispose(),this.inputFocusTracker?.dispose()}setWidth(e){this.width=e,this.contextViewProvider.layout(),this.setInputWidth()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}inputHasFocus(){return this.inputBox.hasFocus()}setInputWidth(){this.inputBox.width=this.width-this.getSubcontrolsWidth()-2}getSubcontrolsWidth(){return 0}getHistory(){return this.inputBox.getHistory()}clearHistory(){this.inputBox.clearHistory()}clear(){this.setValue("")}onSearchSubmit(){this.inputBox.addToHistory()}showNextTerm(){this.inputBox.showNextValue()}showPreviousTerm(){this.inputBox.showPreviousValue()}render(e){this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=new pi.vF(this.domNode,this.contextViewProvider,{placeholder:e.placeholder,showPlaceholderOnFocus:e.showPlaceholderOnFocus,tooltip:e.tooltip,ariaLabel:e.ariaLabel,validationOptions:{validation:void 0},history:e.history||[],showHistoryHint:()=>(0,fi.u)(this.keybindingService),inputBoxStyles:e.inputBoxStyles},this.contextKeyService),this._register(this.inputBox.onDidChange(()=>this._onSubmit.fire(!0))),this.inputFocusTracker=v.go(this.inputBox.inputElement),this.onkeyup(this.inputBox.inputElement,i=>this.onInputKeyUp(i));const t=document.createElement("div");t.className="controls",this.renderSubcontrols(t),this.domNode.appendChild(t),this.setInputWidth()}renderSubcontrols(e){}onInputKeyUp(e){switch(e.keyCode){case 3:return this.onSearchSubmit(),void this._onSubmit.fire(!1);case 9:return void this._onCancel.fire()}}};ct.OPTION_CHANGE="optionChange",ct=(0,g.gn)([(0,g.fM)(3,w.i6),(0,g.fM)(4,H.Ui),(0,g.fM)(5,at.d)],ct);let Dt=class extends ct{constructor(e,t,i,s,r,n){super(e,t,i,s,r,n),this._onChangeSearchInEditorsBoxEmitter=this._register(new O.Q5),this.onChangeSearchInEditorsBox=this._onChangeSearchInEditorsBoxEmitter.event}dispose(){super.dispose(),this.useSearchInEditorsBox.dispose()}onlySearchInOpenEditors(){return this.useSearchInEditorsBox.checked}setOnlySearchInOpenEditors(e){this.useSearchInEditorsBox.checked=e,this._onChangeSearchInEditorsBoxEmitter.fire()}getSubcontrolsWidth(){return super.getSubcontrolsWidth()+this.useSearchInEditorsBox.width()}renderSubcontrols(e){this.useSearchInEditorsBox=this._register(new gi.ZD({icon:N.lA.book,title:l.NC("onlySearchInOpenEditors","Search only in Open Editors"),isChecked:!1,...ce.pl})),this._register(this.useSearchInEditorsBox.onChange(t=>{this._onChangeSearchInEditorsBoxEmitter.fire(),t||this.inputBox.focus()})),e.appendChild(this.useSearchInEditorsBox.domNode),super.renderSubcontrols(e)}};Dt=(0,g.gn)([(0,g.fM)(3,w.i6),(0,g.fM)(4,H.Ui),(0,g.fM)(5,at.d)],Dt);let Bt=class extends ct{constructor(e,t,i,s,r,n){super(e,t,i,s,r,n),this._onChangeIgnoreBoxEmitter=this._register(new O.Q5),this.onChangeIgnoreBox=this._onChangeIgnoreBoxEmitter.event}dispose(){super.dispose(),this.useExcludesAndIgnoreFilesBox.dispose()}useExcludesAndIgnoreFiles(){return this.useExcludesAndIgnoreFilesBox.checked}setUseExcludesAndIgnoreFiles(e){this.useExcludesAndIgnoreFilesBox.checked=e,this._onChangeIgnoreBoxEmitter.fire()}getSubcontrolsWidth(){return super.getSubcontrolsWidth()+this.useExcludesAndIgnoreFilesBox.width()}renderSubcontrols(e){this.useExcludesAndIgnoreFilesBox=this._register(new gi.ZD({icon:N.lA.exclude,actionClassName:"useExcludesAndIgnoreFiles",title:l.NC("useExcludesAndIgnoreFilesDescription","Use Exclude Settings and Ignore Files"),isChecked:!0,...ce.pl})),this._register(this.useExcludesAndIgnoreFilesBox.onChange(t=>{this._onChangeIgnoreBoxEmitter.fire(),t||this.inputBox.focus()})),e.appendChild(this.useExcludesAndIgnoreFilesBox.domNode),super.renderSubcontrols(e)}};Bt=(0,g.gn)([(0,g.fM)(3,w.i6),(0,g.fM)(4,H.Ui),(0,g.fM)(5,at.d)],Bt);const M={value:l.NC("search","Search"),original:"Search"};function De(o,e){return function xn(o,e){return e?o+" ("+e.getLabel()+")":o}(o,e)}function T(o){return o.getActiveViewWithId(A.nn)}function mi(o,e,t){let i=o.getSelection().filter(s=>null!==s).sort((s,r)=>(0,y.j0)(s,r,t.sortOrder));return e&&!(i.length>1&&i.includes(e))&&(i=[e]),i}function Be(o,e){return o.openView(A.nn,e).then(t=>t??void 0)}var bn=p(95558),Es=p(69771),En=p(67173),Is=p(59826),In=p(76688);const Rs=(o,e,t,i,s,r,n)=>{const a=v.$("div.providerMessage"),c=(0,bn.J)(o.text);v.R3(a,v.$("."+En.j.className(o.type===Is.a.Information?Es.Z.Info:Es.Z.Warning).split(" ").join(".")));for(const h of c.nodes)if("string"==typeof h)v.R3(a,document.createTextNode(h));else{const u=e.createInstance(In.r,a,h,{opener:function(){var d=(0,S.Z)(function*(m){if(!o.trusted)return;const C=Le.ov.parse(m,!0);C.scheme===B.lg.command&&o.trusted?(yield s.executeCommand(C.path))?.triggerSearch&&n():C.scheme===B.lg.https?i.open(C):t.error(C.scheme!==B.lg.command||o.trusted?l.NC("unable to open","Unable to open unknown link: {0}",m):l.NC("unable to open trust","Unable to open command link from untrusted source: {0}",m))});return function(C){return d.apply(this,arguments)}}()});r.add(u)}return a};var Fs=p(84249),ks=p(48601),vi=p(37177);const Ms="toggleSearchCaseSensitive",Ps="toggleSearchWholeWord",As="toggleSearchRegex",Ts="toggleSearchPreserveCase",Ns="workbench.action.showAllSymbols",j=new w.uy("searchViewletVisible",!0),xe=new w.uy("searchViewletFocus",!1),Je=new w.uy("inputBoxFocus",!1),lt=new w.uy("searchInputBoxFocus",!1),Ls=new w.uy("replaceInputBoxFocus",!1),ao=new w.uy("patternIncludesInputBoxFocus",!1),co=new w.uy("patternExcludesInputBoxFocus",!1),ge=new w.uy("replaceActive",!1),re=new w.uy("hasSearchResult",!1),Ws=new w.uy("firstMatchFocus",!1),Ve=new w.uy("fileMatchOrMatchFocus",!1),Os=new w.uy("fileMatchOrFolderMatchFocus",!1),Si=new w.uy("fileMatchOrFolderMatchWithResourceFocus",!1),Me=new w.uy("fileMatchFocus",!1),He=new w.uy("folderMatchFocus",!1),Vt=new w.uy("folderMatchWithResourceFocus",!1),J=new w.uy("isEditableItem",!0),Ke=new w.uy("matchFocus",!1),yi=new w.uy("viewHasSearchPattern",!1),Ds=new w.uy("viewHasReplacePattern",!1),Bs=new w.uy("viewHasFilePattern",!1),ht=new w.uy("viewHasSomeCollapsibleResult",!1),ut=new w.uy("inTreeView",!1);let Vs=(()=>{class o{getHeight(t){return o.ITEM_HEIGHT}getTemplateId(t){if(t instanceof y.nA)return dt.TEMPLATE_ID;if(t instanceof y.ut)return gt.TEMPLATE_ID;if(t instanceof y.qE)return pt.TEMPLATE_ID;throw console.error("Invalid search tree element",t),new Error("Invalid search tree element")}}return o.ITEM_HEIGHT=22,o})(),dt=class Cr extends P.JT{constructor(e,t,i,s,r,n){super(),this.searchView=e,this.labels=t,this.contextService=i,this.labelService=s,this.instantiationService=r,this.contextKeyService=n,this.templateId=Cr.TEMPLATE_ID}renderCompressedElements(e,t,i,s){const r=e.element,n=r.elements[r.elements.length-1],a=r.elements.map(c=>c.name());n.resource?i.label.setResource({resource:n.resource,name:a},{fileKind:n instanceof y.m5?le.RR.ROOT_FOLDER:le.RR.FOLDER,separator:this.labelService.getSeparator(n.resource.scheme)}):i.label.setLabel(l.NC("searchFolderMatch.other.label","Other files")),this.renderFolderDetails(n,i)}renderTemplate(e){const t=new P.SL,i=v.R3(e,v.$(".foldermatch")),s=this.labels.create(i,{supportDescriptionHighlights:!0,supportHighlights:!0});t.add(s);const r=new Fs.Z(v.R3(i,v.$(".badge")),{},ce.ku),n=v.R3(i,v.$(".actionBarContainer")),a=new P.SL;t.add(a);const c=t.add(this.contextKeyService.createScoped(e));Ke.bindTo(c).set(!1),Me.bindTo(c).set(!1),He.bindTo(c).set(!0);const h=this.instantiationService.createChild(new ot.y([w.i6,c]));return{label:s,badge:r,actions:t.add(h.createInstance(vi.r,n,f.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:d=>/^inline/.test(d)}})),disposables:t,elementDisposables:a,contextKeyService:c}}renderElement(e,t,i){const s=e.element;if(s.resource){const r=this.contextService.getWorkspaceFolder(s.resource);r&&(0,Y.Xy)(r.uri,s.resource)?i.label.setFile(s.resource,{fileKind:le.RR.ROOT_FOLDER,hidePath:!0}):i.label.setFile(s.resource,{fileKind:le.RR.FOLDER,hidePath:this.searchView.isTreeLayoutViewVisible})}else i.label.setLabel(l.NC("searchFolderMatch.other.label","Other files"));J.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches()),i.elementDisposables.add(s.onChange(()=>{J.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches())})),this.renderFolderDetails(s,i)}disposeElement(e,t,i){i.elementDisposables.clear()}disposeCompressedElements(e,t,i,s){i.elementDisposables.clear()}disposeTemplate(e){e.disposables.dispose()}renderFolderDetails(e,t){const i=e.recursiveMatchCount();t.badge.setCount(i),t.badge.setTitleFormat(i>1?l.NC("searchFileMatches","{0} files found",i):l.NC("searchFileMatch","{0} file found",i)),t.actions.context={viewer:this.searchView.getControl(),element:e}}};dt.TEMPLATE_ID="folderMatch",dt=(0,g.gn)([(0,g.fM)(2,Ce.ec),(0,g.fM)(3,Se.e),(0,g.fM)(4,V.TG),(0,g.fM)(5,w.i6)],dt);let gt=class wr extends P.JT{constructor(e,t,i,s,r,n){super(),this.searchView=e,this.labels=t,this.contextService=i,this.configurationService=s,this.instantiationService=r,this.contextKeyService=n,this.templateId=wr.TEMPLATE_ID}renderCompressedElements(e,t,i,s){throw new Error("Should never happen since node is incompressible.")}renderTemplate(e){const t=new P.SL,i=new P.SL;t.add(i);const s=v.R3(e,v.$(".filematch")),r=this.labels.create(s);t.add(r);const n=new Fs.Z(v.R3(s,v.$(".badge")),{},ce.ku),a=v.R3(s,v.$(".actionBarContainer")),c=t.add(this.contextKeyService.createScoped(e));Ke.bindTo(c).set(!1),Me.bindTo(c).set(!0),He.bindTo(c).set(!1);const h=this.instantiationService.createChild(new ot.y([w.i6,c]));return{el:s,label:r,badge:n,actions:t.add(h.createInstance(vi.r,a,f.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:d=>/^inline/.test(d)}})),disposables:t,elementDisposables:i,contextKeyService:c}}renderElement(e,t,i){const s=e.element;i.el.setAttribute("data-resource",s.resource.toString());const r=this.configurationService.getValue("search").decorations;i.label.setFile(s.resource,{hidePath:this.searchView.isTreeLayoutViewVisible&&!(s.parent()instanceof y.uN),hideIcon:!1,fileDecorations:{colors:r.colors,badges:r.badges}});const n=s.count();i.badge.setCount(n),i.badge.setTitleFormat(n>1?l.NC("searchMatches","{0} matches found",n):l.NC("searchMatch","{0} match found",n)),i.actions.context={viewer:this.searchView.getControl(),element:s},J.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches()),i.elementDisposables.add(s.onChange(()=>{J.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches())})),i.el.parentElement?.parentElement?.querySelector(".monaco-tl-twistie")?.classList.add("force-twistie")}disposeElement(e,t,i){i.elementDisposables.clear()}disposeTemplate(e){e.disposables.dispose()}};gt.TEMPLATE_ID="fileMatch",gt=(0,g.gn)([(0,g.fM)(2,Ce.ec),(0,g.fM)(3,H.Ui),(0,g.fM)(4,V.TG),(0,g.fM)(5,w.i6)],gt);let pt=class xr extends P.JT{constructor(e,t,i,s,r,n){super(),this.searchModel=e,this.searchView=t,this.contextService=i,this.configurationService=s,this.instantiationService=r,this.contextKeyService=n,this.templateId=xr.TEMPLATE_ID}renderCompressedElements(e,t,i,s){throw new Error("Should never happen since node is incompressible.")}renderTemplate(e){e.classList.add("linematch");const t=v.R3(e,v.$("a.plain.match")),i=v.R3(t,v.$("span")),s=v.R3(t,v.$("span.findInFileMatch")),r=v.R3(t,v.$("span.replaceMatch")),n=v.R3(t,v.$("span")),a=v.R3(e,v.$("span.matchLineNum")),c=v.R3(e,v.$("span.actionBarContainer")),h=new P.SL,u=h.add(this.contextKeyService.createScoped(e));Ke.bindTo(u).set(!0),Me.bindTo(u).set(!1),He.bindTo(u).set(!1);const d=this.instantiationService.createChild(new ot.y([w.i6,u]));return{parent:t,before:i,match:s,replace:r,after:n,lineNumber:a,actions:h.add(d.createInstance(vi.r,c,f.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:C=>/^inline/.test(C)}})),disposables:h,contextKeyService:u}}renderElement(e,t,i){const s=e.element,r=s.preview(),n=this.searchModel.isReplaceActive()&&!!this.searchModel.replaceString&&!(s instanceof y.YT&&s.isWebviewMatch());i.before.textContent=r.before,i.match.textContent=r.inside,i.match.classList.toggle("replace",n),i.replace.textContent=n?s.replaceString:"",i.after.textContent=r.after,i.parent.title=(r.before+(n?s.replaceString:r.inside)+r.after).trim().substr(0,999),J.bindTo(i.contextKeyService).set(!(s instanceof y.YT&&s.isWebviewMatch()));const a=s.range().endLineNumber-s.range().startLineNumber,c=a>0?`+${a}`:"",h=this.configurationService.getValue("search").showLineNumbers,u=h?`:${s.range().startLineNumber}`:"";i.lineNumber.classList.toggle("show",a>0||h),i.lineNumber.textContent=u+c,i.lineNumber.setAttribute("title",this.getMatchTitle(s,h)),i.actions.context={viewer:this.searchView.getControl(),element:s}}disposeTemplate(e){e.disposables.dispose()}getMatchTitle(e,t){const i=e.range().startLineNumber,s=e.range().endLineNumber-e.range().startLineNumber;return(t?l.NC("lineNumStr","From line {0}",i,s)+" ":"")+(s>0?"+ "+l.NC("numLinesStr","{0} more lines",s):"")}};pt.TEMPLATE_ID="match",pt=(0,g.gn)([(0,g.fM)(2,Ce.ec),(0,g.fM)(3,H.Ui),(0,g.fM)(4,V.TG),(0,g.fM)(5,w.i6)],pt);let Ci=class{constructor(e,t){this.searchModel=e,this.labelService=t}getWidgetAriaLabel(){return l.NC("search","Search")}getAriaLabel(e){if(e instanceof y.nA){const t=e.allDownstreamFileMatches().reduce((i,s)=>i+s.count(),0);return e.resource?l.NC("folderMatchAriaLabel","{0} matches in folder root {1}, Search result",t,e.name()):l.NC("otherFilesAriaLabel","{0} matches outside of the workspace, Search result",t)}if(e instanceof y.ut){const t=this.labelService.getUriLabel(e.resource,{relative:!0})||e.resource.fsPath;return l.NC("fileMatchAriaLabel","{0} matches in file {1} of folder {2}, Search result",e.count(),e.name(),ks.XX(t))}if(e instanceof y.qE){const t=e,i=this.searchModel,s=i.isReplaceActive()&&!!i.replaceString,r=t.getMatchString(),n=t.range(),a=t.text().substr(0,n.endColumn+150);return s?l.NC("replacePreviewResultAria","'{0}' at column {1} replace {2} with {3}",a,n.startColumn,r,t.replaceString):l.NC("searchResultAria","'{0}' at column {1} found {2}",a,n.startColumn,r)}return null}};Ci=(0,g.gn)([(0,g.fM)(1,Se.e)],Ci);var Hs=p(9110),lo=p(95270),ho=p(27331),Ht=p(32243),Pe=p(7898),Kt=p(42965),uo=p(28759);const U=new w.uy("inSearchEditor",!1),wi="search-editor",Ks="search/editor",Qs="searchEditorFindMatch",xi="workbench.editor.searchEditor",ft="search.action.openEditor",Us="toggleSearchEditorContextLines",bi="workbench.editorinputs.searchEditorInput";class po extends P.JT{get markupInput(){return this._markupInput}set markupInput(e){this._markupInput!==e&&(this._markupInput=e,this._onDidChange.fire({markupInput:e}))}get markupPreview(){return this._markupPreview}set markupPreview(e){this._markupPreview!==e&&(this._markupPreview=e,this._onDidChange.fire({markupPreview:e}))}get codeInput(){return this._codeInput}set codeInput(e){this._codeInput!==e&&(this._codeInput=e,this._onDidChange.fire({codeInput:e}))}get codeOutput(){return this._codeOutput}set codeOutput(e){this._codeOutput!==e&&(this._codeOutput=e,this._onDidChange.fire({codeOutput:e}))}constructor(e,t,i,s){super(),this._onDidChange=this._register(new O.Q5),this.onDidChange=this._onDidChange.event,this._markupInput=!0,this._markupPreview=!0,this._codeInput=!0,this._codeOutput=!0,this._markupInput=e,this._markupPreview=t,this._codeInput=i,this._codeOutput=s,this._initialMarkupInput=e,this._initialMarkupPreview=t,this._initialCodeInput=i,this._initialCodeOutput=s}isModified(){return this._markupInput!==this._initialMarkupInput||this._markupPreview!==this._initialMarkupPreview||this._codeInput!==this._initialCodeInput||this._codeOutput!==this._initialCodeOutput}update(e){this._markupInput=e.markupInput,this._markupPreview=e.markupPreview,this._codeInput=e.codeInput,this._codeOutput=e.codeOutput}}var Zs=p(48017);(0,Tt.Z)(".monaco-workbench .simple-fr-find-part-wrapper{background-color:var(--vscode-editorWidget-background)!important;border-bottom-left-radius:4px;border-bottom-right-radius:4px;box-shadow:0 0 8px 2px var(--vscode-widget-shadow);color:var(--vscode-editorWidget-foreground);max-width:calc(100% - 64px);overflow:hidden;padding:0 var(--notebook-find-horizontal-padding);position:absolute;right:18px;top:-45px;transition:top .2s linear;visibility:hidden;width:var(--notebook-find-width);z-index:10}.monaco-workbench.reduce-motion .simple-fr-find-part-wrapper{transition:top 0ms linear}.monaco-workbench .notebookOverlay .simple-fr-find-part-wrapper.visible{z-index:100}.monaco-workbench .simple-fr-find-part,.monaco-workbench .simple-fr-replace-part{align-items:center;display:flex;margin:0 0 0 17px;padding:4px;pointer-events:all;position:relative;top:0;z-index:10}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress{height:2px;position:absolute;width:100%}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress .monaco-progress-container{height:2px;top:0!important;z-index:100!important}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress .monaco-progress-container .progress-bit{height:2px}.monaco-workbench .simple-fr-find-part-wrapper .monaco-findInput{width:224px}.monaco-workbench .simple-fr-find-part-wrapper .button{align-items:center;background-position:50%;background-repeat:no-repeat;cursor:pointer;display:flex;flex:initial;height:20px;justify-content:center;margin-left:3px;width:20px}.monaco-workbench .simple-fr-find-part-wrapper.visible .simple-fr-find-part{visibility:visible}.monaco-workbench .simple-fr-find-part-wrapper .toggle{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin-left:0;pointer-events:all;position:absolute;top:0;width:18px}.monaco-workbench .simple-fr-find-part-wrapper.visible{visibility:visible}.monaco-workbench .simple-fr-find-part-wrapper.visible-transition{top:0}.monaco-workbench .simple-fr-find-part .monaco-findInput{flex:1}.monaco-workbench .simple-fr-find-part .button{background-position:50%;background-repeat:no-repeat;cursor:pointer;display:flex;flex:initial;height:20px;margin-left:3px;min-width:20px;width:20px}.monaco-workbench .simple-fr-find-part-wrapper .button.disabled{cursor:default;opacity:.3}.monaco-workbench .simple-fr-find-part-wrapper .monaco-custom-toggle.disabled{background-color:inherit!important;cursor:default;opacity:.3;pointer-events:none;user-select:none;-webkit-user-select:none}.monaco-workbench .simple-fr-find-part-wrapper .find-filter-button{box-sizing:border-box;color:inherit;cursor:pointer;float:left;margin-left:2px;user-select:none;-webkit-user-select:none}.find-filter-button .monaco-action-bar .action-label{padding:0}.monaco-workbench .simple-fr-find-part .monaco-inputbox>.ibwrapper>.input,.monaco-workbench .simple-fr-replace-part .monaco-inputbox>.ibwrapper>.input{height:24px}.monaco-workbench .simple-fr-find-part-wrapper .monaco-sash{background-color:var(--vscode-editorWidget-resizeBorder,var(--vscode-editorWidget-border));left:0!important}",{});var mo=p(92908),vo=p(60234);(0,$.q5)("find-filter",N.lA.filter,l.NC("findFilterIcon","Icon for Find Filter in find widget."));const So=l.NC("notebook.find.filter.filterAction","Find Filters"),yo=l.NC("notebook.find.filter.findInMarkupInput","Markdown Source"),Co=l.NC("notebook.find.filter.findInMarkupPreview","Rendered Markdown"),wo=l.NC("notebook.find.filter.findInCodeInput","Code Cell Source"),xo=l.NC("notebook.find.filter.findInCodeOutput","Code Cell Output");let Ei=class extends mo.C{constructor(e,t,i,s){super(t,{getActions:()=>this.getActions()},s,{actionRunner:i,classNames:t.class,anchorAlignmentProvider:()=>1}),this.filters=e}render(e){super.render(e),this.updateChecked()}getActions(){var e=this;const t={checked:this.filters.markupInput,class:void 0,enabled:!0,id:"findInMarkdownInput",label:yo,run:(n=(0,S.Z)(function*(){e.filters.markupInput=!e.filters.markupInput}),function(){return n.apply(this,arguments)}),tooltip:""},i={checked:this.filters.markupPreview,class:void 0,enabled:!0,id:"findInMarkdownInput",label:Co,run:function(){var n=(0,S.Z)(function*(){e.filters.markupPreview=!e.filters.markupPreview});return function(){return n.apply(this,arguments)}}(),tooltip:""},s={checked:this.filters.codeInput,class:void 0,enabled:!0,id:"findInCodeInput",label:wo,run:function(){var n=(0,S.Z)(function*(){e.filters.codeInput=!e.filters.codeInput});return function(){return n.apply(this,arguments)}}(),tooltip:""},r={checked:this.filters.codeOutput,class:void 0,enabled:!0,id:"findInCodeOutput",label:xo,run:function(){var n=(0,S.Z)(function*(){e.filters.codeOutput=!e.filters.codeOutput});return function(){return n.apply(this,arguments)}}(),tooltip:"",dispose:()=>null};var n;return Ne.G6?[t,s]:[t,i,new Ht.Z0,s,r]}updateChecked(){this.element.classList.toggle("checked",this._action.checked)}};Ei=(0,g.gn)([(0,g.fM)(3,je.i)],Ei);class Io extends P.JT{constructor(e,t,i,s,r=So){super(),this.filters=e,this.contextMenuService=t,this.instantiationService=i,this._actionbar=null,this._toggleStyles=s.toggleStyles,this._filtersAction=new Ht.aU("notebookFindFilterAction",r,"notebook-filters "+G.kS.asClassName(vo.QR)),this._filtersAction.checked=!1,this._filterButtonContainer=v.$(".find-filter-button"),this._filterButtonContainer.classList.add("monaco-custom-toggle"),this.createFilters(this._filterButtonContainer)}get container(){return this._filterButtonContainer}get width(){return 22}applyStyles(e){const t=this._toggleStyles;this._filterButtonContainer.style.border="1px solid transparent",this._filterButtonContainer.style.borderRadius="3px",this._filterButtonContainer.style.borderColor=e&&t.inputActiveOptionBorder||"",this._filterButtonContainer.style.color=e&&t.inputActiveOptionForeground||"inherit",this._filterButtonContainer.style.backgroundColor=e&&t.inputActiveOptionBackground||""}createFilters(e){this._actionbar=this._register(new Hs.o(e,{actionViewItemProvider:t=>{if(t.id===this._filtersAction.id)return this.instantiationService.createInstance(Ei,this.filters,t,new Ht.Wi)}})),this._actionbar.push(this._filtersAction,{icon:!0,label:!1})}}(0,rt.Ic)((o,e)=>{e.addRule("\n\t.notebook-editor {\n\t\t--notebook-find-width: 318px;\n\t\t--notebook-find-horizontal-padding: 4px;\n\t}\n\t")});class Ii extends pi.Yb{constructor(e,t,i,s,r,n,a,c){super(e,t,i,s),this.contextMenuService=r,this.instantiationService=n,this.filters=a,this._filterChecked=!1,this._visible=!1,this._findFilter=this._register(new Io(a,r,n,i,l.NC("searchFindInputNotebookFilter.label","Notebook Find Filters"))),this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this._findFilter.width,this.controls.appendChild(this._findFilter.container),this._findFilter.container.classList.add("monaco-custom-toggle"),this.filterVisible=c}set filterVisible(e){this._findFilter.container.style.display=e?"":"none",this._visible=e,this.updateStyles()}setEnabled(e){super.setEnabled(e),!e||this._filterChecked&&this._visible?this.regex?.disable():this.regex?.enable()}updateStyles(){this._filterChecked=!(this.filters.markupInput&&this.filters.markupPreview&&this.filters.codeInput&&this.filters.codeOutput),this._findFilter.applyStyles(this._filterChecked)}}let Qt=(()=>{class o extends Ht.aU{constructor(t){super(o.ID,"",G.kS.asClassName(tn),!1),this._searchWidget=t}set searchWidget(t){this._searchWidget=t}run(){return this._searchWidget?this._searchWidget.triggerReplaceAll():Promise.resolve(null)}}return o.ID="search.action.replaceAll",o})();const $s=Ne.dz?256:2048;function Gs(o,e,t){const i=!!e.match(/\n/);t&&(i||t.clientHeight>26)&&t.selectionStart>0&&o.stopPropagation()}function zs(o,e,t){const i=!!e.match(/\n/);t&&(i||t.clientHeight>26)&&t.selectionEnd<t.value.length&&o.stopPropagation()}let Qe=class tt extends bs.${constructor(e,t,i,s,r,n,a,c,h,u,d){super(),this.contextViewService=i,this.contextKeyService=s,this.keybindingService=r,this.clipboardServce=n,this.configurationService=a,this.accessibilityService=c,this.contextMenuService=h,this.instantiationService=u,this.editorService=d,this.ignoreGlobalFindBufferOnNextFocus=!1,this.previousGlobalFindBufferValue=null,this._onSearchSubmit=this._register(new O.Q5),this.onSearchSubmit=this._onSearchSubmit.event,this._onSearchCancel=this._register(new O.Q5),this.onSearchCancel=this._onSearchCancel.event,this._onReplaceToggled=this._register(new O.Q5),this.onReplaceToggled=this._onReplaceToggled.event,this._onReplaceStateChange=this._register(new O.Q5),this.onReplaceStateChange=this._onReplaceStateChange.event,this._onPreserveCaseChange=this._register(new O.Q5),this.onPreserveCaseChange=this._onPreserveCaseChange.event,this._onReplaceValueChanged=this._register(new O.Q5),this.onReplaceValueChanged=this._onReplaceValueChanged.event,this._onReplaceAll=this._register(new O.Q5),this.onReplaceAll=this._onReplaceAll.event,this._onBlur=this._register(new O.Q5),this.onBlur=this._onBlur.event,this._onDidHeightChange=this._register(new O.Q5),this.onDidHeightChange=this._onDidHeightChange.event,this._onDidToggleContext=new O.Q5,this.onDidToggleContext=this._onDidToggleContext.event,this.replaceActive=ge.bindTo(this.contextKeyService),this.searchInputBoxFocused=lt.bindTo(this.contextKeyService),this.replaceInputBoxFocused=Ls.bindTo(this.contextKeyService);const m=t.notebookOptions??{isInNotebookMarkdownInput:!0,isInNotebookMarkdownPreview:!0,isInNotebookCellInput:!0,isInNotebookCellOutput:!0};this._notebookFilters=this._register(new po(m.isInNotebookMarkdownInput,m.isInNotebookMarkdownPreview,m.isInNotebookCellInput,m.isInNotebookCellOutput)),this._register(this._notebookFilters.onDidChange(()=>{this.searchInput instanceof Ii&&this.searchInput.updateStyles()})),this._register(this.editorService.onDidEditorsChange(C=>{this.searchInput instanceof Ii&&C.event.editor instanceof Zs.h&&(3===C.event.kind||4===C.event.kind)&&(this.searchInput.filterVisible=this._hasNotebookOpen())})),this._replaceHistoryDelayer=new X.vp(500),this.render(e,t),this.configurationService.onDidChangeConfiguration(C=>{C.affectsConfiguration("editor.accessibilitySupport")&&this.updateAccessibilitySupport()}),this.accessibilityService.onDidChangeScreenReaderOptimized(()=>this.updateAccessibilitySupport()),this.updateAccessibilitySupport()}_hasNotebookOpen(){return this.editorService.editors.some(t=>t instanceof Zs.h)}getNotebookFilters(){return this._notebookFilters}focus(e=!0,t=!1,i=!1){this.ignoreGlobalFindBufferOnNextFocus=i,t&&this.isReplaceShown()?this.replaceInput&&(this.replaceInput.focus(),e&&this.replaceInput.select()):this.searchInput&&(this.searchInput.focus(),e&&this.searchInput.select())}setWidth(e){this.searchInput?.inputBox.layout(),this.replaceInput&&(this.replaceInput.width=e-28,this.replaceInput.inputBox.layout())}clear(){this.searchInput?.clear(),this.replaceInput?.setValue(""),this.setReplaceAllActionState(!1)}isReplaceShown(){return!!this.replaceContainer&&!this.replaceContainer.classList.contains("disabled")}isReplaceActive(){return!!this.replaceActive.get()}getReplaceValue(){return this.replaceInput?.getValue()??""}toggleReplace(e){(void 0===e||e!==this.isReplaceShown())&&this.onToggleReplaceButton()}getSearchHistory(){return this.searchInput?.inputBox.getHistory()??[]}getReplaceHistory(){return this.replaceInput?.inputBox.getHistory()??[]}clearHistory(){this.searchInput?.inputBox.clearHistory(),this.replaceInput?.inputBox.clearHistory()}showNextSearchTerm(){this.searchInput?.inputBox.showNextValue()}showPreviousSearchTerm(){this.searchInput?.inputBox.showPreviousValue()}showNextReplaceTerm(){this.replaceInput?.inputBox.showNextValue()}showPreviousReplaceTerm(){this.replaceInput?.inputBox.showPreviousValue()}searchInputHasFocus(){return!!this.searchInputBoxFocused.get()}replaceInputHasFocus(){return!!this.replaceInput?.inputBox.hasFocus()}focusReplaceAllAction(){this.replaceActionBar?.focus(!0)}focusRegexAction(){this.searchInput?.focusOnRegex()}render(e,t){this.domNode=v.R3(e,v.$(".search-widget")),this.domNode.style.position="relative",t._hideReplaceToggle||this.renderToggleReplaceButton(this.domNode),this.renderSearchInput(this.domNode,t),this.renderReplaceInput(this.domNode,t)}updateAccessibilitySupport(){this.searchInput?.setFocusInputOnOptionClick(!this.accessibilityService.isScreenReaderOptimized())}renderToggleReplaceButton(e){this.toggleReplaceButton=this._register(new lo.zx(e,{buttonBackground:void 0,buttonBorder:void 0,buttonForeground:void 0,buttonHoverBackground:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0,buttonSeparator:void 0})),this.toggleReplaceButton.element.setAttribute("aria-expanded","false"),this.toggleReplaceButton.element.classList.add("toggle-replace-button"),this.toggleReplaceButton.icon=oi,this.toggleReplaceButton.onDidClick(()=>this.onToggleReplaceButton()),this.toggleReplaceButton.element.title=l.NC("search.replace.toggle.button.title","Toggle Replace")}renderSearchInput(e,t){var i=this;const s={label:l.NC("label.Search","Search: Type Search Term and press Enter to search"),validation:n=>this.validateSearchInput(n),placeholder:l.NC("search.placeHolder","Search"),appendCaseSensitiveLabel:De("",this.keybindingService.lookupKeybinding(Ms)),appendWholeWordsLabel:De("",this.keybindingService.lookupKeybinding(Ps)),appendRegexLabel:De("",this.keybindingService.lookupKeybinding(As)),history:t.searchHistory,showHistoryHint:()=>(0,fi.u)(this.keybindingService),flexibleHeight:!0,flexibleMaxHeight:tt.INPUT_MAX_HEIGHT,showCommonFindToggles:!0,inputBoxStyles:t.inputBoxStyles,toggleStyles:t.toggleStyles},r=v.R3(e,v.$(".search-container.input-box"));this.searchInput=this._register(new Ii(r,this.contextViewService,s,this.contextKeyService,this.contextMenuService,this.instantiationService,this._notebookFilters,this._hasNotebookOpen())),this.searchInput.onKeyDown(n=>this.onSearchInputKeyDown(n)),this.searchInput.setValue(t.value||""),this.searchInput.setRegex(!!t.isRegex),this.searchInput.setCaseSensitive(!!t.isCaseSensitive),this.searchInput.setWholeWords(!!t.isWholeWords),this._register(this.searchInput.onCaseSensitiveKeyDown(n=>this.onCaseSensitiveKeyDown(n))),this._register(this.searchInput.onRegexKeyDown(n=>this.onRegexKeyDown(n))),this._register(this.searchInput.inputBox.onDidChange(()=>this.onSearchInputChanged())),this._register(this.searchInput.inputBox.onDidHeightChange(()=>this._onDidHeightChange.fire())),this._register(this.onReplaceValueChanged(()=>{this._replaceHistoryDelayer.trigger(()=>this.replaceInput?.inputBox.addToHistory())})),this.searchInputFocusTracker=this._register(v.go(this.searchInput.inputBox.inputElement)),this._register(this.searchInputFocusTracker.onDidFocus((0,S.Z)(function*(){if(i.searchInputBoxFocused.set(!0),!i.ignoreGlobalFindBufferOnNextFocus&&i.searchConfiguration.globalFindClipboard){const a=yield i.clipboardServce.readFindText();a&&i.previousGlobalFindBufferValue!==a&&(i.searchInput?.inputBox.addToHistory(),i.searchInput?.setValue(a),i.searchInput?.select()),i.previousGlobalFindBufferValue=a}i.ignoreGlobalFindBufferOnNextFocus=!1}))),this._register(this.searchInputFocusTracker.onDidBlur(()=>this.searchInputBoxFocused.set(!1))),this.showContextToggle=new gi.ZD({isChecked:!1,title:De(l.NC("showContext","Toggle Context Lines"),this.keybindingService.lookupKeybinding(Us)),icon:en,...ce.pl}),this._register(this.showContextToggle.onChange(()=>this.onContextLinesChanged())),t.showContextToggle&&(this.contextLinesInput=new ho.Wz(r,this.contextViewService,{type:"number",inputBoxStyles:ce.Hc}),this.contextLinesInput.element.classList.add("context-lines-input"),this.contextLinesInput.value=""+(this.configurationService.getValue("search").searchEditor.defaultNumberOfContextLines??1),this._register(this.contextLinesInput.onDidChange(n=>{"0"!==n&&(this.showContextToggle.checked=!0),this.onContextLinesChanged()})),v.R3(r,this.showContextToggle.domNode))}onContextLinesChanged(){this._onDidToggleContext.fire(),this.contextLinesInput.value.includes("-")&&(this.contextLinesInput.value="0"),this._onDidToggleContext.fire()}setContextLines(e){this.contextLinesInput&&(0===e?this.showContextToggle.checked=!1:(this.showContextToggle.checked=!0,this.contextLinesInput.value=""+e))}renderReplaceInput(e,t){this.replaceContainer=v.R3(e,v.$(".replace-container.disabled"));const i=v.R3(this.replaceContainer,v.$(".replace-input"));this.replaceInput=this._register(new pi.Nq(i,this.contextViewService,{label:l.NC("label.Replace","Replace: Type replace term and press Enter to preview"),placeholder:l.NC("search.replace.placeHolder","Replace"),appendPreserveCaseLabel:De("",this.keybindingService.lookupKeybinding(Ts)),history:t.replaceHistory,showHistoryHint:()=>(0,fi.u)(this.keybindingService),flexibleHeight:!0,flexibleMaxHeight:tt.INPUT_MAX_HEIGHT,inputBoxStyles:t.inputBoxStyles,toggleStyles:t.toggleStyles},this.contextKeyService,!0)),this._register(this.replaceInput.onDidOptionChange(s=>{s||this.replaceInput&&this._onPreserveCaseChange.fire(this.replaceInput.getPreserveCase())})),this.replaceInput.onKeyDown(s=>this.onReplaceInputKeyDown(s)),this.replaceInput.setValue(t.replaceValue||""),this._register(this.replaceInput.inputBox.onDidChange(()=>this._onReplaceValueChanged.fire())),this._register(this.replaceInput.inputBox.onDidHeightChange(()=>this._onDidHeightChange.fire())),this.replaceAllAction=new Qt(this),this.replaceAllAction.label=tt.REPLACE_ALL_DISABLED_LABEL,this.replaceActionBar=this._register(new Hs.o(this.replaceContainer)),this.replaceActionBar.push([this.replaceAllAction],{icon:!0,label:!1}),this.onkeydown(this.replaceActionBar.domNode,s=>this.onReplaceActionbarKeyDown(s)),this.replaceInputFocusTracker=this._register(v.go(this.replaceInput.inputBox.inputElement)),this._register(this.replaceInputFocusTracker.onDidFocus(()=>this.replaceInputBoxFocused.set(!0))),this._register(this.replaceInputFocusTracker.onDidBlur(()=>this.replaceInputBoxFocused.set(!1))),this._register(this.replaceInput.onPreserveCaseKeyDown(s=>this.onPreserveCaseKeyDown(s)))}triggerReplaceAll(){return this._onReplaceAll.fire(),Promise.resolve(null)}onToggleReplaceButton(){this.replaceContainer?.classList.toggle("disabled"),this.isReplaceShown()?(this.toggleReplaceButton?.element.classList.remove(...G.kS.asClassNameArray(oi)),this.toggleReplaceButton?.element.classList.add(...G.kS.asClassNameArray(Ss))):(this.toggleReplaceButton?.element.classList.remove(...G.kS.asClassNameArray(Ss)),this.toggleReplaceButton?.element.classList.add(...G.kS.asClassNameArray(oi))),this.toggleReplaceButton?.element.setAttribute("aria-expanded",this.isReplaceShown()?"true":"false"),this.updateReplaceActiveState(),this._onReplaceToggled.fire()}setValue(e){this.searchInput?.setValue(e)}setReplaceAllActionState(e){this.replaceAllAction&&this.replaceAllAction.enabled!==e&&(this.replaceAllAction.enabled=e,this.replaceAllAction.label=e?tt.REPLACE_ALL_ENABLED_LABEL(this.keybindingService):tt.REPLACE_ALL_DISABLED_LABEL,this.updateReplaceActiveState())}updateReplaceActiveState(){const e=this.isReplaceActive(),t=this.isReplaceShown()&&!!this.replaceAllAction?.enabled;e!==t&&(this.replaceActive.set(t),this._onReplaceStateChange.fire(t),this.replaceInput?.inputBox.layout())}validateSearchInput(e){return 0===e.length||this.searchInput?.getRegex(),null}onSearchInputChanged(){if(this.searchInput?.clearMessage(),this.setReplaceAllActionState(!1),this.searchConfiguration.searchOnType)if(this.searchInput?.getRegex())try{const e=new RegExp(this.searchInput.getValue(),"ug"),t="\n\t\t\t\t\t\t\t\t~!@#$%^&*()_+\n\t\t\t\t\t\t\t\t`1234567890-=\n\t\t\t\t\t\t\t\tqwertyuiop[]\\\n\t\t\t\t\t\t\t\tQWERTYUIOP{}|\n\t\t\t\t\t\t\t\tasdfghjkl;'\n\t\t\t\t\t\t\t\tASDFGHJKL:\"\n\t\t\t\t\t\t\t\tzxcvbnm,./\n\t\t\t\t\t\t\t\tZXCVBNM<>? ".match(e)?.length??0;this.submitSearch(!0,this.searchConfiguration.searchOnTypeDebouncePeriod*(t<50?1:t<100?5:10))}catch{}else this.submitSearch(!0,this.searchConfiguration.searchOnTypeDebouncePeriod)}onSearchInputKeyDown(e){e.equals(3|$s)&&(this.searchInput?.inputBox.insertAtCursor("\n"),e.preventDefault()),e.equals(3)?(this.searchInput?.onSearchSubmit(),this.submitSearch(),e.preventDefault()):e.equals(9)?(this._onSearchCancel.fire({focus:!0}),e.preventDefault()):e.equals(2)?(this.isReplaceShown()?this.replaceInput?.focus():this.searchInput?.focusOnCaseSensitive(),e.preventDefault()):e.equals(16)?Gs(e,this.searchInput?.getValue()??"",this.searchInput?.domNode.querySelector("textarea")??null):e.equals(18)&&zs(e,this.searchInput?.getValue()??"",this.searchInput?.domNode.querySelector("textarea")??null)}onCaseSensitiveKeyDown(e){e.equals(1026)&&this.isReplaceShown()&&(this.replaceInput?.focus(),e.preventDefault())}onRegexKeyDown(e){e.equals(2)&&this.isReplaceShown()&&(this.replaceInput?.focusOnPreserve(),e.preventDefault())}onPreserveCaseKeyDown(e){e.equals(2)?(this.isReplaceActive()?this.focusReplaceAllAction():this._onBlur.fire(),e.preventDefault()):e.equals(1026)&&(this.focusRegexAction(),e.preventDefault())}onReplaceInputKeyDown(e){e.equals(3|$s)&&(this.replaceInput?.inputBox.insertAtCursor("\n"),e.preventDefault()),e.equals(3)?(this.submitSearch(),e.preventDefault()):e.equals(2)?(this.searchInput?.focusOnCaseSensitive(),e.preventDefault()):e.equals(1026)?(this.searchInput?.focus(),e.preventDefault()):e.equals(16)?Gs(e,this.replaceInput?.getValue()??"",this.replaceInput?.domNode.querySelector("textarea")??null):e.equals(18)&&zs(e,this.replaceInput?.getValue()??"",this.replaceInput?.domNode.querySelector("textarea")??null)}onReplaceActionbarKeyDown(e){e.equals(1026)&&(this.focusRegexAction(),e.preventDefault())}submitSearch(e=!1,t=0){var i=this;return(0,S.Z)(function*(){if(i.searchInput?.validate(),!i.searchInput?.inputBox.isInputValid())return;const s=i.searchInput.getValue();s&&i.searchConfiguration.globalFindClipboard&&(yield i.clipboardServce.writeFindText(s)),i._onSearchSubmit.fire({triggeredOnType:e,delay:t})})()}getContextLines(){return this.showContextToggle.checked?+this.contextLinesInput.value:0}modifyContextLines(e){const i=+this.contextLinesInput.value+(e?1:-1);this.showContextToggle.checked=0!==i,this.contextLinesInput.value=""+i}toggleContextLines(){this.showContextToggle.checked=!this.showContextToggle.checked,this.onContextLinesChanged()}dispose(){this.setReplaceAllActionState(!1),super.dispose()}get searchConfiguration(){return this.configurationService.getValue("search")}};Qe.INPUT_MAX_HEIGHT=134,Qe.REPLACE_ALL_DISABLED_LABEL=l.NC("search.action.replaceAll.disabled.label","Replace All (Submit Search to Enable)"),Qe.REPLACE_ALL_ENABLED_LABEL=o=>{const e=o.lookupKeybinding(Qt.ID);return De(l.NC("search.action.replaceAll.enabled.label","Replace All"),e)},Qe=(0,g.gn)([(0,g.fM)(2,je.u),(0,g.fM)(3,w.i6),(0,g.fM)(4,at.d),(0,g.fM)(5,Kt.p),(0,g.fM)(6,H.Ui),(0,g.fM)(7,hi.F),(0,g.fM)(8,je.i),(0,g.fM)(9,V.TG),(0,g.fM)(10,F.AR)],Qe),(0,Tt.Z)(".search-editor{display:flex;flex-direction:column}.search-editor .search-results{flex:1}.search-editor .query-container{margin:0 12px 12px 19px;padding-top:6px}.search-editor .search-widget .toggle-replace-button{align-items:center;background-position:50%;background-repeat:no-repeat;box-sizing:border-box;cursor:pointer;display:flex;height:100%;justify-content:center;left:0;position:absolute;top:0;width:16px}.search-editor .search-widget .replace-container,.search-editor .search-widget .search-container{align-items:center;display:flex}.search-editor .search-widget .monaco-findInput{display:inline-block;vertical-align:middle;width:100%}.search-editor .search-widget .monaco-inputbox>.ibwrapper{height:100%}.search-editor .search-widget .monaco-inputbox>.ibwrapper>.mirror,.search-editor .search-widget .monaco-inputbox>.ibwrapper>textarea.input{padding:3px 3px 3px 6px}.search-editor .search-widget .monaco-inputbox>.ibwrapper>.mirror{max-height:134px}.search-editor .search-widget .monaco-inputbox>.ibwrapper>textarea.input{height:26px;overflow:initial}.search-editor .monaco-inputbox>.ibwrapper>textarea.input{scrollbar-width:none}.search-editor .monaco-inputbox>.ibwrapper>textarea.input::-webkit-scrollbar{display:none}.search-editor .search-widget .context-lines-input{margin-left:5px;margin-right:2px;max-width:50px}.search-editor .search-widget .context-lines-input input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none!important}.search-editor .search-widget .replace-container{display:inline-flex;margin-top:6px;position:relative}.search-editor .search-widget .replace-input{display:flex;height:25px;position:relative;vertical-align:middle;width:auto!important}.search-editor .search-widget .replace-input>.controls{position:absolute;right:2px;top:3px}.search-editor .search-widget .replace-container.disabled{display:none}.search-editor .search-widget .replace-container .monaco-action-bar{height:25px;margin-left:0}.search-editor .search-widget .replace-container .monaco-action-bar .action-item .codicon{align-items:center;background-repeat:no-repeat;display:flex;height:25px;justify-content:center;margin-right:0;width:25px}.search-editor .includes-excludes{min-height:1em;position:relative}.search-editor .includes-excludes .expand{cursor:pointer;height:16px;position:absolute;right:-2px;width:25px;z-index:2}.search-editor .includes-excludes .file-types{display:none}.search-editor .includes-excludes.expanded .file-types{display:inherit}.search-editor .includes-excludes.expanded .file-types:last-child{padding-bottom:10px}.search-editor .includes-excludes.expanded h4{font-size:11px;font-weight:400;margin:0;overflow:hidden;padding:4px 0 0;text-overflow:ellipsis;white-space:nowrap}.search-editor .messages{cursor:default;margin-top:-5px}.search-editor .message{padding-left:7px;padding-right:22px;padding-top:0}.search-editor a.prominent{text-decoration:underline}.monaco-editor .searchEditorFindMatch{background-color:var(--vscode-searchEditor-findMatchBackground);border:1px solid var(--vscode-searchEditor-findMatchBorder);box-sizing:border-box}.monaco-editor.hc-black .searchEditorFindMatch,.monaco-editor.hc-light .searchEditorFindMatch{border:1px dotted var(--vscode-searchEditor-findMatchBorder)}",{});const Ri=o=>e=>new ve.e(e.startLineNumber+o,e.startColumn,e.endLineNumber+o,e.endColumn),ko=(o,e)=>{const i=o.fullPreviewLines(),s=[];return i.forEach((r,n)=>{const a=(r=>`${o.range().startLineNumber+r}`)(n),h=`  ${" ".repeat(e-a.length)}${a}: `,u=h.length,d=h+(r.split(/\r?\n?$/,1)[0]||""),C=o.rangeInPreview();let x;x=(({start:I,end:R})=>new ve.e(1,(I??1)+u,1,(R??r.length+1)+u))(C.startLineNumber===C.endLineNumber?{start:C.startColumn,end:C.endColumn}:0===n?{start:C.startColumn}:n===i.length-1?{end:C.endColumn}:{}),s.push({lineNumber:a,line:d,ranges:[x]})}),s};function Ys(o,e,t,i,s=!0){const r=e[e.length-1].range().endLineNumber.toString().length,n=s?[`${i(o)}:`]:[],a=[],c={},h=[];let u;t.forEach((m,C)=>h.push({line:m,lineNumber:C})),h.sort((m,C)=>m.lineNumber-C.lineNumber);const d=new Set;for(e.forEach(m=>{ko(m,r).forEach(C=>{if(!d.has(C.lineNumber)){for(;h.length&&h[0].lineNumber<+C.lineNumber;){const{line:b,lineNumber:x}=h.shift();void 0!==u&&x!==u+1&&n.push(""),n.push(`  ${" ".repeat(r-`${x}`.length)}${x}  ${b}`),u=x}c[C.lineNumber]=n.length,d.add(C.lineNumber),n.push(C.line),u=+C.lineNumber}a.push(...C.ranges.map(Ri(c[C.lineNumber])))})});h.length;){const{line:m,lineNumber:C}=h.shift();n.push(`  ${C}  ${m}`)}return{text:n,matchRanges:a}}const No=o=>{const e={query:"",filesToInclude:"",filesToExclude:"",isRegexp:!1,isCaseSensitive:!1,useExcludeSettingsAndIgnoreFiles:!0,matchWholeWord:!1,contextLines:0,showIncludesExcludes:!1,onlyOpenEditors:!1,notebookSearchConfig:{includeMarkupInput:!0,includeMarkupPreview:!1,includeCodeInput:!0,includeOutput:!0}},t=s=>{let r="";for(let n=0;n<s.length;n++)if("\\"===s[n]){n++;const a=s[n];if("n"===a)r+="\n";else{if("\\"!==a)throw Error((0,l.NC)("invalidQueryStringError","All backslashes in Query string must be escaped (\\\\)"));r+="\\"}}else r+=s[n];return r},i=/^# ([^:]*): (.*)$/;for(const s of o){const r=i.exec(s);if(!r)continue;const[,n,a]=r;switch(n){case"Query":e.query=t(a);break;case"Including":e.filesToInclude=a;break;case"Excluding":e.filesToExclude=a;break;case"ContextLines":e.contextLines=+a;break;case"Flags":e.isRegexp=-1!==a.indexOf("RegExp"),e.isCaseSensitive=-1!==a.indexOf("CaseSensitive"),e.useExcludeSettingsAndIgnoreFiles=-1===a.indexOf("IgnoreExcludeSettings"),e.matchWholeWord=-1!==a.indexOf("WordMatch"),e.onlyOpenEditors=-1!==a.indexOf("OpenEditors")}}return e.showIncludesExcludes=!(!e.filesToInclude&&!e.filesToExclude&&e.useExcludeSettingsAndIgnoreFiles),e},Js=(o,e,t,i,s,r,n)=>{if(!o.query)throw Error("Internal Error: Expected query, got null");const a=((o,e,t,i)=>({query:o.contentPattern.pattern,isRegexp:!!o.contentPattern.isRegExp,isCaseSensitive:!!o.contentPattern.isCaseSensitive,matchWholeWord:!!o.contentPattern.isWordMatch,filesToExclude:t,filesToInclude:e,showIncludesExcludes:!!(e||t||o?.userDisabledExcludesAndIgnoreFiles),useExcludeSettingsAndIgnoreFiles:void 0===o?.userDisabledExcludesAndIgnoreFiles||!o.userDisabledExcludesAndIgnoreFiles,contextLines:i,onlyOpenEditors:!!o.onlyOpenEditors,notebookSearchConfig:{includeMarkupInput:!!o.contentPattern.notebookInfo?.isInNotebookMarkdownInput,includeMarkupPreview:!!o.contentPattern.notebookInfo?.isInNotebookMarkdownPreview,includeCodeInput:!!o.contentPattern.notebookInfo?.isInNotebookCellInput,includeOutput:!!o.contentPattern.notebookInfo?.isInNotebookCellOutput}}))(o.query,e,t,i),c=o.fileCount()>1?(0,l.NC)("numFiles","{0} files",o.fileCount()):(0,l.NC)("oneFile","1 file"),h=o.count()>1?(0,l.NC)("numResults","{0} results",o.count()):(0,l.NC)("oneResult","1 result"),u=[o.count()?`${h} - ${c}`:(0,l.NC)("noResults","No Results")];n&&u.push((0,l.NC)("searchMaxResultsWarning","The result set only contains a subset of all matches. Be more specific in your search to narrow down the results.")),u.push("");const d=(C,b)=>(0,y.ct)(C,b,r),m=Lo((0,ie.xH)(o.folderMatches().sort(d).map(C=>C.allDownstreamFileMatches().sort(d).flatMap(b=>function Mo(o,e){const t=o.textMatches().length>0?Ys(o.resource,o.textMatches().sort(y.ct),o.context,e):void 0,i=o.cellMatches().sort((s,r)=>s.cellIndex-r.cellIndex).sort().filter(s=>s.contentMatches.length>0).map((s,r)=>function Po(o,e,t){return Ys(o.cell.uri,o.contentMatches.sort(y.ct),o.context,e,t)}(s,e,0===r));return[t,...i].filter(s=>!!s)}(b,s)))));return{matchRanges:m.matchRanges.map(Ri(u.length)),text:u.concat(m.text).join("\n"),config:a}},Lo=o=>{const e=[],t=[];return o.forEach(i=>{i.matchRanges.map(Ri(e.length)).forEach(s=>t.push(s)),i.text.forEach(s=>e.push(s)),e.push("")}),{text:e,matchRanges:t}},_s=function(){var o=(0,S.Z)(function*(e,t){const s=(yield e.get(Mt.MM).read(t)).value;return er(s)});return function(t,i){return o.apply(this,arguments)}}(),er=o=>{const e=[],t=[];let i=!0;for(const s of o.split(/\r?\n/g))i?(e.push(s),""===s&&(i=!1)):t.push(s);return{config:No(e),text:t.join("\n")}};var Fi=p(51957);class Ut{constructor(e){this.config=e,this._onConfigDidUpdate=new O.Q5,this.onConfigDidUpdate=this._onConfigDidUpdate.event}updateConfig(e){this.config=e,this._onConfigDidUpdate.fire(e)}}class Wo{constructor(e){this.resource=e}resolve(){var e=this;return(0,S.Z)(function*(){return(0,Q.cW)(mt.models.get(e.resource)).resolve()})()}}const mt=new class Oo{constructor(){this.models=new Ee.Y9}initializeModelFromExistingModel(e,t,i){var s=this;if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const r=e.get(it.O),n=e.get(me.q),a=e.get(V.TG),c=e.get(Fi.n);let h;this.models.set(t,{resolve:()=>(h||(h=(0,S.Z)(function*(){return(yield s.tryFetchModelFromBackupService(t,r,n,c,a))||Promise.resolve({resultsModel:n.getModel(t)??n.createModel("",r.createById("search-result"),t),configurationModel:new Ut(i)})})()),h)})}initializeModelFromRawData(e,t,i,s){var r=this;if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const n=e.get(it.O),a=e.get(me.q),c=e.get(V.TG),h=e.get(Fi.n);let u;this.models.set(t,{resolve:()=>(u||(u=(0,S.Z)(function*(){return(yield r.tryFetchModelFromBackupService(t,n,a,h,c))||Promise.resolve({resultsModel:a.createModel(s??"",n.createById("search-result"),t),configurationModel:new Ut(i)})})()),u)})}initializeModelFromExistingFile(e,t,i){var s=this;if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const r=e.get(it.O),n=e.get(me.q),a=e.get(V.TG),c=e.get(Fi.n);let h;var u;this.models.set(t,{resolve:(u=(0,S.Z)(function*(){return h||(h=(0,S.Z)(function*(){const d=yield s.tryFetchModelFromBackupService(t,r,n,c,a);if(d)return d;const{text:m,config:C}=yield a.invokeFunction(_s,i);return{resultsModel:n.createModel(m??"",r.createById("search-result"),t),configurationModel:new Ut(C)}})()),h}),function(){return u.apply(this,arguments)})})}tryFetchModelFromBackupService(e,t,i,s,r){return(0,S.Z)(function*(){const n=yield s.resolve({resource:e,typeId:Ks});let a=i.getModel(e);if(!a&&n){const c=yield(0,ji.Yb)(n.value);a=i.createModel(c,t.createById("search-result"),e)}if(a){const c=a.getValue(),{text:h,config:u}=er(c);return i.destroyModel(e),{resultsModel:i.createModel(h??"",t.createById("search-result"),e),configurationModel:new Ut(u)}}})()}};var tr=p(71871),Do=p(92765);const vt=".code-search";let L=class bt extends Do.Q{get typeId(){return bt.ID}get editorId(){return this.typeId}get capabilities(){let e=8;return this.backingUri||(e|=4),e}get resource(){return this.backingUri||this.modelUri}constructor(e,t,i,s,r,n,a,c,h,u){if(super(),this.modelUri=e,this.backingUri=t,this.modelService=i,this.textFileService=s,this.fileDialogService=r,this.instantiationService=n,this.workingCopyService=a,this.telemetryService=c,this.pathService=h,this.dirty=!1,this._onDidChangeContent=this._register(new O.Q5),this.onDidChangeContent=this._onDidChangeContent.event,this._onDidSave=this._register(new O.Q5),this.onDidSave=this._onDidSave.event,this.oldDecorationsIDs=[],this.model=n.createInstance(Wo,e),this.modelUri.scheme!==wi)throw Error("SearchEditorInput must be invoked with a SearchEditorScheme uri");this.memento=new di.N(bt.ID,u),u.onWillSaveState(()=>this.memento.saveMemento());const d=this,m=new class{constructor(){this.typeId=Ks,this.resource=d.modelUri,this.capabilities=d.hasCapability(4)?2:0,this.onDidChangeDirty=d.onDidChangeDirty,this.onDidChangeContent=d.onDidChangeContent,this.onDidSave=d.onDidSave}get name(){return d.getName()}isDirty(){return d.isDirty()}isModified(){return d.isDirty()}backup(C){return d.backup(C)}save(C){return d.save(0,C).then(b=>!!b)}revert(C){return d.revert(0,C)}};this._register(this.workingCopyService.registerWorkingCopy(m))}save(e,t){var i=this;return(0,S.Z)(function*(){if(!(yield i.resolveModels()).resultsModel.isDisposed())return i.backingUri?(yield i.textFileService.write(i.backingUri,yield i.serializeForDisk(),t),i.setDirty(!1),i._onDidSave.fire({reason:t?.reason,source:t?.source}),i):i.saveAs(e,t)})()}tryReadConfigSync(){return this._cachedConfigurationModel?.config}serializeForDisk(){var e=this;return(0,S.Z)(function*(){const{configurationModel:t,resultsModel:i}=yield e.resolveModels();return(o=>{return(i=>i.filter(s=>!1!==s&&null!=s))([`# Query: ${i=o.query??"",i.replace(/\\/g,"\\\\").replace(/\n/g,"\\n")}`,(o.isCaseSensitive||o.matchWholeWord||o.isRegexp||!1===o.useExcludeSettingsAndIgnoreFiles)&&`# Flags: ${(0,ie.kX)([o.isCaseSensitive&&"CaseSensitive",o.matchWholeWord&&"WordMatch",o.isRegexp&&"RegExp",o.onlyOpenEditors&&"OpenEditors",!1===o.useExcludeSettingsAndIgnoreFiles&&"IgnoreExcludeSettings"]).join(" ")}`,o.filesToInclude?`# Including: ${o.filesToInclude}`:void 0,o.filesToExclude?`# Excluding: ${o.filesToExclude}`:void 0,o.contextLines?`# ContextLines: ${o.contextLines}`:void 0,""]).join("\n");var i})(t.config)+"\n"+i.getValue()})()}registerConfigChangeListeners(e){this.configChangeListenerDisposable?.dispose(),this.isDisposed()||(this.configChangeListenerDisposable=e.onConfigDidUpdate(()=>{this.lastLabel!==this.getName()&&(this._onDidChangeLabel.fire(),this.lastLabel=this.getName()),this.memento.getMemento(1,1).searchConfig=e.config}),this._register(this.configChangeListenerDisposable))}resolveModels(){var e=this;return(0,S.Z)(function*(){return e.model.resolve().then(t=>(e._cachedResultsModel=t.resultsModel,e._cachedConfigurationModel=t.configurationModel,e.lastLabel!==e.getName()&&(e._onDidChangeLabel.fire(),e.lastLabel=e.getName()),e.registerConfigChangeListeners(t.configurationModel),t))})()}saveAs(e,t){var i=this;return(0,S.Z)(function*(){const s=yield i.fileDialogService.pickFileToSave(yield i.suggestFileName(),t?.availableFileSystems);if(s){i.telemetryService.publicLog2("searchEditor/saveSearchResults");const r=yield i.serializeForDisk();if(yield i.textFileService.create([{resource:s,value:r,options:{overwrite:!0}}])){if(i.setDirty(!1),!(0,Y.Xy)(s,i.modelUri)){const n=i.instantiationService.invokeFunction(Ue,{fileUri:s,from:"existingFile"});return n.setMatchRanges(i.getMatchRanges()),n}return i}}})()}getName(e=12){if(this.backingUri){const s=he.zK.getOriginalUri(this);return(0,l.NC)("searchTitle.withQuery","Search: {0}",(0,ks.EZ)((s??this.backingUri).path,vt))}const i=this._cachedConfigurationModel?.config?.query?.trim();return i?(0,l.NC)("searchTitle.withQuery","Search: {0}",(s=i).length<e?s:`${s.slice(0,e-3)}...`):(0,l.NC)("searchTitle","Search");var s}setDirty(e){const t=this.dirty;this.dirty=e,t!==e&&this._onDidChangeDirty.fire()}isDirty(){return this.dirty}rename(e,t){var i=this;return(0,S.Z)(function*(){if((0,Y.DZ)(t)===vt)return{editor:i.instantiationService.invokeFunction(Ue,{from:"existingFile",fileUri:t})}})()}dispose(){this.modelService.destroyModel(this.modelUri),super.dispose()}matches(e){return!!super.matches(e)||e instanceof bt&&(!(!e.modelUri.fragment||e.modelUri.fragment!==this.modelUri.fragment)||!(!e.backingUri||!(0,Y.Xy)(e.backingUri,this.backingUri)))}getMatchRanges(){return(this._cachedResultsModel?.getAllDecorations()??[]).filter(e=>e.options.className===Qs).filter(({range:e})=>!(1===e.startColumn&&1===e.endColumn)).map(({range:e})=>e)}setMatchRanges(e){var t=this;return(0,S.Z)(function*(){t.oldDecorationsIDs=(yield t.resolveModels()).resultsModel.deltaDecorations(t.oldDecorationsIDs,e.map(i=>({range:i,options:{description:"search-editor-find-match",className:Qs,stickiness:1}})))})()}revert(e,t){var i=()=>super.revert,s=this;return(0,S.Z)(function*(){if(t?.soft)s.setDirty(!1);else{if(s.backingUri){const{config:r,text:n}=yield s.instantiationService.invokeFunction(_s,s.backingUri),{resultsModel:a,configurationModel:c}=yield s.resolveModels();a.setValue(n),c.updateConfig(r)}else(yield s.resolveModels()).resultsModel.setValue("");i().call(s,e,t),s.setDirty(!1)}})()}backup(e){var t=this;return(0,S.Z)(function*(){const i=yield t.serializeForDisk();return e.isCancellationRequested?{}:{content:(0,tr.Xu)(tr.KN.fromString(i))}})()}suggestFileName(){var e=this;return(0,S.Z)(function*(){const i=((yield e.resolveModels()).configurationModel.config.query.replace(/[^\w \-_]+/g,"_")||"Search")+vt;return(0,Y.Vo)(yield e.fileDialogService.defaultFilePath(e.pathService.defaultUriScheme),i)})()}toUntyped(){if(!this.hasCapability(4))return{resource:this.resource,options:{override:bt.ID}}}};L.ID=bi,L=(0,g.gn)([(0,g.fM)(2,me.q),(0,g.fM)(3,Mt.MM),(0,g.fM)(4,Wt.Z$),(0,g.fM)(5,V.TG),(0,g.fM)(6,ss.C),(0,g.fM)(7,Ie.bU),(0,g.fM)(8,is.a),(0,g.fM)(9,Xe.Uy)],L);const Ue=(o,e)=>{const t=o.get(Xe.Uy),i=o.get(H.Ui),s=o.get(V.TG),r="model"===e.from?e.modelUri:Le.ov.from({scheme:wi,fragment:`${Math.random()}`});if(!mt.models.has(r))if("existingFile"===e.from)s.invokeFunction(n=>mt.initializeModelFromExistingFile(n,r,e.fileUri));else{const n=i.getValue("search").searchEditor,c=n.defaultNumberOfContextLines,d={query:"",filesToInclude:"",filesToExclude:"",isRegexp:!1,isCaseSensitive:!1,useExcludeSettingsAndIgnoreFiles:!0,matchWholeWord:!1,contextLines:0,showIncludesExcludes:!1,onlyOpenEditors:!1,notebookSearchConfig:{includeMarkupInput:!0,includeMarkupPreview:!1,includeCodeInput:!0,includeOutput:!0},...n.reusePriorSearchConfiguration?new di.N(L.ID,t).getMemento(1,1).searchConfig:{},...e.config};null!=c&&(d.contextLines=e?.config?.contextLines??c),"rawData"===e.from?(e.resultsContents&&(d.contextLines=0),s.invokeFunction(m=>mt.initializeModelFromRawData(m,r,d,e.resultsContents))):s.invokeFunction(m=>mt.initializeModelFromExistingModel(m,r,d))}return s.createInstance(L,r,"existingFile"===e.from?e.fileUri:"model"===e.from?e.backupOf:void 0)};var ir=p(49470);const sr=(o,e)=>{const t=o.get(F.AR);t.activeEditor instanceof L&&t.activeEditorPane.modifyContextLines(e)};function ki(){return ki=(0,S.Z)(function*(o){const e=o.get(k.qC),t=o.get(V.TG),i=T(e);i?yield t.invokeFunction(St,{filesToInclude:i.searchIncludePattern.getValue(),onlyOpenEditors:i.searchIncludePattern.onlySearchInOpenEditors(),filesToExclude:i.searchExcludePattern.getValue(),isRegexp:i.searchAndReplaceWidget.searchInput?.getRegex(),isCaseSensitive:i.searchAndReplaceWidget.searchInput?.getCaseSensitive(),matchWholeWord:i.searchAndReplaceWidget.searchInput?.getWholeWords(),useExcludeSettingsAndIgnoreFiles:i.searchExcludePattern.useExcludesAndIgnoreFiles(),showIncludesExcludes:!(!i.searchIncludePattern.getValue()&&!i.searchExcludePattern.getValue()&&i.searchExcludePattern.useExcludesAndIgnoreFiles())}):yield t.invokeFunction(St)}),ki.apply(this,arguments)}const St=function(){var o=(0,S.Z)(function*(e,t={},i=!1){const s=e.get(F.AR),r=e.get(_t.Qw),n=e.get(Ie.bU),a=e.get(V.TG),c=e.get(H.Ui),h=e.get(ir.qb),u=e.get(Ce.ec),m=e.get(ei.C).getLastActiveWorkspaceRoot(B.lg.file),C=m?(0,Q.f6)(u.getWorkspaceFolder(m)):void 0,b=s.activeTextEditorControl;let x,I="";if(b){x=(0,Fe.QI)(b)?b.getOriginalEditor().hasTextFocus()?b.getOriginalEditor():b.getModifiedEditor():b;const W=x?.getSelection();if(I=(W&&x?.getModel()?.getValueInRange(W))??"",W?.isEmpty()&&c.getValue("search").seedWithNearestWord){const Z=x.getModel()?.getWordAtPosition(W.getStartPosition());Z&&(I=Z.word)}}else s.activeEditor instanceof L&&(I=s.activeEditorPane.getSelected());n.publicLog2("searchEditor/openNewSearchEditor");const E={query:"new"===t.location||c.getValue("editor").find.seedSearchStringFromSelection?I:void 0};for(const W of Object.entries(t)){const pe=W[1];void 0!==pe&&(E[W[0]]="string"==typeof pe?yield h.resolveAsync(C,pe):pe)}const D=s.getEditors(0).find(W=>W.editor.typeId===L.ID);let ee;if(D&&"reuse"===E.location){const W=r.getGroup(D.groupId);if(!W)throw new Error("Invalid group id for search editor");const Z=D.editor;ee=yield W.openEditor(Z),I?ee.setQuery(I):ee.selectQuery(),ee.setSearchConfig(E)}else{const W=a.invokeFunction(Ue,{config:E,resultsContents:"",from:"rawData"});ee=yield s.openEditor(W,{pinned:!0},i?F.O3:F.LP)}const be=c.getValue("search").searchOnType;(!0===E.triggerSearch||!1!==E.triggerSearch&&be&&E.query)&&ee.triggerSearch({focusResults:E.focusResults}),E.focusResults||ee.focusSearchInput()});return function(t){return o.apply(this,arguments)}}(),rr=function(){var o=(0,S.Z)(function*(e,t,i,s,r){if(!t.query)return void console.error("Expected searchResult.query to be defined. Got",t);const n=e.get(F.AR),a=e.get(Ie.bU),c=e.get(V.TG),h=e.get(Se.e),u=e.get(H.Ui),d=u.getValue("search").sortOrder;a.publicLog2("searchEditor/createEditorFromSearchResult");const{text:C,matchRanges:b,config:x}=Js(t,i,s,0,R=>h.getUriLabel(R,{relative:!0}),d);x.onlyOpenEditors=r;const I=u.getValue("search").searchEditor.defaultNumberOfContextLines;if(t.isDirty||0===I||null===I){const R=c.invokeFunction(Ue,{resultsContents:C,config:x,from:"rawData"});yield n.openEditor(R,{pinned:!0}),R.setMatchRanges(b)}else{const R=c.invokeFunction(Ue,{from:"rawData",resultsContents:"",config:{...x,contextLines:I}});(yield n.openEditor(R,{pinned:!0})).triggerSearch({focusResults:!0})}});return function(t,i,s,r,n){return o.apply(this,arguments)}}();var Zo=p(17360),qo=p(43689);const _=v.$,nr=l.NC("searchCanceled","Search was canceled before any results could be found - ");let Zt=class br extends vn.qV{constructor(e,t,i,s,r,n,a,c,h,u,d,m,C,b,x,I,R,E,D,ee,be,W,Z,pe,xt,vr,Za,qa){super(e,Z,be,m,x,d,u,xt,D,vr),this.fileService=t,this.editorService=i,this.codeEditorService=s,this.progressService=r,this.notificationService=n,this.dialogService=a,this.commandService=c,this.contextViewService=h,this.contextService=C,this.searchWorkbenchService=b,this.replaceService=I,this.textFileService=R,this.preferencesService=E,this.searchHistoryService=ee,this.accessibilityService=W,this.notebookService=Za,this.logService=qa,this.isDisposed=!1,this.lastFocusState="input",this.messageDisposables=new P.SL,this.changedWhileHidden=!1,this.currentSearchQ=Promise.resolve(),this.pauseSearching=!1,this._visibleMatches=0,this.container=v.$(".search-view"),this.viewletVisible=j.bindTo(this.contextKeyService),this.firstMatchFocused=Ws.bindTo(this.contextKeyService),this.fileMatchOrMatchFocused=Ve.bindTo(this.contextKeyService),this.fileMatchOrFolderMatchFocus=Os.bindTo(this.contextKeyService),this.fileMatchOrFolderMatchWithResourceFocus=Si.bindTo(this.contextKeyService),this.fileMatchFocused=Me.bindTo(this.contextKeyService),this.folderMatchFocused=He.bindTo(this.contextKeyService),this.folderMatchWithResourceFocused=Vt.bindTo(this.contextKeyService),this.hasSearchResultsKey=re.bindTo(this.contextKeyService),this.matchFocused=Ke.bindTo(this.contextKeyService),this.searchStateKey=q.Y0.bindTo(this.contextKeyService),this.hasSearchPatternKey=yi.bindTo(this.contextKeyService),this.hasReplacePatternKey=Ds.bindTo(this.contextKeyService),this.hasFilePatternKey=Bs.bindTo(this.contextKeyService),this.hasSomeCollapsibleResultKey=ht.bindTo(this.contextKeyService),this.treeViewKey=ut.bindTo(this.contextKeyService),this.contextKeyService=this._register(this.contextKeyService.createScoped(this.container)),xe.bindTo(this.contextKeyService).set(!0),this.inputBoxFocused=Je.bindTo(this.contextKeyService),this.inputPatternIncludesFocused=ao.bindTo(this.contextKeyService),this.inputPatternExclusionsFocused=co.bindTo(this.contextKeyService),this.isEditableItem=J.bindTo(this.contextKeyService),this.instantiationService=this.instantiationService.createChild(new ot.y([w.i6,this.contextKeyService])),this.configurationService.onDidChangeConfiguration(qe=>{qe.affectsConfiguration("search.sortOrder")&&("modified"===this.searchConfig.sortOrder&&this.removeFileStats(),this.refreshTree())}),this.viewModel=this._register(this.searchWorkbenchService.searchModel),this.queryBuilder=this.instantiationService.createInstance(Nt.z),this.memento=new di.N(this.id,pe),this.viewletState=this.memento.getMemento(1,1),this._register(this.fileService.onDidFilesChange(qe=>this.onFilesChanged(qe))),this._register(this.textFileService.untitled.onWillDispose(qe=>this.onUntitledDidDispose(qe.resource))),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onDidChangeWorkbenchState())),this._register(this.searchHistoryService.onDidClearHistory(()=>this.clearHistory())),this._register(this.configurationService.onDidChangeConfiguration(qe=>this.onConfigurationUpdated(qe))),this.delayedRefresh=this._register(new X.vp(250)),this.addToSearchHistoryDelayer=this._register(new X.vp(2e3)),this.toggleCollapseStateDelayer=this._register(new X.vp(100)),this.triggerQueryDelayer=this._register(new X.vp(0)),this.treeAccessibilityProvider=this.instantiationService.createInstance(Ci,this.viewModel),this.isTreeLayoutViewVisible=this.viewletState["view.treeLayout"]??"tree"===this.searchConfig.defaultViewMode,this._refreshResultsScheduler=this._register(new X.pY(this._updateResults.bind(this),80))}get isTreeLayoutViewVisible(){return this.treeViewKey.get()??!1}set isTreeLayoutViewVisible(e){this.treeViewKey.set(e)}setTreeView(e){e!==this.isTreeLayoutViewVisible&&(this.isTreeLayoutViewVisible=e,this.updateIndentStyles(this.themeService.getFileIconTheme()),this.refreshTree())}get state(){return this.searchStateKey.get()??q.Ps.Idle}set state(e){this.searchStateKey.set(e)}getContainer(){return this.container}get searchResult(){return this.viewModel&&this.viewModel.searchResult}onDidChangeWorkbenchState(){1!==this.contextService.getWorkbenchState()&&this.searchWithoutFolderMessageElement&&v.Cp(this.searchWithoutFolderMessageElement)}renderBody(e){super.renderBody(e),this.container=v.R3(e,v.$(".search-view")),this.searchWidgetsContainerElement=v.R3(this.container,_(".search-widgets-container")),this.createSearchWidget(this.searchWidgetsContainerElement);const t=this.searchHistoryService.load(),i=this.viewletState["query.filePatterns"]||"",s=this.viewletState["query.folderExclusions"]||"",r=t.exclude||[],n=this.viewletState["query.folderIncludes"]||"",a=t.include||[],c=this.viewletState["query.onlyOpenEditors"]||!1,h=this.viewletState["query.queryDetailsExpanded"]||"",u="boolean"!=typeof this.viewletState["query.useExcludesAndIgnoreFiles"]||this.viewletState["query.useExcludesAndIgnoreFiles"];this.queryDetails=v.R3(this.searchWidgetsContainerElement,_(".query-details")),this.toggleQueryDetailsButton=v.R3(this.queryDetails,_(".more"+G.kS.asCSSSelector(vs),{tabindex:0,role:"button",title:l.NC("moreSearch","Toggle Search Details")})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.CLICK,R=>{v.zB.stop(R),this.toggleQueryDetails(!this.accessibilityService.isScreenReaderOptimized())})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.KEY_UP,R=>{const E=new nt.y1(R);(E.equals(3)||E.equals(10))&&(v.zB.stop(R),this.toggleQueryDetails(!1))})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.KEY_DOWN,R=>{new nt.y1(R).equals(1026)&&(this.searchWidget.isReplaceActive()?this.searchWidget.focusReplaceAllAction():this.searchWidget.isReplaceShown()?this.searchWidget.replaceInput?.focusOnPreserve():this.searchWidget.focusRegexAction(),v.zB.stop(R))}));const d=v.R3(this.queryDetails,_(".file-types.includes")),m=l.NC("searchScope.includes","files to include");v.R3(d,_("h4",void 0,m)),this.inputPatternIncludes=this._register(this.instantiationService.createInstance(Dt,d,this.contextViewService,{ariaLabel:m,placeholder:l.NC("placeholder.includes","e.g. *.ts, src/**/include"),showPlaceholderOnFocus:!0,history:a,inputBoxStyles:ce.Hc})),this.inputPatternIncludes.setValue(n),this.inputPatternIncludes.setOnlySearchInOpenEditors(c),this._register(this.inputPatternIncludes.onCancel(()=>this.cancelSearch(!1))),this._register(this.inputPatternIncludes.onChangeSearchInEditorsBox(()=>this.triggerQueryChange())),this.trackInputBox(this.inputPatternIncludes.inputFocusTracker,this.inputPatternIncludesFocused);const C=v.R3(this.queryDetails,_(".file-types.excludes")),b=l.NC("searchScope.excludes","files to exclude");v.R3(C,_("h4",void 0,b)),this.inputPatternExcludes=this._register(this.instantiationService.createInstance(Bt,C,this.contextViewService,{ariaLabel:b,placeholder:l.NC("placeholder.excludes","e.g. *.ts, src/**/exclude"),showPlaceholderOnFocus:!0,history:r,inputBoxStyles:ce.Hc})),this.inputPatternExcludes.setValue(s),this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(u),this._register(this.inputPatternExcludes.onCancel(()=>this.cancelSearch(!1))),this._register(this.inputPatternExcludes.onChangeIgnoreBox(()=>this.triggerQueryChange())),this.trackInputBox(this.inputPatternExcludes.inputFocusTracker,this.inputPatternExclusionsFocused);const x=()=>this.hasFilePatternKey.set(this.inputPatternIncludes.getValue().length>0||this.inputPatternExcludes.getValue().length>0);x();const I=R=>{this.triggerQueryChange({triggeredOnType:R,delay:this.searchConfig.searchOnTypeDebouncePeriod}),R&&x()};this._register(this.inputPatternIncludes.onSubmit(I)),this._register(this.inputPatternExcludes.onSubmit(I)),this.messagesElement=v.R3(this.container,_(".messages.text-search-provider-messages")),1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),this.createSearchResultsView(this.container),(""!==i||""!==s||""!==n||""!==h||!u)&&this.toggleQueryDetails(!0,!0,!0),this._register(this.viewModel.searchResult.onChange(R=>this.onSearchResultsChanged(R))),this._register(this.onDidChangeBodyVisibility(R=>this.onVisibilityChanged(R))),this.updateIndentStyles(this.themeService.getFileIconTheme()),this._register(this.themeService.onDidFileIconThemeChange(this.updateIndentStyles,this))}updateIndentStyles(e){this.resultsElement.classList.toggle("hide-arrows",this.isTreeLayoutViewVisible&&e.hidesExplorerArrows)}onVisibilityChanged(e){this.viewletVisible.set(e),e?this.changedWhileHidden&&(this.refreshAndUpdateCount(),this.changedWhileHidden=!1):this.lastFocusState="input",this.viewModel?.searchResult.toggleHighlights(e)}get searchAndReplaceWidget(){return this.searchWidget}get searchIncludePattern(){return this.inputPatternIncludes}get searchExcludePattern(){return this.inputPatternExcludes}createSearchWidget(e){const t=this.viewletState["query.contentPattern"]||"",i=this.viewletState["query.replaceText"]||"",s=!0===this.viewletState["query.regex"],r=!0===this.viewletState["query.wholeWords"],n=!0===this.viewletState["query.caseSensitive"],a=this.searchHistoryService.load(),u="boolean"!=typeof this.viewletState["view.showReplace"]||this.viewletState["view.showReplace"];if(this.searchWidget=this._register(this.instantiationService.createInstance(Qe,e,{value:t,replaceValue:i,isRegex:s,isCaseSensitive:n,isWholeWords:r,searchHistory:a.search||this.viewletState["query.searchHistory"]||[],replaceHistory:a.replace||this.viewletState["query.replaceHistory"]||[],preserveCase:!0===this.viewletState["query.preserveCase"],inputBoxStyles:ce.Hc,toggleStyles:ce.pl,notebookOptions:{isInNotebookMarkdownInput:this.viewletState["query.isInNotebookMarkdownInput"]??!0,isInNotebookMarkdownPreview:this.viewletState["query.isInNotebookMarkdownPreview"]??!0,isInNotebookCellInput:this.viewletState["query.isInNotebookCellInput"]??!0,isInNotebookCellOutput:this.viewletState["query.isInNotebookCellOutput"]??!0}})),!this.searchWidget.searchInput||!this.searchWidget.replaceInput)return void this.logService.warn(`Cannot fully create search widget. Search or replace input undefined. SearchInput: ${this.searchWidget.searchInput}, ReplaceInput: ${this.searchWidget.replaceInput}`);u&&this.searchWidget.toggleReplace(!0),this._register(this.searchWidget.onSearchSubmit(E=>this.triggerQueryChange(E))),this._register(this.searchWidget.onSearchCancel(({focus:E})=>this.cancelSearch(E))),this._register(this.searchWidget.searchInput.onDidOptionChange(()=>this.triggerQueryChange())),this._register(this.searchWidget.getNotebookFilters().onDidChange(()=>this.triggerQueryChange()));const I=()=>this.hasSearchPatternKey.set(!!this.searchWidget.searchInput&&this.searchWidget.searchInput.getValue().length>0);I(),this._register(this.searchWidget.searchInput.onDidChange(()=>I()));const R=()=>this.hasReplacePatternKey.set(this.searchWidget.getReplaceValue().length>0);R(),this._register(this.searchWidget.replaceInput.inputBox.onDidChange(()=>R())),this._register(this.searchWidget.onDidHeightChange(()=>this.reLayout())),this._register(this.searchWidget.onReplaceToggled(()=>this.reLayout())),this._register(this.searchWidget.onReplaceStateChange(E=>{this.viewModel.replaceActive=E,this.refreshTree()})),this._register(this.searchWidget.onPreserveCaseChange(E=>{this.viewModel.preserveCase=E,this.refreshTree()})),this._register(this.searchWidget.onReplaceValueChanged(()=>{this.viewModel.replaceString=this.searchWidget.getReplaceValue(),this.delayedRefresh.trigger(()=>this.refreshTree())})),this._register(this.searchWidget.onBlur(()=>{this.toggleQueryDetailsButton.focus()})),this._register(this.searchWidget.onReplaceAll(()=>this.replaceAll())),this.trackInputBox(this.searchWidget.searchInputFocusTracker),this.trackInputBox(this.searchWidget.replaceInputFocusTracker)}onConfigurationUpdated(e){e&&(e.affectsConfiguration("search.decorations.colors")||e.affectsConfiguration("search.decorations.badges"))&&this.refreshTree()}trackInputBox(e,t){e&&(this._register(e.onDidFocus(()=>{this.lastFocusState="input",this.inputBoxFocused.set(!0),t?.set(!0)})),this._register(e.onDidBlur(()=>{this.inputBoxFocused.set(this.searchWidget.searchInputHasFocus()||this.searchWidget.replaceInputHasFocus()||this.inputPatternIncludes.inputHasFocus()||this.inputPatternExcludes.inputHasFocus()),t?.set(!1)})))}onSearchResultsChanged(e){if(this.isVisible())return this.refreshAndUpdateCount(e);this.changedWhileHidden=!0}refreshAndUpdateCount(e){return this.searchWidget.setReplaceAllActionState(!this.viewModel.searchResult.isEmpty()),this.updateSearchResultCount(this.viewModel.searchResult.query.userDisabledExcludesAndIgnoreFiles,this.viewModel.searchResult.query?.onlyOpenEditors,e?.clearingAll),this.refreshTree(e)}refreshTree(e){const t=this.searchConfig.collapseResults;!e||e.added||e.removed?"modified"===this.searchConfig.sortOrder?this.retrieveFileStats().then(()=>this.tree.setChildren(null,this.createResultIterator(t))):this.tree.setChildren(null,this.createResultIterator(t)):"countAscending"===this.searchConfig.sortOrder||"countDescending"===this.searchConfig.sortOrder?this.tree.setChildren(null,this.createResultIterator(t)):e.elements.forEach(i=>{this.tree.setChildren(i,this.createIterator(i,t)),this.tree.rerender(i)})}createResultIterator(e){const t=this.searchResult.folderMatches().filter(i=>!i.isEmpty()).sort(y.ct);return 1===t.length?this.createFolderIterator(t[0],e,!0):ci.$.map(t,i=>({element:i,children:this.createFolderIterator(i,e,!0),incompressible:!0}))}createFolderIterator(e,t,i){const s=this.searchConfig.sortOrder,n=(this.isTreeLayoutViewVisible?e.matches():e.allDownstreamFileMatches()).sort((a,c)=>(0,y.ct)(a,c,s));return ci.$.map(n,a=>{let c;c=a instanceof y.ut?this.createFileIterator(a):this.createFolderIterator(a,t,!1);const h="alwaysCollapse"===t||a.count()>10&&"alwaysExpand"!==t?ws.kn.PreserveOrCollapsed:ws.kn.PreserveOrExpanded;return{element:a,children:c,collapsed:h,incompressible:a instanceof y.ut||i}})}createFileIterator(e){const t=e.matches().sort(y.ct);return ci.$.map(t,i=>({element:i,incompressible:!0}))}createIterator(e,t){return e instanceof y.lt?this.createResultIterator(t):e instanceof y.nA?this.createFolderIterator(e,t,!1):this.createFileIterator(e)}replaceAll(){if(0===this.viewModel.searchResult.count())return;const e=this.viewModel.searchResult.count(),t=this.viewModel.searchResult.fileCount(),i=this.searchWidget.getReplaceValue()||"",s=this.buildAfterReplaceAllMessage(e,t,i);let r,n;this.progressService.withProgress({location:this.getProgressLocation(),delay:100,total:e},c=>(n=c,new Promise(h=>r=h)));const a={title:l.NC("replaceAll.confirmation.title","Replace All"),message:this.buildReplaceAllConfirmationMessage(e,t,i),primaryButton:l.NC({key:"replaceAll.confirm.button",comment:["&& denotes a mnemonic"]},"&&Replace")};this.dialogService.confirm(a).then(c=>{c.confirmed?(this.searchWidget.setReplaceAllActionState(!1),this.viewModel.searchResult.replaceAll(n).then(()=>{r();const h=this.clearMessage();v.R3(h,s),this.reLayout()},h=>{r(),oe.n2(h),this.notificationService.error(h)})):r()})}buildAfterReplaceAllMessage(e,t,i){return 1===e?1===t?i?l.NC("replaceAll.occurrence.file.message","Replaced {0} occurrence across {1} file with '{2}'.",e,t,i):l.NC("removeAll.occurrence.file.message","Replaced {0} occurrence across {1} file.",e,t):i?l.NC("replaceAll.occurrence.files.message","Replaced {0} occurrence across {1} files with '{2}'.",e,t,i):l.NC("removeAll.occurrence.files.message","Replaced {0} occurrence across {1} files.",e,t):1===t?i?l.NC("replaceAll.occurrences.file.message","Replaced {0} occurrences across {1} file with '{2}'.",e,t,i):l.NC("removeAll.occurrences.file.message","Replaced {0} occurrences across {1} file.",e,t):i?l.NC("replaceAll.occurrences.files.message","Replaced {0} occurrences across {1} files with '{2}'.",e,t,i):l.NC("removeAll.occurrences.files.message","Replaced {0} occurrences across {1} files.",e,t)}buildReplaceAllConfirmationMessage(e,t,i){return 1===e?1===t?i?l.NC("removeAll.occurrence.file.confirmation.message","Replace {0} occurrence across {1} file with '{2}'?",e,t,i):l.NC("replaceAll.occurrence.file.confirmation.message","Replace {0} occurrence across {1} file?",e,t):i?l.NC("removeAll.occurrence.files.confirmation.message","Replace {0} occurrence across {1} files with '{2}'?",e,t,i):l.NC("replaceAll.occurrence.files.confirmation.message","Replace {0} occurrence across {1} files?",e,t):1===t?i?l.NC("removeAll.occurrences.file.confirmation.message","Replace {0} occurrences across {1} file with '{2}'?",e,t,i):l.NC("replaceAll.occurrences.file.confirmation.message","Replace {0} occurrences across {1} file?",e,t):i?l.NC("removeAll.occurrences.files.confirmation.message","Replace {0} occurrences across {1} files with '{2}'?",e,t,i):l.NC("replaceAll.occurrences.files.confirmation.message","Replace {0} occurrences across {1} files?",e,t)}clearMessage(){this.searchWithoutFolderMessageElement=void 0;const e="none"===this.messagesElement.style.display;v.PO(this.messagesElement),v.$Z(this.messagesElement),this.messageDisposables.clear();const t=v.R3(this.messagesElement,_(".message"));return e&&this.reLayout(),t}createSearchResultsView(e){this.resultsElement=v.R3(e,_(".results.show-file-icons.file-icon-themable-tree"));const t=this.instantiationService.createInstance(Vs);this.treeLabels=this._register(this.instantiationService.createInstance(mn.RX,{onDidChangeVisibility:this.onDidChangeBodyVisibility})),this.tree=this._register(this.instantiationService.createInstance(de.J6,"SearchView",this.resultsElement,t,[this._register(this.instantiationService.createInstance(dt,this,this.treeLabels)),this._register(this.instantiationService.createInstance(gt,this,this.treeLabels)),this._register(this.instantiationService.createInstance(pt,this.viewModel,this))],{identityProvider:{getId:r=>r.id()},accessibilityProvider:this.treeAccessibilityProvider,dnd:this.instantiationService.createInstance(fn.vb,r=>r instanceof y.ut?r.resource:r instanceof y.qE?(0,Lt.YO)(r.parent().resource,r.range()):null),multipleSelectionSupport:!0,selectionNavigation:!0,overrideStyles:{listBackground:this.getBackgroundColor()},additionalScrollHeight:Vs.ITEM_HEIGHT})),this._register(this.tree.onContextMenu(r=>this.onContextMenu(r)));const s=()=>this.toggleCollapseStateDelayer.trigger(()=>this.hasSomeCollapsibleResultKey.set(this.hasSomeCollapsible()));s(),this._register(this.viewModel.searchResult.onChange(()=>s())),this._register(this.tree.onDidChangeCollapseState(()=>s())),this._register(O.ju.debounce(this.tree.onDidOpen,(r,n)=>n,75,!0)(r=>{if(r.element instanceof y.qE){const n=r.element;this.currentSelectedFileMatch?.setSelectedMatch(null),this.currentSelectedFileMatch=n.parent(),this.currentSelectedFileMatch.setSelectedMatch(n),this.onFocus(n,r.editorOptions.preserveFocus,r.sideBySide,r.editorOptions.pinned)}})),this._register(O.ju.debounce(this.tree.onDidChangeFocus,(r,n)=>n,75,!0)(()=>{const r=this.tree.getSelection(),n=this.tree.getFocus()[0];r.length>1&&n instanceof y.qE&&this.onFocus(n,!0)})),this._register(O.ju.any(this.tree.onDidFocus,this.tree.onDidChangeFocus)(()=>{const r=this.tree.getFocus()[0];this.tree.isDOMFocused()&&(this.firstMatchFocused.set(this.tree.navigate().first()===r),this.fileMatchOrMatchFocused.set(!!r),this.fileMatchFocused.set(r instanceof y.ut),this.folderMatchFocused.set(r instanceof y.nA),this.matchFocused.set(r instanceof y.qE),this.fileMatchOrFolderMatchFocus.set(r instanceof y.ut||r instanceof y.nA),this.fileMatchOrFolderMatchWithResourceFocus.set(r instanceof y.ut||r instanceof y.eG),this.folderMatchWithResourceFocused.set(r instanceof y.eG),this.lastFocusState="tree");let n=!1;r instanceof y.YT?n=!r.isWebviewMatch():(r instanceof y.ut||r instanceof y.nA)&&(n=!r.hasOnlyReadOnlyMatches()),this.isEditableItem.set(n)})),this._register(this.tree.onDidBlur(()=>{this.firstMatchFocused.reset(),this.fileMatchOrMatchFocused.reset(),this.fileMatchFocused.reset(),this.folderMatchFocused.reset(),this.matchFocused.reset(),this.fileMatchOrFolderMatchFocus.reset(),this.fileMatchOrFolderMatchWithResourceFocus.reset(),this.folderMatchWithResourceFocused.reset(),this.isEditableItem.reset()}))}onContextMenu(e){e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this.contextMenuService.showContextMenu({menuId:f.eH.SearchContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:this.contextKeyService,getAnchor:()=>e.anchor,getActionsContext:()=>e.element})}hasSomeCollapsible(){const e=this.getControl(),t=e.navigate();let i=t.first();do{if(!e.isCollapsed(i))return!0}while(i=t.next());return!1}selectNextMatch(){if(!this.hasSearchResults())return;const[e]=this.tree.getSelection();e&&!(e instanceof y.qE)&&this.tree.isCollapsed(e)&&this.tree.expand(e);const t=this.tree.navigate(e);let i=t.next();for(i||(i=t.first());i&&!(i instanceof y.qE);)this.tree.isCollapsed(i)&&this.tree.expand(i),i=t.next();if(i){i===e&&this.tree.setFocus([]);const s=(0,de.gN)(void 0,!1,!1);this.tree.setFocus([i],s),this.tree.setSelection([i],s),this.tree.reveal(i);const r=this.treeAccessibilityProvider.getAriaLabel(i);r&&Ye.Z9(r)}}selectPreviousMatch(){if(!this.hasSearchResults())return;const[e]=this.tree.getSelection();let t=this.tree.navigate(e),i=t.previous();for(;!i||!(i instanceof y.qE)&&!this.tree.isCollapsed(i);){const s=i?t.previous():t.last();if(!i&&!s)return;i=s}for(;!(i instanceof y.qE);){const s=t.next();this.tree.expand(i),t=this.tree.navigate(s),i=s?t.previous():t.last()}if(i){i===e&&this.tree.setFocus([]);const s=(0,de.gN)(void 0,!1,!1);this.tree.setFocus([i],s),this.tree.setSelection([i],s),this.tree.reveal(i);const r=this.treeAccessibilityProvider.getAriaLabel(i);r&&Ye.Z9(r)}}moveFocusToResults(){this.tree.domFocus()}focus(){if(super.focus(),"input"!==this.lastFocusState&&this.hasSearchResults())this.tree.domFocus();else{const e=!!this.searchConfig.seedOnFocus&&this.updateTextFromSelection({allowSearchOnType:!1});this.searchWidget.focus(void 0,void 0,e)}}updateTextFromFindWidgetOrSelection({allowUnselectedWord:e=!0,allowSearchOnType:t=!0}){let i=this.editorService.activeTextEditorControl;if((0,Fe.CL)(i)&&!i?.hasTextFocus()){const s=os.CommonFindController.get(i);if(s&&s.isFindInputFocused())return this.updateTextFromFindWidget(s,{allowSearchOnType:t});i=this.codeEditorService.listCodeEditors().find(n=>n instanceof gn.H&&n.getParentEditor()===i&&n.hasTextFocus())??i}return this.updateTextFromSelection({allowUnselectedWord:e,allowSearchOnType:t},i)}updateTextFromFindWidget(e,{allowSearchOnType:t=!0}){if(!this.searchConfig.seedWithNearestWord&&""===(window.getSelection()?.toString()??""))return!1;const i=e.getState().searchString;return""!==i&&(this.searchWidget.searchInput?.setCaseSensitive(e.getState().matchCase),this.searchWidget.searchInput?.setWholeWords(e.getState().wholeWord),this.searchWidget.searchInput?.setRegex(e.getState().isRegex),this.updateText(i,t),!0)}updateTextFromSelection({allowUnselectedWord:e=!0,allowSearchOnType:t=!0},i){if(!this.configurationService.getValue("editor").find.seedSearchStringFromSelection)return!1;let r=this.getSearchTextFromEditor(e,i);return null!==r&&(this.searchWidget.searchInput?.getRegex()&&(r=un.ec(r)),this.updateText(r,t),!0)}updateText(e,t=!0){t&&!this.viewModel.searchResult.isDirty?this.searchWidget.setValue(e):(this.pauseSearching=!0,this.searchWidget.setValue(e),this.pauseSearching=!1)}focusNextInputBox(){if(this.searchWidget.searchInputHasFocus())this.searchWidget.isReplaceShown()?this.searchWidget.focus(!0,!0):this.moveFocusFromSearchOrReplace();else{if(!this.searchWidget.replaceInputHasFocus())return this.inputPatternIncludes.inputHasFocus()?(this.inputPatternExcludes.focus(),void this.inputPatternExcludes.select()):void(this.inputPatternExcludes.inputHasFocus()&&this.selectTreeIfNotSelected());this.moveFocusFromSearchOrReplace()}}moveFocusFromSearchOrReplace(){this.showsFileTypes()?this.toggleQueryDetails(!0,this.showsFileTypes()):this.selectTreeIfNotSelected()}focusPreviousInputBox(){if(!this.searchWidget.searchInputHasFocus()){if(this.searchWidget.replaceInputHasFocus())return void this.searchWidget.focus(!0);if(this.inputPatternIncludes.inputHasFocus())return void this.searchWidget.focus(!0,!0);if(this.inputPatternExcludes.inputHasFocus())return this.inputPatternIncludes.focus(),void this.inputPatternIncludes.select();if(this.tree.isDOMFocused())return void this.moveFocusFromResults()}}moveFocusFromResults(){this.showsFileTypes()?this.toggleQueryDetails(!0,!0,!1,!0):this.searchWidget.focus(!0,!0)}reLayout(){if(this.isDisposed||!this.size)return;const e=this.searchConfig.actionsPosition;this.getContainer().classList.toggle(br.ACTIONS_RIGHT_CLASS_NAME,"right"===e),this.searchWidget.setWidth(this.size.width-28),this.inputPatternExcludes.setWidth(this.size.width-28),this.inputPatternIncludes.setWidth(this.size.width-28);const t=v.wn(this.searchWidgetsContainerElement),i=v.wn(this.messagesElement);this.tree.layout(this.size.height-t-i,this.size.width-28)}layoutBody(e,t){super.layoutBody(e,t),this.size=new v.Ro(t,e),this.reLayout()}getControl(){return this.tree}allSearchFieldsClear(){return""===this.searchWidget.getReplaceValue()&&(!this.searchWidget.searchInput||""===this.searchWidget.searchInput.getValue())}allFilePatternFieldsClear(){return""===this.searchExcludePattern.getValue()&&""===this.searchIncludePattern.getValue()}hasSearchResults(){return!this.viewModel.searchResult.isEmpty()}clearSearchResults(e=!0){this.viewModel.searchResult.clear(),this.showEmptyStage(!0),1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),e&&(this.allSearchFieldsClear()&&this.clearFilePatternFields(),this.searchWidget.clear()),this.viewModel.cancelSearch(),this.tree.ariaLabel=l.NC("emptySearch","Empty Search"),Ye.i7(l.NC("ariaSearchResultsClearStatus","The search results have been cleared")),this.reLayout()}clearFilePatternFields(){this.searchExcludePattern.clear(),this.searchIncludePattern.clear()}cancelSearch(e=!0){return!!this.viewModel.cancelSearch()&&(e&&this.searchWidget.focus(),!0)}selectTreeIfNotSelected(){if(this.tree.getNode(null)&&(this.tree.domFocus(),0===this.tree.getSelection().length)){const t=(0,de.gN)();this.tree.focusNext(void 0,void 0,t),this.tree.setSelection(this.tree.getFocus(),t)}}getSearchTextFromEditor(e,t){if(v.jg(document.activeElement,this.getContainer())||((0,Fe.QI)(t=t??this.editorService.activeTextEditorControl)&&(t=t.getOriginalEditor().hasTextFocus()?t.getOriginalEditor():t.getModifiedEditor()),!(0,Fe.CL)(t)||!t.hasModel()))return null;const i=t.getSelection();if(!i)return null;if(i.isEmpty()&&this.searchConfig.seedWithNearestWord&&e){const s=t.getModel().getWordAtPosition(i.getStartPosition());if(s)return s.word}if(!i.isEmpty()){let s="";for(let r=i.startLineNumber;r<=i.endLineNumber;r++){let n=t.getModel().getLineContent(r);r===i.endLineNumber&&(n=n.substring(0,i.endColumn-1)),r===i.startLineNumber&&(n=n.substring(i.startColumn-1)),r!==i.startLineNumber&&(n="\n"+n),s+=n}return s}return null}showsFileTypes(){return this.queryDetails.classList.contains("more")}toggleCaseSensitive(){this.searchWidget.searchInput?.setCaseSensitive(!this.searchWidget.searchInput.getCaseSensitive()),this.triggerQueryChange()}toggleWholeWords(){this.searchWidget.searchInput?.setWholeWords(!this.searchWidget.searchInput.getWholeWords()),this.triggerQueryChange()}toggleRegex(){this.searchWidget.searchInput?.setRegex(!this.searchWidget.searchInput.getRegex()),this.triggerQueryChange()}togglePreserveCase(){this.searchWidget.replaceInput?.setPreserveCase(!this.searchWidget.replaceInput.getPreserveCase()),this.triggerQueryChange()}setSearchParameters(e={}){"boolean"==typeof e.isCaseSensitive&&this.searchWidget.searchInput?.setCaseSensitive(e.isCaseSensitive),"boolean"==typeof e.matchWholeWord&&this.searchWidget.searchInput?.setWholeWords(e.matchWholeWord),"boolean"==typeof e.isRegex&&this.searchWidget.searchInput?.setRegex(e.isRegex),"string"==typeof e.filesToInclude&&this.searchIncludePattern.setValue(String(e.filesToInclude)),"string"==typeof e.filesToExclude&&this.searchExcludePattern.setValue(String(e.filesToExclude)),"string"==typeof e.query&&this.searchWidget.searchInput?.setValue(e.query),"string"==typeof e.replace?this.searchWidget.replaceInput?.setValue(e.replace):this.searchWidget.replaceInput&&""!==this.searchWidget.replaceInput.getValue()&&this.searchWidget.replaceInput.setValue(""),"boolean"==typeof e.triggerSearch&&e.triggerSearch&&this.triggerQueryChange(),"boolean"==typeof e.preserveCase&&this.searchWidget.replaceInput?.setPreserveCase(e.preserveCase),"boolean"==typeof e.useExcludeSettingsAndIgnoreFiles&&this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(e.useExcludeSettingsAndIgnoreFiles),"boolean"==typeof e.onlyOpenEditors&&this.searchIncludePattern.setOnlySearchInOpenEditors(e.onlyOpenEditors)}toggleQueryDetails(e=!0,t,i,s){const r="more";t=typeof t>"u"?!this.queryDetails.classList.contains(r):!!t,this.viewletState["query.queryDetailsExpanded"]=t,i=!!i,t?(this.toggleQueryDetailsButton.setAttribute("aria-expanded","true"),this.queryDetails.classList.add(r),e&&(s?(this.inputPatternExcludes.focus(),this.inputPatternExcludes.select()):(this.inputPatternIncludes.focus(),this.inputPatternIncludes.select()))):(this.toggleQueryDetailsButton.setAttribute("aria-expanded","false"),this.queryDetails.classList.remove(r),e&&this.searchWidget.focus()),!i&&this.size&&this.reLayout()}searchInFolders(e=[]){this._searchWithIncludeOrExclude(!0,e)}searchOutsideOfFolders(e=[]){this._searchWithIncludeOrExclude(!1,e)}_searchWithIncludeOrExclude(e,t){if(!t.length||t.some(i=>"."===i))return this.inputPatternIncludes.setValue(""),void this.searchWidget.focus();this.showsFileTypes()||this.toggleQueryDetails(!0,!0),(e?this.inputPatternIncludes:this.inputPatternExcludes).setValue(t.join(", ")),this.searchWidget.focus(!1)}triggerQueryChange(e){const t={preserveFocus:!0,triggeredOnType:!1,delay:0,...e};t.triggeredOnType&&!this.searchConfig.searchOnType||this.pauseSearching||this.triggerQueryDelayer.trigger(()=>{this._onQueryChanged(t.preserveFocus,t.triggeredOnType)},t.delay)}_onQueryChanged(e,t=!1){if(!this.searchWidget.searchInput?.inputBox.isInputValid())return;const i=this.searchWidget.searchInput.getRegex(),s=this.searchWidget.getNotebookFilters().markupInput,r=this.searchWidget.getNotebookFilters().markupPreview,n=this.searchWidget.getNotebookFilters().codeInput,a=this.searchWidget.getNotebookFilters().codeOutput,c=this.searchWidget.searchInput.getWholeWords(),h=this.searchWidget.searchInput.getCaseSensitive(),u=this.searchWidget.searchInput.getValue(),d=this.inputPatternExcludes.getValue().trim(),m=this.inputPatternIncludes.getValue().trim(),C=this.inputPatternExcludes.useExcludesAndIgnoreFiles(),b=this.inputPatternIncludes.onlySearchInOpenEditors();if(0===u.length)return this.clearSearchResults(!1),void this.clearMessage();const x={pattern:u,isRegExp:i,isCaseSensitive:h,isWordMatch:c,notebookInfo:{isInNotebookMarkdownInput:s,isInNotebookMarkdownPreview:r,isInNotebookCellInput:n,isInNotebookCellOutput:a}},I=this.inputPatternExcludes.getValue(),R=this.inputPatternIncludes.getValue(),E=x.isRegExp?1e4:1e3,D={_reason:"searchView",extraFileResources:this.instantiationService.invokeFunction(q.ek),maxResults:(0,Q.f6)(this.searchConfig.maxResults),disregardIgnoreFiles:!C||void 0,disregardExcludeSettings:!C||void 0,onlyOpenEditors:b,excludePattern:I,includePattern:R,previewOptions:{matchLines:1,charsPerLine:E},isSmartCase:this.searchConfig.smartCase,expandPatterns:!0},ee=this.contextService.getWorkspace().folders,be=Z=>{this.searchWidget.searchInput?.showMessage({content:Z.message,type:3}),this.viewModel.searchResult.clear()};let W;try{W=this.queryBuilder.text(x,ee.map(Z=>Z.uri),D)}catch(Z){return void be(Z)}this.validateQuery(W).then(()=>{this.onQueryTriggered(W,D,d,m,t),e||this.searchWidget.focus(!1,void 0,!0)},be)}validateQuery(e){const t=e.folderQueries.map(i=>this.fileService.exists(i.folder).catch(()=>!1));return Promise.all(t).then(i=>{const s=e.folderQueries.filter((r,n)=>i[n]);if(e.folderQueries.length&&!s.length){const n=l.NC("searchPathNotFoundError","Search path not found: {0}",e.folderQueries[0].folder.fsPath);return Promise.reject(new Error(n))}e.folderQueries=s})}onQueryTriggered(e,t,i,s,r){this.addToSearchHistoryDelayer.trigger(()=>{this.searchWidget.searchInput?.onSearchSubmit(),this.inputPatternExcludes.onSearchSubmit(),this.inputPatternIncludes.onSearchSubmit()}),this.viewModel.cancelSearch(!0),this.currentSearchQ=this.currentSearchQ.then(()=>this.doSearch(e,i,s,r)).then(()=>{},()=>{})}_updateResults(){try{if(this.state===q.Ps.Idle)return;const e=this.viewModel.searchResult.fileCount();this._visibleMatches!==e&&(this._visibleMatches=e,this.refreshAndUpdateCount())}finally{this._refreshResultsScheduler.schedule()}}doSearch(e,t,i,s){let r;this.progressService.withProgress({location:this.getProgressLocation(),delay:s?300:0},h=>new Promise(u=>r=u)),this.searchWidget.searchInput?.clearMessage(),this.state=q.Ps.Searching,this.showEmptyStage();const n=setTimeout(()=>{this.state=q.Ps.SlowSearch},2e3),a=h=>{if(clearTimeout(n),this.state=q.Ps.Idle,r(),this.onSearchResultsChanged(),"alwaysCollapse"!==this.searchConfig.collapseResults&&1===this.viewModel.searchResult.matches().length){const m=this.viewModel.searchResult.matches()[0];m.count()<50&&this.tree.expand(m)}this.viewModel.replaceString=this.searchWidget.getReplaceValue();const d=!this.viewModel.searchResult.isEmpty();if(1!==h?.exit){if(d)this.viewModel.searchResult.toggleHighlights(this.isVisible()),Ye.i7(l.NC("ariaSearchResultsStatus","Search returned {0} results in {1} files",this.viewModel.searchResult.count(),this.viewModel.searchResult.fileCount()));else{const m=!!t,C=!!i;let b;b=h?this.inputPatternIncludes.onlySearchInOpenEditors()?C&&m?l.NC("noOpenEditorResultsIncludesExcludes","No results found in open editors matching '{0}' excluding '{1}' - ",i,t):C?l.NC("noOpenEditorResultsIncludes","No results found in open editors matching '{0}' - ",i):m?l.NC("noOpenEditorResultsExcludes","No results found in open editors excluding '{0}' - ",t):l.NC("noOpenEditorResultsFound","No results found in open editors. Review your settings for configured exclusions and check your gitignore files - "):C&&m?l.NC("noResultsIncludesExcludes","No results found in '{0}' excluding '{1}' - ",i,t):C?l.NC("noResultsIncludes","No results found in '{0}' - ",i):m?l.NC("noResultsExcludes","No results found excluding '{0}' - ",t):l.NC("noResultsFound","No results found. Review your settings for configured exclusions and check your gitignore files - "):nr,Ye.i7(b);const x=this.clearMessage();if(v.R3(x,b),h)if(C||m){const I=this.messageDisposables.add(new Ae(l.NC("rerunSearchInAll.message","Search again in all files"),this.onSearchAgain.bind(this)));v.R3(x,I.element)}else{const I=this.messageDisposables.add(new Ae(l.NC("openSettings.message","Open Settings"),this.onOpenSettings.bind(this)));v.R3(x,I.element)}else{const I=this.messageDisposables.add(new Ae(l.NC("rerunSearch.message","Search again"),()=>this.triggerQueryChange({preserveFocus:!1})));v.R3(x,I.element)}if(h){v.R3(x,_("span",void 0," - "));const I=this.messageDisposables.add(new Ae(l.NC("openSettings.learnMore","Learn More"),this.onLearnMore.bind(this)));v.R3(x,I.element)}1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),this.reLayout()}if(h&&h.limitHit&&h.messages.push({type:Is.a.Warning,text:l.NC("searchMaxResultsWarning","The result set only contains a subset of all matches. Be more specific in your search to narrow down the results.")}),h&&h.messages)for(const m of h.messages)this.addMessage(m);this.reLayout()}};return this._visibleMatches=0,this._refreshResultsScheduler.schedule(),this.searchWidget.setReplaceAllActionState(!1),this.tree.setSelection([]),this.tree.setFocus([]),this.viewModel.search(e).then(a,h=>(clearTimeout(n),this.state=q.Ps.Idle,oe.n2(h)?a(void 0):(r(),this.searchWidget.searchInput?.showMessage({content:h.message,type:3}),this.viewModel.searchResult.clear(),Promise.resolve())))}onOpenSettings(e){v.zB.stop(e,!1),this.openSettings("@id:files.exclude,search.exclude,search.useParentIgnoreFiles,search.useGlobalIgnoreFiles,search.useIgnoreFiles")}openSettings(e){const t={query:e};return 1!==this.contextService.getWorkbenchState()?this.preferencesService.openWorkspaceSettings(t):this.preferencesService.openUserSettings(t)}onLearnMore(){this.openerService.open(Le.ov.parse("https://go.microsoft.com/fwlink/?linkid=853977"))}onSearchAgain(){this.inputPatternExcludes.setValue(""),this.inputPatternIncludes.setValue(""),this.inputPatternIncludes.setOnlySearchInOpenEditors(!1),this.triggerQueryChange({preserveFocus:!1})}onEnableExcludes(){this.toggleQueryDetails(!1,!0),this.searchExcludePattern.setUseExcludesAndIgnoreFiles(!0)}onDisableSearchInOpenEditors(){this.toggleQueryDetails(!1,!0),this.inputPatternIncludes.setOnlySearchInOpenEditors(!1)}updateSearchResultCount(e,t,i=!1){const s=this.viewModel.searchResult.fileCount();this.hasSearchResultsKey.set(s>0);const r="none"===this.messagesElement.style.display,n=this.clearMessage(),a=i?"":this.buildResultCountMessage(this.viewModel.searchResult.count(),s);if(this.tree.ariaLabel=a+l.NC("forTerm"," - Search: {0}",this.searchResult.query?.contentPattern.pattern??""),v.R3(n,a),s>0){if(e){const u=" - "+l.NC("useIgnoresAndExcludesDisabled","exclude settings and ignore files are disabled")+" ",d=this.messageDisposables.add(new Ae(l.NC("excludes.enable","enable"),this.onEnableExcludes.bind(this),l.NC("useExcludesAndIgnoreFilesDescription","Use Exclude Settings and Ignore Files")));v.R3(n,_("span",void 0,u,"(",d.element,")"))}if(t){const u=" - "+l.NC("onlyOpenEditors","searching only in open files")+" ",d=this.messageDisposables.add(new Ae(l.NC("openEditors.disable","disable"),this.onDisableSearchInOpenEditors.bind(this),l.NC("disableOpenEditors","Search in entire workspace")));v.R3(n,_("span",void 0,u,"(",d.element,")"))}v.R3(n," - ");const c=De(l.NC("openInEditor.tooltip","Copy current search results to an editor"),this.keybindingService.lookupKeybinding("search.action.openInEditor")),h=this.messageDisposables.add(new Ae(l.NC("openInEditor.message","Open in editor"),()=>this.instantiationService.invokeFunction(rr,this.searchResult,this.searchIncludePattern.getValue(),this.searchExcludePattern.getValue(),this.searchIncludePattern.onlySearchInOpenEditors()),c));v.R3(n,h.element),this.reLayout()}else r||v.Cp(this.messagesElement)}addMessage(e){const t=this.messagesElement.firstChild;t&&v.R3(t,Rs(e,this.instantiationService,this.notificationService,this.openerService,this.commandService,this.messageDisposables,()=>this.triggerQueryChange()))}buildResultCountMessage(e,t){return 1===e&&1===t?l.NC("search.file.result","{0} result in {1} file",e,t):1===e?l.NC("search.files.result","{0} result in {1} files",e,t):1===t?l.NC("search.file.results","{0} results in {1} file",e,t):l.NC("search.files.results","{0} results in {1} files",e,t)}showSearchWithoutFolderMessage(){this.searchWithoutFolderMessageElement=this.clearMessage();const e=v.R3(this.searchWithoutFolderMessageElement,_("p",void 0,l.NC("searchWithoutFolder","You have not opened or specified a folder. Only open files are currently searched - "))),t=this.messageDisposables.add(new Ae(l.NC("openFolder","Open Folder"),()=>{this.commandService.executeCommand(Ne.dz&&Ne.tY?xs.zX.ID:xs.JW.ID).catch(i=>oe.dL(i))}));v.R3(e,t.element)}showEmptyStage(e=!1){((this.messagesElement.firstChild?.textContent?.indexOf(nr)??-1)>-1||e||!this.configurationService.getValue().search.searchOnType)&&v.Cp(this.messagesElement),v.$Z(this.resultsElement),this.currentSelectedFileMatch=void 0}shouldOpenInNotebookEditor(e,t){return e instanceof y.YT||t.scheme!==B.lg.untitled&&this.notebookService.getContributedNotebookTypes(t).length>0}onFocus(e,t,i,s){const r=this.configurationService.getValue().search.useReplacePreview,n=e instanceof y.qE?e.parent().resource:e.resource;return r&&this.viewModel.isReplaceActive()&&this.viewModel.replaceString&&!this.shouldOpenInNotebookEditor(e,n)?this.replaceService.openReplacePreview(e,t,i,s):this.open(e,t,i,s,n)}open(e,t,i,s,r){var n=this;return(0,S.Z)(function*(){const a=n.getSelectionFrom(e),c=e instanceof y.qE?e.parent().matches():[],h=r??(e instanceof y.qE?e.parent().resource:e.resource);let u;try{u=yield n.editorService.openEditor({resource:h,options:{preserveFocus:t,pinned:s,selection:a,revealIfVisible:!0}},i?F.O3:F.LP);const d=u?.getControl();e instanceof y.qE&&t&&(0,Fe.CL)(d)?n.viewModel.searchResult.rangeHighlightDecorations.highlightRange(d.getModel(),e.range()):n.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange()}catch(d){return void oe.dL(d)}if(u instanceof Sn){const d=e.parent();if(e instanceof y.qE)if(e instanceof y.YT)e.parent().showMatch(e);else{const m=u.getControl();if(m){d.bindNotebookEditorWidget(m),yield d.updateMatchesForEditorWidget();const C=c.findIndex(I=>I.id()===e.id()),b=e.parent().matches(),x=C>=b.length?b[b.length-1]:b[C];x instanceof y.YT&&d.showMatch(x),(!n.tree.getFocus().includes(x)||!n.tree.getSelection().includes(x))&&(n.tree.setSelection([x],(0,de.gN)()),n.tree.setFocus([x]))}}}})()}openEditorWithMultiCursor(e){const t=e instanceof y.qE?e.parent().resource:e.resource;return this.editorService.openEditor({resource:t,options:{preserveFocus:!1,pinned:!0,revealIfVisible:!0}}).then(i=>{if(i){let s=null;if(e instanceof y.ut?s=e:e instanceof y.qE&&(s=e.parent()),s){const r=s.matches().map(a=>new li.Y(a.range().startLineNumber,a.range().startColumn,a.range().endLineNumber,a.range().endColumn)),n=(0,Fe.Pi)(i.getControl());n&&pn.MultiCursorSelectionController.get(n)?.selectAllUsingSelections(r)}}this.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange()},oe.dL)}getSelectionFrom(e){let t=null;if(e instanceof y.qE&&(t=e),e instanceof y.ut&&e.count()>0&&(t=e.matches()[e.matches().length-1]),t){const i=t.range();return this.viewModel.isReplaceActive()&&this.viewModel.replaceString?{startLineNumber:i.startLineNumber,startColumn:i.startColumn,endLineNumber:i.startLineNumber,endColumn:i.startColumn+t.replaceString.length}:i}}onUntitledDidDispose(e){if(!this.viewModel)return;const t=this.viewModel.searchResult.matches();for(let i=0,s=t.length;i<s;i++)e.toString()===t[i].resource.toString()&&this.viewModel.searchResult.remove(t[i])}onFilesChanged(e){if(!this.viewModel||"modified"!==this.searchConfig.sortOrder&&!e.gotDeleted())return;const t=this.viewModel.searchResult.matches();if(e.gotDeleted()){const i=t.filter(s=>e.contains(s.resource,2));this.viewModel.searchResult.remove(i)}else{const i=t.filter(s=>e.contains(s.resource));i.length&&"modified"===this.searchConfig.sortOrder&&this.updateFileStats(i).then(()=>this.refreshTree())}}get searchConfig(){return this.configurationService.getValue("search")}clearHistory(){this.searchWidget.clearHistory(),this.inputPatternExcludes.clearHistory(),this.inputPatternIncludes.clearHistory()}saveState(){if(!this.searchWidget)return;const e=this.inputPatternExcludes?.getValue().trim()??"",t=this.inputPatternIncludes?.getValue().trim()??"",i=this.inputPatternIncludes?.onlySearchInOpenEditors()??!1,s=this.inputPatternExcludes?.useExcludesAndIgnoreFiles()??!0,r=this.viewModel.preserveCase;if(this.searchWidget.searchInput){const m=this.searchWidget.searchInput.getRegex(),C=this.searchWidget.searchInput.getWholeWords(),b=this.searchWidget.searchInput.getCaseSensitive(),x=this.searchWidget.searchInput.getValue(),I=this.searchWidget.getNotebookFilters().codeInput,R=this.searchWidget.getNotebookFilters().codeOutput,E=this.searchWidget.getNotebookFilters().markupInput,D=this.searchWidget.getNotebookFilters().markupPreview;this.viewletState["query.contentPattern"]=x,this.viewletState["query.regex"]=m,this.viewletState["query.wholeWords"]=C,this.viewletState["query.caseSensitive"]=b,this.viewletState["query.isInNotebookMarkdownInput"]=E,this.viewletState["query.isInNotebookMarkdownPreview"]=D,this.viewletState["query.isInNotebookCellInput"]=I,this.viewletState["query.isInNotebookCellOutput"]=R}this.viewletState["query.folderExclusions"]=e,this.viewletState["query.folderIncludes"]=t,this.viewletState["query.useExcludesAndIgnoreFiles"]=s,this.viewletState["query.preserveCase"]=r,this.viewletState["query.onlyOpenEditors"]=i;const n=this.searchAndReplaceWidget.isReplaceShown();this.viewletState["view.showReplace"]=n,this.viewletState["view.treeLayout"]=this.isTreeLayoutViewVisible,this.viewletState["query.replaceText"]=n&&this.searchWidget.getReplaceValue();const a=Object.create(null),c=this.searchWidget.getSearchHistory();c&&c.length&&(a.search=c);const h=this.searchWidget.getReplaceHistory();h&&h.length&&(a.replace=h);const u=this.inputPatternExcludes.getHistory();u&&u.length&&(a.exclude=u);const d=this.inputPatternIncludes.getHistory();d&&d.length&&(a.include=d),this.searchHistoryService.save(a),this.memento.saveMemento(),super.saveState()}retrieveFileStats(){var e=this;return(0,S.Z)(function*(){const t=e.searchResult.matches().filter(i=>!i.fileStat).map(i=>i.resolveFileStat(e.fileService));yield Promise.all(t)})()}updateFileStats(e){var t=this;return(0,S.Z)(function*(){const i=e.map(s=>s.resolveFileStat(t.fileService));yield Promise.all(i)})()}removeFileStats(){for(const e of this.searchResult.matches())e.fileStat=void 0}dispose(){this.isDisposed=!0,this.saveState(),super.dispose()}};Zt.ACTIONS_RIGHT_CLASS_NAME="actions-right",Zt=(0,g.gn)([(0,g.fM)(1,le.sn),(0,g.fM)(2,F.AR),(0,g.fM)(3,ns.$),(0,g.fM)(4,ui.R9),(0,g.fM)(5,st.lT),(0,g.fM)(6,Wt.Ss),(0,g.fM)(7,Oe.H),(0,g.fM)(8,je.u),(0,g.fM)(9,V.TG),(0,g.fM)(10,k.XH),(0,g.fM)(11,H.Ui),(0,g.fM)(12,Ce.ec),(0,g.fM)(13,y.Zj),(0,g.fM)(14,w.i6),(0,g.fM)(15,Ft.H),(0,g.fM)(16,Mt.MM),(0,g.fM)(17,Zo.UP),(0,g.fM)(18,rt.XE),(0,g.fM)(19,Rt.c),(0,g.fM)(20,je.i),(0,g.fM)(21,hi.F),(0,g.fM)(22,at.d),(0,g.fM)(23,Xe.Uy),(0,g.fM)(24,Lt.v4),(0,g.fM)(25,Ie.bU),(0,g.fM)(26,qo.A),(0,g.fM)(27,It.VZ)],Zt);class Ae extends P.JT{constructor(e,t,i){super(),this.element=_("a.pointer",{tabindex:0,title:i},e),this.addEventHandlers(t)}addEventHandlers(e){const t=i=>{v.zB.stop(i,!1),e(i)};this._register(v.nm(this.element,v.tw.CLICK,t)),this._register(v.nm(this.element,v.tw.KEY_DOWN,i=>{const s=new nt.y1(i);(s.equals(10)||s.equals(3))&&(t(i),s.preventDefault(),s.stopPropagation())}))}}(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.copyMatch",title:{value:l.NC("copyMatchLabel","Copy"),original:"Copy"},category:M,keybinding:{weight:200,when:Ve,primary:2081},menu:[{id:f.eH.SearchContext,when:Ve,group:"search_2",order:1}]})}run(e,t){return(0,S.Z)(function*(){yield function Go(o,e){return Pi.apply(this,arguments)}(e,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.copyPath",title:{value:l.NC("copyPathLabel","Copy Path"),original:"Copy Path"},category:M,keybinding:{weight:200,when:Si,primary:2593,win:{primary:1569}},menu:[{id:f.eH.SearchContext,when:Si,group:"search_2",order:2}]})}run(e,t){return(0,S.Z)(function*(){yield function $o(o,e){return Mi.apply(this,arguments)}(e,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.copyAll",title:{value:l.NC("copyAllLabel","Copy All"),original:"Copy All"},category:M,menu:[{id:f.eH.SearchContext,when:re,group:"search_2",order:3}]})}run(e){return(0,S.Z)(function*(){yield function zo(o){return Ai.apply(this,arguments)}(e)})()}});const _e=Ne.ED?"\r\n":"\n";function Mi(){return Mi=(0,S.Z)(function*(o,e){if(!e){const r=lr(o);if(!(r instanceof y.ut||r instanceof y.eG))return;e=r}const t=o.get(Kt.p),s=o.get(Se.e).getUriLabel(e.resource,{noPrefix:!0});yield t.writeText(s)}),Mi.apply(this,arguments)}function Pi(){return Pi=(0,S.Z)(function*(o,e){if(!e){const r=lr(o);if(!r)return;e=r}const t=o.get(Kt.p),i=o.get(Se.e);let s;e instanceof y.qE?s=ar(e):e instanceof y.ut?s=cr(e,i).text:e instanceof y.nA&&(s=Ti(e,i).text),s&&(yield t.writeText(s))}),Pi.apply(this,arguments)}function Ai(){return Ai=(0,S.Z)(function*(o){const e=o.get(k.qC),t=o.get(Kt.p),i=o.get(Se.e),s=T(e);if(s){const n=function Yo(o,e){const t=[];o=o.sort(y.ct);for(let i=0;i<o.length;i++){const s=Ti(o[i],e);s.count&&t.push(s.text)}return t.join(_e+_e)}(s.searchResult.folderMatches(),i);yield t.writeText(n)}}),Ai.apply(this,arguments)}function ar(o,e=0){const t=()=>`${o.range().startLineNumber},${o.range().startColumn}`,i=a=>o.range().startLineNumber+a+"",s=o.fullPreviewLines(),r=s.reduce((a,c,h)=>{const u=0===h?t().length:i(h).length;return Math.max(u,a)},0);return s.map((a,c)=>{const h=0===c?t():i(c),u=" ".repeat(r-h.length);return`${" ".repeat(e)}${h}: ${u}${a}`}).join("\n")}function cr(o,e){const t=o.matches().sort(y.ct).map(s=>ar(s,2));return{text:`${e.getUriLabel(o.resource,{noPrefix:!0})}${_e}${t.join(_e)}`,count:t.length}}function Ti(o,e){const t=[];let i=0;return o.matches().sort(y.ct).forEach(r=>{const n=function Xo(o,e){return o instanceof y.ut?cr(o,e):Ti(o,e)}(r,e);i+=n.count,t.push(n.text)}),{text:t.join(_e+_e),count:i}}function lr(o){const e=o.get(k.qC);return T(e)?.getControl().getSelection()[0]}var Di,Ni=p(85462),et=p(96617),jo=p(73794);function Li(o,e,t,i,s){return Wi.apply(this,arguments)}function Wi(){return Wi=(0,S.Z)(function*(o,e,t,i,s){const r=o.get(de.Lw),n=o.get(le.sn),a=o.get(k.qC),c=o.get(Ce.ec),h=o.get(Oe.H),u=o.get(H.Ui).getValue().search,d=u.mode;let m;if(e)m=(0,Ni.kn)(i,r,o.get(F.AR),o.get(Ni.gE));else{const b=T(o.get(k.qC));if(!b)return;m=function Jo(o,e,t){return mi(o,e,t).map(i=>i instanceof y.qE?null:i.resource).filter(i=>null!==i)}(b.getControl(),s,u)}const C=n.resolveAll(m.map(b=>({resource:b}))).then(b=>{const x=[];return b.forEach(I=>{I.success&&I.stat&&x.push(I.stat.isDirectory?I.stat.resource:(0,Y.XX)(I.stat.resource))}),(0,Nt.Z)(x,c)});if("view"!==d)return h.executeCommand(ft,t?{filesToInclude:(yield C).join(", "),showIncludesExcludes:!0,location:"newEditor"===d?"new":"reuse"}:{filesToExclude:(yield C).join(", "),showIncludesExcludes:!0,location:"newEditor"===d?"new":"reuse"});{const b=yield Be(a,!0);m&&m.length&&b&&(t?b.searchInFolders(yield C):b.searchOutsideOfFolders(yield C))}}),Wi.apply(this,arguments)}function Oi(){return Oi=(0,S.Z)(function*(o,e={}){const t=o.get(H.Ui).getValue().search,i=o.get(k.qC),s=o.get(Oe.H),r={};if(0!==Object.keys(e).length){const a=o.get(ir.qb),c=o.get(ei.C),h=o.get(Ce.ec),u=c.getLastActiveWorkspaceRoot(),d=u?.scheme===B.lg.file||u?.scheme===B.lg.vscodeRemote?u:void 0,m=d?(0,Q.f6)(h.getWorkspaceFolder(d)):void 0;for(const C of Object.entries(e)){const x=C[1];void 0!==x&&(r[C[0]]="string"==typeof x?yield a.resolveAsync(m,x):x)}}const n=t.mode;var c;"view"===n?Be(i,!1).then(a=>{if(a){a.searchAndReplaceWidget.toggleReplace("string"==typeof r.replace);let h=!1;"string"!=typeof r.query&&(h=a.updateTextFromFindWidgetOrSelection({allowUnselectedWord:"string"!=typeof r.replace})),a.setSearchParameters(r),a.searchAndReplaceWidget.focus(void 0,h,h)}}):s.executeCommand(ft,{location:"newEditor"===n?"new":"reuse",query:(c=r).query,filesToInclude:c.filesToInclude,filesToExclude:c.filesToExclude,matchWholeWord:c.matchWholeWord,isCaseSensitive:c.isCaseSensitive,isRegexp:c.isRegex,useExcludeSettingsAndIgnoreFiles:c.useExcludeSettingsAndIgnoreFiles,onlyOpenEditors:c.onlyOpenEditors,showIncludesExcludes:!(!c.filesToExclude&&!c.filesToExclude&&c.useExcludeSettingsAndIgnoreFiles)})}),Oi.apply(this,arguments)}(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.restrictSearchToFolder",title:{value:l.NC("restrictResultsToFolder","Restrict Search to Folder"),original:"Restrict Search to Folder"},category:M,keybinding:{weight:200,when:w.Ao.and(j,Vt),primary:1572},menu:[{id:f.eH.SearchContext,group:"search",order:3,when:w.Ao.and(Vt)}]})}run(e,t){return(0,S.Z)(function*(){yield Li(e,!1,!0,void 0,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.excludeFromSearch",title:{value:l.NC("excludeFolderFromSearch","Exclude Folder from Search"),original:"Exclude Folder from Search"},category:M,menu:[{id:f.eH.SearchContext,group:"search",order:4,when:w.Ao.and(Vt)}]})}run(e,t){return(0,S.Z)(function*(){yield Li(e,!1,!1,void 0,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.revealInSideBar",title:{value:l.NC("revealInSideBar","Reveal in Explorer View"),original:"Reveal in Explorer View"},category:M,menu:[{id:f.eH.SearchContext,when:w.Ao.and(Me,re),group:"search_3",order:1}]})}run(e,t){return(0,S.Z)(function*(){const i=e.get(jo.c),s=e.get(Ni.gE),r=e.get(Ce.ec),n=T(e.get(k.qC));if(!n)return;let a;t instanceof y.ut||(t=n.getControl().getFocus()[0]),t instanceof y.ut&&(a=t,i.openPaneComposite(et.f3,0,!1).then(c=>{if(!c)return;const h=c.getViewPaneContainer(),u=a.resource;if(u&&r.isInsideWorkspace(u)){const d=h.getExplorerView();d.setExpanded(!0),s.select(u,!0).then(()=>d.focus(),oe.dL)}}))})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"workbench.action.findInFiles",title:{value:l.NC("findInFiles","Find in Files"),mnemonicTitle:l.NC({key:"miFindInFiles",comment:["&& denotes a mnemonic"]},"Find &&in Files"),original:"Find in Files"},description:{description:l.NC("findInFiles.description","Open a workspace search"),args:[{name:l.NC("findInFiles.args","A set of options for the search"),schema:{type:"object",properties:{query:{type:"string"},replace:{type:"string"},preserveCase:{type:"boolean"},triggerSearch:{type:"boolean"},filesToInclude:{type:"string"},filesToExclude:{type:"string"},isRegex:{type:"boolean"},isCaseSensitive:{type:"boolean"},matchWholeWord:{type:"boolean"},useExcludeSettingsAndIgnoreFiles:{type:"boolean"},onlyOpenEditors:{type:"boolean"}}}}]},category:M,keybinding:{weight:200,primary:3108},menu:[{id:f.eH.MenubarEditMenu,group:"4_find_global",order:1}],f1:!0})}run(e,t={}){return(0,S.Z)(function*(){!function _o(o){Oi.apply(this,arguments)}(e,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"filesExplorer.findInFolder",title:{value:l.NC("findInFolder","Find in Folder..."),original:"Find in Folder..."},category:M,keybinding:{weight:200,when:w.Ao.and(et.Ie,et.W$),primary:1572},menu:[{id:f.eH.ExplorerContext,group:"4_search",order:10,when:w.Ao.and(et.W$)}]})}run(e,t){return(0,S.Z)(function*(){yield Li(e,!0,!0,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"filesExplorer.findInWorkspace",title:{value:l.NC("findInWorkspace","Find in Workspace..."),original:"Find in Workspace..."},category:M,menu:[{id:f.eH.ExplorerContext,group:"4_search",order:10,when:w.Ao.and(et.RQ,et.W$.toNegated())}]})}run(e){return(0,S.Z)(function*(){const i=e.get(H.Ui).getValue().search.mode;if("view"!==i)return e.get(Oe.H).executeCommand(ft,{location:"newEditor"===i?"new":"reuse",filesToInclude:""});(yield Be(e.get(k.qC),!0))?.searchInFolders()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"workbench.action.search.toggleQueryDetails",title:{value:l.NC("ToggleQueryDetailsAction.label","Toggle Query Details"),original:"Toggle Query Details"},category:M,keybinding:{weight:200,when:w.Ao.or(xe,U),primary:3112}})}run(e){const t=e.get(w.i6).getContext(document.activeElement);if(t.getValue(U.serialize()))e.get(F.AR).activeEditorPane.toggleQueryDetails();else if(t.getValue(xe.serialize())){const i=T(e.get(k.qC));(0,Q.cW)(i).toggleQueryDetails()}}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"closeReplaceInFilesWidget",title:{value:l.NC("CloseReplaceWidget.label","Close Replace Widget"),original:"Close Replace Widget"},category:M,keybinding:{weight:200,when:w.Ao.and(j,Ls),primary:9}})}run(e){const t=T(e.get(k.qC));return t&&(t.searchAndReplaceWidget.toggleReplace(!1),t.searchAndReplaceWidget.focus()),Promise.resolve(null)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:Ms,title:{value:l.NC("ToggleCaseSensitiveCommandId.label","Toggle Case Sensitive"),original:"Toggle Case Sensitive"},category:M,keybinding:Object.assign({weight:200,when:Ne.dz?w.Ao.and(xe,Os.toNegated()):xe},Pe.Dt)})}run(e){return(0,S.Z)(function*(){!function ea(o){T(o.get(k.qC))?.toggleCaseSensitive()}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:Ps,title:{value:l.NC("ToggleWholeWordCommandId.label","Toggle Whole Word"),original:"Toggle Whole Word"},keybinding:Object.assign({weight:200,when:xe},Pe.CP),category:M})}run(e){return(0,S.Z)(function*(){return function ta(o){T(o.get(k.qC))?.toggleWholeWords()}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:As,title:{value:l.NC("ToggleRegexCommandId.label","Toggle Regex"),original:"Toggle Regex"},keybinding:Object.assign({weight:200,when:xe},Pe.LM),category:M})}run(e){return(0,S.Z)(function*(){return function ia(o){T(o.get(k.qC))?.toggleRegex()}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:Ts,title:{value:l.NC("TogglePreserveCaseId.label","Toggle Preserve Case"),original:"Toggle Preserve Case"},keybinding:Object.assign({weight:200,when:xe},Pe.mt),category:M})}run(e){return(0,S.Z)(function*(){return function sa(o){T(o.get(k.qC))?.togglePreserveCase()}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openResult",title:{value:l.NC("OpenMatch.label","Open Match"),original:"Open Match"},category:M,keybinding:{weight:200,when:w.Ao.and(j,Ve),primary:3,mac:{primary:3,secondary:[2066]}}})}run(e){const t=T(e.get(k.qC));if(t){const i=t.getControl(),s=t.getControl(),r=i.getFocus()[0];r instanceof y.nA?s.toggleCollapsed(r):t.open(i.getFocus()[0],!1,!1,!0)}}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openResultToSide",title:{value:l.NC("OpenMatchToSide.label","Open Match To Side"),original:"Open Match To Side"},category:M,keybinding:{weight:200,when:w.Ao.and(j,Ve),primary:2051,mac:{primary:259}}})}run(e){const t=T(e.get(k.qC));if(t){const i=t.getControl();t.open(i.getFocus()[0],!1,!0,!0)}}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"addCursorsAtSearchResults",title:{value:l.NC("AddCursorsAtSearchResults.label","Add Cursors at Search Results"),original:"Add Cursors at Search Results"},keybinding:{weight:200,when:w.Ao.and(j,Ve),primary:3114},category:M})}run(e){return(0,S.Z)(function*(){const t=T(e.get(k.qC));if(t){const i=t.getControl();t.openEditorWithMultiCursor(i.getFocus()[0])}})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.focus.nextInputBox",title:{value:l.NC("FocusNextInputAction.label","Focus Next Input"),original:"Focus Next Input"},category:M,keybinding:{weight:200,when:w.Ao.or(w.Ao.and(U,Je),w.Ao.and(j,Je)),primary:2066}})}run(e){return(0,S.Z)(function*(){const t=e.get(F.AR);t.activeEditor instanceof L&&t.activeEditorPane.focusNextInput(),T(e.get(k.qC))?.focusNextInputBox()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.focus.previousInputBox",title:{value:l.NC("FocusPreviousInputAction.label","Focus Previous Input"),original:"Focus Previous Input"},category:M,keybinding:{weight:200,when:w.Ao.or(w.Ao.and(U,Je),w.Ao.and(j,Je,lt.toNegated())),primary:2064}})}run(e){return(0,S.Z)(function*(){const t=e.get(F.AR);t.activeEditor instanceof L&&t.activeEditorPane.focusPrevInput(),T(e.get(k.qC))?.focusPreviousInputBox()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusSearchFromResults",title:{value:l.NC("FocusSearchFromResults.label","Focus Search From Results"),original:"Focus Search From Results"},category:M,keybinding:{weight:200,when:w.Ao.and(j,w.Ao.or(Ws,hi.U)),primary:2064}})}run(e){T(e.get(k.qC))?.focusPreviousInputBox()}}),(0,f.r1)(((Di=class Gi extends f.Ke{constructor(){super({id:"workbench.action.toggleSearchOnType",title:{value:l.NC("toggleTabs","Toggle Search on Type"),original:"Toggle Search on Type"},category:M})}run(e){return(0,S.Z)(function*(){const t=e.get(H.Ui),i=t.getValue(Gi.searchOnTypeKey);return t.updateValue(Gi.searchOnTypeKey,!i)})()}}).searchOnTypeKey="search.searchOnType",Di)),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusSearchList",title:{value:l.NC("focusSearchListCommandLabel","Focus List"),original:"Focus List"},category:M,f1:!0})}run(e){return(0,S.Z)(function*(){ra(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusNextSearchResult",title:{value:l.NC("FocusNextSearchResult.label","Focus Next Search Result"),original:"Focus Next Search Result"},keybinding:[{primary:62,weight:200}],category:M,f1:!0,precondition:w.Ao.or(re,U)})}run(e){return(0,S.Z)(function*(){return yield function na(o){return Bi.apply(this,arguments)}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusPreviousSearchResult",title:{value:l.NC("FocusPreviousSearchResult.label","Focus Previous Search Result"),original:"Focus Previous Search Result"},keybinding:[{primary:1086,weight:200}],category:M,f1:!0,precondition:w.Ao.or(re,U)})}run(e){return(0,S.Z)(function*(){return yield function oa(o){return Vi.apply(this,arguments)}(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"workbench.action.replaceInFiles",title:{value:l.NC("replaceInFiles","Replace in Files"),original:"Replace in Files"},keybinding:[{primary:3110,weight:200}],category:M,f1:!0,menu:[{id:f.eH.MenubarEditMenu,group:"4_find_global",order:2}]})}run(e){return(0,S.Z)(function*(){return yield function aa(o,e){return Hi.apply(this,arguments)}(e,!0)})()}});const ra=o=>{Be(o.get(k.qC)).then(t=>{t?.moveFocusToResults()})};function Bi(){return Bi=(0,S.Z)(function*(o){const e=o.get(F.AR);return e.activeEditor instanceof L?e.activeEditorPane.focusNextResult():Be(o.get(k.qC)).then(i=>{i?.selectNextMatch()})}),Bi.apply(this,arguments)}function Vi(){return Vi=(0,S.Z)(function*(o){const e=o.get(F.AR);return e.activeEditor instanceof L?e.activeEditorPane.focusPreviousResult():Be(o.get(k.qC)).then(i=>{i?.selectPreviousMatch()})}),Vi.apply(this,arguments)}function Hi(){return Hi=(0,S.Z)(function*(o,e){return Be(o.get(k.qC),!1).then(t=>{if(t){t.searchAndReplaceWidget.toggleReplace(e);const s=t.updateTextFromFindWidgetOrSelection({allowUnselectedWord:!e});t.searchAndReplaceWidget.focus(void 0,s,s)}})}),Hi.apply(this,arguments)}function Ki(o,e){const t=o.get(H.Ui),s=T(o.get(k.qC)),r=e?.viewer??s?.getControl();if(!r)return;const n=e?.element??r.getFocus()[0],a=mi(r,n??void 0,t.getValue("search"));let h,c=r.getFocus()[0];if((!c||c&&!(0,y.tJ)(c,a)||c instanceof y.lt)&&(c=n),0===a.length)return;c&&(h=hr(r,c,a));const u=s?.searchResult;u&&u.batchReplace(a),c&&(h||(h=ur(r,c)),h&&(r.reveal(h),r.setFocus([h],(0,de.gN)()),r.setSelection([h],(0,de.gN)()),h instanceof y.qE?!t.getValue().search.useReplacePreview||function ca(o,e){if(!(e instanceof y.qE))return!1;const i=o.get(F.AR).activeEditor?.resource;return!!i&&o.get(Gt.v).extUri.isEqual(i,e.parent().resource)}(o,h)||h instanceof y.YT?s?.open(h,!0):o.get(Ft.H).openReplacePreview(h,!0):h instanceof y.ut&&s?.open(h,!0))),r.domFocus()}function la(o,e){return o instanceof y.qE?e instanceof y.qE?0:-1:o instanceof y.ut?e instanceof y.qE?1:e instanceof y.ut?0:-1:e instanceof y.nA?0:1}function hr(o,e,t){const i=o.navigate(e);if(e instanceof y.nA)for(;i.next()&&(!(i.current()instanceof y.nA)||(0,y.tJ)(i.current(),t)););else if(e instanceof y.ut)for(;i.next()&&(!(i.current()instanceof y.ut)||(0,y.tJ)(i.current(),t));)o.expand(i.current());else for(;i.next()&&(!(i.current()instanceof y.qE)||(0,y.tJ)(i.current(),t));)o.expand(i.current());return i.current()}function ur(o,e){let t=o.lastVisibleElement??null;for(;t;){const i=la(e,t);if(-1===i)o.expand(t),t=o.lastVisibleElement;else{if(1!==i)return t;t=o.getParentElement(t)}}}var yt;(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.remove",title:{value:l.NC("RemoveAction.label","Dismiss"),original:"Dismiss"},category:M,icon:sn,keybinding:{weight:200,when:w.Ao.and(j,Ve),primary:20,mac:{primary:2049}},menu:[{id:f.eH.SearchContext,group:"search",order:2},{id:f.eH.SearchActionMenu,group:"inline",order:2}]})}run(e,t){const i=e.get(k.qC),s=e.get(H.Ui),r=T(i);if(!r)return;let n=t?.element,a=t?.viewer;a||(a=r.getControl()),n||(n=a.getFocus()[0]??void 0);const c=mi(a,n,s.getValue("search"));let u,h=a.getFocus()[0]??void 0;if(0===c.length)return;(!h||h instanceof y.lt)&&(h=n);const d=function Cn(o,e){return!!e&&(!e||o.includes(e)||function wn(o,e){for(const t of o)if(t instanceof y.ut&&e instanceof y.qE&&t.matches().includes(e)||t instanceof y.nA&&(e instanceof y.ut&&t.getDownstreamFileMatch(e.resource)||e instanceof y.qE&&t.getDownstreamFileMatch(e.parent().resource)))return!0;return!1}(o,e))}(c,h);h&&d&&(u=hr(a,h,c));const m=r.searchResult;m&&m.batchRemove(c),h&&d?(u||(u=ur(a,h)),u&&!(0,y.tJ)(u,c)&&(a.reveal(u),a.setFocus([u],(0,de.gN)()),a.setSelection([u],(0,de.gN)()))):(0,ie.fS)(a.getFocus(),a.getSelection())||a.setSelection(a.getFocus()),a.domFocus()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.replace",title:{value:l.NC("match.replace.label","Replace"),original:"Replace"},category:M,keybinding:{weight:200,when:w.Ao.and(j,ge,Ke,J),primary:3094},icon:ai,menu:[{id:f.eH.SearchContext,when:w.Ao.and(ge,Ke,J),group:"search",order:1},{id:f.eH.SearchActionMenu,when:w.Ao.and(ge,Ke,J),group:"inline",order:1}]})}run(e,t){return(0,S.Z)(function*(){return Ki(e,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.replaceAllInFile",title:{value:l.NC("file.replaceAll.label","Replace All"),original:"Replace All"},category:M,keybinding:{weight:200,when:w.Ao.and(j,ge,Me,J),primary:3094,secondary:[3075]},icon:ai,menu:[{id:f.eH.SearchContext,when:w.Ao.and(ge,Me,J),group:"search",order:1},{id:f.eH.SearchActionMenu,when:w.Ao.and(ge,Me,J),group:"inline",order:1}]})}run(e,t){return(0,S.Z)(function*(){return Ki(e,t)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.replaceAllInFolder",title:{value:l.NC("file.replaceAll.label","Replace All"),original:"Replace All"},category:M,keybinding:{weight:200,when:w.Ao.and(j,ge,He,J),primary:3094,secondary:[3075]},icon:ai,menu:[{id:f.eH.SearchContext,when:w.Ao.and(ge,He,J),group:"search",order:1},{id:f.eH.SearchActionMenu,when:w.Ao.and(ge,He,J),group:"inline",order:1}]})}run(e,t){return(0,S.Z)(function*(){return Ki(e,t)})()}}),(0,f.r1)(((yt=class Er extends f.Ke{constructor(){super({id:Ns,title:{value:l.NC("showTriggerActions","Go to Symbol in Workspace..."),original:"Go to Symbol in Workspace...",mnemonicTitle:l.NC({key:"miGotoSymbolInWorkspace",comment:["&& denotes a mnemonic"]},"Go to Symbol in &&Workspace...")},f1:!0,keybinding:{weight:200,primary:2098},menu:{id:f.eH.MenubarGoMenu,group:"3_global_nav",order:2}})}run(e){return(0,S.Z)(function*(){e.get(ue.eJ).quickAccess.show(Er.ALL_SYMBOLS_PREFIX)})()}}).ID="workbench.action.showAllSymbols",yt.LABEL=l.NC("showTriggerActions","Go to Symbol in Workspace..."),yt.ALL_SYMBOLS_PREFIX="#",yt)),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.clearHistory",title:{value:l.NC("clearSearchHistoryLabel","Clear Search History"),original:"Clear Search History"},category:M,f1:!0})}run(e){return(0,S.Z)(function*(){ha(e)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.cancel",title:{value:l.NC("CancelSearchAction.label","Cancel Search"),original:"Cancel Search"},icon:ln,category:M,f1:!0,precondition:q.Y0.isEqualTo(q.Ps.Idle).negate(),keybinding:{weight:200,when:w.Ao.and(j,de.CQ),primary:9},menu:[{id:f.eH.ViewTitle,group:"navigation",order:0,when:w.Ao.and(w.Ao.equals("view",A.nn),q.Y0.isEqualTo(q.Ps.SlowSearch))}]})}run(e){return function ga(o){const e=o.get(k.qC);T(e)?.cancelSearch()}(e)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.refreshSearchResults",title:{value:l.NC("RefreshAction.label","Refresh"),original:"Refresh"},icon:ys,precondition:yi,category:M,f1:!0,menu:[{id:f.eH.ViewTitle,group:"navigation",order:0,when:w.Ao.and(w.Ao.equals("view",A.nn),q.Y0.isEqualTo(q.Ps.SlowSearch).negate())}]})}run(e,...t){return function pa(o){const e=o.get(k.qC);T(e)?.triggerQueryChange({preserveFocus:!1})}(e)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.collapseSearchResults",title:{value:l.NC("CollapseDeepestExpandedLevelAction.label","Collapse All"),original:"Collapse All"},category:M,icon:rn,f1:!0,precondition:w.Ao.and(re,ht),menu:[{id:f.eH.ViewTitle,group:"navigation",order:3,when:w.Ao.and(w.Ao.equals("view",A.nn),w.Ao.or(re.negate(),ht))}]})}run(e,...t){return function fa(o){const t=T(o.get(k.qC));if(t){const i=t.getControl(),s=i.navigate();let r=s.first(),n=!1,a=!1;if(r instanceof y.m5||t.isTreeLayoutViewVisible)for(;r=s.next();){if(r instanceof y.qE){n=!0;break}if(t.isTreeLayoutViewVisible&&!a){let h=r;if(r instanceof y.nA){const d=i.getCompressedTreeNode(r).element?.elements[0];h=!d||d instanceof y.qE?r:d}const u=h.parent();u instanceof y.m5||u instanceof y.uN||u instanceof y.lt||(a=!0)}}if(n){r=s.first();do{r instanceof y.ut&&i.collapse(r)}while(r=s.next())}else if(a){if(r=s.first(),r)do{let h=r;if(r instanceof y.nA){const d=i.getCompressedTreeNode(r).element?.elements[0];h=!d||d instanceof y.qE?r:d}const u=h.parent();(u instanceof y.m5||u instanceof y.uN)&&(i.hasElement(r)?i.collapse(r,!0):i.collapseAll())}while(r=s.next())}else i.collapseAll();const c=i.getFocus()[0]?.parent();c&&(c instanceof y.nA||c instanceof y.ut)&&i.hasElement(c)&&i.isCollapsed(c)&&(i.domFocus(),i.focusFirst(),i.setSelection(i.getFocus()))}}(e)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.expandSearchResults",title:{value:l.NC("ExpandAllAction.label","Expand All"),original:"Expand All"},category:M,icon:nn,f1:!0,precondition:w.Ao.and(re,ht.toNegated()),menu:[{id:f.eH.ViewTitle,group:"navigation",order:3,when:w.Ao.and(w.Ao.equals("view",A.nn),re,ht.toNegated())}]})}run(e,...t){return function ua(o){const t=T(o.get(k.qC));t&&t.getControl().expandAll()}(e)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.clearSearchResults",title:{value:l.NC("ClearSearchResultsAction.label","Clear Search Results"),original:"Clear Search Results"},category:M,icon:cn,f1:!0,precondition:w.Ao.or(re,yi,Ds,Bs),menu:[{id:f.eH.ViewTitle,group:"navigation",order:1,when:w.Ao.equals("view",A.nn)}]})}run(e,...t){return function da(o){const e=o.get(k.qC);T(e)?.clearSearchResults()}(e)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.viewAsTree",title:{value:l.NC("ViewAsTreeAction.label","View as Tree"),original:"View as Tree"},category:M,icon:an,f1:!0,precondition:w.Ao.and(re,ut.toNegated()),menu:[{id:f.eH.ViewTitle,group:"navigation",order:2,when:w.Ao.and(w.Ao.equals("view",A.nn),ut.toNegated())}]})}run(e,...t){const i=T(e.get(k.qC));i&&i.setTreeView(!0)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.viewAsList",title:{value:l.NC("ViewAsListAction.label","View as List"),original:"View as List"},category:M,icon:on,f1:!0,precondition:w.Ao.and(re,ut),menu:[{id:f.eH.ViewTitle,group:"navigation",order:2,when:w.Ao.and(w.Ao.equals("view",A.nn),ut)}]})}run(e,...t){const i=T(e.get(k.qC));i&&i.setTreeView(!1)}});const ha=o=>{o.get(Rt.c).clearHistory()};(function _r(){Re.B.as(ms.I.Workbench).registerWorkbenchContribution(Xt,1)})(),function Ro(){uo.W.registerCommandAndKeybindingRule({id:Qt.ID,weight:200,when:w.Ao.and(j,ge,Pe.VO),primary:2563,handler:o=>{const e=o.get(k.qC);if(function yn(o){const e=T(o),t=document.activeElement;return!!(e&&t&&v.jg(t,e.getContainer()))}(e)){const t=T(e);t&&new Qt(t.searchAndReplaceWidget).run()}}})}();const dr=Re.B.as(k.IP.ViewContainersRegistry).registerViewContainer({id:A.f3,title:{value:l.NC("name","Search"),original:"Search"},ctorDescriptor:new ne.M(Nr.XV,[A.f3,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,icon:Cs,order:1},0,{doNotRegisterOpenCommand:!0}),va={id:A.nn,containerIcon:Cs,name:l.NC("search","Search"),ctorDescriptor:new ne.M(Zt),canToggleVisibility:!1,canMoveView:!0,openCommandActionDescriptor:{id:dr.id,mnemonicTitle:l.NC({key:"miViewSearch",comment:["&& denotes a mnemonic"]},"&&Search"),keybindings:{primary:3108,when:w.Ao.regex("neverMatch",/doesNotMatch/)},order:1}};Re.B.as(k.IP.ViewsRegistry).registerViews([va],dr);const gr=Re.B.as(jt.IP.Quickaccess);gr.registerQuickAccessProvider({ctor:we,prefix:we.PREFIX,placeholder:l.NC("anythingQuickAccessPlaceholder","Search files by name (append {0} to go to line or {1} to go to symbol)",Ar.q.PREFIX,se.PREFIX),contextKey:Lr.Id,helpEntries:[{description:l.NC("anythingQuickAccess","Go to File"),commandId:"workbench.action.quickOpen"}]}),gr.registerQuickAccessProvider({ctor:ke,prefix:ke.PREFIX,placeholder:l.NC("symbolsQuickAccessPlaceholder","Type the name of a symbol to open."),contextKey:"inWorkspaceSymbolsPicker",helpEntries:[{description:l.NC("symbolsQuickAccess","Go to Symbol in Workspace"),commandId:Ns}]}),Re.B.as(Tr.IP.Configuration).registerConfiguration({id:"search",order:13,title:l.NC("searchConfigurationTitle","Search"),type:"object",properties:{[A.XG]:{type:"object",markdownDescription:l.NC("exclude","Configure [glob patterns](https://code.visualstudio.com/docs/editor/codebasics#_advanced-search-options) for excluding files and folders in fulltext searches and quick open. Inherits all glob patterns from the `#files.exclude#` setting."),default:{"**/node_modules":!0,"**/bower_components":!0,"**/*.code-search":!0},additionalProperties:{anyOf:[{type:"boolean",description:l.NC("exclude.boolean","The glob pattern to match file paths against. Set to true or false to enable or disable the pattern.")},{type:"object",properties:{when:{type:"string",pattern:"\\w*\\$\\(basename\\)\\w*",default:"$(basename).ext",markdownDescription:l.NC({key:"exclude.when",comment:["\\$(basename) should not be translated"]},"Additional check on the siblings of a matching file. Use \\$(basename) as variable for the matching file name.")}}}]},scope:4},"search.mode":{type:"string",enum:["view","reuseEditor","newEditor"],default:"view",markdownDescription:l.NC("search.mode","Controls where new `Search: Find in Files` and `Find in Folder` operations occur: either in the search view, or in a search editor."),enumDescriptions:[l.NC("search.mode.view","Search in the search view, either in the panel or side bars."),l.NC("search.mode.reuseEditor","Search in an existing search editor if present, otherwise in a new search editor."),l.NC("search.mode.newEditor","Search in a new search editor.")]},"search.useRipgrep":{type:"boolean",description:l.NC("useRipgrep",'This setting is deprecated and now falls back on "search.usePCRE2".'),deprecationMessage:l.NC("useRipgrepDeprecated",'Deprecated. Consider "search.usePCRE2" for advanced regex feature support.'),default:!0},"search.maintainFileSearchCache":{type:"boolean",deprecationMessage:l.NC("maintainFileSearchCacheDeprecated","The search cache is kept in the extension host which never shuts down, so this setting is no longer needed."),description:l.NC("search.maintainFileSearchCache","When enabled, the searchService process will be kept alive instead of being shut down after an hour of inactivity. This will keep the file search cache in memory."),default:!1},"search.useIgnoreFiles":{type:"boolean",markdownDescription:l.NC("useIgnoreFiles","Controls whether to use `.gitignore` and `.ignore` files when searching for files."),default:!0,scope:4},"search.useGlobalIgnoreFiles":{type:"boolean",markdownDescription:l.NC("useGlobalIgnoreFiles","Controls whether to use your global gitignore file (e.g., from `$HOME/.config/git/ignore`) when searching for files. Requires `#search.useIgnoreFiles#` to be enabled."),default:!1,scope:4},"search.useParentIgnoreFiles":{type:"boolean",markdownDescription:l.NC("useParentIgnoreFiles","Controls whether to use `.gitignore` and `.ignore` files in parent directories when searching for files. Requires `#search.useIgnoreFiles#` to be enabled."),default:!1,scope:4},"search.quickOpen.includeSymbols":{type:"boolean",description:l.NC("search.quickOpen.includeSymbols","Whether to include results from a global symbol search in the file results for Quick Open."),default:!1},"search.quickOpen.includeHistory":{type:"boolean",description:l.NC("search.quickOpen.includeHistory","Whether to include results from recently opened files in the file results for Quick Open."),default:!0},"search.quickOpen.history.filterSortOrder":{type:"string",enum:["default","recency"],default:"default",enumDescriptions:[l.NC("filterSortOrder.default","History entries are sorted by relevance based on the filter value used. More relevant entries appear first."),l.NC("filterSortOrder.recency","History entries are sorted by recency. More recently opened entries appear first.")],description:l.NC("filterSortOrder","Controls sorting order of editor history in quick open when filtering.")},"search.followSymlinks":{type:"boolean",description:l.NC("search.followSymlinks","Controls whether to follow symlinks while searching."),default:!0},"search.smartCase":{type:"boolean",description:l.NC("search.smartCase","Search case-insensitively if the pattern is all lowercase, otherwise, search case-sensitively."),default:!1},"search.globalFindClipboard":{type:"boolean",default:!1,description:l.NC("search.globalFindClipboard","Controls whether the search view should read or modify the shared find clipboard on macOS."),included:Ne.dz},"search.location":{type:"string",enum:["sidebar","panel"],default:"sidebar",description:l.NC("search.location","Controls whether the search will be shown as a view in the sidebar or as a panel in the panel area for more horizontal space."),deprecationMessage:l.NC("search.location.deprecationMessage","This setting is deprecated. You can drag the search icon to a new location instead.")},"search.maxResults":{type:["number","null"],default:2e4,markdownDescription:l.NC("search.maxResults","Controls the maximum number of search results, this can be set to `null` (empty) to return unlimited results.")},"search.collapseResults":{type:"string",enum:["auto","alwaysCollapse","alwaysExpand"],enumDescriptions:[l.NC("search.collapseResults.auto","Files with less than 10 results are expanded. Others are collapsed."),"",""],default:"alwaysExpand",description:l.NC("search.collapseAllResults","Controls whether the search results will be collapsed or expanded.")},"search.useReplacePreview":{type:"boolean",default:!0,description:l.NC("search.useReplacePreview","Controls whether to open Replace Preview when selecting or replacing a match.")},"search.showLineNumbers":{type:"boolean",default:!1,description:l.NC("search.showLineNumbers","Controls whether to show line numbers for search results.")},"search.usePCRE2":{type:"boolean",default:!1,description:l.NC("search.usePCRE2","Whether to use the PCRE2 regex engine in text search. This enables using some advanced regex features like lookahead and backreferences. However, not all PCRE2 features are supported - only features that are also supported by JavaScript."),deprecationMessage:l.NC("usePCRE2Deprecated","Deprecated. PCRE2 will be used automatically when using regex features that are only supported by PCRE2.")},"search.actionsPosition":{type:"string",enum:["auto","right"],enumDescriptions:[l.NC("search.actionsPositionAuto","Position the actionbar to the right when the search view is narrow, and immediately after the content when the search view is wide."),l.NC("search.actionsPositionRight","Always position the actionbar to the right.")],default:"right",description:l.NC("search.actionsPosition","Controls the positioning of the actionbar on rows in the search view.")},"search.searchOnType":{type:"boolean",default:!0,description:l.NC("search.searchOnType","Search all files as you type.")},"search.seedWithNearestWord":{type:"boolean",default:!1,description:l.NC("search.seedWithNearestWord","Enable seeding search from the word nearest the cursor when the active editor has no selection.")},"search.seedOnFocus":{type:"boolean",default:!1,markdownDescription:l.NC("search.seedOnFocus","Update the search query to the editor's selected text when focusing the search view. This happens either on click or when triggering the `workbench.views.search.focus` command.")},"search.searchOnTypeDebouncePeriod":{type:"number",default:300,markdownDescription:l.NC("search.searchOnTypeDebouncePeriod","When {0} is enabled, controls the timeout in milliseconds between a character being typed and the search starting. Has no effect when {0} is disabled.","`#search.searchOnType#`")},"search.searchEditor.doubleClickBehaviour":{type:"string",enum:["selectWord","goToLocation","openLocationToSide"],default:"goToLocation",enumDescriptions:[l.NC("search.searchEditor.doubleClickBehaviour.selectWord","Double-clicking selects the word under the cursor."),l.NC("search.searchEditor.doubleClickBehaviour.goToLocation","Double-clicking opens the result in the active editor group."),l.NC("search.searchEditor.doubleClickBehaviour.openLocationToSide","Double-clicking opens the result in the editor group to the side, creating one if it does not yet exist.")],markdownDescription:l.NC("search.searchEditor.doubleClickBehaviour","Configure effect of double-clicking a result in a search editor.")},"search.searchEditor.reusePriorSearchConfiguration":{type:"boolean",default:!1,markdownDescription:l.NC({key:"search.searchEditor.reusePriorSearchConfiguration",comment:['"Search Editor" is a type of editor that can display search results. "includes, excludes, and flags" refers to the "files to include" and "files to exclude" input boxes, and the flags that control whether a query is case-sensitive or a regex.']},"When enabled, new Search Editors will reuse the includes, excludes, and flags of the previously opened Search Editor.")},"search.searchEditor.defaultNumberOfContextLines":{type:["number","null"],default:1,markdownDescription:l.NC("search.searchEditor.defaultNumberOfContextLines","The default number of surrounding context lines to use when creating new Search Editors. If using `#search.searchEditor.reusePriorSearchConfiguration#`, this can be set to `null` (empty) to use the prior Search Editor's configuration.")},"search.sortOrder":{type:"string",enum:["default","fileNames","type","modified","countDescending","countAscending"],default:"default",enumDescriptions:[l.NC("searchSortOrder.default","Results are sorted by folder and file names, in alphabetical order."),l.NC("searchSortOrder.filesOnly","Results are sorted by file names ignoring folder order, in alphabetical order."),l.NC("searchSortOrder.type","Results are sorted by file extensions, in alphabetical order."),l.NC("searchSortOrder.modified","Results are sorted by file last modified date, in descending order."),l.NC("searchSortOrder.countDescending","Results are sorted by count per file, in descending order."),l.NC("searchSortOrder.countAscending","Results are sorted by count per file, in ascending order.")],description:l.NC("search.sortOrder","Controls sorting order of search results.")},"search.decorations.colors":{type:"boolean",description:l.NC("search.decorations.colors","Controls whether search file decorations should use colors."),default:!0},"search.decorations.badges":{type:"boolean",description:l.NC("search.decorations.badges","Controls whether search file decorations should use badges."),default:!0},"search.defaultViewMode":{type:"string",enum:["tree","list"],default:"list",enumDescriptions:[l.NC("scm.defaultViewMode.tree","Shows search results as a tree."),l.NC("scm.defaultViewMode.list","Shows search results as a list.")],description:l.NC("search.defaultViewMode","Controls the default search result view mode.")}}}),Oe.P.registerCommand("_executeWorkspaceSymbolProvider",function(){var o=(0,S.Z)(function*(e,...t){const[i]=t;return(0,Q.p_)("string"==typeof i),(yield(0,q.$g)(i)).map(r=>r.symbol)});return function(e){return o.apply(this,arguments)}}());var Sa=p(73533),pr=p(86682),Ct=p(46740),ya=p(40411),Ca=p(13266),wt=p(66179),wa=p(57669),xa=p(38356),ba=p(21781);const Ea=/^(\s+)(\d+)(: |  )(\s*)(.*)$/,Ia=/^(\S.*):$/;let Ze=class Ir extends wa.e{get searchResultEditor(){return this.editorControl}constructor(e,t,i,s,r,n,a,c,h,u,d,m,C,b,x,I,R,E){super(Ir.ID,e,a,i,C,t,x,b,R),this.modelService=s,this.contextService=r,this.labelService=n,this.contextViewService=c,this.commandService=h,this.openerService=u,this.notificationService=d,this.configurationService=I,this.logService=E,this.runSearchDelayer=new X.vp(0),this.pauseSearching=!1,this.showingIncludesExcludes=!1,this.ongoingOperations=0,this.updatingModelForSearch=!1,this.container=v.$(".search-editor"),this.searchOperation=this._register(new ui.nR(m)),this._register(this.messageDisposables=new P.SL),this.searchHistoryDelayer=new X.vp(2e3),this.searchModel=this._register(this.instantiationService.createInstance(y.hU))}createEditor(e){v.R3(e,this.container),this.queryEditorContainer=v.R3(this.container,v.$(".query-container"));const t=v.R3(this.container,v.$(".search-results"));super.createEditor(t),this.registerEditorListeners();const i=(0,Q.cW)(this.scopedContextKeyService);U.bindTo(i).set(!0),this.createQueryEditor(this.queryEditorContainer,this.instantiationService.createChild(new ot.y([w.i6,i])),Je.bindTo(i))}createQueryEditor(e,t,i){const s=(0,ce.tJ)({inputBorder:Ra});this.queryEditorWidget=this._register(t.createInstance(Qe,e,{_hideReplaceToggle:!0,showContextToggle:!0,inputBoxStyles:s,toggleStyles:ce.pl})),this._register(this.queryEditorWidget.onReplaceToggled(()=>this.reLayout())),this._register(this.queryEditorWidget.onDidHeightChange(()=>this.reLayout())),this._register(this.queryEditorWidget.onSearchSubmit(({delay:h})=>this.triggerSearch({delay:h}))),this.queryEditorWidget.searchInput?this._register(this.queryEditorWidget.searchInput.onDidOptionChange(()=>this.triggerSearch({resetCursor:!1}))):this.logService.warn("SearchEditor: SearchWidget.searchInput is undefined, cannot register onDidOptionChange listener"),this._register(this.queryEditorWidget.onDidToggleContext(()=>this.triggerSearch({resetCursor:!1}))),this.includesExcludesContainer=v.R3(e,v.$(".includes-excludes")),this.toggleQueryDetailsButton=v.R3(this.includesExcludesContainer,v.$(".expand"+G.kS.asCSSSelector(vs),{tabindex:0,role:"button",title:(0,l.NC)("moreSearch","Toggle Search Details")})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.CLICK,h=>{v.zB.stop(h),this.toggleIncludesExcludes()})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.KEY_UP,h=>{const u=new nt.y1(h);(u.equals(3)||u.equals(10))&&(v.zB.stop(h),this.toggleIncludesExcludes())})),this._register(v.nm(this.toggleQueryDetailsButton,v.tw.KEY_DOWN,h=>{new nt.y1(h).equals(1026)&&(this.queryEditorWidget.isReplaceActive()?this.queryEditorWidget.focusReplaceAllAction():this.queryEditorWidget.isReplaceShown()?this.queryEditorWidget.replaceInput?.focusOnPreserve():this.queryEditorWidget.focusRegexAction(),v.zB.stop(h))}));const r=v.R3(this.includesExcludesContainer,v.$(".file-types.includes")),n=(0,l.NC)("searchScope.includes","files to include");v.R3(r,v.$("h4",void 0,n)),this.inputPatternIncludes=this._register(t.createInstance(Dt,r,this.contextViewService,{ariaLabel:(0,l.NC)("label.includes","Search Include Patterns"),inputBoxStyles:s})),this.inputPatternIncludes.onSubmit(h=>this.triggerSearch({resetCursor:!1,delay:h?this.searchConfig.searchOnTypeDebouncePeriod:0})),this._register(this.inputPatternIncludes.onChangeSearchInEditorsBox(()=>this.triggerSearch()));const a=v.R3(this.includesExcludesContainer,v.$(".file-types.excludes")),c=(0,l.NC)("searchScope.excludes","files to exclude");v.R3(a,v.$("h4",void 0,c)),this.inputPatternExcludes=this._register(t.createInstance(Bt,a,this.contextViewService,{ariaLabel:(0,l.NC)("label.excludes","Search Exclude Patterns"),inputBoxStyles:s})),this.inputPatternExcludes.onSubmit(h=>this.triggerSearch({resetCursor:!1,delay:h?this.searchConfig.searchOnTypeDebouncePeriod:0})),this._register(this.inputPatternExcludes.onChangeIgnoreBox(()=>this.triggerSearch())),this.messageBox=v.R3(e,v.$(".messages.text-search-provider-messages")),[this.queryEditorWidget.searchInputFocusTracker,this.queryEditorWidget.replaceInputFocusTracker,this.inputPatternExcludes.inputFocusTracker,this.inputPatternIncludes.inputFocusTracker].forEach(h=>{h&&(this._register(h.onDidFocus(()=>setTimeout(()=>i.set(!0),0))),this._register(h.onDidBlur(()=>i.set(!1))))})}toggleRunAgainMessage(e){var t=this;if(v.PO(this.messageBox),this.messageDisposables.clear(),e){const i=v.R3(this.messageBox,v.$("a.pointer.prominent.message",{},(0,l.NC)("runSearch","Run Search")));this.messageDisposables.add(v.nm(i,v.tw.CLICK,(0,S.Z)(function*(){yield t.triggerSearch(),t.searchResultEditor.focus()})))}}_getContributions(){const e=[ba.UnusualLineTerminatorsDetector.ID];return xa.Uc.getEditorContributions().filter(t=>-1===e.indexOf(t.id))}getCodeEditorWidgetOptions(){return{contributions:this._getContributions()}}registerEditorListeners(){this.searchResultEditor.onMouseUp(e=>{if(2===e.event.detail){const t=this.searchConfig.searchEditor.doubleClickBehaviour,i=e.target.position;if(i&&"selectWord"!==t){const s=this.searchResultEditor.getModel()?.getLineContent(i.lineNumber)??"";s.match(Ea)?(this.searchResultEditor.setSelection(ve.e.fromPositions(i)),this.commandService.executeCommand("goToLocation"===t?"editor.action.goToDeclaration":"editor.action.openDeclarationToTheSide")):s.match(Ia)&&(this.searchResultEditor.setSelection(ve.e.fromPositions(i)),this.commandService.executeCommand("editor.action.peekDefinition"))}}}),this._register(this.searchResultEditor.onDidChangeModelContent(()=>{this.updatingModelForSearch||this.getInput()?.setDirty(!0)}))}getControl(){return this.searchResultEditor}focus(){const e=this.loadEditorViewState(this.getInput());e&&"editor"===e.focused?this.searchResultEditor.focus():this.queryEditorWidget.focus()}focusSearchInput(){this.queryEditorWidget.searchInput?.focus()}focusFilesToIncludeInput(){this.showingIncludesExcludes||this.toggleIncludesExcludes(!0),this.inputPatternIncludes.focus()}focusFilesToExcludeInput(){this.showingIncludesExcludes||this.toggleIncludesExcludes(!0),this.inputPatternExcludes.focus()}focusNextInput(){this.queryEditorWidget.searchInputHasFocus()?this.showingIncludesExcludes?this.inputPatternIncludes.focus():this.searchResultEditor.focus():this.inputPatternIncludes.inputHasFocus()?this.inputPatternExcludes.focus():this.inputPatternExcludes.inputHasFocus()?this.searchResultEditor.focus():this.searchResultEditor.hasWidgetFocus()}focusPrevInput(){this.queryEditorWidget.searchInputHasFocus()?this.searchResultEditor.focus():this.inputPatternIncludes.inputHasFocus()?this.queryEditorWidget.searchInput?.focus():this.inputPatternExcludes.inputHasFocus()?this.inputPatternIncludes.focus():this.searchResultEditor.hasWidgetFocus()}setQuery(e){this.queryEditorWidget.searchInput?.setValue(e)}selectQuery(){this.queryEditorWidget.searchInput?.select()}toggleWholeWords(){this.queryEditorWidget.searchInput?.setWholeWords(!this.queryEditorWidget.searchInput.getWholeWords()),this.triggerSearch({resetCursor:!1})}toggleRegex(){this.queryEditorWidget.searchInput?.setRegex(!this.queryEditorWidget.searchInput.getRegex()),this.triggerSearch({resetCursor:!1})}toggleCaseSensitive(){this.queryEditorWidget.searchInput?.setCaseSensitive(!this.queryEditorWidget.searchInput.getCaseSensitive()),this.triggerSearch({resetCursor:!1})}toggleContextLines(){this.queryEditorWidget.toggleContextLines()}modifyContextLines(e){this.queryEditorWidget.modifyContextLines(e)}toggleQueryDetails(){this.toggleIncludesExcludes()}deleteResultBlock(){const e=new Set,t=this.searchResultEditor.getSelections(),i=this.searchResultEditor.getModel();if(!t||!i)return;const s=i.getLineCount(),n=u=>{for(let d=u;d>=1;d--){const m=i.getLineContent(d);if(e.add(d),void 0!==m[0]&&" "!==m[0])break}},a=u=>{e.add(u);for(let d=u+1;d<=s;d++){const m=i.getLineContent(d);if(void 0!==m[0]&&" "!==m[0])return d;e.add(d)}},c=[];for(const u of t){const d=u.startLineNumber;c.push(a(d)),n(d);for(let m=u.startLineNumber;m<=u.endLineNumber;m++)e.add(m)}0===c.length&&c.push(1);const h=u=>void 0!==u;i.pushEditOperations(this.searchResultEditor.getSelections(),[...e].map(u=>({range:new ve.e(u,1,u+1,1),text:""})),()=>c.filter(h).map(u=>new li.Y(u,1,u,1)))}cleanState(){this.getInput()?.setDirty(!1)}get searchConfig(){return this.configurationService.getValue("search")}iterateThroughMatches(e){const t=this.searchResultEditor.getModel();if(!t)return;const i=t.getLineCount()??1,s=t.getLineLength(i),r=e?new Ct.L(i,s):new Ct.L(1,1),n=this.searchResultEditor.getSelection()?.getStartPosition()??r,a=this.getInput()?.getMatchRanges();if(!a)return;const c=(e?ka:Fa)(a,n);this.searchResultEditor.setSelection(c),this.searchResultEditor.revealLineInCenterIfOutsideViewport(c.startLineNumber),this.searchResultEditor.focus();const h=t.getLineContent(c.startLineNumber),u=t.getValueInRange(c);let d="";for(let m=c.startLineNumber;m>=1;m--)if(" "!==t.getValueInRange(new ve.e(m,1,m,2))){d=t.getLineContent(m);break}(0,Ye.Z9)((0,l.NC)("searchResultItem","Matched {0} at {1} in file {2}",u,h,d.slice(0,d.length-1)))}focusNextResult(){this.iterateThroughMatches(!1)}focusPreviousResult(){this.iterateThroughMatches(!0)}focusAllResults(){this.searchResultEditor.setSelections((this.getInput()?.getMatchRanges()??[]).map(e=>new li.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn))),this.searchResultEditor.focus()}triggerSearch(e){var t=this;return(0,S.Z)(function*(){const i={resetCursor:!0,delay:0,...e};t.pauseSearching||(yield t.runSearchDelayer.trigger((0,S.Z)(function*(){t.toggleRunAgainMessage(!1),yield t.doRunSearch(),i.resetCursor&&(t.searchResultEditor.setPosition(new Ct.L(1,1)),t.searchResultEditor.setScrollPosition({scrollTop:0,scrollLeft:0})),i.focusResults&&t.searchResultEditor.focus()}),i.delay))})()}readConfigFromWidget(){return{isCaseSensitive:this.queryEditorWidget.searchInput?.getCaseSensitive()??!1,contextLines:this.queryEditorWidget.getContextLines(),filesToExclude:this.inputPatternExcludes.getValue(),filesToInclude:this.inputPatternIncludes.getValue(),query:this.queryEditorWidget.searchInput?.getValue()??"",isRegexp:this.queryEditorWidget.searchInput?.getRegex()??!1,matchWholeWord:this.queryEditorWidget.searchInput?.getWholeWords()??!1,useExcludeSettingsAndIgnoreFiles:this.inputPatternExcludes.useExcludesAndIgnoreFiles(),onlyOpenEditors:this.inputPatternIncludes.onlySearchInOpenEditors(),showIncludesExcludes:this.showingIncludesExcludes,notebookSearchConfig:{includeMarkupInput:this.queryEditorWidget.getNotebookFilters().markupInput,includeMarkupPreview:this.queryEditorWidget.getNotebookFilters().markupPreview,includeCodeInput:this.queryEditorWidget.getNotebookFilters().codeInput,includeOutput:this.queryEditorWidget.getNotebookFilters().codeOutput}}}doRunSearch(){var e=this;return(0,S.Z)(function*(){e.searchModel.cancelSearch(!0);const t=e.getInput();if(!t)return;e.searchHistoryDelayer.trigger(()=>{e.queryEditorWidget.searchInput?.onSearchSubmit(),e.inputPatternExcludes.onSearchSubmit(),e.inputPatternIncludes.onSearchSubmit()});const i=e.readConfigFromWidget();if(!i.query)return;const s={pattern:i.query,isRegExp:i.isRegexp,isCaseSensitive:i.isCaseSensitive,isWordMatch:i.matchWholeWord},r={_reason:"searchEditor",extraFileResources:e.instantiationService.invokeFunction(q.ek),maxResults:(0,Q.f6)(e.searchConfig.maxResults),disregardIgnoreFiles:!i.useExcludeSettingsAndIgnoreFiles||void 0,disregardExcludeSettings:!i.useExcludeSettingsAndIgnoreFiles||void 0,excludePattern:i.filesToExclude,includePattern:i.filesToInclude,onlyOpenEditors:i.onlyOpenEditors,previewOptions:{matchLines:1,charsPerLine:1e3},afterContext:i.contextLines,beforeContext:i.contextLines,isSmartCase:e.searchConfig.smartCase,expandPatterns:!0,notebookSearchConfig:{includeMarkupInput:i.notebookSearchConfig.includeMarkupInput,includeMarkupPreview:i.notebookSearchConfig.includeMarkupPreview,includeCodeInput:i.notebookSearchConfig.includeCodeInput,includeOutput:i.notebookSearchConfig.includeOutput}},n=e.contextService.getWorkspace().folders;let a;try{a=e.instantiationService.createInstance(Nt.z).text(s,n.map(d=>d.uri),r)}catch{return}e.searchOperation.start(500),e.ongoingOperations++;const{configurationModel:c}=yield t.resolveModels();c.updateConfig(i),t.ongoingSearchOperation=e.searchModel.search(a).finally(()=>{e.ongoingOperations--,0===e.ongoingOperations&&e.searchOperation.stop()});const h=yield t.ongoingSearchOperation;yield e.onSearchComplete(h,i,t)})()}onSearchComplete(e,t,i){var s=this;return(0,S.Z)(function*(){const r=s.getInput();if(!r||r!==i||JSON.stringify(t)!==JSON.stringify(s.readConfigFromWidget()))return;r.ongoingSearchOperation=void 0;const n=s.searchConfig.sortOrder;"modified"===n&&(yield s.retrieveFileStats(s.searchModel.searchResult)),Ca.J.get(s.searchResultEditor)?.closeWidget(!1);const h=Js(s.searchModel.searchResult,t.filesToInclude,t.filesToExclude,t.contextLines,d=>s.labelService.getUriLabel(d,{relative:!0}),n,e?.limitHit),{resultsModel:u}=yield r.resolveModels();if(s.updatingModelForSearch=!0,s.modelService.updateModel(u,h.text),s.updatingModelForSearch=!1,e&&e.messages)for(const d of e.messages)s.addMessage(d);s.reLayout(),r.setDirty(!r.hasCapability(4)),r.setMatchRanges(h.matchRanges)})()}addMessage(e){let t;t=this.messageBox.firstChild?this.messageBox.firstChild:v.R3(this.messageBox,v.$(".message")),v.R3(t,Rs(e,this.instantiationService,this.notificationService,this.openerService,this.commandService,this.messageDisposables,()=>this.triggerSearch()))}retrieveFileStats(e){var t=this;return(0,S.Z)(function*(){const i=e.matches().filter(s=>!s.fileStat).map(s=>s.resolveFileStat(t.fileService));yield Promise.all(i)})()}layout(e){this.dimension=e,this.reLayout()}getSelected(){const e=this.searchResultEditor.getSelection();return e?this.searchResultEditor.getModel()?.getValueInRange(e)??"":""}reLayout(){this.dimension&&(this.queryEditorWidget.setWidth(this.dimension.width-28),this.searchResultEditor.layout({height:this.dimension.height-v.wn(this.queryEditorContainer),width:this.dimension.width}),this.inputPatternExcludes.setWidth(this.dimension.width-28),this.inputPatternIncludes.setWidth(this.dimension.width-28))}getInput(){return this._input}setSearchConfig(e){this.priorConfig=e,void 0!==e.query&&this.queryEditorWidget.setValue(e.query),void 0!==e.isCaseSensitive&&this.queryEditorWidget.searchInput?.setCaseSensitive(e.isCaseSensitive),void 0!==e.isRegexp&&this.queryEditorWidget.searchInput?.setRegex(e.isRegexp),void 0!==e.matchWholeWord&&this.queryEditorWidget.searchInput?.setWholeWords(e.matchWholeWord),void 0!==e.contextLines&&this.queryEditorWidget.setContextLines(e.contextLines),void 0!==e.filesToExclude&&this.inputPatternExcludes.setValue(e.filesToExclude),void 0!==e.filesToInclude&&this.inputPatternIncludes.setValue(e.filesToInclude),void 0!==e.onlyOpenEditors&&this.inputPatternIncludes.setOnlySearchInOpenEditors(e.onlyOpenEditors),void 0!==e.useExcludeSettingsAndIgnoreFiles&&this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(e.useExcludeSettingsAndIgnoreFiles),void 0!==e.showIncludesExcludes&&this.toggleIncludesExcludes(e.showIncludesExcludes)}setInput(e,t,i,s){var r=()=>super.setInput,n=this;return(0,S.Z)(function*(){if(yield r().call(n,e,t,i,s),s.isCancellationRequested)return;const{configurationModel:a,resultsModel:c}=yield e.resolveModels();if(!s.isCancellationRequested&&(n.searchResultEditor.setModel(c),n.pauseSearching=!0,n.toggleRunAgainMessage(!e.ongoingSearchOperation&&1===c.getLineCount()&&""===c.getValue()&&""!==a.config.query),n.setSearchConfig(a.config),n._register(a.onConfigDidUpdate(h=>{h!==n.priorConfig&&(n.pauseSearching=!0,n.setSearchConfig(h),n.pauseSearching=!1)})),n.restoreViewState(i),t?.preserveFocus||n.focus(),n.pauseSearching=!1,e.ongoingSearchOperation)){const h=n.readConfigFromWidget();e.ongoingSearchOperation.then(u=>{n.onSearchComplete(u,h,e)})}})()}toggleIncludesExcludes(e){const t="expanded";e??!this.includesExcludesContainer.classList.contains(t)?(this.toggleQueryDetailsButton.setAttribute("aria-expanded","true"),this.includesExcludesContainer.classList.add(t)):(this.toggleQueryDetailsButton.setAttribute("aria-expanded","false"),this.includesExcludesContainer.classList.remove(t)),this.showingIncludesExcludes=this.includesExcludesContainer.classList.contains(t),this.reLayout()}toEditorViewStateResource(e){if(e.typeId===bi)return e.modelUri}computeEditorViewState(e){const i=this.getControl().saveViewState();if(i&&e.toString()===this.getInput()?.modelUri.toString())return{...i,focused:this.searchResultEditor.hasWidgetFocus()?"editor":"input"}}tracksEditorViewState(e){return e.typeId===bi}restoreViewState(e){const t=this.loadEditorViewState(this.getInput(),e);t&&this.searchResultEditor.restoreViewState(t)}getAriaLabel(){return this.getInput()?.getName()??(0,l.NC)("searchEditor","Search")}};Ze.ID=xi,Ze.SEARCH_EDITOR_VIEW_STATE_PREFERENCE_KEY="searchEditorViewState",Ze=(0,g.gn)([(0,g.fM)(0,Ie.bU),(0,g.fM)(1,rt.XE),(0,g.fM)(2,Xe.Uy),(0,g.fM)(3,me.q),(0,g.fM)(4,Ce.ec),(0,g.fM)(5,Se.e),(0,g.fM)(6,V.TG),(0,g.fM)(7,je.u),(0,g.fM)(8,Oe.H),(0,g.fM)(9,Lt.v4),(0,g.fM)(10,st.lT),(0,g.fM)(11,ui.ek),(0,g.fM)(12,ya.V),(0,g.fM)(13,_t.Qw),(0,g.fM)(14,F.AR),(0,g.fM)(15,H.Ui),(0,g.fM)(16,le.sn),(0,g.fM)(17,It.VZ)],Ze);const Ra=(0,wt.P6G)("searchEditor.textInputBorder",{dark:wt.dt_,light:wt.dt_,hcDark:wt.dt_,hcLight:wt.dt_},(0,l.NC)("textInputBoxBorder","Search editor text input box border."));function Fa(o,e){for(const t of o)if(Ct.L.isBefore(e,t.getStartPosition()))return t;return o[0]}function ka(o,e){for(let t=o.length-1;t>=0;t--){const i=o[t];if(Ct.L.isBefore(i.getStartPosition(),e))return i}return o[o.length-1]}var fr=p(742),Ma=p(52809);Re.B.as(he.bS.EditorPane).registerEditorPane(Sa.gS.create(Ze,Ze.ID,(0,l.NC)("searchEditor","Search Editor")),[new ne.M(L)]);let Qi=class{constructor(e,t){e.registerEditor("*"+vt,{id:L.ID,label:(0,l.NC)("promptOpenWith.searchEditor.displayName","Search Editor"),detail:he.Cr.providerDisplayName,priority:fr.OP.default},{singlePerResource:!0,canSupportResource:i=>(0,Y.DZ)(i)===vt},{createEditorInput:({resource:i})=>({editor:t.invokeFunction(Ue,{from:"existingFile",fileUri:i})})})}};Qi=(0,g.gn)([(0,g.fM)(0,fr.es),(0,g.fM)(1,V.TG)],Qi);const mr=Re.B.as(ms.I.Workbench);mr.registerWorkbenchContribution(Qi,1),Oe.P.registerCommand("cleanSearchEditorState",o=>{const e=o.get(F.AR).activeEditorPane;e instanceof Ze&&e.cleanState()});const z={value:(0,l.NC)("search","Search Editor"),original:"Search Editor"},Ui=(o={})=>{const e={},t={includes:"filesToInclude",excludes:"filesToExclude",wholeWord:"matchWholeWord",caseSensitive:"isCaseSensitive",regexp:"isRegexp",useIgnores:"useExcludeSettingsAndIgnoreFiles"};return Object.entries(o).forEach(([i,s])=>{e[t[i]??i]=s}),e},Zi={description:"Open a new search editor. Arguments passed can include variables like ${relativeFileDirname}.",args:[{name:"Open new Search Editor args",schema:{properties:{query:{type:"string"},filesToInclude:{type:"string"},filesToExclude:{type:"string"},contextLines:{type:"number"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},isRegexp:{type:"boolean"},useExcludeSettingsAndIgnoreFiles:{type:"boolean"},showIncludesExcludes:{type:"boolean"},triggerSearch:{type:"boolean"},focusResults:{type:"boolean"},onlyOpenEditors:{type:"boolean"}}}}]};(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.searchEditor.action.deleteFileResults",title:{value:(0,l.NC)("searchEditor.deleteResultBlock","Delete File Results"),original:"Delete File Results"},keybinding:{weight:100,primary:3073},precondition:U,category:z,f1:!0})}run(o){return(0,S.Z)(function*(){o.get(w.i6).getContext(document.activeElement).getValue(U.serialize())&&o.get(F.AR).activeEditorPane.deleteResultBlock()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openNewEditor",title:{value:(0,l.NC)("search.openNewSearchEditor","New Search Editor"),original:"New Search Editor"},category:z,f1:!0,description:Zi})}run(o,e){return(0,S.Z)(function*(){yield o.get(V.TG).invokeFunction(St,Ui({location:"new",...e}))})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:ft,title:{value:(0,l.NC)("search.openSearchEditor","Open Search Editor"),original:"Open Search Editor"},category:z,f1:!0,description:Zi})}run(o,e){return(0,S.Z)(function*(){yield o.get(V.TG).invokeFunction(St,Ui({location:"reuse",...e}))})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openNewEditorToSide",title:{value:(0,l.NC)("search.openNewEditorToSide","Open New Search Editor to the Side"),original:"Open new Search Editor to the Side"},category:z,f1:!0,description:Zi})}run(o,e){return(0,S.Z)(function*(){yield o.get(V.TG).invokeFunction(St,Ui(e),!0)})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openInEditor",title:{value:(0,l.NC)("search.openResultsInEditor","Open Results in Editor"),original:"Open Results in Editor"},category:z,f1:!0,keybinding:{primary:515,when:w.Ao.and(re,xe),weight:200,mac:{primary:2051}}})}run(o){return(0,S.Z)(function*(){const e=o.get(k.qC),t=o.get(V.TG),i=T(e);i&&(yield t.invokeFunction(rr,i.searchResult,i.searchIncludePattern.getValue(),i.searchExcludePattern.getValue(),i.searchIncludePattern.onlySearchInOpenEditors()))})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"rerunSearchEditorSearch",title:{value:(0,l.NC)("search.rerunSearchInEditor","Search Again"),original:"Search Again"},category:z,keybinding:{primary:3120,when:U,weight:100},icon:ys,menu:[{id:f.eH.EditorTitle,group:"navigation",when:pr.cM.isEqualTo(xi)},{id:f.eH.CommandPalette,when:pr.cM.isEqualTo(xi)}]})}run(o){return(0,S.Z)(function*(){const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.triggerSearch({resetCursor:!1})})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusQueryEditorWidget",title:{value:(0,l.NC)("search.action.focusQueryEditorWidget","Focus Search Editor Input"),original:"Focus Search Editor Input"},category:z,f1:!0,precondition:U,keybinding:{primary:9,weight:100}})}run(o){return(0,S.Z)(function*(){const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.focusSearchInput()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusFilesToInclude",title:{value:(0,l.NC)("search.action.focusFilesToInclude","Focus Search Editor Files to Include"),original:"Focus Search Editor Files to Include"},category:z,f1:!0,precondition:U})}run(o){return(0,S.Z)(function*(){const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.focusFilesToIncludeInput()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.focusFilesToExclude",title:{value:(0,l.NC)("search.action.focusFilesToExclude","Focus Search Editor Files to Exclude"),original:"Focus Search Editor Files to Exclude"},category:z,f1:!0,precondition:U})}run(o){return(0,S.Z)(function*(){const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.focusFilesToExcludeInput()})()}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"toggleSearchEditorCaseSensitive",title:{value:(0,l.NC)("searchEditor.action.toggleSearchEditorCaseSensitive","Toggle Match Case"),original:"Toggle Match Case"},category:z,f1:!0,precondition:U,keybinding:Object.assign({weight:200,when:lt},Pe.Dt)})}run(o){(o=>{const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.toggleCaseSensitive()})(o)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"toggleSearchEditorWholeWord",title:{value:(0,l.NC)("searchEditor.action.toggleSearchEditorWholeWord","Toggle Match Whole Word"),original:"Toggle Match Whole Word"},category:z,f1:!0,precondition:U,keybinding:Object.assign({weight:200,when:lt},Pe.CP)})}run(o){(o=>{const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.toggleWholeWords()})(o)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"toggleSearchEditorRegex",title:{value:(0,l.NC)("searchEditor.action.toggleSearchEditorRegex","Toggle Use Regular Expression"),original:'Toggle Use Regular Expression"'},category:z,f1:!0,precondition:U,keybinding:Object.assign({weight:200,when:lt},Pe.LM)})}run(o){(o=>{const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.toggleRegex()})(o)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:Us,title:{value:(0,l.NC)("searchEditor.action.toggleSearchEditorContextLines","Toggle Context Lines"),original:'Toggle Context Lines"'},category:z,f1:!0,precondition:U,keybinding:{weight:200,primary:554,mac:{primary:2602}}})}run(o){(o=>{const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.toggleContextLines()})(o)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"increaseSearchEditorContextLines",title:{original:"Increase Context Lines",value:(0,l.NC)("searchEditor.action.increaseSearchEditorContextLines","Increase Context Lines")},category:z,f1:!0,precondition:U,keybinding:{weight:200,primary:598}})}run(o){sr(o,!0)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"decreaseSearchEditorContextLines",title:{original:"Decrease Context Lines",value:(0,l.NC)("searchEditor.action.decreaseSearchEditorContextLines","Decrease Context Lines")},category:z,f1:!0,precondition:U,keybinding:{weight:200,primary:600}})}run(o){sr(o,!1)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"selectAllSearchEditorMatches",title:{original:"Select All Matches",value:(0,l.NC)("searchEditor.action.selectAllSearchEditorMatches","Select All Matches")},category:z,f1:!0,precondition:U,keybinding:{weight:200,primary:3114}})}run(o){(o=>{const e=o.get(F.AR);e.activeEditor instanceof L&&e.activeEditorPane.focusAllResults()})(o)}}),(0,f.r1)(class extends f.Ke{constructor(){super({id:"search.action.openNewEditorFromView",title:(0,l.NC)("search.openNewEditor","Open New Search Editor"),category:z,icon:hn,menu:[{id:f.eH.ViewTitle,group:"navigation",order:2,when:w.Ao.equals("view",A.nn)}]})}run(e,...t){return function Uo(o){return ki.apply(this,arguments)}(e)}});let qi=class extends P.JT{constructor(e,t){super(),this.instantiationService=e,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===wi}isOpen(e,t){return!!this.handles(e)&&t instanceof L&&(0,Y.Xy)(e.resource,t.modelUri)}createEditor(e){const t=this.instantiationService.invokeFunction(Ue,{from:"model",modelUri:e.resource});return t.setDirty(!0),t}};function Ua(){return{[A.x1.toString()]:new ne.M(zt),[y.Zj.toString()]:new ne.M(y.pv),[Rt.c.toString()]:new ne.M(Rt.r),[Ft.H.toString()]:new ne.M(Pt)}}qi=(0,g.gn)([(0,g.fM)(0,V.TG),(0,g.fM)(1,Ma.i)],qi),mr.registerWorkbenchContribution(qi,2)},6640:(Rr,Et,p)=>{p.d(Et,{Id:()=>oe,UE:()=>P,dG:()=>ie,gz:()=>X,x8:()=>Ee});var zi=p(12829),ne=p(76972),A=p(53091),S=p(79026);const g="inQuickOpen",ie=new ne.uy(g,!1,(0,zi.NC)("inQuickOpen","Whether keyboard focus is inside the quick open control")),X=ne.Ao.has(g),oe="inFilesPicker",P=ne.Ao.and(X,ne.Ao.has(oe));function Ee(B,$t){return Q=>{const me=Q.get(A.d),le=Q.get(S.eJ),Ie={keybindings:me.lookupKeybindings(B)};le.navigate(!!$t,Ie)}}}}]);