"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[825],{90075:($r,wo,m)=>{m.d(wo,{Z:()=>O});var w=m(3884),h=m.n(w),jr=m(20088),ie=m.n(jr)()(h());ie.push([$r.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-breadcrumbs {\n\tuser-select: none;\n\t-webkit-user-select: none;\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-wrap: nowrap;\n\tjustify-content: flex-start;\n\toutline-style: none;\n}\n\n.monaco-breadcrumbs .monaco-breadcrumb-item {\n\tdisplay: flex;\n\talign-items: center;\n\tflex: 0 1 auto;\n\twhite-space: nowrap;\n\tcursor: pointer;\n\talign-self: center;\n\theight: 100%;\n\toutline: none;\n}\n.monaco-breadcrumbs.disabled .monaco-breadcrumb-item {\n\tcursor: default;\n}\n\n.monaco-breadcrumbs .monaco-breadcrumb-item .codicon-breadcrumb-separator {\n\tcolor: inherit;\n}\n\n.monaco-breadcrumbs .monaco-breadcrumb-item:first-of-type::before {\n\tcontent: ' ';\n}\n",""]);const O=ie},80825:($r,wo,m)=>{m.r(wo),m.d(wo,{ViewContainerLocation:()=>O.fI,default:()=>Kh,registerCustomView:()=>Uh,renderActivitybarPar:()=>Bh,renderEditorPart:()=>Gh,renderPanelPart:()=>Wh,renderSidebarPart:()=>Fh,renderStatusBarPart:()=>zh});var w=m(58054),h=m(55885),Wt=(m(87708),m(72967)),ie=m(21462),O=m(73059),tc=m(29773),R=m(82344),ve=m(96970);(0,ve.Z)(".monaco-workbench.nosidebar>.part.sidebar{display:none!important;visibility:hidden!important}.monaco-workbench .part.sidebar .title-actions .actions-container{justify-content:flex-end}.monaco-workbench .part.sidebar .title-actions .action-item{margin-right:4px}.monaco-workbench .part.sidebar>.title>.title-label h2{text-transform:uppercase}.monaco-workbench .viewlet .collapsible.header .title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .viewlet .collapsible.header .actions{width:0}.monaco-workbench .viewlet .collapsible.header.focused .actions,.monaco-workbench .viewlet .split-view-view:hover>.header .actions{flex:1;width:auto}.monaco-workbench .viewlet .collapsible.header .actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;height:22px;margin-right:0;width:28px}.monaco-workbench .viewlet .collapsible.header .actions .action-label .label,.monaco-workbench .viewlet .collapsible.header.collapsed .actions{display:none}.monaco-workbench .viewlet .collapsible.header .action-label{background-repeat:no-repeat;height:16px;margin-right:.2em;width:16px}",{});var me=m(33562);(0,ve.Z)(".monaco-workbench .part>.content>.composite{height:100%}.monaco-workbench .part>.composite.title{display:flex}.monaco-workbench .part>.composite.title>.title-actions{flex:1;padding-left:5px}",{});var p=m(12829),nc=m(75390),C=m(12997),S=m(13683),Xe=m(86810),qe=m(9110),Xr=m(20400);(0,ve.Z)(".monaco-workbench .part{box-sizing:border-box;overflow:hidden}.monaco-workbench .part>.drop-block-overlay.visible{visibility:visible}.monaco-workbench .part>.drop-block-overlay{height:100%;opacity:0;position:absolute;top:0;visibility:hidden;width:100%;z-index:12}.monaco-workbench .part>.title{box-sizing:border-box;display:none;display:flex;height:35px;overflow:hidden;padding-left:8px;padding-right:8px}.monaco-workbench .part>.title>.title-label{line-height:35px;overflow:hidden;padding-left:12px;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label h2{cursor:default;font-size:11px;font-weight:400;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label a{cursor:default;font-size:13px;text-decoration:none}.monaco-workbench .part>.title>.title-actions{flex:1;height:35px;padding-left:5px}.monaco-workbench .part>.title>.title-actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;display:block}.monaco-workbench .part>.title>.title-actions .action-label .label{display:none}.monaco-workbench .part>.title>.title-actions .action-label.codicon{color:inherit}.monaco-workbench .part>.content{font-size:13px}.monaco-workbench .part.editor>.content .monaco-progress-container,.monaco-workbench .part>.content>.monaco-progress-container{height:2px;left:0;position:absolute;top:33px;z-index:5}.monaco-workbench\n\t.part.editor>.content\n\t.monaco-progress-container\n\t.progress-bit,.monaco-workbench .part>.content>.monaco-progress-container .progress-bit{height:2px}",{});var sc=m(69521),g=m(6418),A=m(93358);class yo extends sc.w{get dimension(){return this._dimension}constructor(e,t,i,o,n){super(e,i,o),this.options=t,this.layoutService=n,this._onDidVisibilityChange=this._register(new S.Q5),this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._onDidChange=this._register(new S.Q5),n.registerPart(this)}onThemeChange(e){this.parent&&super.onThemeChange(e)}updateStyles(){super.updateStyles()}create(e,t){this.parent=e,this.titleArea=this.createTitleArea(e,t),this.contentArea=this.createContentArea(e,t),this.partLayout=new ac(this.options,this.contentArea),this.updateStyles()}getContainer(){return this.parent}createTitleArea(e,t){}getTitleArea(){return this.titleArea}createContentArea(e,t){}getContentArea(){return this.contentArea}layoutContents(e,t){return(0,A.cW)(this.partLayout).layout(e,t)}get onDidChange(){return this._onDidChange.event}layout(e,t,i,o){this._dimension=new g.Ro(e,t)}setVisible(e){this._onDidVisibilityChange.fire(e)}}let ac=(()=>{class c{constructor(t,i){this.options=t,this.contentArea=i}layout(t,i){let o;o=this.options.hasTitle?new g.Ro(t,Math.min(i,c.TITLE_HEIGHT)):g.Ro.None;let n=t;this.options&&"function"==typeof this.options.borderWidth&&(n-=this.options.borderWidth());const r=new g.Ro(n,i-o.height);return this.contentArea&&(0,g.dp)(this.contentArea,r.width,r.height),{titleSize:o,contentSize:r}}}return c.TITLE_HEIGHT=35,c})();var Yr=m(49052),Gt=m(7003),Be=m(36774),an=m(92466),Qr=m(37177),zt=m(470);class Jr extends yo{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M){super(k,M,a,t,n),this.notificationService=e,this.storageService=t,this.telemetryService=i,this.contextMenuService=o,this.keybindingService=r,this.instantiationService=s,this.registry=d,this.activeCompositeSettingsKey=l,this.defaultCompositeId=u,this.nameForTelemetry=f,this.compositeCSSClass=b,this.titleForegroundColor=E,this.onDidCompositeOpen=this._register(new S.Q5),this.onDidCompositeClose=this._register(new S.Q5),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.telemetryActionsListener=this._register(new C.XK),this.lastActiveCompositeId=t.get(l,1,this.defaultCompositeId)}openComposite(e,t){return this.activeComposite?.getId()===e?(t&&this.activeComposite.focus(),this.activeComposite):this.element?this.doOpenComposite(e,t):void 0}doOpenComposite(e,t=!1){const i=nc.a.nextId();this.currentCompositeOpenToken=i,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);const o=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==i||this.activeComposite&&this.activeComposite.getId()!==o.getId()))return this.activeComposite?.getId()===o.getId()?(t&&o.focus(),this.onDidCompositeOpen.fire({composite:o,focus:t}),o):(this.showComposite(o),t&&o.focus(),o&&this.onDidCompositeOpen.fire({composite:o,focus:t}),o)}createComposite(e,t){const i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;const o=this.registry.getComposite(e);if(o){const n=this,r=new an.GX((0,A.cW)(this.progressBar),new class extends an.nw{constructor(){super(o.id,!!t),this._register(n.onDidCompositeOpen.event(l=>this.onScopeOpened(l.composite.getId()))),this._register(n.onDidCompositeClose.event(l=>this.onScopeClosed(l.getId())))}}),s=this.instantiationService.createChild(new Yr.y([Gt.ek,r])),a=o.instantiate(s),d=new C.SL;return this.instantiatedCompositeItems.set(e,{composite:a,disposable:d,progress:r}),d.add(a.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(a.getId()),this)),a}throw new Error(`Unable to find composite with id ${e}`)}showComposite(e){this.activeComposite=e;const t=this.activeComposite.getId();t!==this.defaultCompositeId?this.storageService.store(this.activeCompositeSettingsKey,t,1,1):this.storageService.remove(this.activeCompositeSettingsKey,1),this.lastActiveCompositeId=this.activeComposite.getId();let i=this.mapCompositeToCompositeContainer.get(e.getId());if(i||(i=(0,g.$)(".composite"),i.classList.add(...this.compositeCSSClass.split(" ")),i.id=e.getId(),e.create(i),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),i)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;this.getContentArea()?.appendChild(i),(0,g.$Z)(i);const n=(0,A.cW)(this.toolBar);n.actionRunner=e.getActionRunner();const r=this.registry.getComposite(e.getId());r&&r.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let s=this.mapActionsBindingToComposite.get(e.getId());s||(s=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),s)),s(),this.telemetryActionsListener.value=n.actionRunner.onDidRun(a=>{a.error&&!(0,Xe.n2)(a.error)&&this.notificationService.error(a.error),this.telemetryService.publicLog2("workbenchActionExecuted",{id:a.action.id,from:this.nameForTelemetry})}),e.setVisible(!0),this.activeComposite&&e.getId()===this.activeComposite.getId()&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){const t=this.instantiatedCompositeItems.get(e);if(t&&this.updateTitle(e,t.composite.getTitle()),this.activeComposite?.getId()===e){const i=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),i),i()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){const i=this.registry.getComposite(e);if(!i||!this.titleLabel)return;t||(t=i.name);const o=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,(0,A.f6)(o?.getLabel())),(0,A.cW)(this.toolBar).setAriaLabel((0,p.NC)("ariaCompositeToolbarLabel","{0} actions",t))}collectCompositeActions(e){const t=e?.getMenuIds(),i=e?.getActions().slice(0)||[],o=e?.getSecondaryActions().slice(0)||[],n=(0,A.cW)(this.toolBar);return n.context=this.actionsContextProvider(),()=>n.setActions((0,qe.c)(i),(0,qe.c)(o),t)}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){if(!this.activeComposite)return;const e=this.activeComposite;this.activeComposite=void 0;const t=this.mapCompositeToCompositeContainer.get(e.getId());return e.setVisible(!1),t&&(t.remove(),(0,g.Cp)(t)),this.progressBar?.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(e),e}createTitleArea(e){const t=(0,g.R3)(e,(0,g.$)(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);const i=(0,g.R3)(t,(0,g.$)(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(Qr.T,i,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,p.NC)("viewsAndMoreActions","Views and More Actions...")})),this.collectCompositeActions()(),t}createTitleLabel(e){const t=(0,g.R3)(e,(0,g.$)(".title-label")),i=(0,g.R3)(t,(0,g.$)("h2"));this.titleLabelElement=i;const o=this;return{updateTitle:(n,r,s)=>{(!this.activeComposite||this.activeComposite.getId()===n)&&(i.innerText=r,i.title=s?(0,p.NC)("titleTooltip","{0} ({1})",r,s):r)},updateStyles:()=>{i.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||""}}}updateStyles(){super.updateStyles(),(0,A.cW)(this.titleLabel).updateStyles()}actionViewItemProvider(e){return this.activeComposite?this.activeComposite.getActionViewItem(e):(0,Be.Id)(this.instantiationService,e)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){const t=(0,g.R3)(e,(0,g.$)(".content"));return this.progressBar=this._register(new Xr.k(t,zt.b5)),this.progressBar.hide(),t}getProgressIndicator(e){const t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return 1}layout(e,t,i,o){super.layout(e,t,i,o),this.contentAreaSize=g.Ro.lift(super.layoutContents(e,t).contentSize),this.activeComposite?.layout(this.contentAreaSize)}setBoundarySashes(e){this.boundarySashes=e,this.activeComposite?.setBoundarySashes(e)}removeComposite(e){if(this.activeComposite?.getId()===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);const t=this.instantiatedCompositeItems.get(e);return t&&(t.composite.dispose(),(0,C.B9)(t.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),(0,C.B9)(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}}var Co=m(3847),et=m(94401),N=m(86682),Ie=m(58571),ge=m(54922),Ue=m(17324),Se=m(53091),K=m(32064),Y=m(66179),I=m(35814),oe=m(51776),ct=m(48671),y=m(76972),Pt=m(69486),B=m(86200),ae=m(44027);let So=class za extends Jr{get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}get onDidPaneCompositeRegister(){return this.viewletRegistry.onDidRegister}get onDidPaneCompositeOpen(){return S.ju.map(this.onDidCompositeOpen.event,e=>e.composite)}get onDidPaneCompositeClose(){return this.onDidCompositeClose.event}constructor(e,t,i,o,n,r,s,a,d,l,u){super(e,t,i,o,n,r,s,a,me.B.as(Co.IP.Viewlets),za.activeViewletSettingsKey,d.getDefaultViewContainer(0).id,"sideBar","viewlet",I.nq,"workbench.parts.sidebar",{hasTitle:!0,borderWidth:()=>this.getColor(I._M)||this.getColor(Y.lRK)?1:0}),this.viewDescriptorService=d,this.contextKeyService=l,this.extensionService=u,this.minimumWidth=170,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.priority=1,this.snap=!0,this._onDidViewletDeregister=this._register(new S.Q5),this.onDidPaneCompositeDeregister=this._onDidViewletDeregister.event,this.viewletRegistry=me.B.as(Co.IP.Viewlets),this.sideBarFocusContextKey=N.Sr.bindTo(this.contextKeyService),this.activeViewletContextKey=N.bD.bindTo(this.contextKeyService),this.blockOpeningViewlet=!1,this.registerListeners()}registerListeners(){var e=this;this._register(this.onDidPaneCompositeOpen(t=>{this.activeViewletContextKey.set(t.getId())})),this._register(this.onDidPaneCompositeClose(t=>{this.activeViewletContextKey.get()===t.getId()&&this.activeViewletContextKey.reset()})),this._register(this.registry.onDidDeregister(function(){var t=(0,w.Z)(function*(i){const o=e.viewDescriptorService.getViewContainersByLocation(0).filter(n=>e.viewDescriptorService.getViewContainerModel(n).activeViewDescriptors.length>0);if(o.length){if(e.getActiveComposite()?.getId()===i.id){const n=e.viewDescriptorService.getDefaultViewContainer(0)?.id,r=o.filter(s=>s.id===n)[0]||o[0];yield e.openPaneComposite(r.id)}}else e.layoutService.setPartHidden(!0,"workbench.parts.sidebar");e.removeComposite(i.id),e._onDidViewletDeregister.fire(i)});return function(i){return t.apply(this,arguments)}}()))}create(e){this.element=e,super.create(e);const t=this._register((0,g.go)(e));this._register(t.onDidFocus(()=>this.sideBarFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.sideBarFocusContextKey.set(!1)))}createTitleArea(e){const t=super.createTitleArea(e);return this._register((0,g.nm)(t,g.tw.CONTEXT_MENU,o=>{this.onTitleAreaContextMenu(new ct.nV(o))})),this._register(ae.o.addTarget(t)),this._register((0,g.nm)(t,ae.t.Contextmenu,o=>{this.onTitleAreaContextMenu(new ct.nV(o))})),this.titleLabelElement.draggable=!0,this._register(B.Mi.INSTANCE.registerDraggable(this.titleLabelElement,()=>({type:"composite",id:this.getActivePaneComposite().getId()}),{})),t}updateStyles(){super.updateStyles();const e=(0,A.cW)(this.getContainer());e.style.backgroundColor=this.getColor(I.Qd)||"",e.style.color=this.getColor(I.Sr)||"";const t=this.getColor(I._M)||this.getColor(Y.lRK),i=0===this.layoutService.getSideBarPosition();e.style.borderRightWidth=t&&i?"1px":"",e.style.borderRightStyle=t&&i?"solid":"",e.style.borderRightColor=i&&t||"",e.style.borderLeftWidth=t&&!i?"1px":"",e.style.borderLeftStyle=t&&!i?"solid":"",e.style.borderLeftColor=i?"":t||"",e.style.outlineColor=this.getColor(I.pY)??""}layout(e,t,i,o){this.layoutService.isVisible("workbench.parts.sidebar")&&super.layout(e,t,i,o)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.hideActiveComposite()}openPaneComposite(e,t){var i=this;return(0,w.Z)(function*(){if("string"==typeof e&&i.getPaneComposite(e)||(yield i.extensionService.whenInstalledExtensionsRegistered(),"string"==typeof e&&i.getPaneComposite(e)))return i.doOpenViewlet(e,t)})()}getPaneComposites(){return this.viewletRegistry.getPaneComposites().sort((e,t)=>"number"!=typeof e.order?-1:"number"!=typeof t.order?1:e.order-t.order)}getPaneComposite(e){return this.getPaneComposites().filter(t=>t.id===e)[0]}doOpenViewlet(e,t){if(!this.blockOpeningViewlet){if(!this.layoutService.isVisible("workbench.parts.sidebar"))try{this.blockOpeningViewlet=!0,this.layoutService.setPartHidden(!1,"workbench.parts.sidebar")}finally{this.blockOpeningViewlet=!1}return this.openComposite(e,t)}}getTitleAreaDropDownAnchorAlignment(){return 0===this.layoutService.getSideBarPosition()?0:1}onTitleAreaContextMenu(e){const t=this.getActivePaneComposite();if(t){const i=t?t.getContextMenuActions():[];if(i.length){const o={x:e.posx,y:e.posy};this.contextMenuService.showContextMenu({getAnchor:()=>o,getActions:()=>i.slice(),getActionViewItem:n=>this.actionViewItemProvider(n),actionRunner:t.getActionRunner()})}}}toJSON(){return{type:"workbench.parts.sidebar"}}};So.activeViewletSettingsKey="workbench.sidebar.activeviewletid",So=(0,h.gn)([(0,h.fM)(0,oe.lT),(0,h.fM)(1,Ie.Uy),(0,h.fM)(2,Ue.bU),(0,h.fM)(3,ge.i),(0,h.fM)(4,et.z),(0,h.fM)(5,Se.d),(0,h.fM)(6,R.TG),(0,h.fM)(7,K.XE),(0,h.fM)(8,O.XH),(0,h.fM)(9,y.i6),(0,h.fM)(10,Pt.QS)],So);var Ci=m(48780),qr=m(4699),W=m(58535),L=m(13686),J=m(70473),be=m(52786),Ae=m(99740),wt=m(9590),v=m(73317),Ee=m(38707),cc=m(2883),Te=m(56160);const cn="viewsLog",es=(0,p.NC)("views log","Views");function dn(c){return(0,J.Vo)(c.windowLogsPath,"views.log")}function ts(c){return`${c}.hidden`}(0,v.r1)(class extends v.Ke{constructor(){super({id:"_workbench.output.showViewsLog",title:{value:"Show Views Log",original:"Show Views Log"},category:Ee.R.Developer,f1:!0})}run(c){return(0,w.Z)(function*(){const e=c.get(Ae.yR),t=c.get(cc.GI),i=c.get(wt.n);e.setVisibility(dn(i),!0),t.showChannel(cn)})()}});let ln=class extends C.JT{constructor(e,t,i,o,n){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new S.Q5),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=o.createLogger(dn(n),{id:cn,name:es,hidden:!0}),this.globalViewsStateStorageId=ts(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(r=>this.onDidStorageChange(r))),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){const t=this.getStoredWorkspaceState();for(const i of e){const o=this.get(i.id);o&&(t[i.id]={collapsed:!!o.collapsed,isHidden:!o.visibleWorkspace,size:o.size,order:i.workspace&&o?o.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),1,1):this.storageService.remove(this.workspaceViewsStateStorageId,1)}updateGlobalState(e){const t=this.getStoredGlobalState();for(const i of e){const o=this.get(i.id);t.set(i.id,{id:i.id,isHidden:!(!o||!i.canToggleVisibility||o.visibleGlobal),order:!i.workspace&&o?o.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(e){if(e.key===this.globalViewsStateStorageId&&0===e.scope&&this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;const t=this.getStoredGlobalState(),i=this.getStoredWorkspaceState(),o=[];for(const[n,r]of t){const s=this.get(n);if(s)s.visibleGlobal!==!r.isHidden&&(r.isHidden||this.logger.info(`View visibility state changed: ${n} is now visible`,this.viewContainerName),o.push({id:n,visible:!r.isHidden}));else{const a=i[n];this.set(n,{active:!1,visibleGlobal:!r.isHidden,visibleWorkspace:(0,A.o8)(a?.isHidden)?void 0:!a?.isHidden,collapsed:a?.collapsed,order:a?.order,size:a?.size})}}if(o.length){this._onDidChangeStoredState.fire(o);for(const n of o){const r=this.get(n.id);r&&(r.visibleGlobal=n.visible)}}}}initialize(){const e=new Map,t=this.getStoredWorkspaceState();for(const s of Object.keys(t)){const a=t[s];e.set(s,{active:!1,visibleGlobal:void 0,visibleWorkspace:(0,A.o8)(a.isHidden)?void 0:!a.isHidden,collapsed:a.collapsed,order:a.order,size:a.size})}const i=this.storageService.get(this.globalViewsStateStorageId,1,"[]"),{state:o}=this.parseStoredGlobalState(i);if(o.size>0){for(const{id:s,isHidden:a}of o.values()){const d=e.get(s);d?(0,A.o8)(d.visibleWorkspace)&&(d.visibleWorkspace=!a):e.set(s,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!a})}this.storageService.remove(this.globalViewsStateStorageId,1)}const{state:n,hasDuplicates:r}=this.parseStoredGlobalState(this.globalViewsStatesValue);r&&this.setStoredGlobalState(n);for(const{id:s,isHidden:a,order:d}of n.values()){const l=e.get(s);l?(l.visibleGlobal=!a,(0,A.o8)(d)||(l.order=d)):e.set(s,{active:!1,visibleGlobal:!a,order:d,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,1,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){const t=JSON.parse(e);let i=!1;return{state:t.reduce((n,r)=>("string"==typeof r?(i=i||n.has(r),n.set(r,{id:r,isHidden:!0})):(i=i||n.has(r.id),n.set(r.id,r)),n),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,0,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,0,0)}};ln=(0,h.gn)([(0,h.fM)(2,Ie.Uy),(0,h.fM)(3,Ae.yR),(0,h.fM)(4,wt.n)],ln);let hn=class extends C.JT{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,o,n){super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new Te.WJ,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new S.Q5),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new S.Q5),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new S.Q5),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new S.Q5),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new S.Q5),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new S.Q5),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this.logger=o.createLogger(dn(n),{id:cn,name:es,hidden:!0}),this._register(S.ju.filter(i.onDidChangeContext,r=>r.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(ln,e.storageId||`${e.id}.state`,"string"==typeof e.title?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(r=>this.updateVisibility(r))),this.updateContainerInfo()}updateContainerInfo(){const e=this.viewContainer.alwaysUseContainerInfo||0===this.visibleViewDescriptors.length||this.visibleViewDescriptors.some(a=>me.B.as(O.IP.ViewsRegistry).getViewContainer(a.id)===this.viewContainer),t=e?"string"==typeof this.viewContainer.title?this.viewContainer.title:this.viewContainer.title.value:this.visibleViewDescriptors[0]?.containerTitle||this.visibleViewDescriptors[0]?.name||"";let i=!1;this._title!==t&&(this._title=t,i=!0);const o=e?this.viewContainer.icon:this.visibleViewDescriptors[0]?.containerIcon||O.L7;let n=!1;this.isEqualIcon(o)||(this._icon=o,n=!0);const r=this.viewContainer.openCommandActionDescriptor?.id??this.activeViewDescriptors.find(a=>a.openCommandActionDescriptor)?.openCommandActionDescriptor?.id;let s=!1;this._keybindingId!==r&&(this._keybindingId=r,s=!0),(i||n||s)&&this._onDidChangeContainerInfo.fire({title:i,icon:n,keybindingId:s})}isEqualIcon(e){return W.ov.isUri(e)?W.ov.isUri(this._icon)&&(0,J.Xy)(e,this._icon):be.kS.isThemeIcon(e)?be.kS.isThemeIcon(this._icon)&&be.kS.isEqual(e,this._icon):e===this._icon}isVisible(e){const t=this.viewDescriptorItems.find(i=>i.viewDescriptor.id===e);if(!t)throw new Error(`Unknown view ${e}`);return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){const t=(0,L.kX)(e.filter(({visible:n})=>!n).map(({id:n})=>this.findAndIgnoreIfNotFound(n))),i=[];for(const{viewDescriptorItem:n,visibleIndex:r}of t)this.updateViewDescriptorItemVisibility(n,!1)&&i.push({viewDescriptor:n.viewDescriptor,index:r});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);const o=[];for(const{id:n,visible:r}of e){if(!r)continue;const s=this.findAndIgnoreIfNotFound(n);if(!s)continue;const{viewDescriptorItem:a,visibleIndex:d}=s;this.updateViewDescriptorItemVisibility(a,!0)&&o.push({index:d,viewDescriptor:a.viewDescriptor,size:a.state.size,collapsed:!!a.state.collapsed})}o.length&&this.broadCastAddedVisibleViewDescriptors(o)}updateViewDescriptorItemVisibility(e,t){return!(!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t)&&(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.info(`Showing view ${e.viewDescriptor.id} in the container ${this.viewContainer.id}`)),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){const{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(const{id:t,size:i}of e){const{viewDescriptorItem:o}=this.find(t);o.state.size!==i&&(o.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){const i=this.viewDescriptorItems.findIndex(s=>s.viewDescriptor.id===e),o=this.viewDescriptorItems.findIndex(s=>s.viewDescriptor.id===t),n=this.viewDescriptorItems[i],r=this.viewDescriptorItems[o];(0,L.pB)(this.viewDescriptorItems,i,o);for(let s=0;s<this.viewDescriptorItems.length;s++)this.viewDescriptorItems[s].state.order=s;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:n.viewDescriptor},{index:o,viewDescriptor:r.viewDescriptor})}add(e){const t=[];for(const n of e){const r=n.viewDescriptor;if(r.when)for(const a of r.when.keys())this.contextKeys.add(a);let s=this.viewDescriptorsState.get(r.id);if(s){if(r.workspace)s.visibleWorkspace=(0,A.Jp)(n.visible)?(0,A.Jp)(s.visibleWorkspace)?!r.hideByDefault:s.visibleWorkspace:n.visible;else{const a=s.visibleGlobal;s.visibleGlobal=(0,A.Jp)(n.visible)?(0,A.Jp)(s.visibleGlobal)?!r.hideByDefault:s.visibleGlobal:n.visible,s.visibleGlobal&&!a&&this.logger.info(`Added view ${r.id} in the container ${this.viewContainer.id} and showing it.`,`${a}`,`${r.hideByDefault}`,`${n.visible}`)}s.collapsed=(0,A.Jp)(n.collapsed)?(0,A.Jp)(s.collapsed)?!!r.collapsed:s.collapsed:n.collapsed}else s={active:!1,visibleGlobal:(0,A.Jp)(n.visible)?!r.hideByDefault:n.visible,visibleWorkspace:(0,A.Jp)(n.visible)?!r.hideByDefault:n.visible,collapsed:(0,A.Jp)(n.collapsed)?!!r.collapsed:n.collapsed};this.viewDescriptorsState.set(r.id,s),s.active=this.contextKeyService.contextMatchesRules(r.when),t.push({viewDescriptor:r,state:s})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(({viewDescriptor:n})=>n),removed:[]});const i=[];for(const n of t)n.state.active&&i.push({viewDescriptorItem:n,visible:this.isViewDescriptorVisible(n)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(({viewDescriptorItem:n})=>n.viewDescriptor),removed:[]});const o=[];for(const{viewDescriptorItem:n,visible:r}of i)if(r&&this.isViewDescriptorVisible(n)){const{visibleIndex:s}=this.find(n.viewDescriptor.id);o.push({index:s,viewDescriptor:n.viewDescriptor,size:n.state.size,collapsed:!!n.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}remove(e){const t=[],i=[],o=[],n=[];for(const r of e){if(r.when)for(const a of r.when.keys())this.contextKeys.delete(a);const s=this.viewDescriptorItems.findIndex(a=>a.viewDescriptor.id===r.id);if(-1!==s){t.push(r);const a=this.viewDescriptorItems[s];if(a.state.active&&o.push(a.viewDescriptor),this.isViewDescriptorVisible(a)){const{visibleIndex:d}=this.find(a.viewDescriptor.id);n.push({index:d,viewDescriptor:a.viewDescriptor})}i.push(a)}}i.forEach(r=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(r),1)),this.broadCastRemovedVisibleViewDescriptors(n),o.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:o}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){const e=[],t=[];for(const n of this.viewDescriptorItems){const r=n.state.active,s=this.contextKeyService.contextMatchesRules(n.viewDescriptor.when);r!==s&&(s?e.push({item:n,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(n)}):t.push(n))}const i=[];for(const n of t)if(this.isViewDescriptorVisible(n)){const{visibleIndex:r}=this.find(n.viewDescriptor.id);i.push({index:r,viewDescriptor:n.viewDescriptor})}t.forEach(n=>n.state.active=!1),e.forEach(({item:n})=>n.state.active=!0),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(({item:n})=>n.viewDescriptor),removed:t.map(n=>n.viewDescriptor)});const o=[];for(const{item:n,visibleWhenActive:r}of e)if(r&&this.isViewDescriptorVisible(n)){const{visibleIndex:s}=this.find(n.viewDescriptor.id);o.push({index:s,viewDescriptor:n.viewDescriptor,size:n.state.size,collapsed:!!n.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((t,i)=>t.index-i.index)),this.updateState(`Added views:${e.map(t=>t.viewDescriptor.id).join(",")} in ${this.viewContainer.id}`))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((t,i)=>i.index-t.index)),this.updateState(`Removed views:${e.map(t=>t.viewDescriptor.id).join(",")} from ${this.viewContainer.id}`))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState(`Moved view ${e.viewDescriptor.id} to ${t.viewDescriptor.id} in ${this.viewContainer.id}`)}updateState(e){this.logger.info(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return!!e.state.active&&this.isViewDescriptorVisibleWhenActive(e)}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){const t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw new Error(`view descriptor ${e} not found`)}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){const o=this.viewDescriptorItems[t];if(o.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:o};this.isViewDescriptorVisible(o)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){const t="number"==typeof e.state.order?e.state.order:e.viewDescriptor.order;return"number"==typeof t?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return e.group&&t.group&&e.group!==t.group?e.group<t.group?-1:1:0}};function is(c){return`${c}.state`}hn=(0,h.gn)([(0,h.fM)(1,R.TG),(0,h.fM)(2,y.i6),(0,h.fM)(3,Ae.yR),(0,h.fM)(4,wt.n)],hn);let Oi=class Ht extends C.JT{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,o,n){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=o,this.telemetryService=n,this._onDidChangeContainer=this._register(new S.Q5),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new S.Q5),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new S.Q5),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new C.b2),this.viewsVisibilityActionDisposables=this._register(new C.b2),this._onDidChangeViewContainers=this._register(new S.Q5),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=me.B.as(O.IP.ViewContainersRegistry),this.viewsRegistry=me.B.as(O.IP.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(r=>this.onDidRegisterViewContainer(r)),this._register(this.viewsRegistry.onViewsRegistered(r=>this.onDidRegisterViews(r))),this._register(this.viewsRegistry.onViewsDeregistered(({views:r,viewContainer:s})=>this.onDidDeregisterViews(r,s))),this._register(this.viewsRegistry.onDidChangeContainer(({views:r,from:s,to:a})=>this.onDidChangeDefaultContainer(r,s,a))),this._register(this.viewContainersRegistry.onDidRegister(({viewContainer:r})=>{this.onDidRegisterViewContainer(r),this._onDidChangeViewContainers.fire({added:[{container:r,location:this.getViewContainerLocation(r)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(({viewContainer:r})=>{this.onDidDeregisterViewContainer(r),this._onDidChangeViewContainers.fire({removed:[{container:r,location:this.getViewContainerLocation(r)}],added:[]})})),this._register(this.storageService.onDidChangeValue(r=>{this.onDidStorageChange(r)})),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(Ht.VIEWS_CUSTOMIZATIONS,0))return;const e=this.storageService.get("views.cachedViewContainerLocations",0),t=this.storageService.get("views.cachedViewPositions",0);if(!e&&!t)return;const i=e?JSON.parse(e):[],o=t?JSON.parse(t):[],n={viewContainerLocations:i.reduce((r,[s,a])=>(r[s]=a,r),{}),viewLocations:o.reduce((r,[s,{containerId:a}])=>(r[s]=a,r),{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(Ht.VIEWS_CUSTOMIZATIONS,JSON.stringify(n),0,0),this.storageService.remove("views.cachedViewContainerLocations",0),this.storageService.remove("views.cachedViewPositions",0)}registerGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);if(!o||!this.viewContainerModels.has(o)){if(this.isGeneratedContainerId(t)){const r=this.viewContainersCustomLocations.get(t);void 0!==r&&this.registerGeneratedViewContainer(r,t)}continue}const n=i.filter(r=>0===this.getViewContainerModel(o).allViewDescriptors.filter(s=>s.id===r.id).length);this.addViews(o,n)}}deregisterGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);!o||!this.viewContainerModels.has(o)||this.removeViews(o,i)}}moveOrphanViewsToDefaultLocation(){for(const[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;const i=this.viewsRegistry.getViewContainer(e),o=this.getViewDescriptorById(e);i&&o&&this.addViews(i,[o])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(const e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations(),this.registerViewsVisibilityActions()}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(({views:t,viewContainer:i})=>{const o=this.regroupViews(i.id,t);this.registerGroupedViews(o),t.forEach(n=>this.getOrCreateMovableViewContextKey(n).set(!!n.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(Ht.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){const i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(o=>this.getOrCreateMovableViewContextKey(o).set(!1))})}regroupViews(e,t){const i=new Map;for(const o of t){const n=this.viewDescriptorsCustomLocations.get(o.id)??e;let r=i.get(n);r||i.set(n,r=[]),r.push(o)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){const t=this.getViewContainerByViewId(e);return null===t?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){const t=this.viewDescriptorsCustomLocations.get(e);return t?this.viewContainersRegistry.get(t)??null:this.getDefaultContainerById(e)}getViewContainerLocation(e){return this.viewContainersCustomLocations.get(e.id)??this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){return this.viewsRegistry.getViewContainer(e)??null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i){this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){return this.viewContainerBadgeEnablementStates.get(e)??!0}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t){const i=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],i)}moveViewsToContainer(e,t,i){if(!e.length)return;const o=this.getViewContainerByViewId(e[0].id),n=t;o&&n&&o!==n&&(this.moveViewsWithoutSaving(e,o,n,i),this.cleanUpGeneratedViewContainer(o.id),this.saveViewCustomizations(),this.reportMovedViews(e,o,n))}reset(){for(const e of this.viewContainers){const t=this.getViewContainerModel(e);for(const n of t.allViewDescriptors){const r=this.getDefaultContainerById(n.id),s=this.getViewContainerByViewId(n.id);s&&r&&s!==r&&this.moveViewsWithoutSaving([n],s,r)}const i=this.getDefaultViewContainerLocation(e),o=this.getViewContainerLocation(e);null!==i&&o!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){const o=e.filter(n=>!this.viewDescriptorsCustomLocations.has(n.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(n.id)===t.id);o.length&&this.moveViewsWithoutSaving(o,t,i)}reportMovedViews(e,t,i){const o=f=>f.id.startsWith(Ht.COMMON_CONTAINER_ID_PREFIX)?"custom":f.extensionId?"extension":f.id,n=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i),s=e.length,a=o(t),d=o(i);this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:s,fromContainer:a,toContainer:d,fromLocation:1===n?"panel":"sidebar",toLocation:1===r?"panel":"sidebar"})}moveViewsWithoutSaving(e,t,i,o=O.nm.Expand){this.removeViews(t,e),this.addViews(i,e,o);const n=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i);n!==r&&this._onDidChangeLocation.fire({views:e,from:n,to:r}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){const o=this.getViewContainerLocation(e),n=t;if(o!==n){const r=this.isGeneratedContainerId(e.id),s=n===this.getDefaultViewContainerLocation(e);r||!s?this.viewContainersCustomLocations.set(e.id,n):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(r||s),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:o,to:n});const a=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:a,from:o,to:n})}}cleanUpGeneratedViewContainer(e){if(!this.isGeneratedContainerId(e))return;const t=this.getViewContainerById(e);t&&this.getViewContainerModel(t)?.allViewDescriptors.length||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(t&&this.viewContainersRegistry.deregisterViewContainer(t),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(ts(t?.storageId||is(e)),0))}registerGeneratedViewContainer(e,t){const i=t||this.generateContainerId(e),o=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new ie.M(Ci.XV,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:i,icon:0===e?O.L7:void 0,storageId:is(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(o.id)!==e&&this.viewContainersCustomLocations.set(o.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(o).set(!0),o}onDidStorageChange(e){e.key===Ht.VIEWS_CUSTOMIZATIONS&&0===e.scope&&JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;const e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],o=[];for(const[n,r]of e.entries()){const s=this.getViewContainerById(n);s?r!==this.getViewContainerLocation(s)&&i.push([s,r]):this.isGeneratedContainerId(n)&&this.registerGeneratedViewContainer(r,n)}for(const n of this.viewContainers)if(!e.has(n.id)){const r=this.getViewContainerLocation(n),s=this.getDefaultViewContainerLocation(n);r!==s&&i.push([n,s])}for(const[n,r]of t.entries()){const s=this.getViewDescriptorById(n);if(s){const a=this.getViewContainerByViewId(n),d=this.viewContainersRegistry.get(r);a&&d&&d!==a&&o.push({views:[s],from:a,to:d})}}for(const n of this.viewContainers){const r=this.getViewContainerModel(n);for(const s of r.allViewDescriptors)if(!t.has(s.id)){const a=this.getViewContainerByViewId(s.id),d=this.getDefaultContainerById(s.id);a&&d&&a!==d&&o.push({views:[s],from:a,to:d})}}for(const[n,r]of i)this.moveViewContainerToLocationWithoutSaving(n,r);for(const{views:n,from:r,to:s}of o)this.moveViewsWithoutSaving(n,r,s,O.nm.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return`${Ht.COMMON_CONTAINER_ID_PREFIX}.${(0,O.Hg)(e)}.${(0,qr.R)()}`}saveViewCustomizations(){const e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(const[t,i]of this.viewContainersCustomLocations){const o=this.getViewContainerById(t);o&&!this.isGeneratedContainerId(t)&&i===this.getDefaultViewContainerLocation(o)||(e.viewContainerLocations[t]=i)}for(const[t,i]of this.viewDescriptorsCustomLocations){const o=this.getViewContainerById(i);o&&this.getDefaultContainerById(t)?.id===o.id||(e.viewLocations[t]=i)}for(const[t,i]of this.viewContainerBadgeEnablementStates)!1===i&&(e.viewContainerBadgeEnablementStates[t]=i);this.viewCustomizations=e}get viewCustomizations(){return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=this._viewCustomizations.viewContainerLocations??{},this._viewCustomizations.viewLocations=this._viewCustomizations.viewLocations??{},this._viewCustomizations.viewContainerBadgeEnablementStates=this._viewCustomizations.viewContainerBadgeEnablementStates??{}),this._viewCustomizations}set viewCustomizations(e){const t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(Ht.VIEWS_CUSTOMIZATIONS,0,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(Ht.VIEWS_CUSTOMIZATIONS,e,0,0)}getViewsByContainer(e){const t=this.viewsRegistry.getViews(e).filter(i=>(this.viewDescriptorsCustomLocations.get(i.id)??e.id)===e.id);for(const[i,o]of this.viewDescriptorsCustomLocations.entries()){if(o!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;const n=this.getViewDescriptorById(i);n&&t.push(n)}return t}onDidRegisterViewContainer(e){const t=!!this.isGeneratedContainerId(e.id)||this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){let t=this.viewContainerModels.get(e)?.viewContainerModel;if(!t){const i=new C.SL;t=i.add(this.instantiationService.createInstance(hn,e)),this.onDidChangeActiveViews({added:t.activeViewDescriptors,removed:[]}),t.onDidChangeActiveViewDescriptors(n=>this.onDidChangeActiveViews(n),this,i),this.onDidChangeVisibleViews({added:[...t.visibleViewDescriptors],removed:[]}),t.onDidAddVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:n.map(({viewDescriptor:r})=>r),removed:[]}),this,i),t.onDidRemoveVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:[],removed:n.map(({viewDescriptor:r})=>r)}),this,i),i.add((0,C.OF)(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),i.add(this.registerResetViewContainerAction(e)),this.viewContainerModels.set(e,{viewContainerModel:t,disposables:i,dispose:()=>i.dispose()}),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);const o=this.getViewsByContainer(e).filter(n=>this.getDefaultContainerById(n.id)!==e);o.length&&(this.addViews(e,o),this.contextKeyService.bufferChangeEvents(()=>{o.forEach(n=>this.getOrCreateMovableViewContextKey(n).set(!!n.canMoveView))}))}return t}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e)}onDidChangeActiveViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!1))})}onDidChangeVisibleViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!1))})}registerViewsVisibilityActions(){for(const[e,{viewContainerModel:t,disposables:i}]of this.viewContainerModels)this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t)),i.add(S.ju.any(t.onDidChangeActiveViewDescriptors,t.onDidAddVisibleViewDescriptors,t.onDidRemoveVisibleViewDescriptors,t.onDidMoveVisibleViewDescriptors)(o=>this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t))))}registerViewsVisibilityActionsForContainer(e){const t=new C.SL;return e.activeViewDescriptors.forEach((i,o)=>{i.remoteAuthority||(t.add((0,v.r1)(class extends Ci.wr{constructor(){super({id:`${i.id}.toggleVisibility`,viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?y.Ao.true():y.Ao.false(),toggled:y.Ao.has(`${i.id}.visible`),title:i.name,menu:[{id:Ci.jc,group:"1_toggleViews",when:y.Ao.and(y.Ao.equals("viewContainer",e.viewContainer.id),y.Ao.equals("viewContainerLocation",(0,O.Hg)(0))),order:o},{id:v.eH.ViewContainerTitleContext,when:y.Ao.and(y.Ao.equals("viewContainer",e.viewContainer.id)),order:o,group:"1_toggleVisibility"},{id:v.eH.ViewTitleContext,when:y.Ao.and(e.visibleViewDescriptors.length>1?y.Ao.or(...e.visibleViewDescriptors.map(n=>y.Ao.equals("view",n.id))):y.Ao.false()),order:o,group:"2_toggleVisibility"}]})}runInViewPaneContainer(n,r){return(0,w.Z)(function*(){r.toggleViewVisibility(i.id)})()}})),t.add((0,v.r1)(class extends Ci.wr{constructor(){super({id:`${i.id}.removeView`,viewPaneContainerId:e.viewContainer.id,title:(0,p.NC)("hideView","Hide '{0}'",i.name),precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?y.Ao.true():y.Ao.false(),menu:[{id:v.eH.ViewTitleContext,when:y.Ao.and(y.Ao.equals("view",i.id),y.Ao.has(`${i.id}.visible`)),group:"1_hide",order:1}]})}runInViewPaneContainer(n,r){return(0,w.Z)(function*(){r.toggleViewVisibility(i.id)})()}})))}),t}registerResetViewContainerAction(e){const t=this;return(0,v.r1)(class extends v.Ke{constructor(){super({id:`${e.id}.resetViewContainerLocation`,title:{original:"Reset Location",value:(0,p.NC)("resetViewLocation","Reset Location")},menu:[{id:v.eH.ViewContainerTitleContext,when:y.Ao.or(y.Ao.and(y.Ao.equals("viewContainer",e.id),y.Ao.equals(`${e.id}.defaultViewContainerLocation`,!1)))}]})}run(){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e))}})}addViews(e,t,i=O.nm.Default){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(o=>{const n=this.getDefaultContainerById(o.id)===e;this.getOrCreateDefaultViewLocationContextKey(o).set(n),n?this.viewDescriptorsCustomLocations.delete(o.id):this.viewDescriptorsCustomLocations.set(o.id,e.id)})}),this.getViewContainerModel(e).add(t.map(o=>({viewDescriptor:o,collapsed:i===O.nm.Default&&void 0,visible:i!==O.nm.Default||void 0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(i=>{this.viewDescriptorsCustomLocations.get(i.id)===e.id&&this.viewDescriptorsCustomLocations.delete(i.id),this.getOrCreateDefaultViewLocationContextKey(i).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){const t=`${e.id}.active`;let i=this.activeViewContextKeys.get(t);return i||(i=new y.uy(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){const t=`${e.id}.visible`;let i=this.activeViewContextKeys.get(t);return i||(i=new y.uy(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){const t=`${e.id}.canMove`;let i=this.movableViewContextKeys.get(t);return i||(i=new y.uy(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){const t=`${e.id}.defaultViewLocation`;let i=this.defaultViewLocationContextKeys.get(t);return i||(i=new y.uy(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){const t=`${e.id}.defaultViewContainerLocation`;let i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new y.uy(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}};Oi.VIEWS_CUSTOMIZATIONS="views.customizations",Oi.COMMON_CONTAINER_ID_PREFIX="workbench.views.service",Oi=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,y.i6),(0,h.fM)(2,Ie.Uy),(0,h.fM)(3,Pt.QS),(0,h.fM)(4,Ue.bU)],Oi);var yt=m(57229);const ri="workbench.action.globalActivity",Eo="workbench.action.accountsActivity";var si=m(73794);let un=class extends C.JT{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=C.JT.None,this._register(S.ju.filter(this.viewDescriptorService.onDidChangeContainer,o=>o.views.some(n=>n.id===e))(()=>this.update())),this._register(S.ju.filter(this.viewDescriptorService.onDidChangeLocation,o=>o.views.some(n=>n.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();const e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose()}};un=(0,h.gn)([(0,h.fM)(1,O.XH),(0,h.fM)(2,yt.By)],un);let pn=class{constructor(e,t,i){this.paneCompositeService=e,this.viewDescriptorService=t,this.instantiationService=i,this.viewActivities=new Map}showViewContainerActivity(e,{badge:t,clazz:i,priority:o}){const n=this.viewDescriptorService.getViewContainerById(e);if(n){const r=this.viewDescriptorService.getViewContainerLocation(n);if(null!==r)return this.paneCompositeService.showActivity(n.id,r,t,i,o)}return C.JT.None}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(un,e)},this.viewActivities.set(e,i));const o=i.id;i.activity.setActivity(t);const n=i;return(0,C.OF)(()=>{n.id===o&&(n.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(Eo,0,e,t,i)}showGlobalActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(ri,0,e,t,i)}};pn=(0,h.gn)([(0,h.fM)(0,si.c),(0,h.fM)(1,O.XH),(0,h.fM)(2,R.TG)],pn),(0,ve.Z)('.monaco-workbench .part.activitybar{height:100%;width:48px}.monaco-workbench .activitybar.bordered:before{border-color:inherit;box-sizing:border-box;content:"";float:left;height:100%;position:absolute;width:0}.monaco-workbench .activitybar.left.bordered:before{border-right-style:solid;border-right-width:1px;right:0}.monaco-workbench .activitybar.right.bordered:before{border-left-style:solid;border-left-width:1px;left:0}.monaco-workbench .activitybar>.content{display:flex;flex-direction:column;height:100%;justify-content:space-between}.monaco-workbench .activitybar>.content .monaco-action-bar{background-color:inherit;text-align:left}.monaco-workbench .activitybar .action-item:focus{outline:0!important}.monaco-workbench .activitybar>.content>.composite-bar{margin-bottom:auto}.monaco-workbench .activitybar .menubar,.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more{height:35px;width:100%}',{}),(0,ve.Z)('.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item{display:block;position:relative}.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:before{background-color:transparent;content:"";display:none;height:2px;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:background-color;width:48px}.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:before{margin-top:-2px;top:1px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:after{bottom:1px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:first-of-type:before{margin-top:-2px;top:2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type:after{bottom:2px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before{transition-delay:0s}.monaco-workbench .activitybar>.content.dragged-over-head>.composite-bar>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .activitybar>.content.dragged-over-tail>.composite-bar>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom+.action-item:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type.bottom:after{background-color:var(--insert-border-color)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label{box-sizing:border-box;display:flex;height:48px;margin-right:0;overflow:hidden;position:relative;width:48px;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label:not(.codicon){font-size:15px;line-height:40px;padding:0 0 0 48px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label.codicon{align-items:center;font-size:24px;justify-content:center}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.codicon{color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.uri-icon{background-color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-left:2px solid;content:"";height:100%;position:absolute;top:0;width:0;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before{height:100%;top:0}.monaco-workbench.hc-black .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator.action-item,.monaco-workbench.hc-light .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator{display:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.clicked:focus:before{border-left:none!important}.monaco-workbench .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{left:0}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{right:0}.monaco-workbench.hc-black .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-black .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before{outline:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{bottom:0;height:100%;left:0;margin:auto;overflow:hidden;position:absolute;top:0;width:100%}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge{z-index:2}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{pointer-events:none}.monaco-workbench.border .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{left:-2px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .badge-content{border-radius:20px;font-size:9px;font-weight:600;height:16px;line-height:16px;min-width:8px;padding:0 4px;position:absolute;right:8px;text-align:center;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge .profile-badge-content{background-color:var(--vscode-profileBadge-background);border:2px solid var(--vscode-activityBar-background);border-radius:7px;color:var(--vscode-profileBadge-foreground);font-size:9px;font-weight:600;line-height:10px;padding:2px 3px;position:absolute;right:6px;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:active .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .profile-badge-content{color:var(--vscode-activityBar-foreground)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content{font-size:12px;font-weight:unset;justify-content:center;padding:0}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content:before{text-align:center;vertical-align:baseline}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{left:auto;right:0}',{});var dt=m(6262),P=m(32243),Fe=m(59494),Z=m(13141),hc=m(25237);function gn(){return(gn=(0,w.Z)(function*(c,e){const t=yield c.getPassword(`${e.urlProtocol}.login`,"account");if(t)try{const i=JSON.parse(t);if(i&&(0,A.HD)(i.id)&&(0,A.HD)(i.accessToken)&&(0,A.HD)(i.providerId))return i}catch{}})).apply(this,arguments)}Z.P.registerCommand("workbench.getCodeExchangeProxyEndpoints",function(c,e){return c.get(hc.y).options?.codeExchangeProxyEndpoints}),v.BH.appendMenuItem(v.eH.AccountsContext,{command:{id:"noAuthenticationProviders",title:p.NC("authentication.Placeholder","No accounts requested yet..."),precondition:y.Ao.false()}});const pc=(0,R.yh)("IAuthenticationService");var G=m(31719),gc=m(81532),tt=m(63171);const fc=(0,R.yh)("credentialsService");var mc=m(75221);let Hi=class Ua extends Fe.JS{constructor(e,t,i,o,n){super(e),this.paneCompositePart=t,this.layoutService=i,this.telemetryService=o,this.configurationService=n,this.lastRun=0}updateActivity(e){this.activity=e}run(e){var t=this;return(0,w.Z)(function*(){if(e instanceof MouseEvent&&2===e.button)return;const i=Date.now();if(i>t.lastRun&&i-t.lastRun<Ua.preventDoubleClickDelay)return;t.lastRun=i;const o=t.layoutService.isVisible("workbench.parts.sidebar"),n=t.paneCompositePart.getActivePaneComposite(),r=t.configurationService.getValue("workbench.activityBar.iconClickBehavior"),s=!e||!("preserveFocus"in e)||!e.preserveFocus;if(!o||n?.getId()!==t.activity.id)return t.logAction("show"),yield t.paneCompositePart.openPaneComposite(t.activity.id,s),t.activate();"focus"===r?(t.logAction("refocus"),t.paneCompositePart.openPaneComposite(t.activity.id,s)):(t.logAction("hide"),t.layoutService.setPartHidden(!0,"workbench.parts.sidebar"))})()}logAction(e){this.telemetryService.publicLog2("activityBarAction",{viewletId:this.activity.id,action:e})}};Hi.preventDoubleClickDelay=300,Hi=(0,h.gn)([(0,h.fM)(2,et.z),(0,h.fM)(3,Ue.bU),(0,h.fM)(4,G.Ui)],Hi);let fn=class extends Fe.Pw{constructor(e,t,i,o,n,r,s,a,d,l,u){super(e,i,()=>!0,o,n,d,u),this.contextMenuActionsProvider=t,this.menuService=r,this.contextMenuService=s,this.contextKeyService=a,this.environmentService=l}render(e){var t=this;super.render(e),this._register((0,g.nm)(this.container,g.tw.MOUSE_DOWN,function(){var i=(0,w.Z)(function*(o){g.zB.stop(o,!0),2!==o?.button&&t.run()});return function(o){return i.apply(this,arguments)}}())),this._register((0,g.nm)(this.container,g.tw.CONTEXT_MENU,function(){var i=(0,w.Z)(function*(o){const n=new C.SL,r=yield t.resolveContextMenuActions(n),s=new ct.nV(o),a={x:s.posx,y:s.posy};t.contextMenuService.showContextMenu({getAnchor:()=>a,getActions:()=>r,onHide:()=>n.dispose()})});return function(o){return i.apply(this,arguments)}}())),this._register((0,g.nm)(this.container,g.tw.KEY_UP,i=>{const o=new dt.y1(i);(o.equals(3)||o.equals(10))&&(g.zB.stop(i,!0),this.run())})),this._register((0,g.nm)(this.container,ae.t.Tap,i=>{g.zB.stop(i,!0),this.run()}))}resolveContextMenuActions(e){var t=this;return(0,w.Z)(function*(){return t.contextMenuActionsProvider()})()}};fn=(0,h.gn)([(0,h.fM)(3,K.XE),(0,h.fM)(4,tt.B),(0,h.fM)(5,v.co),(0,h.fM)(6,ge.i),(0,h.fM)(7,y.i6),(0,h.fM)(8,G.Ui),(0,h.fM)(9,wt.n),(0,h.fM)(10,Se.d)],fn);let xo=class extends fn{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E){super(t,i,{draggable:!1,colors:n,icon:o,hasPopup:!0,hoverOptions:r},s,a,d,l,u,f,b,E),this.menuId=e}run(){var e=this;return(0,w.Z)(function*(){const t=new C.SL,i=t.add(e.menuService.createMenu(e.menuId,e.contextKeyService)),o=yield e.resolveMainMenuActions(i,t);e.contextMenuService.showContextMenu({getAnchor:()=>e.container,anchorAlignment:"left"===e.configurationService.getValue("workbench.sideBar.location")?1:0,anchorAxisAlignment:1,getActions:()=>o,onHide:()=>t.dispose(),menuActionOptions:{renderShortTitle:!0}})})()}resolveMainMenuActions(e,t){return(0,w.Z)(function*(){const i=[];return(0,Be.vr)(e,{renderShortTitle:!0},{primary:[],secondary:i}),i})()}};xo=(0,h.gn)([(0,h.fM)(6,K.XE),(0,h.fM)(7,tt.B),(0,h.fM)(8,v.co),(0,h.fM)(9,ge.i),(0,h.fM)(10,y.i6),(0,h.fM)(11,G.Ui),(0,h.fM)(12,wt.n),(0,h.fM)(13,Se.d)],xo);let ai=class Ka extends xo{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X){super(v.eH.AccountsContext,e,t,!0,i,o,n,r,a,s,d,b,u,k),this.authenticationService=l,this.productService=f,this.storageService=E,this.credentialsService=M,this.logService=X,this.groupedAccounts=new Map,this.problematicProviders=new Set,this.initialized=!1,this.sessionFromEmbedder=function uc(c,e){return gn.apply(this,arguments)}(this.credentialsService,this.productService),this.registerListeners(),this.initialize()}registerListeners(){var e=this;this._register(this.authenticationService.onDidRegisterAuthenticationProvider(function(){var t=(0,w.Z)(function*(i){yield e.addAccountsFromProvider(i.id)});return function(i){return t.apply(this,arguments)}}())),this._register(this.authenticationService.onDidUnregisterAuthenticationProvider(t=>{this.groupedAccounts.delete(t.id),this.problematicProviders.delete(t.id)})),this._register(this.authenticationService.onDidChangeSessions(function(){var t=(0,w.Z)(function*(i){for(const o of[...i.event.changed,...i.event.added])try{yield e.addOrUpdateAccount(i.providerId,o.account)}catch(n){e.logService.error(n)}for(const o of i.event.removed)e.removeAccount(i.providerId,o.account)});return function(i){return t.apply(this,arguments)}}()))}initialize(){var e=this;return(0,w.Z)(function*(){const t=e.authenticationService.getProviderIds(),i=yield Promise.allSettled(t.map(o=>e.addAccountsFromProvider(o)));for(const o of i)"rejected"===o.status&&e.logService.error(o.reason);e.initialized=!0})()}resolveMainMenuActions(e,t){var i=()=>super.resolveMainMenuActions,o=this;return(0,w.Z)(function*(){yield i().call(o,e,t);const n=o.authenticationService.getProviderIds(),r=e.getActions();let s=[];for(const a of n){if(!o.initialized){const u=t.add(new P.aU("noAccountsAvailable",(0,p.NC)("loading","Loading..."),void 0,!1));s.push(u);break}const d=o.authenticationService.getLabel(a),l=o.groupedAccounts.get(a);if(l)for(const u of l){const b=[t.add(new P.aU(`configureSessions${u.label}`,(0,p.NC)("manageTrustedExtensions","Manage Trusted Extensions"),void 0,!0,()=>o.authenticationService.manageTrustedExtensionsForAccount(a,u.label)))];if(u.canSignOut){const k=t.add(new P.aU("signOut",(0,p.NC)("signOut","Sign Out"),void 0,!0,(0,w.Z)(function*(){const X=(yield o.authenticationService.getSessions(a)).filter(ee=>ee.account.id===u.id);return yield o.authenticationService.removeAccountSessions(a,u.label,X)})));b.push(k)}const E=new P.wY("activitybar.submenu",`${u.label} (${d})`,b);s.push(E)}else if(o.problematicProviders.has(a)){const u=t.add(new P.aU("providerUnavailable",(0,p.NC)("authProviderUnavailable","{0} is currently unavailable",d),void 0,!1));s.push(u);try{yield o.addAccountsFromProvider(a)}catch(f){o.logService.error(f)}}}if(n.length&&!s.length){const a=t.add(new P.aU("noAccountsAvailable",(0,p.NC)("noAccounts","You are not signed in to any accounts"),void 0,!1));s.push(a)}return s.length&&r.length&&s.push(new P.Z0),r.forEach((a,d)=>{s=s.concat(a[1]),d!==r.length-1&&s.push(new P.Z0)}),s})()}resolveContextMenuActions(e){var t=()=>super.resolveContextMenuActions,i=this;return(0,w.Z)(function*(){const o=yield t().call(i,e);return o.unshift((0,P.xw)({id:"hideAccounts",label:(0,p.NC)("hideAccounts","Hide Accounts"),run:()=>i.storageService.store(Ka.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,!1,0,0)}),new P.Z0),o})()}addOrUpdateAccount(e,t){var i=this;return(0,w.Z)(function*(){let o=i.groupedAccounts.get(e);if(o){const s=o.find(a=>a.id===t.id);if(s)return void(s.label!==t.label&&(s.label=t.label))}else o=[],i.groupedAccounts.set(e,o);const n=yield i.sessionFromEmbedder;let r=!!n?.canSignOut;r||(r=!n?.id||!(yield i.authenticationService.getSessions(e)).filter(a=>a.account.id===t.id).some(a=>a.id===n.id)),o.push({...t,canSignOut:r})})()}removeAccount(e,t){const i=this.groupedAccounts.get(e);if(!i)return;const o=i.findIndex(n=>n.id===t.id);-1!==o&&(i.splice(o,1),0===i.length&&this.groupedAccounts.delete(e))}addAccountsFromProvider(e){var t=this;return(0,w.Z)(function*(){try{const i=yield t.authenticationService.getSessions(e);t.problematicProviders.delete(e);for(const o of i)try{yield t.addOrUpdateAccount(e,o.account)}catch(n){t.logService.error(n)}}catch(i){t.logService.error(i),t.problematicProviders.add(e)}})()}};ai.ACCOUNTS_VISIBILITY_PREFERENCE_KEY="workbench.activity.showAccounts",ai=(0,h.gn)([(0,h.fM)(4,K.XE),(0,h.fM)(5,tt.B),(0,h.fM)(6,ge.i),(0,h.fM)(7,v.co),(0,h.fM)(8,y.i6),(0,h.fM)(9,pc),(0,h.fM)(10,wt.n),(0,h.fM)(11,gc.a),(0,h.fM)(12,G.Ui),(0,h.fM)(13,Ie.Uy),(0,h.fM)(14,Se.d),(0,h.fM)(15,fc),(0,h.fM)(16,Ae.VZ)],ai);let mn=class extends xo{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b){super(v.eH.GlobalActivity,e,t,!0,i,o,r,s,a,d,l,u,f,b),this.userDataProfileService=n,this._register(S.ju.any(this.userDataProfileService.onDidUpdateCurrentProfile,this.userDataProfileService.onDidChangeCurrentProfile)(()=>this.updateProfileBadge()))}render(e){super.render(e),this.profileBadge=(0,g.R3)(e,(0,g.$)(".profile-badge")),this.profileBadgeContent=(0,g.R3)(this.profileBadge,(0,g.$)(".profile-badge-content")),this.updateProfileBadge()}updateProfileBadge(){!this.profileBadge||!this.profileBadgeContent||((0,g.PO)(this.profileBadgeContent),(0,g.Cp)(this.profileBadge),!this.userDataProfileService.currentProfile.isDefault&&(this.action.getBadge()||(this.profileBadgeContent.textContent=this.userDataProfileService.currentProfile.name.substring(0,2).toUpperCase(),(0,g.$Z)(this.profileBadge))))}updateBadge(){super.updateBadge(),this.updateProfileBadge()}computeTitle(){return this.userDataProfileService.currentProfile.isDefault?super.computeTitle():(0,p.NC)("manage","Manage {0} (Profile)",this.userDataProfileService.currentProfile.name)}};mn=(0,h.gn)([(0,h.fM)(4,mc.A),(0,h.fM)(5,K.XE),(0,h.fM)(6,tt.B),(0,h.fM)(7,v.co),(0,h.fM)(8,ge.i),(0,h.fM)(9,y.i6),(0,h.fM)(10,G.Ui),(0,h.fM)(11,wt.n),(0,h.fM)(12,Se.d)],mn);class vc extends Hi{}class os extends Fe.du{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class ns extends Fe.B7{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class rs extends v.Ke{constructor(e,t){super(e),this.offset=t}run(e){var t=this;return(0,w.Z)(function*(){const i=e.get(si.c),o=i.getVisiblePaneCompositeIds(0),n=i.getActivePaneComposite(0);if(!n)return;let r;for(let s=0;s<o.length;s++)if(o[s]===n.getId()){r=o[(s+o.length+t.offset)%o.length];break}yield i.openPaneComposite(r,0,!0)})()}}(0,v.r1)(class extends rs{constructor(){super({id:"workbench.action.previousSideBarView",title:{value:(0,p.NC)("previousSideBarView","Previous Primary Side Bar View"),original:"Previous Primary Side Bar View"},category:Ee.R.View,f1:!0},-1)}}),(0,v.r1)(class extends rs{constructor(){super({id:"workbench.action.nextSideBarView",title:{value:(0,p.NC)("nextSideBarView","Next Primary Side Bar View"),original:"Next Primary Side Bar View"},category:Ee.R.View,f1:!0},1)}}),(0,v.r1)(class extends v.Ke{constructor(){super({id:"workbench.action.focusActivityBar",title:{value:(0,p.NC)("focusActivityBar","Focus Activity Bar"),original:"Focus Activity Bar"},category:Ee.R.View,f1:!0})}run(e){return(0,w.Z)(function*(){const t=e.get(et.z);t.setPartHidden(!1,"workbench.parts.activitybar"),t.focusPart("workbench.parts.activitybar")})()}}),(0,K.Ic)((c,e)=>{const t=c.getColor(I.D$);t&&e.addRule(`\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator:before {\n\t\t\t\tborder-left-color: ${t};\n\t\t\t}\n\t\t`);const i=c.getColor(I.sz);i&&e.addRule(`\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus::before {\n\t\t\t\tvisibility: hidden;\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus .active-item-indicator:before {\n\t\t\t\tvisibility: visible;\n\t\t\t\tborder-left-color: ${i};\n\t\t\t}\n\t\t`);const o=c.getColor(I.MQ);o&&e.addRule(`\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator {\n\t\t\t\tz-index: 0;\n\t\t\t\tbackground-color: ${o};\n\t\t\t}\n\t\t`);const n=c.getColor(Y.xL1);if(n)e.addRule(`\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:before {\n\t\t\t\tcontent: "";\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 8px;\n\t\t\t\tleft: 8px;\n\t\t\t\theight: 32px;\n\t\t\t\twidth: 32px;\n\t\t\t\tz-index: 1;\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.profile-activity-item:before {\n\t\t\t\ttop: -6px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before {\n\t\t\t\toutline: 1px solid;\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {\n\t\t\t\toutline: 1px dashed;\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {\n\t\t\t\tborder-left-color: ${n};\n\t\t\t}\n\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before,\n\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {\n\t\t\t\toutline-color: ${n};\n\t\t\t}\n\t\t`);else{const r=c.getColor(Y.R80);r&&e.addRule(`\n\t\t\t\t.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {\n\t\t\t\t\t\tborder-left-color: ${r};\n\t\t\t\t\t}\n\t\t\t\t`)}});var ci=m(92207),vn=m(55459);class ss{constructor(e,t,i,o,n){this.viewDescriptorService=e,this.targetContainerLocation=t,this.openComposite=i,this.moveComposite=o,this.getItems=n}drop(e,t,i,o){const n=e.getData();if("composite"===n.type){const r=this.viewDescriptorService.getViewContainerById(n.id);if(this.viewDescriptorService.getViewContainerLocation(r)===this.targetContainerLocation)t&&this.moveComposite(n.id,t,o);else{if(this.viewDescriptorService.getViewContainerModel(r).allViewDescriptors.some(d=>!d.canMoveView))return;this.viewDescriptorService.moveViewContainerToLocation(r,this.targetContainerLocation,this.getTargetIndex(t,o))}}if("view"===n.type){const r=this.viewDescriptorService.getViewDescriptorById(n.id);if(r&&r.canMoveView){this.viewDescriptorService.moveViewToLocation(r,this.targetContainerLocation);const s=this.viewDescriptorService.getViewContainerByViewId(r.id);t&&this.moveComposite(s.id,t,o),this.openComposite(s.id,!0).then(a=>{a?.openView(r.id,!0)})}}}onDragEnter(e,t,i){return this.canDrop(e,t)}onDragOver(e,t,i){return this.canDrop(e,t)}getTargetIndex(e,t){if(!e)return;const i=this.getItems(),o=1===this.targetContainerLocation?t?.horizontallyBefore:t?.verticallyBefore;return i.filter(n=>n.visible).findIndex(n=>n.id===e)+(o?0:1)}canDrop(e,t){const i=e.getData();if("composite"===i.type){const o=this.viewDescriptorService.getViewContainerById(i.id);return this.viewDescriptorService.getViewContainerLocation(o)===this.targetContainerLocation?i.id!==t:!this.viewDescriptorService.getViewContainerModel(o).allViewDescriptors.some(s=>!s.canMoveView)}{const o=this.viewDescriptorService.getViewDescriptorById(i.id);return!(!o||!o.canMoveView)}}}let ko=class extends vn.${constructor(e,t,i,o,n){super(),this.options=t,this.instantiationService=i,this.contextMenuService=o,this.viewDescriptorService=n,this._onDidChange=this._register(new S.Q5),this.onDidChange=this._onDidChange.event,this.model=new bc(e,t),this.visibleComposites=[],this.compositeSizeInBar=new Map,this.computeSizes(this.model.visibleItems)}getCompositeBarItems(){return[...this.model.items]}setCompositeBarItems(e){this.model.setItems(e)&&this.updateCompositeSwitcher()}getPinnedComposites(){return this.model.pinnedItems}getVisibleComposites(){return this.model.visibleItems}create(e){const t=e.appendChild((0,g.$)(".composite-bar"));let i;return this.compositeSwitcherBar=this._register(new qe.o(t,{actionViewItemProvider:o=>{if(o instanceof Fe.L$)return this.compositeOverflowActionViewItem;const n=this.model.findItem(o.id);return n&&this.instantiationService.createInstance(Fe.fn,{draggable:!0,colors:this.options.colors,icon:this.options.icon,hoverOptions:this.options.activityHoverOptions},o,n.pinnedAction,n.toggleBadgeAction,r=>this.options.getContextMenuActionsForComposite(r),()=>this.getContextMenuActions(),this.options.dndHandler,this)},orientation:this.options.orientation,ariaLabel:(0,p.NC)("activityBarAriaLabel","Active View Switcher"),ariaRole:"tablist",animated:!1,preventLoopNavigation:this.options.preventLoopNavigation,triggerKeys:{keyDown:!0}})),this._register((0,g.nm)(e,g.tw.CONTEXT_MENU,o=>this.showContextMenu(o))),this._register(ae.o.addTarget(e)),this._register((0,g.nm)(e,ae.t.Contextmenu,o=>this.showContextMenu(o))),this._register(B.Mi.INSTANCE.registerTarget(e,{onDragOver:o=>{const n=this.getVisibleComposites();if(!n.length||o.eventData.target&&(0,g.jg)(o.eventData.target,t))return void(i=this.updateFromDragging(e,!1,!1,!0));const r=this.insertAtFront(t,o.eventData),a=this.options.dndHandler.onDragOver(o.dragAndDropData,(r?n[0]:n[n.length-1]).id,o.eventData);(0,B.cP)(o.eventData.dataTransfer,"move",a),i=this.updateFromDragging(e,a,r,!0)},onDragLeave:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDragEnd:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDrop:o=>{const n=this.getVisibleComposites();if(n.length){const r=this.insertAtFront(t,o.eventData)?n[0]:n[n.length-1];this.options.dndHandler.drop(o.dragAndDropData,r.id,o.eventData,i)}i=this.updateFromDragging(e,!1,!1,!1)}})),t}insertAtFront(e,t){const i=e.getBoundingClientRect(),o=t.clientX,n=t.clientY;switch(this.options.orientation){case 0:return o<i.left;case 1:return n<i.top}}updateFromDragging(e,t,i,o){if(e.classList.toggle("dragged-over",o),e.classList.toggle("dragged-over-head",t&&i),e.classList.toggle("dragged-over-tail",t&&!i),t)return{verticallyBefore:i,horizontallyBefore:i}}focus(e){this.compositeSwitcherBar?.focus(e)}recomputeSizes(){this.computeSizes(this.model.visibleItems)}layout(e){this.dimension=e,0!==e.height&&0!==e.width&&(0===this.compositeSizeInBar.size&&this.computeSizes(this.model.visibleItems),this.updateCompositeSwitcher())}addComposite({id:e,name:t,order:i,requestedIndex:o}){this.model.add(e,t,i,o)&&(this.computeSizes([this.model.findItem(e)]),this.updateCompositeSwitcher())}removeComposite(e){this.isPinned(e)&&this.unpin(e),this.model.remove(e)&&this.updateCompositeSwitcher()}hideComposite(e){this.model.hide(e)&&(this.resetActiveComposite(e),this.updateCompositeSwitcher())}activateComposite(e){const t=this.model.activeItem;this.model.activate(e)&&(-1===this.visibleComposites.indexOf(e)||this.model.activeItem&&!this.model.activeItem.pinned||t&&!t.pinned)&&this.updateCompositeSwitcher()}deactivateComposite(e){const t=this.model.activeItem;this.model.deactivate()&&t&&!t.pinned&&this.updateCompositeSwitcher()}showActivity(e,t,i,o){if(!t)throw(0,Xe.b1)("badge");"number"!=typeof o&&(o=0);const n={badge:t,clazz:i,priority:o};return this.model.addActivity(e,n),(0,C.OF)(()=>this.model.removeActivity(e,n))}pin(e,t){var i=this;return(0,w.Z)(function*(){i.model.setPinned(e,!0)&&(i.updateCompositeSwitcher(),t&&(yield i.options.openComposite(e),i.activateComposite(e)))})()}unpin(e){this.model.setPinned(e,!1)&&(this.updateCompositeSwitcher(),this.resetActiveComposite(e))}areBadgesEnabled(e){return this.viewDescriptorService.getViewContainerBadgeEnablementState(e)}toggleBadgeEnablement(e){this.viewDescriptorService.setViewContainerBadgeEnablementState(e,!this.areBadgesEnabled(e)),this.updateCompositeSwitcher();const t=this.model.findItem(e);t&&t.activityAction.setBadge(t.activityAction.getBadge(),t.activityAction.getClass())}resetActiveComposite(e){const t=this.options.getDefaultCompositeId();!this.model.activeItem||this.model.activeItem.id!==e||(this.deactivateComposite(e),t&&t!==e&&this.isPinned(t)?this.options.openComposite(t,!0):this.options.openComposite(this.visibleComposites.filter(i=>i!==e)[0]))}isPinned(e){return this.model.findItem(e)?.pinned}move(e,t,i){if(void 0!==i){const o=this.model.items.findIndex(r=>r.id===e);let n=this.model.items.findIndex(r=>r.id===t);o>=0&&n>=0&&(!i&&o>n&&n++,i&&o<n&&n--,n<this.model.items.length&&n>=0&&n!==o&&this.model.move(this.model.items[o].id,this.model.items[n].id)&&setTimeout(()=>this.updateCompositeSwitcher(),0))}else this.model.move(e,t)&&setTimeout(()=>this.updateCompositeSwitcher(),0)}getAction(e){return this.model.findItem(e)?.activityAction}computeSizes(e){const t=this.options.compositeSize;if(t)e.forEach(i=>this.compositeSizeInBar.set(i.id,t));else{const i=this.compositeSwitcherBar;if(i&&this.dimension&&0!==this.dimension.height&&0!==this.dimension.width){const o=i.viewItems.length;i.push(e.map(n=>n.activityAction)),e.forEach((n,r)=>this.compositeSizeInBar.set(n.id,1===this.options.orientation?i.getHeight(o+r):i.getWidth(o+r))),e.forEach(()=>i.pull(i.viewItems.length-1))}}}updateCompositeSwitcher(){const e=this.compositeSwitcherBar;if(!e||!this.dimension)return;let t=this.model.visibleItems.filter(a=>a.pinned||this.model.activeItem&&this.model.activeItem.id===a.id).map(a=>a.id),i=t.length;const o=t.length;let n=0;const r=1===this.options.orientation?this.dimension.height:this.dimension.width;for(let a=0;a<t.length;a++){const d=this.compositeSizeInBar.get(t[a]);if(n+d>r){i=a;break}n+=d}for(o>i&&(t=t.slice(0,i)),this.model.activeItem&&t.every(a=>!!this.model.activeItem&&a!==this.model.activeItem.id)&&(n+=this.compositeSizeInBar.get(this.model.activeItem.id),t.push(this.model.activeItem.id));n>r&&t.length;){const a=t.length>1?t.splice(t.length-2,1)[0]:t.pop();n-=this.compositeSizeInBar.get(a)}for(o>t.length&&(n+=this.options.overflowActionSize);n>r&&t.length;){const a=t.length>1&&t[t.length-1]===this.model.activeItem?.id?t.splice(t.length-2,1)[0]:t.pop();n-=this.compositeSizeInBar.get(a)}o===t.length&&this.compositeOverflowAction&&(e.pull(e.length()-1),this.compositeOverflowAction.dispose(),this.compositeOverflowAction=void 0,this.compositeOverflowActionViewItem?.dispose(),this.compositeOverflowActionViewItem=void 0);const s=[];this.visibleComposites.forEach((a,d)=>{t.includes(a)||s.push(d)}),s.reverse().forEach(a=>{const d=e.viewItems[a];e.pull(a),d.dispose(),this.visibleComposites.splice(a,1)}),t.forEach((a,d)=>{const l=this.visibleComposites.indexOf(a);if(d!==l){if(-1!==l){const u=e.viewItems[l];e.pull(l),u.dispose(),this.visibleComposites.splice(l,1)}e.push(this.model.findItem(a).activityAction,{label:!0,icon:this.options.icon,index:d}),this.visibleComposites.splice(d,0,a)}}),o>t.length&&!this.compositeOverflowAction&&(this.compositeOverflowAction=this.instantiationService.createInstance(Fe.L$,()=>{this.compositeOverflowActionViewItem?.showMenu()}),this.compositeOverflowActionViewItem=this.instantiationService.createInstance(Fe.Ui,this.compositeOverflowAction,()=>this.getOverflowingComposites(),()=>this.model.activeItem?this.model.activeItem.id:void 0,a=>this.model.findItem(a)?.activity[0]?.badge,this.options.getOnCompositeClickAction,this.options.colors,this.options.activityHoverOptions),e.push(this.compositeOverflowAction,{label:!1,icon:!0})),this._onDidChange.fire()}getOverflowingComposites(){let e=this.model.visibleItems.filter(t=>t.pinned).map(t=>t.id);return this.model.activeItem&&!this.model.activeItem.pinned&&e.push(this.model.activeItem.id),e=e.filter(t=>!this.visibleComposites.includes(t)),this.model.visibleItems.filter(t=>e.includes(t.id)).map(t=>({id:t.id,name:this.getAction(t.id)?.label||t.name}))}showContextMenu(e){g.zB.stop(e,!0);const t=new ct.nV(e);this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>this.getContextMenuActions(e)})}getContextMenuActions(e){return this.model.visibleItems.map(({id:i,name:o,activityAction:n})=>(0,P.xw)({id:i,label:this.getAction(i).label||o||i,checked:this.isPinned(i),enabled:n.enabled,run:()=>{this.isPinned(i)?this.unpin(i):this.pin(i,!0)}}))}};ko=(0,h.gn)([(0,h.fM)(2,R.TG),(0,h.fM)(3,ge.i),(0,h.fM)(4,O.XH)],ko);class bc{get items(){return this._items}constructor(e,t){this._items=[],this.options=t,this.setItems(e)}setItems(e){const t=[];let i=!1;if(this.items&&0!==this.items.length){const o=this.items;for(let n=0;n<e.length;n++){const r=e[n],s=o.filter(({id:a})=>a===r.id)[0];s?s.pinned!==r.pinned||n!==o.indexOf(s)?(s.pinned=r.pinned,t.push(s),i=!0):t.push(s):(t.push(this.createCompositeBarItem(r.id,r.name,r.order,r.pinned,r.visible)),i=!0)}this._items=t}else this._items=e.map(o=>this.createCompositeBarItem(o.id,o.name,o.order,o.pinned,o.visible)),i=!0;return i}get visibleItems(){return this.items.filter(e=>e.visible)}get pinnedItems(){return this.items.filter(e=>e.visible&&e.pinned)}createCompositeBarItem(e,t,i,o,n){const r=this.options;return{id:e,name:t,pinned:o,order:i,visible:n,activity:[],get activityAction(){return r.getActivityAction(e)},get pinnedAction(){return r.getCompositePinnedAction(e)},get toggleBadgeAction(){return r.getCompositeBadgeAction(e)}}}add(e,t,i,o){const n=this.findItem(e);if(n){let r=!1;return n.name=t,(0,A.Jp)(i)||(r=n.order!==i,n.order=i),n.visible||(n.visible=!0,r=!0),r}{const r=this.createCompositeBarItem(e,t,i,!0,!0);if((0,A.Jp)(o))if((0,A.Jp)(i))this.items.push(r);else{let s=0;for(;s<this.items.length&&"number"==typeof this.items[s].order&&this.items[s].order<i;)s++;this.items.splice(s,0,r)}else{let s=0,a=o;for(;a>0&&s<this.items.length;)this.items[s++].visible&&a--;this.items.splice(s,0,r)}return!0}}remove(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return this.items.splice(t,1),!0;return!1}hide(e){for(const t of this.items)if(t.id===e)return!!t.visible&&(t.visible=!1,!0);return!1}move(e,t){const i=this.findIndex(e),o=this.findIndex(t);if(-1===i||-1===o)return!1;const n=this.items.splice(i,1)[0];return this.items.splice(o,0,n),n.pinned=!0,!0}setPinned(e,t){for(const i of this.items)if(i.id===e)return i.pinned!==t&&(i.pinned=t,!0);return!1}addActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity;for(let n=0;n<=o.length;n++){if(n===o.length){o.push(t);break}if(o[n].priority<=t.priority){o.splice(n,0,t);break}}return this.updateActivity(e),!0}return!1}removeActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity.indexOf(t);if(-1!==o)return i.activity.splice(o,1),this.updateActivity(e),!0}return!1}updateActivity(e){const t=this.findItem(e);if(t)if(t.activity.length){const[{badge:i,clazz:o}]=t.activity;t.activityAction.setBadge(i,o)}else t.activityAction.setBadge(void 0)}activate(e){if(!this.activeItem||this.activeItem.id!==e){this.activeItem&&this.deactivate();for(const t of this.items)if(t.id===e)return this.activeItem=t,this.activeItem.activityAction.activate(),!0}return!1}deactivate(){return!!this.activeItem&&(this.activeItem.activityAction.deactivate(),this.activeItem=void 0,!0)}findItem(e){return this.items.filter(t=>t.id===e)[0]}findIndex(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return t;return-1}}(0,ve.Z)(".monaco-workbench .menubar .toolbar-toggle-more,.monaco-workbench .menubar>.menubar-menu-button{color:var(--vscode-titleBar-activeForeground)}.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button{color:var(--vscode-activityBar-inactiveForeground)}.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover,.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus .toolbar-toggle-more{color:var(--vscode-activityBar-foreground)}.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button,.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button .toolbar-toggle-more{color:var(--vscode-titleBar-inactiveForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .toolbar-toggle-more,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .toolbar-toggle-more{color:var(--vscode-menubar-selectionForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .menubar-menu-title{background-color:var(--vscode-menubar-selectionBackground)}.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline:dashed 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title{outline:solid 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline-color:var(--vscode-menubar-selectionBorder);outline-offset:-1px}",{});var Si=m(42462),F=m(84621),Ct=m(36725),Ve=m(26056),Ut=m(82927),yc=m(3582),Cc=m(17360),Bi=m(37781),We=m(36450),$=m(62981),it=m(19980),Kt=m(16003);(0,ve.Z)('.menubar{box-sizing:border-box;display:flex;flex-shrink:1;height:100%;overflow:hidden}.menubar.overflow-menu-only{width:38px}.fullscreen .menubar:not(.compact){margin:0;padding:4px 5px}.menubar>.menubar-menu-button{-webkit-app-region:no-drag;zoom:1;align-items:center;box-sizing:border-box;cursor:default;display:flex;outline:0!important;white-space:nowrap}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title{outline-color:var(--vscode-focusBorder);outline-offset:-1px;outline-style:solid;outline-width:1px}.menubar.compact{flex-shrink:0;overflow:visible}.menubar.compact>.menubar-menu-button{height:100%;padding:0;width:100%}.menubar-menu-title{border-radius:5px;padding:0 8px}.menubar .menubar-menu-items-holder{left:0;opacity:1;position:fixed;z-index:2000}.menubar.compact .menubar-menu-items-holder{position:fixed}.menubar .menubar-menu-items-holder.monaco-menu-container{border:none;outline:0}.menubar .menubar-menu-items-holder.monaco-menu-container :focus{outline:0}.menubar .toolbar-toggle-more{align-items:center;display:flex;height:22px;justify-content:center;padding:0 8px;vertical-align:sub;width:22px}.menubar.compact .toolbar-toggle-more{align-items:center;cursor:pointer;display:flex;justify-content:center;left:0;position:relative;top:0;width:100%}.menubar.compact .toolbar-toggle-more:before,.menubar:not(.compact) .menubar-menu-button:first-child .toolbar-toggle-more:before{content:"\\eb94"!important}.menubar.compact>.menubar-menu-button.open .menubar-menu-title,.menubar.compact>.menubar-menu-button:focus .menubar-menu-title,.menubar.compact>.menubar-menu-button:hover .menubar-menu-title{outline-offset:-8px!important;outline-width:1px!important}',{});const Ei=g.$;var q=(()=>((q=q||{})[q.HIDDEN=0]="HIDDEN",q[q.VISIBLE=1]="VISIBLE",q[q.FOCUSED=2]="FOCUSED",q[q.OPEN=3]="OPEN",q))();let Ec=(()=>{class c extends C.JT{constructor(t,i,o){super(),this.container=t,this.options=i,this.menuStyle=o,this._mnemonicsInUse=!1,this.openedViaKeyboard=!1,this.awaitingAltRelease=!1,this.ignoreNextMouseUp=!1,this.updatePending=!1,this.numMenusShown=0,this.overflowLayoutScheduled=void 0,this.container.setAttribute("role","menubar"),this.isCompact&&this.container.classList.add("compact"),this.menus=[],this.mnemonics=new Map,this._focusState=q.VISIBLE,this._onVisibilityChange=this._register(new S.Q5),this._onFocusStateChange=this._register(new S.Q5),this.createOverflowMenu(),this.menuUpdater=this._register(new Ve.pY(()=>this.update(),200)),this.actionRunner=this.options.actionRunner??this._register(new P.Wi),this._register(this.actionRunner.onWillRun(()=>{this.setUnfocusedState()})),this._register(g._q.getInstance().event(this.onModifierKeyToggled,this)),this._register(g.nm(this.container,g.tw.KEY_DOWN,n=>{const r=new dt.y1(n);let s=!0;const a=n.key?n.key.toLocaleLowerCase():"",d=F.dz&&!this.isCompact;if(r.equals(15)||d&&r.equals(1026))this.focusPrevious();else if(r.equals(17)||d&&r.equals(2))this.focusNext();else if(r.equals(9)&&this.isFocused&&!this.isOpen)this.setUnfocusedState();else if(!this.isOpen&&!r.ctrlKey&&this.options.enableMnemonics&&this.mnemonicsInUse&&this.mnemonics.has(a)){const l=this.mnemonics.get(a);this.onMenuTriggered(l,!1)}else s=!1;!this.isCompact&&(r.equals(1026)||r.equals(2))&&r.preventDefault(),s&&(r.preventDefault(),r.stopPropagation())})),this._register(g.nm(window,g.tw.MOUSE_DOWN,()=>{this.isFocused&&this.setUnfocusedState()})),this._register(g.nm(this.container,g.tw.FOCUS_IN,n=>{const r=n;r.relatedTarget&&(this.container.contains(r.relatedTarget)||(this.focusToReturn=r.relatedTarget))})),this._register(g.nm(this.container,g.tw.FOCUS_OUT,n=>{n.relatedTarget?n.relatedTarget&&!this.container.contains(n.relatedTarget)&&(this.focusToReturn=void 0,this.setUnfocusedState()):this.setUnfocusedState()})),this._register(g.nm(window,g.tw.KEY_DOWN,n=>{if(!this.options.enableMnemonics||!n.altKey||n.ctrlKey||n.defaultPrevented)return;const r=n.key.toLocaleLowerCase();if(!this.mnemonics.has(r))return;this.mnemonicsInUse=!0,this.updateMnemonicVisibility(!0);const s=this.mnemonics.get(r);this.onMenuTriggered(s,!1)})),this.setUnfocusedState()}push(t){(0,L._2)(t).forEach(o=>{const n=this.menus.length,r=(0,We.t7)(o.label),s=We.Dy.exec(o.label);if(s&&this.registerMnemonic(this.menus.length,s[1]?s[1]:s[3]),this.isCompact)this.menus.push(o);else{const a=Ei("div.menubar-menu-button",{role:"menuitem",tabindex:-1,"aria-label":r,"aria-haspopup":!0}),d=Ei("div.menubar-menu-title",{role:"none","aria-hidden":!0});a.appendChild(d),this.container.insertBefore(a,this.overflowMenu.buttonElement),this.updateLabels(d,a,o.label),this._register(g.nm(a,g.tw.KEY_UP,l=>{const u=new dt.y1(l);let f=!0;!u.equals(18)&&!u.equals(3)||this.isOpen?f=!1:(this.focusedMenu={index:n},this.openedViaKeyboard=!0,this.focusState=q.OPEN),f&&(u.preventDefault(),u.stopPropagation())})),this._register(ae.o.addTarget(a)),this._register(g.nm(a,ae.t.Tap,l=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&g.jg(l.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(n,!0),l.preventDefault(),l.stopPropagation())})),this._register(g.nm(a,g.tw.MOUSE_DOWN,l=>{new ct.nV(l).leftButton?(this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(n,!0)),l.preventDefault(),l.stopPropagation()):l.preventDefault()})),this._register(g.nm(a,g.tw.MOUSE_UP,l=>{l.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(n,!0))})),this._register(g.nm(a,g.tw.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(n)?(a.focus(),this.cleanupCustomMenu(),this.showCustomMenu(n,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:n},a.focus())})),this.menus.push({label:o.label,actions:o.actions,buttonElement:a,titleElement:d})}})}createOverflowMenu(){const t=this.isCompact?p.NC("mAppMenu","Application Menu"):p.NC("mMore","More"),i=Ei("div.menubar-menu-button",{role:"menuitem",tabindex:this.isCompact?0:-1,"aria-label":t,"aria-haspopup":!0}),o=Ei("div.menubar-menu-title.toolbar-toggle-more"+be.kS.asCSSSelector($.lA.menuBarMore),{role:"none","aria-hidden":!0});i.appendChild(o),this.container.appendChild(i),i.style.visibility="hidden",this._register(g.nm(i,g.tw.KEY_UP,n=>{const r=new dt.y1(n);let s=!0;const a=[3];this.isCompact?(a.push(10),this.options.compactMode===We.Nm.Right?a.push(17):this.options.compactMode===We.Nm.Left&&a.push(15)):a.push(18),a.some(d=>r.equals(d))&&!this.isOpen?(this.focusedMenu={index:c.OVERFLOW_INDEX},this.openedViaKeyboard=!0,this.focusState=q.OPEN):s=!1,s&&(r.preventDefault(),r.stopPropagation())})),this._register(ae.o.addTarget(i)),this._register(g.nm(i,ae.t.Tap,n=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&g.jg(n.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(c.OVERFLOW_INDEX,!0),n.preventDefault(),n.stopPropagation())})),this._register(g.nm(i,g.tw.MOUSE_DOWN,n=>{new ct.nV(n).leftButton?(this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(c.OVERFLOW_INDEX,!0)),n.preventDefault(),n.stopPropagation()):n.preventDefault()})),this._register(g.nm(i,g.tw.MOUSE_UP,n=>{n.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(c.OVERFLOW_INDEX,!0))})),this._register(g.nm(i,g.tw.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(c.OVERFLOW_INDEX)?(this.overflowMenu.buttonElement.focus(),this.cleanupCustomMenu(),this.showCustomMenu(c.OVERFLOW_INDEX,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:c.OVERFLOW_INDEX},i.focus())})),this.overflowMenu={buttonElement:i,titleElement:o,label:"More",actions:[]}}updateMenu(t){const i=this.menus.filter(o=>o.label===t.label);i&&i.length&&(i[0].actions=t.actions)}dispose(){super.dispose(),this.menus.forEach(t=>{t.titleElement?.remove(),t.buttonElement?.remove()}),this.overflowMenu.titleElement.remove(),this.overflowMenu.buttonElement.remove(),(0,C.B9)(this.overflowLayoutScheduled),this.overflowLayoutScheduled=void 0}blur(){this.setUnfocusedState()}getWidth(){if(!this.isCompact&&this.menus){const t=this.menus[0].buttonElement.getBoundingClientRect().left;return(this.hasOverflow?this.overflowMenu.buttonElement.getBoundingClientRect().right:this.menus[this.menus.length-1].buttonElement.getBoundingClientRect().right)-t}return 0}getHeight(){return this.container.clientHeight}toggleFocus(){this.isFocused||"hidden"===this.options.visibility?this.isOpen||this.setUnfocusedState():(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:c.OVERFLOW_INDEX},this.focusState=q.FOCUSED)}updateOverflowAction(){if(!this.menus||!this.menus.length)return;const t="overflow-menu-only";this.container.classList.toggle(t,!1);const i=this.container.offsetWidth;let o=0,n=this.isCompact;const r=this.numMenusShown;this.numMenusShown=0;const s=this.menus.filter(a=>void 0!==a.buttonElement&&void 0!==a.titleElement);for(const a of s){if(!n){const d=a.buttonElement.offsetWidth;o+d>i?n=!0:(o+=d,this.numMenusShown++,this.numMenusShown>r&&(a.buttonElement.style.visibility="visible"))}n&&(a.buttonElement.style.visibility="hidden")}if(this.numMenusShown-1<=s.length/2){for(const a of s)a.buttonElement.style.visibility="hidden";n=!0,this.numMenusShown=0,o=0}if(this.isCompact){this.overflowMenu.actions=[];for(let d=this.numMenusShown;d<this.menus.length;d++)this.overflowMenu.actions.push(new P.wY(`menubar.submenu.${this.menus[d].label}`,this.menus[d].label,this.menus[d].actions||[]));const a=this.options.getCompactMenuActions?.();a&&a.length&&(this.overflowMenu.actions.push(new P.Z0),this.overflowMenu.actions.push(...a)),this.overflowMenu.buttonElement.style.visibility="visible"}else if(n){for(;o+this.overflowMenu.buttonElement.offsetWidth>i&&this.numMenusShown>0;){this.numMenusShown--;const a=s[this.numMenusShown].buttonElement.offsetWidth;s[this.numMenusShown].buttonElement.style.visibility="hidden",o-=a}this.overflowMenu.actions=[];for(let a=this.numMenusShown;a<s.length;a++)this.overflowMenu.actions.push(new P.wY(`menubar.submenu.${s[a].label}`,s[a].label,s[a].actions||[]));this.overflowMenu.buttonElement.nextElementSibling!==s[this.numMenusShown].buttonElement&&(this.overflowMenu.buttonElement.remove(),this.container.insertBefore(this.overflowMenu.buttonElement,s[this.numMenusShown].buttonElement)),this.overflowMenu.buttonElement.style.visibility="visible"}else this.overflowMenu.buttonElement.remove(),this.container.appendChild(this.overflowMenu.buttonElement),this.overflowMenu.buttonElement.style.visibility="hidden";this.container.classList.toggle(t,0===this.numMenusShown)}updateLabels(t,i,o){const n=(0,We.t7)(o);if(this.options.enableMnemonics){const s=Kt.YU(o);We.Yo.lastIndex=0;let a=We.Yo.exec(s);for(;a&&a[1];)a=We.Yo.exec(s);const d=l=>l.replace(/&amp;&amp;/g,"&amp;");a?(t.innerText="",t.append(Kt.j3(d(s.substr(0,a.index))," "),Ei("mnemonic",{"aria-hidden":"true"},a[3]),Kt.oL(d(s.substr(a.index+a[0].length))," "))):t.innerText=d(s).trim()}else t.innerText=n.replace(/&&/g,"&");const r=We.Dy.exec(o);r&&(this.options.enableMnemonics?i.setAttribute("aria-keyshortcuts","Alt+"+(r[1]?r[1]:r[3]).toLocaleLowerCase()):i.removeAttribute("aria-keyshortcuts"))}update(t){t&&(this.options=t),this.isFocused?this.updatePending=!0:(this.menus.forEach(i=>{!i.buttonElement||!i.titleElement||this.updateLabels(i.titleElement,i.buttonElement,i.label)}),this.overflowLayoutScheduled||(this.overflowLayoutScheduled=g.jL(()=>{this.updateOverflowAction(),this.overflowLayoutScheduled=void 0})),this.setUnfocusedState())}registerMnemonic(t,i){this.mnemonics.set(i.toLocaleLowerCase(),t)}hideMenubar(){"none"!==this.container.style.display&&(this.container.style.display="none",this._onVisibilityChange.fire(!1))}showMenubar(){"flex"!==this.container.style.display&&(this.container.style.display="flex",this._onVisibilityChange.fire(!0),this.updateOverflowAction())}get focusState(){return this._focusState}set focusState(t){if(this._focusState>=q.FOCUSED&&t<q.FOCUSED&&this.updatePending&&(this.menuUpdater.schedule(),this.updatePending=!1),t===this._focusState)return;const i=this.isVisible,o=this.isOpen,n=this.isFocused;switch(this._focusState=t,t){case q.HIDDEN:i&&this.hideMenubar(),o&&this.cleanupCustomMenu(),n&&(this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case q.VISIBLE:i||this.showMenubar(),o&&this.cleanupCustomMenu(),n&&(this.focusedMenu&&(this.focusedMenu.index===c.OVERFLOW_INDEX?this.overflowMenu.buttonElement.blur():this.menus[this.focusedMenu.index].buttonElement?.blur()),this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case q.FOCUSED:i||this.showMenubar(),o&&this.cleanupCustomMenu(),this.focusedMenu&&(this.focusedMenu.index===c.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus());break;case q.OPEN:i||this.showMenubar(),this.focusedMenu&&this.showCustomMenu(this.focusedMenu.index,this.openedViaKeyboard)}this._focusState=t,this._onFocusStateChange.fire(this.focusState>=q.FOCUSED)}get isVisible(){return this.focusState>=q.VISIBLE}get isFocused(){return this.focusState>=q.FOCUSED}get isOpen(){return this.focusState>=q.OPEN}get hasOverflow(){return this.isCompact||this.numMenusShown<this.menus.length}get isCompact(){return void 0!==this.options.compactMode}setUnfocusedState(){this.focusState="toggle"===this.options.visibility||"hidden"===this.options.visibility||"classic"===this.options.visibility&&Bi.isFullscreen()?q.HIDDEN:q.VISIBLE,this.ignoreNextMouseUp=!1,this.mnemonicsInUse=!1,this.updateMnemonicVisibility(!1)}focusPrevious(){if(!this.focusedMenu||0===this.numMenusShown)return;let t=(this.focusedMenu.index-1+this.numMenusShown)%this.numMenusShown;this.focusedMenu.index===c.OVERFLOW_INDEX?t=this.numMenusShown-1:0===this.focusedMenu.index&&this.hasOverflow&&(t=c.OVERFLOW_INDEX),t!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(t)):this.isFocused&&(this.focusedMenu.index=t,t===c.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[t].buttonElement?.focus()))}focusNext(){if(!this.focusedMenu||0===this.numMenusShown)return;let t=(this.focusedMenu.index+1)%this.numMenusShown;this.focusedMenu.index===c.OVERFLOW_INDEX?t=0:this.focusedMenu.index===this.numMenusShown-1&&(t=c.OVERFLOW_INDEX),t!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(t)):this.isFocused&&(this.focusedMenu.index=t,t===c.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[t].buttonElement?.focus()))}updateMnemonicVisibility(t){this.menus&&this.menus.forEach(i=>{if(i.titleElement&&i.titleElement.children.length){const o=i.titleElement.children.item(0);o&&(o.style.textDecoration=this.options.alwaysOnMnemonics||t?"underline":"")}})}get mnemonicsInUse(){return this._mnemonicsInUse}set mnemonicsInUse(t){this._mnemonicsInUse=t}get shouldAltKeyFocus(){return!(F.dz||this.options.disableAltFocus&&"toggle"!==this.options.visibility)}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}onMenuTriggered(t,i){this.isOpen?this.isCurrentMenu(t)?this.setUnfocusedState():(this.cleanupCustomMenu(),this.showCustomMenu(t,this.openedViaKeyboard)):(this.focusedMenu={index:t},this.openedViaKeyboard=!i,this.focusState=q.OPEN)}onModifierKeyToggled(t){const i=!(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey);"hidden"!==this.options.visibility&&(t.event&&this.shouldAltKeyFocus&&159===it.Z5.toEnum(t.event.code)&&t.event.preventDefault(),this.isFocused&&"alt"===t.lastKeyPressed&&t.altKey&&(this.setUnfocusedState(),this.mnemonicsInUse=!1,this.awaitingAltRelease=!0),i&&"alt"===t.lastKeyPressed&&"alt"===t.lastKeyReleased&&(this.awaitingAltRelease||(!this.isFocused&&this.shouldAltKeyFocus?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:c.OVERFLOW_INDEX},this.focusState=q.FOCUSED):this.isOpen||this.setUnfocusedState())),!t.altKey&&"alt"===t.lastKeyReleased&&(this.awaitingAltRelease=!1),this.options.enableMnemonics&&this.menus&&!this.isOpen&&this.updateMnemonicVisibility(!this.awaitingAltRelease&&t.altKey||this.mnemonicsInUse))}isCurrentMenu(t){return!!this.focusedMenu&&this.focusedMenu.index===t}cleanupCustomMenu(){this.focusedMenu&&(this.focusedMenu.index===c.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus(),this.focusedMenu.holder&&(this.focusedMenu.holder.parentElement?.classList.remove("open"),this.focusedMenu.holder.remove()),this.focusedMenu.widget?.dispose(),this.focusedMenu={index:this.focusedMenu.index})}showCustomMenu(t,i=!0){const o=t>=this.numMenusShown?c.OVERFLOW_INDEX:t,n=o===c.OVERFLOW_INDEX?this.overflowMenu:this.menus[o];if(!n.actions||!n.buttonElement||!n.titleElement)return;const r=Ei("div.menubar-menu-items-holder",{title:""});n.buttonElement.classList.add("open");const s=n.titleElement.getBoundingClientRect(),a=g.I8(n.titleElement);this.options.compactMode===We.Nm.Right?(r.style.top=`${s.top}px`,r.style.left=`${s.left+this.container.clientWidth}px`):this.options.compactMode===We.Nm.Left?(r.style.top=`${s.top}px`,r.style.right=`${this.container.clientWidth}px`,r.style.left="auto"):(r.style.top=s.bottom*a+"px",r.style.left=s.left*a+"px"),n.buttonElement.appendChild(r);const d={getKeyBinding:this.options.getKeybinding,actionRunner:this.actionRunner,enableMnemonics:this.options.alwaysOnMnemonics||this.mnemonicsInUse&&this.options.enableMnemonics,ariaLabel:(0,A.f6)(n.buttonElement.getAttribute("aria-label")),expandDirection:this.isCompact?this.options.compactMode:We.Nm.Right,useEventAsContext:!0},l=this._register(new We.v2(r,n.actions,d,this.menuStyle));this._register(l.onDidCancel(()=>{this.focusState=q.FOCUSED})),o!==t?l.trigger(t-this.numMenusShown):l.focus(i),this.focusedMenu={index:o,holder:r,widget:l}}}return c.OVERFLOW_INDEX=-1,c})();var lt=m(74486),xc=m(62465),Do=m(76148),kc=m(26278),xi=m(5716),ki=m(89295),T=m(28759),St=m(79026),ce=m(39108),as=m(90290),Dc=m(49698),bn=m(43764),z=m(17088),wn=m(6640);function cs(c){return c&&c.hasOwnProperty("folderUri")}const ds="inRecentFilesPicker";class Ac extends v.Ke{constructor(e){super(e),this.removeFromRecentlyOpened={iconClass:be.kS.asClassName($.lA.removeClose),tooltip:(0,p.NC)("remove","Remove from Recently Opened")},this.dirtyRecentlyOpenedFolder={iconClass:"dirty-workspace "+be.kS.asClassName($.lA.closeDirty),tooltip:(0,p.NC)("dirtyRecentlyOpenedFolder","Folder With Unsaved Files"),alwaysVisible:!0},this.dirtyRecentlyOpenedWorkspace={...this.dirtyRecentlyOpenedFolder,tooltip:(0,p.NC)("dirtyRecentlyOpenedWorkspace","Workspace With Unsaved Files")}}run(e){var t=this;return(0,w.Z)(function*(){const i=e.get(Ct.Dc),o=e.get(St.eJ),n=e.get(ce.ec),r=e.get(Ut.e),s=e.get(Se.d),a=e.get(as.q),d=e.get(Dc.O),l=e.get(Do.$),u=e.get(ki.Ss),f=yield i.getRecentlyOpened(),b=yield i.getDirtyWorkspaces();let E=!1;const k=new Te.Y9,M=new Te.Y9;for(const se of b)cs(se)?k.set(se.folderUri,!0):(M.set(se.workspace.configPath,se.workspace),E=!0);const X=new Te.Y9,ee=new Te.Y9;for(const se of f.workspaces)(0,Ct.ID)(se)?X.set(se.folderUri,!0):(ee.set(se.workspace.configPath,se.workspace),E=!0);const De=[];for(const se of f.workspaces){const bt=(0,Ct.ID)(se)?k.has(se.folderUri):M.has(se.workspace.configPath);De.push(t.toQuickPick(a,d,r,se,bt))}for(const se of b)(cs(se)&&!X.has(se.folderUri)||(c=se)&&c.hasOwnProperty("workspace")&&!ee.has(se.workspace.configPath))&&De.push(t.toQuickPick(a,d,r,se,!0));var c;const mt=f.files.map(se=>t.toQuickPick(a,d,r,se,!1)),$e=f.workspaces[0],Q=$e&&n.isCurrentWorkspace((0,Ct.eI)($e)?$e.workspace:$e.folderUri);let re;const fe={type:"separator",label:E?(0,p.NC)("workspacesAndFolders","folders & workspaces"):(0,p.NC)("folders","folders")},vt={type:"separator",label:(0,p.NC)("files","files")},Ni=[fe,...De,vt,...mt],Kr=yield o.pick(Ni,{contextKey:ds,activeItem:[...De,...mt][Q?1:0],placeHolder:F.dz?(0,p.NC)("openRecentPlaceholderMac","Select to open (hold Cmd-key to force new window or Option-key for same window)"):(0,p.NC)("openRecentPlaceholder","Select to open (hold Ctrl-key to force new window or Alt-key for same window)"),matchOnDescription:!0,onKeyMods:se=>re=se,quickNavigate:t.isQuickNavigate()?{keybindings:s.lookupKeybindings(t.desc.id)}:void 0,hideInput:t.isQuickNavigate(),onDidTriggerItemButton:(se=(0,w.Z)(function*(bt){if(bt.button===t.removeFromRecentlyOpened)yield i.removeRecentlyOpened([bt.item.resource]),bt.removeItem();else if(bt.button===t.dirtyRecentlyOpenedFolder||bt.button===t.dirtyRecentlyOpenedWorkspace){const rn=bt.button===t.dirtyRecentlyOpenedWorkspace,{confirmed:Zh}=yield u.confirm({title:rn?(0,p.NC)("dirtyWorkspace","Workspace with Unsaved Files"):(0,p.NC)("dirtyFolder","Folder with Unsaved Files"),message:rn?(0,p.NC)("dirtyWorkspaceConfirm","Do you want to open the workspace to review the unsaved files?"):(0,p.NC)("dirtyFolderConfirm","Do you want to open the folder to review the unsaved files?"),detail:rn?(0,p.NC)("dirtyWorkspaceConfirmDetail","Workspaces with unsaved files cannot be removed until all unsaved files have been saved or reverted."):(0,p.NC)("dirtyFolderConfirmDetail","Folders with unsaved files cannot be removed until all unsaved files have been saved or reverted.")});Zh&&(l.openWindow([bt.item.openable],{remoteAuthority:bt.item.remoteAuthority||null}),o.cancel())}}),function(rn){return se.apply(this,arguments)})});var se;if(Kr)return l.openWindow([Kr.openable],{forceNewWindow:re?.ctrlCmd,forceReuseWindow:re?.alt,remoteAuthority:Kr.remoteAuthority||null})})()}toQuickPick(e,t,i,o,n){let r,s,a,d,l=!1;(0,Ct.ID)(o)?(d=o.folderUri,s=(0,bn.r)(e,t,d,z.RR.FOLDER),r={folderUri:d},a=o.label||i.getWorkspaceLabel(d,{verbose:2})):(0,Ct.eI)(o)?(d=o.workspace.configPath,s=(0,bn.r)(e,t,d,z.RR.ROOT_FOLDER),r={workspaceUri:d},a=o.label||i.getWorkspaceLabel(o.workspace,{verbose:2}),l=!0):(d=o.fileUri,s=(0,bn.r)(e,t,d,z.RR.FILE),r={fileUri:d},a=o.label||i.getUriLabel(d));const{name:u,parentPath:f}=(0,lt.w7)(a);return{iconClasses:s,label:u,ariaLabel:n?l?(0,p.NC)("recentDirtyWorkspaceAriaLabel","{0}, workspace with unsaved changes",u):(0,p.NC)("recentDirtyFolderAriaLabel","{0}, folder with unsaved changes",u):u,description:f,buttons:n?[l?this.dirtyRecentlyOpenedWorkspace:this.dirtyRecentlyOpenedFolder]:[this.removeFromRecentlyOpened],openable:r,resource:d,remoteAuthority:o.remoteAuthority}}}let _c=(()=>{class c extends Ac{constructor(){super({id:c.ID,title:{value:(0,p.NC)("openRecent","Open Recent..."),mnemonicTitle:(0,p.NC)({key:"miMore",comment:["&& denotes a mnemonic"]},"&&More..."),original:"Open Recent..."},category:Ee.R.File,f1:!0,keybinding:{weight:200,primary:2096,mac:{primary:304}},menu:{id:v.eH.MenubarRecentMenu,group:"y_more",order:1}})}isQuickNavigate(){return!1}}return c.ID="workbench.action.openRecent",c})();const ls=y.Ao.and(wn.gz,y.Ao.has(ds)),hs="workbench.action.quickOpenNavigateNextInRecentFilesPicker";T.W.registerCommandAndKeybindingRule({id:hs,weight:250,handler:(0,wn.x8)(hs,!0),when:ls,primary:2096,mac:{primary:304}});const us="workbench.action.quickOpenNavigatePreviousInRecentFilesPicker";T.W.registerCommandAndKeybindingRule({id:us,weight:250,handler:(0,wn.x8)(us,!1),when:ls,primary:3120,mac:{primary:1328}}),Z.P.registerCommand("workbench.action.toggleConfirmBeforeClose",c=>{const e=c.get(G.Ui),t=e.inspect("window.confirmBeforeClose").userValue;return e.updateValue("window.confirmBeforeClose","never"===t?"keyboardOnly":"never")});var Tc=m(53085);v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarFileMenu,title:{value:"File",original:"File",mnemonicTitle:(0,p.NC)({key:"mFile",comment:["&& denotes a mnemonic"]},"&&File")},order:1}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarEditMenu,title:{value:"Edit",original:"Edit",mnemonicTitle:(0,p.NC)({key:"mEdit",comment:["&& denotes a mnemonic"]},"&&Edit")},order:2}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarSelectionMenu,title:{value:"Selection",original:"Selection",mnemonicTitle:(0,p.NC)({key:"mSelection",comment:["&& denotes a mnemonic"]},"&&Selection")},order:3}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarViewMenu,title:{value:"View",original:"View",mnemonicTitle:(0,p.NC)({key:"mView",comment:["&& denotes a mnemonic"]},"&&View")},order:4}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarGoMenu,title:{value:"Go",original:"Go",mnemonicTitle:(0,p.NC)({key:"mGoto",comment:["&& denotes a mnemonic"]},"&&Go")},order:5}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarTerminalMenu,title:{value:"Terminal",original:"Terminal",mnemonicTitle:(0,p.NC)({key:"mTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal")},order:7}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarHelpMenu,title:{value:"Help",original:"Help",mnemonicTitle:(0,p.NC)({key:"mHelp",comment:["&& denotes a mnemonic"]},"&&Help")},order:8}),v.BH.appendMenuItem(v.eH.MenubarMainMenu,{submenu:v.eH.MenubarPreferencesMenu,title:{value:"Preferences",original:"Preferences",mnemonicTitle:(0,p.NC)({key:"mPreferences",comment:["&& denotes a mnemonic"]},"Preferences")},when:xi.hr,order:9});let Vc=(()=>{class c extends C.JT{constructor(t,i,o,n,r,s,a,d,l,u,f,b,E,k){super(),this.menuService=t,this.workspacesService=i,this.contextKeyService=o,this.keybindingService=n,this.configurationService=r,this.labelService=s,this.updateService=a,this.storageService=d,this.notificationService=l,this.preferencesService=u,this.environmentService=f,this.accessibilityService=b,this.hostService=E,this.commandService=k,this.keys=["window.menuBarVisibility","window.enableMenuBarMnemonics","window.customMenuBarAltFocus","workbench.sideBar.location","window.nativeTabs"],this.menus={},this.topLevelTitles={},this.recentlyOpened={files:[],workspaces:[]},this.mainMenu=this._register(this.menuService.createMenu(v.eH.MenubarMainMenu,this.contextKeyService)),this.mainMenuDisposables=this._register(new C.SL),this.setupMainMenu(),this.menuUpdater=this._register(new Ve.pY(()=>this.doUpdateMenubar(!1),200)),this.notifyUserOfCustomMenubarAccessibility()}registerListeners(){this._register(this.hostService.onDidChangeFocus(t=>this.onDidChangeWindowFocus(t))),this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t))),this.updateService.onStateChange(()=>this.onUpdateStateChange()),this._register(this.workspacesService.onDidChangeRecentlyOpened(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.keybindingService.onDidUpdateKeybindings(()=>this.updateMenubar())),this._register(this.labelService.onDidChangeFormatters(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.mainMenu.onDidChange(()=>{this.setupMainMenu(),this.doUpdateMenubar(!0)}))}setupMainMenu(){this.mainMenuDisposables.clear(),this.menus={},this.topLevelTitles={};const[,t]=this.mainMenu.getActions()[0];for(const i of t)i instanceof v.NZ&&"string"!=typeof i.item.title&&(this.menus[i.item.title.original]=this.mainMenuDisposables.add(this.menuService.createMenu(i.item.submenu,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.topLevelTitles[i.item.title.original]=i.item.title.mnemonicTitle??i.item.title.value)}updateMenubar(){this.menuUpdater.schedule()}calculateActionLabel(t){return t.label}onUpdateStateChange(){this.updateMenubar()}onUpdateKeybindings(){this.updateMenubar()}getOpenRecentActions(){if(!this.recentlyOpened)return[];const{workspaces:t,files:i}=this.recentlyOpened,o=[];if(t.length>0){for(let n=0;n<c.MAX_MENU_RECENT_ENTRIES&&n<t.length;n++)o.push(this.createOpenRecentMenuAction(t[n]));o.push(new P.Z0)}if(i.length>0){for(let n=0;n<c.MAX_MENU_RECENT_ENTRIES&&n<i.length;n++)o.push(this.createOpenRecentMenuAction(i[n]));o.push(new P.Z0)}return o}onDidChangeWindowFocus(t){t&&this.onDidChangeRecentlyOpened()}onConfigurationUpdated(t){this.keys.some(i=>t.affectsConfiguration(i))&&this.updateMenubar(),t.affectsConfiguration("editor.accessibilitySupport")&&this.notifyUserOfCustomMenubarAccessibility(),t.affectsConfiguration("window.menuBarVisibility")&&this.onDidChangeRecentlyOpened()}get menubarHidden(){return!(F.dz&&F.tY||"hidden"!==(0,Si.fi)(this.configurationService))}onDidChangeRecentlyOpened(){this.menubarHidden||this.workspacesService.getRecentlyOpened().then(t=>{this.recentlyOpened=t,this.updateMenubar()})}createOpenRecentMenuAction(t){let i,o,n,r;const s=t.remoteAuthority;(0,Ct.ID)(t)?(o=t.folderUri,i=t.label||this.labelService.getWorkspaceLabel(o,{verbose:2}),n="openRecentFolder",r={folderUri:o}):(0,Ct.eI)(t)?(o=t.workspace.configPath,i=t.label||this.labelService.getWorkspaceLabel(t.workspace,{verbose:2}),n="openRecentWorkspace",r={workspaceUri:o}):(o=t.fileUri,i=t.label||this.labelService.getUriLabel(o),n="openRecentFile",r={fileUri:o});const a=new P.aU(n,(0,lt.NF)(i),void 0,void 0,d=>this.hostService.openWindow([r],{forceNewWindow:!(!d||!(!F.dz&&(d.ctrlKey||d.shiftKey)||F.dz&&(d.metaKey||d.altKey))),remoteAuthority:s||null}));return Object.assign(a,{uri:o,remoteAuthority:s})}notifyUserOfCustomMenubarAccessibility(){if(F.$L||F.dz)return;const t=this.storageService.getBoolean("menubar/accessibleMenubarNotified",-1,!1),i="custom"===(0,Si.ET)(this.configurationService);if(t||i||!this.accessibilityService.isScreenReaderOptimized())return;const o=(0,p.NC)("menubar.customTitlebarAccessibilityNotification","Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.");this.notificationService.prompt(oe.zb.Info,o,[{label:(0,p.NC)("goToSetting","Open Settings"),run:()=>this.preferencesService.openUserSettings({query:"window.titleBarStyle"})}]),this.storageService.store("menubar/accessibleMenubarNotified",!0,-1,0)}}return c.MAX_MENU_RECENT_ENTRIES=10,c})(),yn=class extends Vc{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M){super(e,t,i,o,n,r,s,a,d,l,u,f,k,M),this.layoutService=b,this.telemetryService=E,this.alwaysOnMnemonics=!1,this.focusInsideMenubar=!1,this.pendingFirstTimeUpdate=!1,this.visible=!0,this.webNavigationMenu=this._register(this.menuService.createMenu(v.eH.MenubarHomeMenu,this.contextKeyService)),this.reinstallDisposables=this._register(new C.SL),this._onVisibilityChange=this._register(new S.Q5),this._onFocusStateChange=this._register(new S.Q5),this.actionRunner=this._register(new P.Wi),this.actionRunner.onDidRun(X=>{this.telemetryService.publicLog2("workbenchActionExecuted",{id:X.action.id,from:"menu"})}),this.workspacesService.getRecentlyOpened().then(X=>{this.recentlyOpened=X}),this.registerListeners(),this.registerActions()}doUpdateMenubar(e){this.focusInsideMenubar||this.setupCustomMenubar(e),e&&(this.pendingFirstTimeUpdate=!0)}registerActions(){const e=this;F.$L&&this._register((0,v.r1)(class extends v.Ke{constructor(){super({id:"workbench.actions.menubar.focus",title:{value:(0,p.NC)("focusMenu","Focus Application Menu"),original:"Focus Application Menu"},keybinding:{primary:68,weight:200,when:xi.Pf},f1:!0})}run(){return(0,w.Z)(function*(){e.menubar?.toggleFocus()})()}}))}getUpdateAction(){switch(this.updateService.state.type){case"uninitialized":return null;case"idle":return new P.aU("update.check",(0,p.NC)({key:"checkForUpdates",comment:["&& denotes a mnemonic"]},"Check for &&Updates..."),void 0,!0,()=>this.updateService.checkForUpdates(!0));case"checking for updates":return new P.aU("update.checking",(0,p.NC)("checkingForUpdates","Checking for Updates..."),void 0,!1);case"available for download":return new P.aU("update.downloadNow",(0,p.NC)({key:"download now",comment:["&& denotes a mnemonic"]},"D&&ownload Update"),void 0,!0,()=>this.updateService.downloadUpdate());case"downloading":return new P.aU("update.downloading",(0,p.NC)("DownloadingUpdate","Downloading Update..."),void 0,!1);case"downloaded":return new P.aU("update.install",(0,p.NC)({key:"installUpdate...",comment:["&& denotes a mnemonic"]},"Install &&Update..."),void 0,!0,()=>this.updateService.applyUpdate());case"updating":return new P.aU("update.updating",(0,p.NC)("installingUpdate","Installing Update..."),void 0,!1);case"ready":return new P.aU("update.restart",(0,p.NC)({key:"restartToUpdate",comment:["&& denotes a mnemonic"]},"Restart to &&Update"),void 0,!0,()=>this.updateService.quitAndInstall())}}get currentMenubarVisibility(){return(0,Si.fi)(this.configurationService)}get currentDisableMenuBarAltFocus(){const e=this.configurationService.getValue("window.customMenuBarAltFocus");let t=!1;return"boolean"==typeof e&&(t=!e),t}insertActionsBefore(e,t){switch(e.id){case _c.ID:t.push(...this.getOpenRecentActions());break;case"workbench.action.showAboutDialog":if(!F.dz&&!F.$L){const i=this.getUpdateAction();i&&(i.label=(0,lt.Pg)(i.label),t.push(i),t.push(new P.Z0))}}}get currentEnableMenuBarMnemonics(){let e=this.configurationService.getValue("window.enableMenuBarMnemonics");return"boolean"!=typeof e&&(e=!0),e&&(!F.$L||(0,Bi.isFullscreen)())}get currentCompactMenuMode(){return"compact"!==this.currentMenubarVisibility?void 0:"right"===this.configurationService.getValue("workbench.sideBar.location")?We.Nm.Left:We.Nm.Right}onDidVisibilityChange(e){this.visible=e,this.onDidChangeRecentlyOpened(),this._onVisibilityChange.fire(e)}toActionsArray(e){const t=[];return(0,Be.LJ)(e,{shouldForwardArgs:!0},t),t}setupCustomMenubar(e){if(!this.container)return;e?(this.menubar&&this.reinstallDisposables.clear(),this.menubar=this.reinstallDisposables.add(new Ec(this.container,this.getMenuBarOptions(),zt.ZR)),this.accessibilityService.alwaysUnderlineAccessKeys().then(i=>{this.alwaysOnMnemonics=i,this.menubar?.update(this.getMenuBarOptions())}),this.reinstallDisposables.add(this.menubar.onFocusStateChange(i=>{this._onFocusStateChange.fire(i),i||(this.pendingFirstTimeUpdate?(this.setupCustomMenubar(!0),this.pendingFirstTimeUpdate=!1):this.updateMenubar(),this.focusInsideMenubar=!1)})),this.reinstallDisposables.add(this.menubar.onVisibilityChange(i=>this.onDidVisibilityChange(i))),this.reinstallDisposables.add((0,g.nm)(this.container,g.tw.FOCUS_IN,()=>{this.focusInsideMenubar=!0})),this.reinstallDisposables.add((0,g.nm)(this.container,g.tw.FOCUS_OUT,()=>{this.focusInsideMenubar=!1})),this.menubar.isVisible&&this.onDidVisibilityChange(!0)):this.menubar?.update(this.getMenuBarOptions());const t=(i,o,n)=>{o.splice(0);for(const r of i)if(this.insertActionsBefore(r,o),r instanceof P.Z0)o.push(r);else if(r instanceof v.NZ||r instanceof v.U8){let s="string"==typeof r.item.title?r.item.title:r.item.title.mnemonicTitle??r.item.title.value;if(r instanceof v.NZ){const a=[];t(r.actions,a,n),a.length>0&&o.push(new P.wY(r.id,(0,lt.Pg)(s),a))}else{(0,Tc.X)(r.item.toggled)&&(s=r.item.toggled.mnemonicTitle??r.item.toggled.title??s);const a=new P.aU(r.id,(0,lt.Pg)(s),r.class,r.enabled,()=>this.commandService.executeCommand(r.id));a.tooltip=r.tooltip,a.checked=r.checked,o.push(a)}}if("File"===n&&void 0===this.currentCompactMenuMode){const r=this.getWebNavigationActions();r.length&&o.push(...r)}};for(const i of Object.keys(this.topLevelTitles)){const o=this.menus[i];e&&o&&(this.reinstallDisposables.add(o.onDidChange(()=>{if(!this.focusInsideMenubar){const r=[];t(this.toActionsArray(o),r,i),this.menubar?.updateMenu({actions:r,label:(0,lt.Pg)(this.topLevelTitles[i])})}})),o===this.menus.File&&this.reinstallDisposables.add(this.webNavigationMenu.onDidChange(()=>{if(!this.focusInsideMenubar){const r=[];t(this.toActionsArray(o),r,i),this.menubar?.updateMenu({actions:r,label:(0,lt.Pg)(this.topLevelTitles[i])})}})));const n=[];o&&t(this.toActionsArray(o),n,i),this.menubar&&(e?this.menubar.push({actions:n,label:(0,lt.Pg)(this.topLevelTitles[i])}):this.menubar.updateMenu({actions:n,label:(0,lt.Pg)(this.topLevelTitles[i])}))}}getWebNavigationActions(){var e=this;if(!F.$L)return[];const t=[];for(const i of this.webNavigationMenu.getActions()){const[,o]=i;for(const n of o)n instanceof v.U8&&t.push(new P.aU(n.id,(0,lt.Pg)("string"==typeof n.item.title?n.item.title:n.item.title.mnemonicTitle??n.item.title.value),n.class,n.enabled,function(){var s=(0,w.Z)(function*(a){e.commandService.executeCommand(n.id,a)});return function(a){return s.apply(this,arguments)}}()));t.push(new P.Z0)}return t.length&&t.pop(),t}getMenuBarOptions(){return{enableMnemonics:this.currentEnableMenuBarMnemonics,disableAltFocus:this.currentDisableMenuBarAltFocus,visibility:this.currentMenubarVisibility,actionRunner:this.actionRunner,getKeybinding:e=>this.keybindingService.lookupKeybinding(e.id),alwaysOnMnemonics:this.alwaysOnMnemonics,compactMode:this.currentCompactMenuMode,getCompactMenuActions:()=>F.$L?this.getWebNavigationActions():[]}}onDidChangeWindowFocus(e){this.visible&&(super.onDidChangeWindowFocus(e),this.container&&(e?this.container.classList.remove("inactive"):(this.container.classList.add("inactive"),this.menubar?.blur())))}onUpdateStateChange(){this.visible&&super.onUpdateStateChange()}onDidChangeRecentlyOpened(){this.visible&&super.onDidChangeRecentlyOpened()}onUpdateKeybindings(){this.visible&&super.onUpdateKeybindings()}registerListeners(){super.registerListeners(),this._register((0,g.nm)(window,g.tw.RESIZE,()=>{this.menubar&&(!F.gn||!kc.D.pointerEvents)&&this.menubar.blur()})),F.$L&&(this._register(this.layoutService.onDidChangeFullscreen(e=>this.updateMenubar())),this._register(this.webNavigationMenu.onDidChange(()=>this.updateMenubar())))}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}getMenubarItemsDimensions(){return this.menubar?new g.Ro(this.menubar.getWidth(),this.menubar.getHeight()):new g.Ro(0,0)}create(e){return this.container=e,this.container&&this.doUpdateMenubar(!0),this.container}layout(e){this.menubar?.update(this.getMenuBarOptions())}toggleFocus(){this.menubar?.toggleFocus()}};yn=(0,h.gn)([(0,h.fM)(0,v.co),(0,h.fM)(1,Ct.Dc),(0,h.fM)(2,y.i6),(0,h.fM)(3,Se.d),(0,h.fM)(4,G.Ui),(0,h.fM)(5,Ut.e),(0,h.fM)(6,yc.F),(0,h.fM)(7,Ie.Uy),(0,h.fM)(8,oe.lT),(0,h.fM)(9,Cc.UP),(0,h.fM)(10,wt.n),(0,h.fM)(11,xc.F),(0,h.fM)(12,et.z),(0,h.fM)(13,Ue.bU),(0,h.fM)(14,Do.$),(0,h.fM)(15,Z.H)],yn);var he=m(37202),di=m(61604);let Lt=class ze extends yo{constructor(e,t,i,o,n,r,s,a,d,l){super("workbench.parts.activitybar",{hasTitle:!1},o,n,i),this.paneCompositePart=e,this.instantiationService=t,this.storageService=n,this.extensionService=r,this.viewDescriptorService=s,this.contextKeyService=a,this.configurationService=d,this.environmentService=l,this.minimumWidth=48,this.maximumWidth=48,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.globalActivity=[],this.accountsActivity=[],this.compositeActions=new Map,this.viewContainerDisposables=new Map,this.keyboardNavigationDisposables=this._register(new C.SL),this.location=0,this.hasExtensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this._cachedViewContainers=void 0;for(const u of this.cachedViewContainers)u.visible=!this.shouldBeHidden(u.id,u);this.compositeBar=this.createCompositeBar(),this.onDidRegisterViewContainers(this.getViewContainers()),this.registerListeners()}createCompositeBar(){var e=this;const t=this.cachedViewContainers.map(i=>({id:i.id,name:i.name,visible:i.visible,order:i.order,pinned:i.pinned}));return this._register(this.instantiationService.createInstance(ko,t,{icon:!0,orientation:1,activityHoverOptions:this.getActivityHoverOptions(),preventLoopNavigation:!0,openComposite:(i=(0,w.Z)(function*(o,n){return(yield e.paneCompositePart.openPaneComposite(o,!n))??null}),function(n,r){return i.apply(this,arguments)}),getActivityAction:i=>this.getCompositeActions(i).activityAction,getCompositePinnedAction:i=>this.getCompositeActions(i).pinnedAction,getCompositeBadgeAction:i=>this.getCompositeActions(i).badgeAction,getOnCompositeClickAction:i=>{return(0,P.xw)({id:i,label:"",run:(o=(0,w.Z)(function*(){return e.paneCompositePart.getActivePaneComposite()?.getId()===i?e.paneCompositePart.hideActivePaneComposite():e.paneCompositePart.openPaneComposite(i)}),function(){return o.apply(this,arguments)})});var o},fillExtraContextMenuActions:(i,o)=>{const n=(0,Si.fi)(this.configurationService);("compact"===n||"hidden"===n||"toggle"===n)&&i.unshift((0,P.xw)({id:"toggleMenuVisibility",label:(0,p.NC)("menu","Menu"),checked:"compact"===n,run:()=>this.configurationService.updateValue("window.menuBarVisibility","compact"===n?"toggle":"compact")}),new P.Z0),"compact"===n&&this.menuBarContainer&&o?.target&&(0,g.jg)(o.target,this.menuBarContainer)&&i.unshift((0,P.xw)({id:"hideCompactMenu",label:(0,p.NC)("hideMenu","Hide Menu"),run:()=>this.configurationService.updateValue("window.menuBarVisibility","toggle")}),new P.Z0),i.push(new P.Z0),i.push((0,P.xw)({id:"toggleAccountsVisibility",label:(0,p.NC)("accounts","Accounts"),checked:this.accountsVisibilityPreference,run:()=>this.accountsVisibilityPreference=!this.accountsVisibilityPreference})),i.push(new P.Z0),i.push((0,P.xw)({id:ci.VR.ID,label:ci.VR.getLabel(this.layoutService),run:()=>this.instantiationService.invokeFunction(r=>(new ci.VR).run(r))})),i.push((0,P.xw)({id:ci.h_.ID,label:(0,p.NC)("hideActivitBar","Hide Activity Bar"),run:()=>this.instantiationService.invokeFunction(r=>(new ci.h_).run(r))}))},getContextMenuActionsForComposite:i=>this.getContextMenuActionsForComposite(i),getDefaultCompositeId:()=>this.viewDescriptorService.getDefaultViewContainer(this.location)?.id,hidePart:()=>this.layoutService.setPartHidden(!0,"workbench.parts.sidebar"),dndHandler:new ss(this.viewDescriptorService,0,function(){var i=(0,w.Z)(function*(o,n){return(yield e.paneCompositePart.openPaneComposite(o,n))??null});return function(o,n){return i.apply(this,arguments)}}(),(i,o,n)=>this.compositeBar.move(i,o,n?.verticallyBefore),()=>this.compositeBar.getCompositeBarItems()),compositeSize:52,colors:i=>this.getActivitybarItemColors(i),overflowActionSize:ze.ACTION_HEIGHT}));var i}getActivityHoverOptions(){return{position:()=>0===this.layoutService.getSideBarPosition()?1:0}}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push((0,P.xw)({id:"resetLocationAction",label:(0,p.NC)("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const n=this.viewDescriptorService.getViewContainerModel(i);if(1===n.allViewDescriptors.length){const r=n.allViewDescriptors[0],s=this.viewDescriptorService.getDefaultContainerById(r.id);s!==i&&t.push((0,P.xw)({id:"resetLocationAction",label:(0,p.NC)("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([r],s)}))}}return t}registerListeners(){this._register(this.viewDescriptorService.onDidChangeViewContainers(({added:t,removed:i})=>this.onDidChangeViewContainers(t,i))),this._register(this.viewDescriptorService.onDidChangeContainerLocation(({viewContainer:t,from:i,to:o})=>this.onDidChangeViewContainerLocation(t,i,o))),this.paneCompositePart.onDidPaneCompositeOpen(t=>this.onDidChangeViewContainerVisibility(t.getId(),!0)),this.paneCompositePart.onDidPaneCompositeClose(t=>this.onDidChangeViewContainerVisibility(t.getId(),!1));const e=this._register(new C.SL);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedViewContainers(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)})),this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("window.menuBarVisibility")&&("compact"===(0,Si.fi)(this.configurationService)?this.installMenubar():this.uninstallMenubar())}))}onDidChangeViewContainers(e,t){t.filter(({location:i})=>0===i).forEach(({container:i})=>this.onDidDeregisterViewContainer(i)),this.onDidRegisterViewContainers(e.filter(({location:i})=>0===i).map(({container:i})=>i))}onDidChangeViewContainerLocation(e,t,i){t===this.location&&this.onDidDeregisterViewContainer(e),i===this.location&&this.onDidRegisterViewContainers([e])}onDidChangeViewContainerVisibility(e,t){t?this.onDidViewContainerVisible(e):this.compositeBar.deactivateComposite(e)}onDidRegisterExtensions(){this.hasExtensionsRegistered=!0;for(const{id:e}of this.cachedViewContainers){const t=this.getViewContainer(e);t?this.showOrHideViewContainer(t):this.viewDescriptorService.isViewContainerRemovedPermanently(e)?this.removeComposite(e):this.hideComposite(e)}this.saveCachedViewContainers()}onDidViewContainerVisible(e){const t=this.getViewContainer(e);t&&(this.addComposite(t),this.compositeBar.activateComposite(t.id),this.shouldBeHidden(t)&&0===this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length&&this.hideComposite(t.id))}showActivity(e,t,i,o){return this.getViewContainer(e)?this.compositeBar.showActivity(e,t,i,o):e===ri?this.showGlobalActivity(ri,t,i,o):e===Eo?this.showGlobalActivity(Eo,t,i,o):C.JT.None}showGlobalActivity(e,t,i,o){"number"!=typeof o&&(o=0);const n={badge:t,clazz:i,priority:o},r=e===ri?this.globalActivity:this.accountsActivity;for(let s=0;s<=r.length;s++){if(s===r.length){r.push(n);break}if(r[s].priority<=o){r.splice(s,0,n);break}}return this.updateGlobalActivity(e),(0,C.OF)(()=>this.removeGlobalActivity(e,n))}removeGlobalActivity(e,t){const i=e===ri?this.globalActivity:this.accountsActivity,o=i.indexOf(t);-1!==o&&(i.splice(o,1),this.updateGlobalActivity(e))}updateGlobalActivity(e){const t=e===ri?this.globalActivityAction:this.accountsActivityAction;if(!t)return;const i=e===ri?this.globalActivity:this.accountsActivity;if(i.length){const[{badge:o,clazz:n,priority:r}]=i;if(o instanceof yt.mA&&i.length>1){const s=this.getCumulativeNumberBadge(i,r);t.setBadge(s)}else t.setBadge(o,n)}else t.setBadge(void 0)}getCumulativeNumberBadge(e,t){const i=e.filter(r=>r.badge instanceof yt.mA&&r.priority===t),o=i.reduce((r,s)=>r+s.badge.number,0);return new yt.mA(o,()=>i.reduce((r,s,a)=>(r+=s.badge.getDescription(),a<i.length-1&&(r=`${r}\n`),r),""))}uninstallMenubar(){this.menuBar&&(this.menuBar.dispose(),this.menuBar=void 0),this.menuBarContainer&&(this.menuBarContainer.remove(),this.menuBarContainer=void 0,this.registerKeyboardNavigationListeners())}installMenubar(){this.menuBar||(this.menuBarContainer=document.createElement("div"),this.menuBarContainer.classList.add("menubar"),(0,A.cW)(this.content).prepend(this.menuBarContainer),this.menuBar=this._register(this.instantiationService.createInstance(yn)),this.menuBar.create(this.menuBarContainer),this.registerKeyboardNavigationListeners())}createContentArea(e){return this.element=e,this.content=document.createElement("div"),this.content.classList.add("content"),e.appendChild(this.content),"compact"===(0,Si.fi)(this.configurationService)&&this.installMenubar(),this.compositeBarContainer=this.compositeBar.create(this.content),this.globalActivitiesContainer=document.createElement("div"),this.content.appendChild(this.globalActivitiesContainer),this.registerKeyboardNavigationListeners(),this.content}registerKeyboardNavigationListeners(){this.keyboardNavigationDisposables.clear(),this.menuBarContainer&&this.keyboardNavigationDisposables.add((0,g.nm)(this.menuBarContainer,g.tw.KEY_DOWN,e=>{const t=new dt.y1(e);(t.equals(18)||t.equals(17))&&this.compositeBar?.focus()})),this.compositeBarContainer&&this.keyboardNavigationDisposables.add((0,g.nm)(this.compositeBarContainer,g.tw.KEY_DOWN,e=>{const t=new dt.y1(e);t.equals(18)||t.equals(17)?this.globalActivityActionBar?.focus(!0):(t.equals(16)||t.equals(15))&&this.menuBar?.toggleFocus()})),this.globalActivitiesContainer&&this.keyboardNavigationDisposables.add((0,g.nm)(this.globalActivitiesContainer,g.tw.KEY_DOWN,e=>{const t=new dt.y1(e);(t.equals(16)||t.equals(15))&&this.compositeBar?.focus(this.getVisiblePaneCompositeIds().length-1)}))}createGlobalActivityActionBar(e){this.globalActivityActionBar=this._register(new qe.o(e,{actionViewItemProvider:t=>{if("workbench.actions.manage"===t.id)return this.instantiationService.createInstance(mn,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());if("workbench.actions.accounts"===t.id)return this.instantiationService.createInstance(ai,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());throw new Error(`No view item for action '${t.id}'`)},orientation:1,ariaLabel:(0,p.NC)("manage","Manage"),animated:!1,preventLoopNavigation:!0})),this.globalActivityAction=this._register(new Fe.JS({id:"workbench.actions.manage",name:(0,p.NC)("manage","Manage"),classNames:be.kS.asClassNameArray(ze.GEAR_ICON)})),this.accountsVisibilityPreference&&(this.accountsActivityAction=this._register(new Fe.JS({id:"workbench.actions.accounts",name:(0,p.NC)("accounts","Accounts"),classNames:be.kS.asClassNameArray(ze.ACCOUNTS_ICON)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:ze.ACCOUNTS_ACTION_INDEX})),this.globalActivityActionBar.push(this.globalActivityAction)}toggleAccountsActivity(){!!this.accountsActivityAction!==this.accountsVisibilityPreference&&(this.globalActivityActionBar&&(this.accountsActivityAction?(this.globalActivityActionBar.pull(ze.ACCOUNTS_ACTION_INDEX),this.accountsActivityAction=void 0):(this.accountsActivityAction=this._register(new Fe.JS({id:"workbench.actions.accounts",name:(0,p.NC)("accounts","Accounts"),classNames:be.kS.asClassNameArray($.lA.account)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:ze.ACCOUNTS_ACTION_INDEX}))),this.updateGlobalActivity(Eo))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(Hi,this.toActivity(o),this.paneCompositePart),pinnedAction:new Fe.du(this.toActivity(o),this.compositeBar),badgeAction:new Fe.B7(this.toActivity(o),this.compositeBar)}}else{const o=this.cachedViewContainers.filter(n=>n.id===e)[0];t={activityAction:this.instantiationService.createInstance(vc,ze.toActivity(e,e,o?.icon,void 0),this.paneCompositePart),pinnedAction:new os(e,this.compositeBar),badgeAction:new ns(e,this.compositeBar)}}this.compositeActions.set(e,t)}return t}onDidRegisterViewContainers(e){for(const t of e){this.addComposite(t),this.cachedViewContainers.filter(({id:s})=>s===t.id)[0]||this.compositeBar.pin(t.id),this.paneCompositePart.getActivePaneComposite()?.getId()===t.id&&this.compositeBar.activateComposite(t.id);const n=this.viewDescriptorService.getViewContainerModel(t);this.updateActivity(t,n),this.showOrHideViewContainer(t);const r=new C.SL;r.add(n.onDidChangeContainerInfo(()=>this.updateActivity(t,n))),r.add(n.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(t))),this.viewContainerDisposables.set(t.id,r)}}onDidDeregisterViewContainer(e){this.viewContainerDisposables.get(e.id)?.dispose(),this.viewContainerDisposables.delete(e.id),this.removeComposite(e.id)}updateActivity(e,t){const i=this.toActivity(t),{activityAction:o,pinnedAction:n}=this.getCompositeActions(e.id);o.updateActivity(i),n instanceof os&&n.setActivity(i),this.saveCachedViewContainers()}toActivity(e){return ze.toActivity(e.viewContainer.id,e.title,e.icon,e.keybindingId)}static toActivity(e,t,i,o){let n,r;if(W.ov.isUri(i)){r=i;const s=(0,g.wY)(i),a=new di.yP;a.update(s);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`;n=[d,"uri-icon"],(0,g.fk)(`.monaco-workbench .activitybar .monaco-action-bar .action-label.${d}`,`\n\t\t\t\tmask: ${s} no-repeat 50% 50%;\n\t\t\t\tmask-size: 24px;\n\t\t\t\t-webkit-mask: ${s} no-repeat 50% 50%;\n\t\t\t\t-webkit-mask-size: 24px;\n\t\t\t`)}else be.kS.isThemeIcon(i)&&(n=be.kS.asClassNameArray(i));return{id:e,name:t,classNames:n,iconUrl:r,keybindingId:o}}showOrHideViewContainer(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey((0,N.l0)(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),this.shouldBeHidden(e)?(t.set(!1),this.hideComposite(e.id)):(t.set(!0),this.addComposite(e))}shouldBeHidden(e,t){const i=(0,A.HD)(e)?this.getViewContainer(e):e,o=(0,A.HD)(e)?e:e.id;if(i){if(!i.hideIfEmpty)return!1;if(this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.length>0)return!1}if(!(this.hasExtensionsRegistered||this.environmentService.remoteAuthority&&F.tY)){if(t=t||this.cachedViewContainers.find(({id:n})=>n===o),!i&&t?.isBuiltin&&t?.visible)return!1;if(t?.views?.length)return t.views.every(({when:n})=>!!n&&!this.contextKeyService.contextMatchesRules(y.Ao.deserialize(n)))}return!0}addComposite(e){this.compositeBar.addComposite({id:e.id,name:"string"==typeof e.title?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex})}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}removeComposite(e){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getViewContainers().filter(t=>this.compositeBar.isPinned(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>this.paneCompositePart.getActivePaneComposite()?.getId()===e.id||this.compositeBar.isPinned(e.id)).map(e=>e.id)}focus(){this.compositeBar.focus()}updateStyles(){super.updateStyles();const e=(0,A.cW)(this.getContainer()),t=this.getColor(I.X0)||"";e.style.backgroundColor=t;const i=this.getColor(I.bG)||this.getColor(Y.lRK)||"";e.classList.toggle("bordered",!!i),e.style.borderColor=i||""}getActivitybarItemColors(e){return{activeForegroundColor:e.getColor(I.wJ),inactiveForegroundColor:e.getColor(I.Dj),activeBorderColor:e.getColor(I.D$),activeBackground:e.getColor(I.MQ),badgeBackground:e.getColor(I.ob),badgeForeground:e.getColor(I.jY),dragAndDropBorder:e.getColor(I.Fs),activeBackgroundColor:void 0,inactiveBackgroundColor:void 0,activeBorderBottomColor:void 0}}layout(e,t){if(!this.layoutService.isVisible("workbench.parts.activitybar"))return;let o=super.layoutContents(e,t).contentSize.height;this.menuBarContainer&&(o-=this.menuBarContainer.clientHeight),this.globalActivityActionBar&&(o-=this.globalActivityActionBar.viewItems.length*ze.ACTION_HEIGHT),this.compositeBar.layout(new g.Ro(e,o))}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.location?t:void 0}getViewContainers(){return this.viewDescriptorService.getViewContainersByLocation(this.location)}onDidStorageValueChange(e){if(e.key===ze.PINNED_VIEW_CONTAINERS&&0===e.scope&&this.pinnedViewContainersValue!==this.getStoredPinnedViewContainersValue()){this._pinnedViewContainersValue=void 0,this._cachedViewContainers=void 0;const t=[],i=this.compositeBar.getCompositeBarItems();for(const o of this.cachedViewContainers)t.push({id:o.id,name:o.name,order:o.order,pinned:o.pinned,visible:!!i.find(({id:n})=>n===o.id)});for(let o=0;o<i.length;o++)if(!t.some(({id:n})=>n===i[o].id)){const n=this.viewDescriptorService.getViewContainerById(i[o].id);t.splice(o,0,{...i[o],pinned:!0,visible:!0,order:n?.order})}this.compositeBar.setCompositeBarItems(t)}e.key===ai.ACCOUNTS_VISIBILITY_PREFERENCE_KEY&&0===e.scope&&this.toggleAccountsActivity()}saveCachedViewContainers(){const e=[],t=this.compositeBar.getCompositeBarItems();for(const i of t){const o=this.getViewContainer(i.id);if(o){const n=this.viewDescriptorService.getViewContainerModel(o),r=[];for(const{when:s}of n.allViewDescriptors)r.push({when:s?s.serialize():void 0});e.push({id:i.id,name:n.title,icon:W.ov.isUri(n.icon)&&this.environmentService.remoteAuthority?void 0:n.icon,views:r,pinned:i.pinned,order:i.order,visible:i.visible,isBuiltin:!o.extensionId})}else e.push({id:i.id,pinned:i.pinned,order:i.order,visible:!1,isBuiltin:!1})}this.storeCachedViewContainersState(e)}get cachedViewContainers(){if(void 0===this._cachedViewContainers){this._cachedViewContainers=this.getPinnedViewContainers();for(const e of this.getPlaceholderViewContainers()){const t=this._cachedViewContainers.filter(i=>i.id===e.id)[0];t&&(t.name=e.name,t.icon=e.themeIcon?e.themeIcon:e.iconUrl?W.ov.revive(e.iconUrl):void 0,W.ov.isUri(t.icon)&&this.environmentService.remoteAuthority&&(t.icon=void 0),t.views=e.views,t.isBuiltin=e.isBuiltin)}}return this._cachedViewContainers}storeCachedViewContainersState(e){this.setPinnedViewContainers(e.map(({id:t,pinned:i,visible:o,order:n})=>({id:t,pinned:i,visible:o,order:n}))),this.setPlaceholderViewContainers(e.map(({id:t,icon:i,name:o,views:n,isBuiltin:r})=>({id:t,iconUrl:W.ov.isUri(i)?i:void 0,themeIcon:be.kS.isThemeIcon(i)?i:void 0,name:o,isBuiltin:r,views:n})))}getPinnedViewContainers(){return JSON.parse(this.pinnedViewContainersValue)}setPinnedViewContainers(e){this.pinnedViewContainersValue=JSON.stringify(e)}get pinnedViewContainersValue(){return this._pinnedViewContainersValue||(this._pinnedViewContainersValue=this.getStoredPinnedViewContainersValue()),this._pinnedViewContainersValue}set pinnedViewContainersValue(e){this.pinnedViewContainersValue!==e&&(this._pinnedViewContainersValue=e,this.setStoredPinnedViewContainersValue(e))}getStoredPinnedViewContainersValue(){return this.storageService.get(ze.PINNED_VIEW_CONTAINERS,0,"[]")}setStoredPinnedViewContainersValue(e){this.storageService.store(ze.PINNED_VIEW_CONTAINERS,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(ze.PLACEHOLDER_VIEW_CONTAINERS,0,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(ze.PLACEHOLDER_VIEW_CONTAINERS,e,0,1)}get accountsVisibilityPreference(){return this.storageService.getBoolean(ai.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,0,!0)}set accountsVisibilityPreference(e){this.storageService.store(ai.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,e,0,0)}toJSON(){return{type:"workbench.parts.activitybar"}}};Lt.PINNED_VIEW_CONTAINERS="workbench.activity.pinnedViewlets2",Lt.PLACEHOLDER_VIEW_CONTAINERS="workbench.activity.placeholderViewlets",Lt.ACTION_HEIGHT=48,Lt.ACCOUNTS_ACTION_INDEX=0,Lt.GEAR_ICON=(0,he.q5)("settings-view-bar-icon",$.lA.settingsGear,(0,p.NC)("settingsViewBarIcon","Settings icon in the view bar.")),Lt.ACCOUNTS_ICON=(0,he.q5)("accounts-view-bar-icon",$.lA.account,(0,p.NC)("accountsViewBarIcon","Accounts icon in the view bar.")),Lt=(0,h.gn)([(0,h.fM)(1,R.TG),(0,h.fM)(2,et.z),(0,h.fM)(3,K.XE),(0,h.fM)(4,Ie.Uy),(0,h.fM)(5,Pt.QS),(0,h.fM)(6,O.XH),(0,h.fM)(7,y.i6),(0,h.fM)(8,G.Ui),(0,h.fM)(9,wt.n)],Lt),(0,ve.Z)('.monaco-workbench .workbench-hover{background:var(--vscode-editorHoverWidget-background);border:1px solid var(--vscode-editorHoverWidget-border);border-radius:3px;box-shadow:0 2px 8px var(--vscode-widget-shadow);color:var(--vscode-editorHoverWidget-foreground);font-size:13px;line-height:19px;max-width:700px;overflow:hidden;position:relative;z-index:40}.monaco-workbench .workbench-hover hr{border-bottom:none}.monaco-workbench .workbench-hover:not(.skip-fade-in){animation:fadein .1s linear}.monaco-workbench .workbench-hover.compact{font-size:12px}.monaco-workbench .workbench-hover.compact .hover-contents{padding:2px 8px}.monaco-workbench .workbench-hover-container.locked .workbench-hover{outline:1px solid var(--vscode-editorHoverWidget-border)}.monaco-workbench .workbench-hover-container.locked .workbench-hover:focus,.monaco-workbench .workbench-hover-lock:focus{outline:1px solid var(--vscode-focusBorder)}.monaco-workbench .workbench-hover-container.locked .workbench-hover-lock:hover{background:var(--vscode-toolbar-hoverBackground)}.monaco-workbench .workbench-hover-pointer{pointer-events:none;position:absolute;z-index:41}.monaco-workbench .workbench-hover-pointer:after{background-color:var(--vscode-editorHoverWidget-background);border-bottom:1px solid var(--vscode-editorHoverWidget-border);border-right:1px solid var(--vscode-editorHoverWidget-border);content:"";height:5px;position:absolute;width:5px}.monaco-workbench .locked .workbench-hover-pointer:after{border-bottom-width:2px;border-right-width:2px;height:4px;width:4px}.monaco-workbench .workbench-hover-pointer.left{left:-3px}.monaco-workbench .workbench-hover-pointer.right{right:3px}.monaco-workbench .workbench-hover-pointer.top{top:-3px}.monaco-workbench .workbench-hover-pointer.bottom{bottom:3px}.monaco-workbench .workbench-hover-pointer.left:after{transform:rotate(135deg)}.monaco-workbench .workbench-hover-pointer.right:after{transform:rotate(315deg)}.monaco-workbench .workbench-hover-pointer.top:after{transform:rotate(225deg)}.monaco-workbench .workbench-hover-pointer.bottom:after{transform:rotate(45deg)}.monaco-workbench .workbench-hover a{color:var(--vscode-textLink-foreground)}.monaco-workbench .workbench-hover a:focus{outline:1px solid;outline-color:var(--vscode-focusBorder);outline-offset:-1px;text-decoration:underline}.monaco-workbench .workbench-hover a:active,.monaco-workbench .workbench-hover a:hover{color:var(--vscode-textLink-activeForeground)}.monaco-workbench .workbench-hover code{background:var(--vscode-textCodeBlock-background)}.monaco-workbench .workbench-hover .hover-row .actions{background:var(--vscode-editorHoverWidget-statusBarBackground)}.monaco-workbench .workbench-hover.right-aligned{left:1px}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions{flex-direction:row-reverse}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions .action-container{margin-left:16px;margin-right:0}',{});var Pc=m(15023),ps=m(99395),Zt=m(12292),gs=m(53513),li=m(49851);const Et=g.$;let Cn=class extends vn.${get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return 2===this._hoverPosition?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,o,n){super(),this._keybindingService=t,this._configurationService=i,this._openerService=o,this._instantiationService=n,this._messageListeners=new C.SL,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new S.Q5),this._onRequestLayout=this._register(new S.Q5),this._linkHandler=e.linkHandler||(u=>(0,gs.N)(this._openerService,u,(0,li.Fr)(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new Lc(e.target),this._hoverPointer=e.showPointer?Et("div.workbench-hover-pointer"):void 0,this._hover=this._register(new ps.c),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),e.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),e.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=e.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,u=>u.stopPropagation()),this.onkeydown(this._hover.containerDomNode,u=>{u.equals(9)&&this.dispose()}),this._register(g.nm(window,"blur",()=>this.dispose()));const r=Et("div.hover-row.markdown-hover"),s=Et("div.hover-contents");if("string"==typeof e.content)s.textContent=e.content,s.style.whiteSpace="pre-wrap";else if(e.content instanceof HTMLElement)s.appendChild(e.content),s.classList.add("html-hover-contents");else{const u=e.content,f=this._instantiationService.createInstance(gs.$,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||Pc.hL.fontFamily}),{element:b}=f.render(u,{actionHandler:{callback:E=>this._linkHandler(E),disposables:this._messageListeners},asyncRenderCallback:()=>{s.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});s.appendChild(b)}if(r.appendChild(s),this._hover.contentsDomNode.appendChild(r),e.actions&&e.actions.length>0){const u=Et("div.hover-row.status-bar"),f=Et("div.actions");e.actions.forEach(b=>{const E=this._keybindingService.lookupKeybinding(b.commandId),k=E?E.getLabel():null;ps.S.render(f,{label:b.label,commandId:b.commandId,run:M=>{b.run(M),this.dispose()},iconClass:b.iconClass},k)}),u.appendChild(f),this._hover.containerDomNode.appendChild(u)}let a;if(this._hoverContainer=Et("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode),a=!(e.actions&&e.actions.length>0)&&(void 0===e.hideOnHover?"string"==typeof e.content||(0,li.Fr)(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):e.hideOnHover),a&&e.showHoverHint){const u=Et("div.hover-row.status-bar"),f=Et("div.info");f.textContent=(0,p.NC)("hoverhint","Hold {0} key to mouse over",F.dz?"Option":"Alt"),u.appendChild(f),this._hover.containerDomNode.appendChild(u)}const d=[...this._target.targetElements];a||d.push(this._hoverContainer);const l=this._register(new fs(d));if(this._register(l.onMouseOut(()=>{this._isLocked||this.dispose()})),a){const u=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new fs(u)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=l}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=g.Ce(this._hoverContainer,Et("div")),o=g.R3(this._hoverContainer,Et("div"));i.tabIndex=0,o.tabIndex=0,this._register(g.nm(o,"focus",n=>{e.focus(),n.preventDefault()})),this._register(g.nm(i,"focus",n=>{t.focus(),n.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE&&"number"==typeof i.tabIndex&&i.tabIndex>=0)return i;const o=this.findLastFocusableChild(i);if(o)return o}}render(e){e.appendChild(this._hoverContainer),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const t=this._target.targetElements.map(l=>(l=>{const u=g.I8(l),f=l.getBoundingClientRect();return{top:f.top*u,bottom:f.bottom*u,right:f.right*u,left:f.left*u}})(l)),i=Math.min(...t.map(l=>l.top)),o=Math.max(...t.map(l=>l.right)),n=Math.max(...t.map(l=>l.bottom)),r=Math.min(...t.map(l=>l.left)),s=o-r,a=n-i,d={top:i,right:o,bottom:n,left:r,width:s,height:a,center:{x:r+s/2,y:i+a/2}};if(this.adjustHorizontalHoverPosition(d),this.adjustVerticalHoverPosition(d),this.adjustHoverMaxHeight(d),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:d.left+=3,d.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:d.left-=3,d.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:d.top+=3,d.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:d.top-=3,d.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px"}d.center.x=d.left+s/2,d.center.y=d.top+a/2}this.computeXCordinate(d),this.computeYCordinate(d),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(d)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;void 0!==this._target.x?this._x=this._target.x:1===this._hoverPosition?this._x=e.right:0===this._hoverPosition?this._x=e.left-t:(this._x=this._hoverPointer?e.center.x-this._hover.containerDomNode.clientWidth/2:e.left,this._x+t>=document.documentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(document.documentElement.clientWidth-t-2,document.documentElement.clientLeft))),this._x<document.documentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._y=void 0!==this._target.y?this._target.y:3===this._hoverPosition?e.top:2===this._hoverPosition?e.bottom-2:this._hoverPointer?e.center.y+this._hover.containerDomNode.clientHeight/2:e.bottom,this._y>window.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(void 0===this._target.x){if(this._forcePosition){const t=2+(this._hoverPointer?3:0);return void(1===this._hoverPosition?this._hover.containerDomNode.style.maxWidth=document.documentElement.clientWidth-e.right-t+"px":0===this._hoverPosition&&(this._hover.containerDomNode.style.maxWidth=e.left-t+"px"))}1===this._hoverPosition?document.documentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth&&(this._hoverPosition=e.left>=this._hover.containerDomNode.clientWidth?0:2):0===this._hoverPosition&&(e.left<this._hover.containerDomNode.clientWidth&&(this._hoverPosition=document.documentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth?1:2),e.left-this._hover.containerDomNode.clientWidth<=document.documentElement.clientLeft&&(this._hoverPosition=1))}}adjustVerticalHoverPosition(e){void 0!==this._target.y||this._forcePosition||(3===this._hoverPosition?e.top-this._hover.containerDomNode.clientHeight<0&&(this._hoverPosition=2):2===this._hoverPosition&&e.bottom+this._hover.containerDomNode.clientHeight>window.innerHeight&&(this._hoverPosition=3))}adjustHoverMaxHeight(e){let t=window.innerHeight/2;if(this._forcePosition){const i=2+(this._hoverPointer?3:0);3===this._hoverPosition?t=Math.min(t,e.top-i):2===this._hoverPosition&&(t=Math.min(t,window.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(0===this._hoverPosition?"right":"left");const t=this._hover.containerDomNode.clientHeight;this._hoverPointer.style.top=t>e.height?e.center.y-(this._y-t)-3+"px":Math.round(t/2)-3+"px";break}case 3:case 2:{this._hoverPointer.classList.add(3===this._hoverPosition?"bottom":"top");let i=Math.round(this._hover.containerDomNode.clientWidth/2)-3;const o=this._x+i;(o<e.left||o>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}hide(){this.dispose()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};Cn=(0,h.gn)([(0,h.fM)(1,Se.d),(0,h.fM)(2,G.Ui),(0,h.fM)(3,Zt.v4),(0,h.fM)(4,R.TG)],Cn);class fs extends vn.${get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new S.Q5),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver())),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave()))}_onTargetMouseOver(){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout()}_onTargetMouseLeave(){this._isMouseIn=!1,this._evaluateMouseState()}_evaluateMouseState(){this._clearEvaluateMouseStateTimeout(),this._mouseTimeout=window.setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(){this._mouseTimeout&&(clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class Lc{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}let Sn=class{constructor(e,t,i,o){this._instantiationService=e,this._contextViewService=t,this._keybindingService=o,i.onDidShowContextMenu(()=>this.hideHover())}showHover(e,t){if(ms(this._currentHoverOptions)===ms(e))return;this._currentHoverOptions=e,this._lastFocusedElementBeforeOpen=e.trapFocus&&document.activeElement?document.activeElement:void 0;const i=new C.SL,o=this._instantiationService.createInstance(Cn,e);o.onDispose(()=>{this._lastFocusedElementBeforeOpen?.focus(),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),i.dispose()});const n=this._contextViewService;if(n.showContextView(new Rc(o,t),e.container),o.onRequestLayout(()=>n.layout()),"targetElements"in e.target)for(const s of e.target.targetElements)i.add((0,g.nm)(s,g.tw.CLICK,()=>this.hideHover()));else i.add((0,g.nm)(e.target,g.tw.CLICK,()=>this.hideHover()));const r=document.activeElement;if(r&&(i.add((0,g.nm)(r,g.tw.KEY_DOWN,s=>this._keyDown(s,o,!!e.hideOnKeyDown))),i.add((0,g.nm)(document,g.tw.KEY_DOWN,s=>this._keyDown(s,o,!!e.hideOnKeyDown))),i.add((0,g.nm)(r,g.tw.KEY_UP,s=>this._keyUp(s,o))),i.add((0,g.nm)(document,g.tw.KEY_UP,s=>this._keyUp(s,o)))),"IntersectionObserver"in window){const s=new IntersectionObserver(d=>this._intersectionChange(d,o),{threshold:0});s.observe("targetElements"in e.target?e.target.targetElements[0]:e.target),i.add((0,C.OF)(()=>s.disconnect()))}return this._currentHover=o,o}hideHover(){this._currentHover?.isLocked||!this._currentHoverOptions||(this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewService.hideContextView())}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}_keyDown(e,t,i){if("Alt"===e.key)return void(t.isLocked=!0);const o=new dt.y1(e);this._keybindingService.resolveKeyboardEvent(o).getSingleModifierDispatchChords().some(r=>!!r)||0!==this._keybindingService.softDispatch(o,o.target).kind||i&&(!this._currentHoverOptions?.trapFocus||"Tab"!==e.key)&&(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus())}_keyUp(e,t){"Alt"===e.key&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus()))}};function ms(c){if(void 0!==c)return c?.id??c}Sn=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,ge.u),(0,h.fM)(2,ge.i),(0,h.fM)(3,Se.d)],Sn);class Rc{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}(0,K.Ic)((c,e)=>{const t=c.getColor(Y.CNo);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});var Nc=m(51459),we=m(85462),xt=m(37923),xe=m(19409),Oc=m(97667),$t=m(54239),Hc=m(84776),En=m(28732),Io=m(32325),Ao=m(10154),vs=m(4866);class Fi{constructor(){this.uris=[]}perform(){var e=this;return(0,w.Z)(function*(){return e})()}toString(){return"(noop)"}}class bs{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}}let xn=class Za{constructor(e,t,i,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}perform(e){var t=this;return(0,w.Z)(function*(){const i=[],o=[];for(const n of t._edits)void 0===n.options.overwrite&&n.options.ignoreIfExists&&(yield t._fileService.exists(n.newUri))||(i.push({file:{source:n.oldUri,target:n.newUri},overwrite:n.options.overwrite}),o.push(new bs(n.oldUri,n.newUri,n.options)));return 0===i.length?new Fi:(yield t._workingCopyFileService.move(i,e,t._undoRedoInfo),new Za(o,{isUndoing:!0},t._workingCopyFileService,t._fileService))})()}toString(){return`(rename ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};xn=(0,h.gn)([(0,h.fM)(2,Ao.I),(0,h.fM)(3,z.sn)],xn);class Bc{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}}let kn=class{constructor(e,t,i,o,n){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._instaService=n}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}perform(e){var t=this;return(0,w.Z)(function*(){const i=[];for(const r of t._edits)void 0===r.options.overwrite&&r.options.ignoreIfExists&&(yield t._fileService.exists(r.newUri))||i.push({file:{source:r.oldUri,target:r.newUri},overwrite:r.options.overwrite});if(0===i.length)return new Fi;const o=yield t._workingCopyFileService.copy(i,e,t._undoRedoInfo),n=[];for(let r=0;r<o.length;r++){const s=o[r];n.push(new Dn(s.resource,{recursive:!0,folder:t._edits[r].options.folder||s.isDirectory,...t._edits[r].options},!1))}return t._instaService.createInstance(Wi,n,{isUndoing:!0})})()}toString(){return`(copy ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};kn=(0,h.gn)([(0,h.fM)(2,Ao.I),(0,h.fM)(3,z.sn),(0,h.fM)(4,R.TG)],kn);class ws{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}}let _o=class{constructor(e,t,i,o,n,r){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=o,this._instaService=n,this._textFileService=r}get uris(){return this._edits.map(e=>e.newUri)}perform(e){var t=this;return(0,w.Z)(function*(){const i=[],o=[],n=[];for(const r of t._edits)if(void 0!==r.options.overwrite||!r.options.ignoreIfExists||!(yield t._fileService.exists(r.newUri))){if(r.options.folder)i.push({resource:r.newUri});else{const s=typeof r.contents<"u"?r.contents:yield t._textFileService.getEncodedReadable(r.newUri);o.push({resource:r.newUri,contents:s,overwrite:r.options.overwrite})}n.push(new Dn(r.newUri,r.options,!r.options.folder&&!r.contents))}return 0===i.length&&0===o.length?new Fi:(yield t._workingCopyFileService.createFolder(i,e,t._undoRedoInfo),yield t._workingCopyFileService.create(o,e,t._undoRedoInfo),t._instaService.createInstance(Wi,n,{isUndoing:!0}))})()}toString(){return`(create ${this._edits.map(e=>e.options.folder?`folder ${e.newUri}`:`file ${e.newUri} with ${e.contents?.byteLength||0} bytes`).join(", ")})`}};_o=(0,h.gn)([(0,h.fM)(2,z.sn),(0,h.fM)(3,Ao.I),(0,h.fM)(4,R.TG),(0,h.fM)(5,vs.MM)],_o);class Dn{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}}let Wi=class{constructor(e,t,i,o,n,r,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._configurationService=n,this._instaService=r,this._logService=s}get uris(){return this._edits.map(e=>e.oldUri)}perform(e){var t=this;return(0,w.Z)(function*(){const i=[],o=[];for(const n of t._edits){let r,s;try{r=yield t._fileService.resolve(n.oldUri,{resolveMetadata:!0})}catch{if(!n.options.ignoreIfNotExists)throw new Error(`${n.oldUri} does not exist and can not be deleted`);continue}if(i.push({resource:n.oldUri,recursive:n.options.recursive,useTrash:!n.options.skipTrashBin&&t._fileService.hasCapability(n.oldUri,4096)&&t._configurationService.getValue("files.enableTrash")}),!(n.undoesCreate||n.options.folder||"number"==typeof n.options.maxSize&&r.size>n.options.maxSize))try{s=yield t._fileService.readFile(n.oldUri)}catch(a){t._logService.error(a)}void 0!==s&&o.push(new ws(n.oldUri,n.options,s.value))}return 0===i.length?new Fi:(yield t._workingCopyFileService.delete(i,e,t._undoRedoInfo),0===o.length?new Fi:t._instaService.createInstance(_o,o,{isUndoing:!0}))})()}toString(){return`(delete ${this._edits.map(e=>e.oldUri).join(", ")})`}};Wi=(0,h.gn)([(0,h.fM)(2,Ao.I),(0,h.fM)(3,z.sn),(0,h.fM)(4,G.Ui),(0,h.fM)(5,R.TG),(0,h.fM)(6,Ae.VZ)],Wi);class Fc{constructor(e,t,i,o){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=o,this.type=1,this.resources=i.map(n=>n.uris).flat()}undo(){var e=this;return(0,w.Z)(function*(){yield e._reverse()})()}redo(){var e=this;return(0,w.Z)(function*(){yield e._reverse()})()}_reverse(){var e=this;return(0,w.Z)(function*(){for(let t=0;t<e.operations.length;t++){const o=yield e.operations[t].perform(xe.T.None);e.operations[t]=o}})()}toString(){return this.operations.map(e=>String(e)).join(", ")}}let In=class{constructor(e,t,i,o,n,r,s,a,d,l){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=o,this._confirmBeforeUndo=n,this._progress=r,this._token=s,this._edits=a,this._instaService=d,this._undoRedoService=l}apply(){var e=this;return(0,w.Z)(function*(){const t=[],i={undoRedoGroupId:e._undoRedoGroup.id},o=[];for(const s of e._edits)s.newResource&&s.oldResource&&!s.options?.copy?o.push(new bs(s.newResource,s.oldResource,s.options??{})):s.newResource&&s.oldResource&&s.options?.copy?o.push(new Bc(s.newResource,s.oldResource,s.options??{})):!s.newResource&&s.oldResource?o.push(new Dn(s.oldResource,s.options??{},!1)):s.newResource&&!s.oldResource&&o.push(new ws(s.newResource,s.options??{},yield s.options.contents));if(0===o.length)return[];const n=[];n[0]=[o[0]];for(let s=1;s<o.length;s++){const a=o[s],d=(0,L.eJ)(n);d[0].type===a.type?d.push(a):n.push([a])}for(const s of n){if(e._token.isCancellationRequested)break;let a;switch(s[0].type){case"rename":a=e._instaService.createInstance(xn,s,i);break;case"copy":a=e._instaService.createInstance(kn,s,i);break;case"delete":a=e._instaService.createInstance(Wi,s,i);break;case"create":a=e._instaService.createInstance(_o,s,i)}if(a){const d=yield a.perform(e._token);t.push(d)}e._progress.report(void 0)}const r=new Fc(e._label,e._code,t,e._confirmBeforeUndo);return e._undoRedoService.pushElement(r,e._undoRedoGroup,e._undoRedoSource),r.resources})()}};In=(0,h.gn)([(0,h.fM)(8,R.TG),(0,h.fM)(9,En.tJ)],In);var Wc=m(542),Ye=m(84761),Gi=m(56980),Gc=m(58763),An=m(80258),zc=m(18349),ys=m(19220);class Cs{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||void 0!==this._newEol&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;const{textEdit:t}=e;if("number"==typeof t.eol&&(this._newEol=t.eol),!t.range&&!t.text||Ye.e.isEmpty(t.range)&&!t.text)return;let i;i=t.range?Ye.e.lift(t.range):this.model.getFullModelRange(),this._edits.push({...Wc.h.replaceMove(i,t.text),insertAsSnippet:t.insertAsSnippet})}validate(){return typeof this._expectedModelVersionId>"u"||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>Ye.e.compareRangesUsingStarts(e.range,t.range)),this.model.pushEditOperations(null,this._edits,()=>null)),void 0!==this._newEol&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;const t=ys.Yj.asInsertText(e.text);return{...e,insertAsSnippet:!1,text:t}}}class Uc extends Cs{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(){if(this._canUseEditor()){if(this._edits.length>0){const e=zc.SnippetController2.get(this._editor);if(e&&this._edits.some(t=>t.insertAsSnippet)){const t=[];for(const i of this._edits)i.range&&null!==i.text&&t.push({range:Ye.e.lift(i.range),template:i.insertAsSnippet?i.text:ys.Yj.escape(i.text)});e.apply(t,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((t,i)=>Ye.e.compareRangesUsingStarts(t.range,i.range)),this._editor.executeEdits("",this._edits)}void 0!==this._newEol&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}else super.apply()}_canUseEditor(){return this._editor?.getModel()?.uri.toString()===this.model.uri.toString()}}let _n=class{constructor(e,t,i,o,n,r,s,a,d,l,u,f){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=o,this._undoRedoSource=n,this._progress=r,this._token=s,this._editorWorker=d,this._modelService=l,this._textModelResolverService=u,this._undoRedoService=f,this._edits=new Te.Y9;for(const b of a){let E=this._edits.get(b.resource);E||(E=[],this._edits.set(b.resource,E)),E.push(b)}}_validateBeforePrepare(){for(const e of this._edits.values())for(const t of e)if("number"==typeof t.versionId){const i=this._modelService.getModel(t.resource);if(i&&i.getVersionId()!==t.versionId)throw new Error(`${i.uri.toString()} has changed in the meantime`)}}_createEditsTasks(){var e=this;return(0,w.Z)(function*(){const t=[],i=[];for(const[o,n]of e._edits){const r=e._textModelResolverService.createModelReference(o).then(function(){var s=(0,w.Z)(function*(a){let d,l=!1;e._editor?.getModel()?.uri.toString()===a.object.textEditorModel.uri.toString()?(d=new Uc(a,e._editor),l=!0):d=new Cs(a);for(const u of n)if(l&&!u.textEdit.insertAsSnippet){const f=yield e._editorWorker.computeMoreMinimalEdits(u.resource,[u.textEdit]);if(f)for(const b of f)d.addEdit(new xt.Gl(u.resource,b,u.versionId,u.metadata));else d.addEdit(u)}else d.addEdit(u);t.push(d)});return function(a){return s.apply(this,arguments)}}());i.push(r)}return yield Promise.all(i),t})()}_validateTasks(e){for(const t of e){const i=t.validate();if(!i.canApply)return i}return{canApply:!0}}apply(){var e=this;return(0,w.Z)(function*(){e._validateBeforePrepare();const t=yield e._createEditsTasks();try{if(e._token.isCancellationRequested)return[];const i=[],o=e._validateTasks(t);if(!o.canApply)throw new Error(`${o.reason.toString()} has changed in the meantime`);if(1===t.length){const n=t[0];if(!n.isNoOp()){const r=new An.vi(e._label,e._code,n.model,n.getBeforeCursorState());e._undoRedoService.pushElement(r,e._undoRedoGroup,e._undoRedoSource),n.apply(),r.close(),i.push(n.model.uri)}e._progress.report(void 0)}else{const n=new An.z5(e._label,e._code,t.map(r=>new An.vi(e._label,e._code,r.model,r.getBeforeCursorState())));e._undoRedoService.pushElement(n,e._undoRedoGroup,e._undoRedoSource);for(const r of t)r.apply(),e._progress.report(void 0),i.push(r.model.uri);n.close()}return i}finally{(0,C.B9)(t)}})()}};_n=(0,h.gn)([(0,h.fM)(8,Gc.p),(0,h.fM)(9,as.q),(0,h.fM)(10,Gi.S),(0,h.fM)(11,En.tJ)],_n);var U=m(49311),Tn=m(89488),Kc=m(67018);let Vn=class{constructor(e,t,i,o,n,r,s,a,d,l,u){this._label=e,this._code=t,this._editor=i,this._progress=o,this._token=n,this._edits=r,this._undoRedoGroup=s,this._undoRedoSource=a,this._confirmBeforeUndo=d,this._instaService=l,this._logService=u}ariaMessage(){const e=new Te.Y9,t=new Te.Y9;let i=0;for(const o of this._edits)o instanceof xt.Gl?(i+=1,t.set(o.resource,!0)):o instanceof xt.pH&&e.set(o.oldResource??o.newResource,!0);return 0===this._edits.length?(0,p.NC)("summary.0","Made no edits"):0===e.size?i>1&&t.size>1?(0,p.NC)("summary.nm","Made {0} text edits in {1} files",i,t.size):(0,p.NC)("summary.n0","Made {0} text edits in one file",i):(0,p.NC)("summary.textFiles","Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}perform(){var e=this;return(0,w.Z)(function*(){if(0===e._edits.length)return[];const t=[1];for(let s=1;s<e._edits.length;s++)Object.getPrototypeOf(e._edits[s-1])===Object.getPrototypeOf(e._edits[s])?t[t.length-1]++:t.push(1);e._progress.report({increment:e._edits.length>1?0:void 0,total:100});const o={report:s=>e._progress.report({increment:100/e._edits.length})},n=[];let r=0;for(const s of t){if(e._token.isCancellationRequested)break;const a=e._edits.slice(r,r+s);a[0]instanceof xt.pH?n.push(yield e._performFileEdits(a,e._undoRedoGroup,e._undoRedoSource,e._confirmBeforeUndo,o)):a[0]instanceof xt.Gl?n.push(yield e._performTextEdits(a,e._undoRedoGroup,e._undoRedoSource,o)):a[0]instanceof Io.t?n.push(yield e._performCellEdits(a,e._undoRedoGroup,e._undoRedoSource,o)):console.log("UNKNOWN EDIT"),r+=s}return n.flat()})()}_performFileEdits(e,t,i,o,n){var r=this;return(0,w.Z)(function*(){return r._logService.debug("_performFileEdits",JSON.stringify(e)),yield r._instaService.createInstance(In,r._label||(0,p.NC)("workspaceEdit","Workspace Edit"),r._code||"undoredo.workspaceEdit",t,i,o,n,r._token,e).apply()})()}_performTextEdits(e,t,i,o){var n=this;return(0,w.Z)(function*(){return n._logService.debug("_performTextEdits",JSON.stringify(e)),yield n._instaService.createInstance(_n,n._label||(0,p.NC)("workspaceEdit","Workspace Edit"),n._code||"undoredo.workspaceEdit",n._editor,t,i,o,n._token,e).apply()})()}_performCellEdits(e,t,i,o){var n=this;return(0,w.Z)(function*(){return n._logService.debug("_performCellEdits",JSON.stringify(e)),yield n._instaService.createInstance(Io.s,t,i,o,n._token,e).apply()})()}};Vn=(0,h.gn)([(0,h.fM)(9,R.TG),(0,h.fM)(10,Ae.VZ)],Vn);let Mn=class{constructor(e,t,i,o,n,r,s){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=o,this._dialogService=n,this._workingCopyService=r,this._configService=s,this._activeUndoRedoGroups=new Oc.S}setPreviewHandler(e){return this._previewHandler=e,(0,C.OF)(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}apply(e,t){var i=this;return(0,w.Z)(function*(){let o=function Zc(c){return c.map(e=>{if(xt.Gl.is(e))return xt.Gl.lift(e);if(xt.pH.is(e))return xt.pH.lift(e);if(Io.t.is(e))return Io.t.lift(e);throw new Error("Unsupported edit")})}(Array.isArray(e)?e:e.edits);if(0===o.length)return{ariaSummary:(0,p.NC)("nothing","Made no edits"),isApplied:!1};i._previewHandler&&(t?.showPreview||o.some(u=>u.metadata?.needsConfirmation))&&(o=yield i._previewHandler(o,t));let n=t?.editor;if(!n){const u=i._editorService.activeTextEditorControl;(0,$t.CL)(u)&&(n=u)}n&&n.getOption(88)&&(n=void 0);let r,s=()=>{};if("number"==typeof t?.undoRedoGroupId)for(const u of i._activeUndoRedoGroups)if(u.id===t.undoRedoGroupId){r=u;break}r||(r=new En.Xt,s=i._activeUndoRedoGroups.push(r));const a=t?.quotableLabel||t?.label,d=i._instaService.createInstance(Vn,a,t?.code,n,t?.progress??Gt.Ex.None,t?.token??xe.T.None,o,r,t?.undoRedoSource,!!t?.confirmBeforeUndo);let l;try{l=i._lifecycleService.onBeforeShutdown(f=>f.veto(i._shouldVeto(a,f.reason),"veto.blukEditService"));const u=yield d.perform();return t?.respectAutoSaveConfig&&!0===i._configService.getValue(Ss)&&u.length>1&&(yield i._saveAll(u)),{ariaSummary:d.ariaMessage(),isApplied:o.length>0}}catch(u){throw i._logService.error(u),u}finally{l?.dispose(),s()}})()}_saveAll(e){var t=this;return(0,w.Z)(function*(){const i=new Te.XV(e),o=t._workingCopyService.dirtyWorkingCopies.map(function(){var r=(0,w.Z)(function*(s){i.has(s.resource)&&(yield s.save())});return function(s){return r.apply(this,arguments)}}()),n=yield Promise.allSettled(o);for(const r of n)"rejected"===r.status&&t._logService.warn(r.reason)})()}_shouldVeto(e,t){var i=this;return(0,w.Z)(function*(){let o,n;switch(t){case 1:o=(0,p.NC)("closeTheWindow.message","Are you sure you want to close the window?"),n=(0,p.NC)({key:"closeTheWindow",comment:["&& denotes a mnemonic"]},"&&Close Window");break;case 4:o=(0,p.NC)("changeWorkspace.message","Are you sure you want to change the workspace?"),n=(0,p.NC)({key:"changeWorkspace",comment:["&& denotes a mnemonic"]},"Change &&Workspace");break;case 3:o=(0,p.NC)("reloadTheWindow.message","Are you sure you want to reload the window?"),n=(0,p.NC)({key:"reloadTheWindow",comment:["&& denotes a mnemonic"]},"&&Reload Window");break;default:o=(0,p.NC)("quit.message","Are you sure you want to quit?"),n=(0,p.NC)({key:"quit",comment:["&& denotes a mnemonic"]},"&&Quit")}return!(yield i._dialogService.confirm({message:o,detail:(0,p.NC)("areYouSureQuiteBulkEdit.detail","'{0}' is in progress.",e||(0,p.NC)("fileOperation","File operation")),primaryButton:n})).confirmed})()}};Mn=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,Ae.VZ),(0,h.fM)(2,U.AR),(0,h.fM)(3,Tn.g),(0,h.fM)(4,ki.Ss),(0,h.fM)(5,Kc.C),(0,h.fM)(6,G.Ui)],Mn);const Ss="files.refactoring.autoSave";me.B.as(Hc.IP.Configuration).registerConfiguration({id:"files",properties:{[Ss]:{description:(0,p.NC)("refactoring.autoSave","Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}}),(0,ve.Z)('.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .actions-container{justify-content:flex-end}.monaco-workbench .part.basepanel>.composite.title>.global-actions .monaco-action-bar .action-item,.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item{margin-right:4px}.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item .action-label{outline-offset:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container.composite-bar>.monaco-action-bar .action-label.codicon-more{align-items:center;color:inherit!important;display:flex;justify-content:center;margin-left:0;margin-right:0}.monaco-workbench .part.basepanel .empty-panel-message-area{display:none;height:100%;width:100%}.monaco-workbench .part.basepanel .empty-panel-message-area.visible{align-content:center;align-items:center;display:flex;justify-content:center}.monaco-workbench .part.basepanel .empty-panel-message-area .empty-panel-message{margin:12px;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar{height:35px;line-height:27px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item{display:flex;font-size:11px;padding:2px 10px;text-transform:uppercase}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon{padding-left:2px;padding-right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label:not(.codicon){height:16px;width:16px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{background-color:var(--insert-border-color);content:"";display:none;height:24px;opacity:0;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:opacity;width:2px}.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{left:1px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after{margin-right:-2px;right:1px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before{left:2px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after{margin-right:-2px;right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:before{transition-delay:0s}.monaco-workbench .part.basepanel>.composite.title.dragged-over-head>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .part.basepanel>.composite.title.dragged-over-tail>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right+.action-item:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type.right:after{opacity:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .action-label{border-radius:0;margin-right:0;padding:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label.codicon,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:not(.icon) .action-label{background:none!important}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .action-label{margin-right:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge{align-items:center;display:flex;margin-left:8px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .badge{margin-left:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge .badge-content{border-radius:11px;box-sizing:border-box;display:inline-block;font-size:11px;font-weight:400;height:18px;line-height:11px;min-width:18px;padding:3px 5px;position:relative;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .active-item-indicator{bottom:0;height:100%;left:10px;overflow:hidden;pointer-events:none;position:absolute;top:-4px;width:calc(100% - 20px);z-index:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .active-item-indicator{left:2px;top:1px;width:calc(100% - 4px)}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-top-style:solid;border-top-width:1px;bottom:0;content:"";height:0;position:absolute;width:100%;z-index:1}.monaco-workbench .part.basepanel>.title>.panel-switcher-container>.monaco-action-bar .action-item.clicked:not(.checked):focus .active-item-indicator:before{border-top-color:transparent!important}.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.right .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(-90deg)}.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.left .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(90deg)}',{}),m(36012);var hi=m(62325),jc=m(44176),Xc=m(79505);let To=class Zr extends Jr{get preferredHeight(){return.4*this.layoutService.dimension.height}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}get onDidPaneCompositeOpen(){return S.ju.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X,ee,De,mt,$e){super(e,t,i,o,n,r,s,a,me.B.as(M),b,d.getDefaultViewContainer(ee)?.id||"","panel","panel",void 0,f,$e),this.viewDescriptorService=d,this.contextKeyService=l,this.extensionService=u,this.partId=f,this.pinnedPanelsKey=E,this.placeholdeViewContainersKey=k,this.backgroundColor=X,this.viewContainerLocation=ee,this.activePanelContextKey=De,this.panelFocusContextKey=mt,this.panelOptions=$e,this.minimumWidth=300,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=77,this.maximumHeight=Number.POSITIVE_INFINITY,this.snap=!0,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.compositeActions=new Map,this.panelDisposables=new Map,this.blockOpeningPanel=!1,this.extensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this.panelRegistry=me.B.as(M),this.dndHandler=new ss(this.viewDescriptorService,this.viewContainerLocation,(Q,re)=>this.openPaneComposite(Q,re).then(fe=>fe||null),(Q,re,fe)=>this.compositeBar.move(Q,re,fe?.horizontallyBefore),()=>this.compositeBar.getCompositeBarItems()),this.compositeBar=this._register(this.instantiationService.createInstance(ko,this.getCachedPanels(),{icon:!!this.panelOptions.useIcons,orientation:0,activityHoverOptions:this.getActivityHoverOptions(),openComposite:(Q,re)=>this.openPaneComposite(Q,!re).then(fe=>fe||null),getActivityAction:Q=>this.getCompositeActions(Q).activityAction,getCompositePinnedAction:Q=>this.getCompositeActions(Q).pinnedAction,getCompositeBadgeAction:Q=>this.getCompositeActions(Q).badgeAction,getOnCompositeClickAction:Q=>this.instantiationService.createInstance(hi.rV,(0,A.cW)(this.getPaneComposite(Q)),this.viewContainerLocation),fillExtraContextMenuActions:Q=>this.fillExtraContextMenuActions(Q),getContextMenuActionsForComposite:Q=>this.getContextMenuActionsForComposite(Q),getDefaultCompositeId:()=>d.getDefaultViewContainer(this.viewContainerLocation)?.id,hidePart:()=>this.layoutService.setPartHidden(!0,this.partId),dndHandler:this.dndHandler,compositeSize:0,overflowActionSize:44,colors:Q=>({activeBackgroundColor:Q.getColor(this.backgroundColor),inactiveBackgroundColor:Q.getColor(this.backgroundColor),activeBorderBottomColor:Q.getColor(I.bT),activeForegroundColor:Q.getColor(I.Pl),inactiveForegroundColor:Q.getColor(I.rU),badgeBackground:Q.getColor(Y.g8u),badgeForeground:Q.getColor(Y.qeD),dragAndDropBorder:Q.getColor(I.Px)})})),this.registerListeners(),this.onDidRegisterPanels([...this.getPaneComposites()]),this.globalActions=this._register(this.instantiationService.createInstance(jc.C,"workbench.parts.panel"===f?v.eH.PanelTitle:v.eH.AuxiliaryBarTitle,void 0,void 0)),this._register(this.globalActions.onDidChange(()=>this.updateGlobalToolbarActions()))}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push((0,P.xw)({id:"resetLocationAction",label:(0,p.NC)("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const n=this.viewDescriptorService.getViewContainerModel(i);if(1===n.allViewDescriptors.length){const r=n.allViewDescriptors[0],s=this.viewDescriptorService.getDefaultContainerById(r.id);s!==i&&t.push((0,P.xw)({id:"resetLocationAction",label:(0,p.NC)("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([r],s)}))}}return t}onDidRegisterPanels(e){const t=this.getCachedPanels();for(const i of e){const o=t.filter(({id:s})=>s===i.id)[0],n=this.getActivePaneComposite(),r=n?.getId()===i.id||this.extensionsRegistered&&0===this.compositeBar.getVisibleComposites().length;!r&&this.shouldBeHidden(i.id,o)||(this.compositeBar.addComposite({id:i.id,name:i.name,order:i.order,requestedIndex:i.requestedIndex}),o||this.compositeBar.pin(i.id),r&&(this.compositeBar.activateComposite(i.id),!n&&this.element&&this.layoutService.isVisible(this.partId)&&this.doOpenPanel(i.id)))}for(const i of e){const o=this.getViewContainer(i.id),n=this.viewDescriptorService.getViewContainerModel(o);this.updateActivity(o,n),this.showOrHideViewContainer(o,n);const r=new C.SL;r.add(n.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(o,n))),r.add(n.onDidChangeContainerInfo(()=>this.updateActivity(o,n))),this.panelDisposables.set(i.id,r)}}onDidDeregisterPanel(e){var t=this;return(0,w.Z)(function*(){t.panelDisposables.get(e)?.dispose(),t.panelDisposables.delete(e);const o=t.viewDescriptorService.getViewContainersByLocation(t.viewContainerLocation).filter(n=>t.viewDescriptorService.getViewContainerModel(n).activeViewDescriptors.length>0);if(o.length){if(t.getActivePaneComposite()?.getId()===e){const n=t.viewDescriptorService.getDefaultViewContainer(t.viewContainerLocation)?.id,r=o.filter(s=>s.id===n)[0]||o[0];yield t.openPaneComposite(r.id)}}else t.layoutService.setPartHidden(!0,t.partId);t.removeComposite(e)})()}updateActivity(e,t){const i=this.getPlaceholderViewContainers().filter(s=>s.id===e.id)[0]?.name,o={id:e.id,name:this.extensionsRegistered||void 0===i?t.title:i,keybindingId:t.keybindingId},{activityAction:n,pinnedAction:r}=this.getCompositeActions(e.id);n.setActivity(this.toActivity(t)),r instanceof hi.Bq&&r.setActivity(o),this.compositeBar.recomputeSizes(),this.layoutCompositeBar(),this.extensionsRegistered&&this.saveCachedPanels()}toActivity(e){return Zr.toActivity(e.viewContainer.id,e.title,this.panelOptions.useIcons?e.icon:void 0,e.keybindingId)}static toActivity(e,t,i,o){let n,r;if(W.ov.isUri(i)){r=i;const s=(0,g.wY)(i),a=new di.yP;a.update(s);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`;n=[d,"uri-icon"],(0,g.fk)(`.monaco-workbench .basepanel .monaco-action-bar .action-label.${d}`,`\n\t\t\t\tmask: ${s} no-repeat 50% 50%;\n\t\t\t\tmask-size: 16px;\n\t\t\t\t-webkit-mask: ${s} no-repeat 50% 50%;\n\t\t\t\t-webkit-mask-size: 16px;\n\t\t\t\tmask-origin: padding;\n\t\t\t\t-webkit-mask-origin: padding;\n\t\t\t`)}else be.kS.isThemeIcon(i)&&(n=be.kS.asClassNameArray(i));return{id:e,name:t,classNames:n,iconUrl:r,keybindingId:o}}showOrHideViewContainer(e,t){let i=this.enabledViewContainersContextKeys.get(e.id);if(i||(i=this.contextKeyService.createKey((0,N.l0)(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,i)),t.activeViewDescriptors.length){if(i.set(!0),this.compositeBar.addComposite({id:e.id,name:"string"==typeof e.title?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex}),this.layoutService.isRestored()&&this.layoutService.isVisible(this.partId)){const o=this.getActiveComposite();(void 0===o||o.getId()===e.id)&&this.compositeBar.activateComposite(e.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}else e.hideIfEmpty&&(i.set(!1),this.hideComposite(e.id))}shouldBeHidden(e,t){const i=this.getViewContainer(e);return!(!i||!i.hideIfEmpty)&&!(!t?.views||!t.views.length)&&t.views.every(({when:o})=>!!o&&!this.contextKeyService.contextMatchesRules(y.Ao.deserialize(o)))}registerListeners(){this._register(this.registry.onDidRegister(t=>this.onDidRegisterPanels([t]))),this._register(this.registry.onDidDeregister(t=>this.onDidDeregisterPanel(t.id))),this._register(this.onDidPaneCompositeOpen(t=>this.onPanelOpen(t))),this._register(this.onDidPaneCompositeClose(this.onPanelClose,this));const e=this._register(new C.SL);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedPanels(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)}))}onDidRegisterExtensions(){this.extensionsRegistered=!0;const e=this.getPaneComposites();for(const{id:t}of this.getCachedPanels())e.every(i=>i.id!==t)&&(this.viewDescriptorService.isViewContainerRemovedPermanently(t)?this.removeComposite(t):this.hideComposite(t));this.saveCachedPanels()}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}onPanelOpen(e){this.activePanelContextKey.set(e.getId());const t=this.panelRegistry.getPaneComposite(e.getId());t&&this.compositeBar.addComposite(t),this.compositeBar.activateComposite(e.getId());const i=this.panelRegistry.getPaneComposite(e.getId());if(i){const o=this.getViewContainer(i.id);o?.hideIfEmpty&&0===this.viewDescriptorService.getViewContainerModel(o).activeViewDescriptors.length&&this.hideComposite(i.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}onPanelClose(e){const t=e.getId();this.activePanelContextKey.get()===t&&this.activePanelContextKey.reset(),this.compositeBar.deactivateComposite(e.getId()),this.layoutEmptyMessage()}create(e){this.element=e,super.create(e),this.createEmptyPanelMessage();const t=this._register((0,g.go)(e));this._register(t.onDidFocus(()=>this.panelFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.panelFocusContextKey.set(!1)))}createEmptyPanelMessage(){const e=this.getContentArea();this.emptyPanelMessageElement=document.createElement("div"),this.emptyPanelMessageElement.classList.add("empty-panel-message-area");const t=document.createElement("div");t.classList.add("empty-panel-message"),t.innerText=(0,p.NC)("panel.emptyMessage","Drag a view here to display."),this.emptyPanelMessageElement.appendChild(t),e.appendChild(this.emptyPanelMessageElement),this._register(B.Mi.INSTANCE.registerTarget(this.emptyPanelMessageElement,{onDragOver:i=>{g.zB.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);(0,B.cP)(i.eventData.dataTransfer,"move",o)},onDragEnter:i=>{g.zB.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);this.emptyPanelMessageElement.style.backgroundColor=o&&this.theme.getColor(I.Xv)?.toString()||""},onDragLeave:i=>{g.zB.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDragEnd:i=>{g.zB.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDrop:i=>{g.zB.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor="",this.dndHandler.drop(i.dragAndDropData,void 0,i.eventData)}}))}createTitleArea(e){const t=super.createTitleArea(e),i=t.appendChild((0,g.$)(".global-actions"));return this.globalToolBar=this._register(new Xc.u(i,this.contextMenuService,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,p.NC)("moreActions","More Actions...")})),this.updateGlobalToolbarActions(),t}updateStyles(){super.updateStyles();const e=(0,A.cW)(this.getContainer());e.style.backgroundColor=this.getColor(this.backgroundColor)||"";const t=this.getColor(Y.lRK)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(Y.lRK)||"")}doOpenPanel(e,t){if(!this.blockOpeningPanel){if(!this.layoutService.isVisible(this.partId))try{this.blockOpeningPanel=!0,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpeningPanel=!1}return this.openComposite(e,t)}}openPaneComposite(e,t){var i=this;return(0,w.Z)(function*(){if("string"==typeof e&&i.getPaneComposite(e)||(yield i.extensionService.whenInstalledExtensionsRegistered(),"string"==typeof e&&i.getPaneComposite(e)))return i.doOpenPanel(e,t)})()}showActivity(e,t,i){return this.compositeBar.showActivity(e,t,i)}getPaneComposite(e){return this.panelRegistry.getPaneComposite(e)}getPaneComposites(){return this.panelRegistry.getPaneComposites().sort((e,t)=>"number"!=typeof e.order?1:"number"!=typeof t.order?-1:e.order-t.order)}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getPaneComposites().filter(t=>e.includes(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>this.getActivePaneComposite()?.getId()===e.id||this.compositeBar.isPinned(e.id)).map(e=>e.id)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}createTitleLabel(e){return this.compositeBar.create(e).classList.add("panel-switcher-container"),{updateTitle:(i,o,n)=>{const r=this.compositeBar.getAction(i);r&&(r.label=o)},updateStyles:()=>{}}}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}layout(e,t,i,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new g.Ro(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension){let e=this.contentDimension.width-40;this.toolBar&&(e=Math.max(Zr.MIN_COMPOSITE_BAR_WIDTH,e-this.getToolbarWidth())),this.compositeBar.layout(new g.Ro(e,this.dimension.height))}}layoutEmptyMessage(){this.emptyPanelMessageElement?.classList.toggle("visible",0===this.compositeBar.getVisibleComposites().length)}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.viewContainerLocation?t:void 0}updateGlobalToolbarActions(){const e=this.globalActions.getPrimaryActions(),t=this.globalActions.getSecondaryActions();this.globalToolBar?.setActions((0,qe.c)(e),(0,qe.c)(t))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(hi.rV,this.toActivity(o),this.viewContainerLocation),pinnedAction:new Fe.du(this.toActivity(o),this.compositeBar),badgeAction:new Fe.B7(this.toActivity(o),this.compositeBar)}}else t={activityAction:this.instantiationService.createInstance(hi.h3,e,this.viewContainerLocation),pinnedAction:new hi.Bq(e,this.compositeBar),badgeAction:new ns(e,this.compositeBar)};this.compositeActions.set(e,t)}return t}removeComposite(e){if(super.removeComposite(e)){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);return t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e)),!0}return!1}getToolbarWidth(){return this.getActivePaneComposite()&&this.toolBar?this.toolBar.getItemsWidth()+(this.globalToolBar?.getItemsWidth()??0):0}onDidStorageValueChange(e){if(e.key===this.pinnedPanelsKey&&0===e.scope&&this.cachedPanelsValue!==this.getStoredCachedPanelsValue()){this._cachedPanelsValue=void 0;const t=[],i=this.compositeBar.getCompositeBarItems(),o=this.getCachedPanels();for(const n of o)t.push({id:n.id,name:n.name,order:n.order,pinned:n.pinned,visible:!!i.find(({id:r})=>r===n.id)});for(let n=0;n<i.length;n++)t.some(({id:r})=>r===i[n].id)||t.splice(n,0,i[n]);this.compositeBar.setCompositeBarItems(t)}}saveCachedPanels(){const e=[],t=[],i=this.compositeBar.getCompositeBarItems();for(const o of i){const n=this.getViewContainer(o.id);if(n){const r=this.viewDescriptorService.getViewContainerModel(n);e.push({id:o.id,name:r.title,pinned:o.pinned,order:o.order,visible:o.visible}),t.push({id:o.id,name:this.getCompositeActions(o.id).activityAction.label})}else e.push({id:o.id,name:o.name,pinned:o.pinned,order:o.order,visible:o.visible})}this.cachedPanelsValue=JSON.stringify(e),this.setPlaceholderViewContainers(t)}getCachedPanels(){const e=this.getPaneComposites(),i=JSON.parse(this.cachedPanelsValue).map(o=>{const n="string"==typeof o?{id:o,pinned:!0,order:void 0,visible:!0}:o,r=e.some(s=>s.id===n.id);return n.visible=!!r&&(!!(0,A.Jp)(n.visible)||n.visible),n});for(const o of this.getPlaceholderViewContainers()){const n=i.filter(r=>r.id===o.id)[0];n&&(n.name=o.name)}return i}get cachedPanelsValue(){return this._cachedPanelsValue||(this._cachedPanelsValue=this.getStoredCachedPanelsValue()),this._cachedPanelsValue}set cachedPanelsValue(e){this.cachedPanelsValue!==e&&(this._cachedPanelsValue=e,this.setStoredCachedViewletsValue(e))}getStoredCachedPanelsValue(){return this.storageService.get(this.pinnedPanelsKey,0,"[]")}setStoredCachedViewletsValue(e){this.storageService.store(this.pinnedPanelsKey,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(this.placeholdeViewContainersKey,1,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(this.placeholdeViewContainersKey,e,1,1)}};To.MIN_COMPOSITE_BAR_WIDTH=50,To=(0,h.gn)([(0,h.fM)(0,oe.lT),(0,h.fM)(1,Ie.Uy),(0,h.fM)(2,Ue.bU),(0,h.fM)(3,ge.i),(0,h.fM)(4,et.z),(0,h.fM)(5,Se.d),(0,h.fM)(6,R.TG),(0,h.fM)(7,K.XE),(0,h.fM)(8,O.XH),(0,h.fM)(9,y.i6),(0,h.fM)(10,Pt.QS)],To);let Vo=class $a extends To{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b){super(e,t,i,o,n,r,s,a,d,l,u,"workbench.parts.panel",$a.activePanelSettingsKey,"workbench.panel.pinnedPanels","workbench.panel.placeholderPanels",Co.IP.Panels,I.v9,1,N.jN.bindTo(l),N.dX.bindTo(l),{useIcons:!1,hasTitle:!0}),this.commandService=f,this.menuService=b}updateStyles(){super.updateStyles();const e=(0,A.cW)(this.getContainer()),t=this.getColor(I.QO)||this.getColor(Y.lRK)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(I.QO)||this.getColor(Y.lRK)||"")}getActivityHoverOptions(){return{position:()=>2!==this.layoutService.getPanelPosition()||this.layoutService.isPanelMaximized()?2:3}}fillExtraContextMenuActions(e){const t=this.menuService.createMenu(v.eH.PanelPositionMenu,this.contextKeyService),i=this.menuService.createMenu(v.eH.PanelAlignmentMenu,this.contextKeyService),o=[],n=[];(0,Be.LJ)(t,{shouldForwardArgs:!0},{primary:[],secondary:o}),(0,Be.LJ)(i,{shouldForwardArgs:!0},{primary:[],secondary:n}),i.dispose(),t.dispose(),e.push(new P.Z0,new P.wY("workbench.action.panel.position",(0,p.NC)("panel position","Panel Position"),o),new P.wY("workbench.action.panel.align",(0,p.NC)("align panel","Align Panel"),n),(0,P.xw)({id:hi.gU.ID,label:(0,p.NC)("hidePanel","Hide Panel"),run:()=>this.commandService.executeCommand(hi.gU.ID)}))}layout(e,t,i,o){let n;n=1===this.layoutService.getPanelPosition()?new g.Ro(e-1,t):new g.Ro(e,t),super.layout(n.width,n.height,i,o)}toJSON(){return{type:"workbench.parts.panel"}}};Vo.activePanelSettingsKey="workbench.panelpart.activepanelid",Vo=(0,h.gn)([(0,h.fM)(0,oe.lT),(0,h.fM)(1,Ie.Uy),(0,h.fM)(2,Ue.bU),(0,h.fM)(3,ge.i),(0,h.fM)(4,et.z),(0,h.fM)(5,Se.d),(0,h.fM)(6,R.TG),(0,h.fM)(7,K.XE),(0,h.fM)(8,O.XH),(0,h.fM)(9,y.i6),(0,h.fM)(10,Pt.QS),(0,h.fM)(11,Z.H),(0,h.fM)(12,v.co)],Vo);var Mo=m(11113);(0,ve.Z)(".monaco-grid-view{overflow:hidden;position:relative}.monaco-grid-branch-node,.monaco-grid-view{height:100%;width:100%}",{});var Re=m(27034),jt=m(88632),Qc=m(32536);const Jc={separatorBorder:jt.Il.transparent};function kt(c){return 0===c?1:0}class qc{constructor(e){this.isLayoutEnabled=e}}function ht(c,e){if(Math.abs(c)>e)throw new Error("Invalid index");return(0,Qc.Xs)(c,e+1)}class ue{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return 1===this.orientation?this.size:this.orthogonalSize}get height(){return 1===this.orientation?this.orthogonalSize:this.size}get top(){return 1===this.orientation?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return 1===this.orientation?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return 0===this.children.length?0:Math.max(...this.children.map(e=>e.minimumOrthogonalSize))}get maximumSize(){return Math.min(...this.children.map(e=>e.maximumOrthogonalSize))}get priority(){if(0===this.children.length)return 0;const e=this.children.map(t=>typeof t.priority>"u"?0:t.priority);return e.some(t=>2===t)?2:e.some(t=>1===t)?1:0}get proportionalLayout(){return 0===this.children.length||this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return 1===this.orientation?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return 1===this.orientation?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return 1===this.orientation?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return 1===this.orientation?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){const i=this.children[t];i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:0===t?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:t===this.children.length-1?e.end:i.boundarySashes.orthogonalEnd}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(e){if(this._edgeSnapping!==e){this._edgeSnapping=e;for(const t of this.children)t instanceof ue&&(t.edgeSnapping=e);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,o,n=0,r=0,s=!1,a){if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=o,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new S.Q5,this.onDidChange=this._onDidChange.event,this._onDidScroll=new S.Q5,this.onDidScrollDisposable=C.JT.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=C.JT.None,this._onDidSashReset=new S.Q5,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=C.JT.None,this.childrenSashResetDisposable=C.JT.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=n,this._orthogonalSize=r,this.element=(0,g.$)(".monaco-grid-branch-node"),a){const l={views:a.map(f=>({view:f.node,size:f.node.size,visible:!(f.node instanceof _e&&void 0!==f.visible)||f.visible})),size:this.orthogonalSize},u={proportionalLayout:o,orientation:e,styles:i};this.children=a.map(f=>f.node),this.splitview=new Re.z(this.element,{...u,descriptor:l}),this.children.forEach((f,b)=>{f.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:0===b?this.boundarySashes.start:this.splitview.sashes[b-1],orthogonalEnd:b===this.children.length?this.boundarySashes.end:this.splitview.sashes[b]}})}else this.splitview=new Re.z(this.element,{orientation:e,styles:i,proportionalLayout:o}),this.splitview.layout(n,{orthogonalSize:r,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:n,absoluteOrthogonalSize:r});const d=S.ju.map(this.splitview.onDidSashReset,l=>[l]);this.splitviewSashResetDisposable=d(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(e){this._styles=e,this.splitview.style(e);for(const t of this.children)t instanceof ue&&t.style(e)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(const t of this.children)t.setVisible(e)}addChild(e,t,i,o){i=ht(i,this.children.length),this.splitview.addView(e,t,i,o),this._addChild(e,i),this.onDidChildrenChange()}_addChild(e,t){const i=0===t,o=t===this.children.length;this.children.splice(t,0,e),e.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:i?this.boundarySashes.start:this.splitview.sashes[t-1],orthogonalEnd:o?this.boundarySashes.end:this.splitview.sashes[t]},i||(this.children[t-1].boundarySashes={...this.children[t-1].boundarySashes,orthogonalEnd:this.splitview.sashes[t-1]}),o||(this.children[t+1].boundarySashes={...this.children[t+1].boundarySashes,orthogonalStart:this.splitview.sashes[t]})}removeChild(e,t){e=ht(e,this.children.length),this.splitview.removeView(e,t),this._removeChild(e),this.onDidChildrenChange()}_removeChild(e){const t=0===e,i=e===this.children.length-1,[o]=this.children.splice(e,1);return t||(this.children[e-1].boundarySashes={...this.children[e-1].boundarySashes,orthogonalEnd:this.splitview.sashes[e-1]}),i||(this.children[e].boundarySashes={...this.children[e].boundarySashes,orthogonalStart:this.splitview.sashes[Math.max(e-1,0)]}),o}moveChild(e,t){if((e=ht(e,this.children.length))===(t=ht(t,this.children.length)))return;e<t&&t--,this.splitview.moveView(e,t);const i=this._removeChild(e);this._addChild(i,t),this.onDidChildrenChange()}swapChildren(e,t){(e=ht(e,this.children.length))!==(t=ht(t,this.children.length))&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=ht(e,this.children.length),this.splitview.resizeView(e,t)}isChildSizeMaximized(e){return this.splitview.isViewSizeMaximized(e)}distributeViewSizes(e=!1){if(this.splitview.distributeViewSizes(),e)for(const t of this.children)t instanceof ue&&t.distributeViewSizes(!0)}getChildSize(e){return e=ht(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=ht(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){e=ht(e,this.children.length),this.splitview.isViewVisible(e)!==t&&this.splitview.setViewVisible(e,t)}getChildCachedVisibleSize(e){return e=ht(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){const e=S.ju.map(S.ju.any(...this.children.map(o=>o.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=e(this._onDidChange.fire,this._onDidChange);const t=S.ju.any(...this.children.map((o,n)=>S.ju.map(o.onDidSashReset,r=>[n,...r])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=t(this._onDidSashReset.fire,this._onDidSashReset);const i=S.ju.any(S.ju.signal(this.splitview.onDidScroll),...this.children.map(o=>o.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=i(this._onDidScroll.fire,this._onDidScroll)}trySet2x2(e){if(2!==this.children.length||2!==e.children.length||this.getChildSize(0)!==e.getChildSize(0))return C.JT.None;const[t,i]=this.children,[o,n]=e.children;if(!(t instanceof _e&&i instanceof _e&&o instanceof _e&&n instanceof _e))return C.JT.None;0===this.orientation?(i.linkedWidthNode=o.linkedHeightNode=t,t.linkedWidthNode=n.linkedHeightNode=i,n.linkedWidthNode=t.linkedHeightNode=o,o.linkedWidthNode=i.linkedHeightNode=n):(o.linkedWidthNode=i.linkedHeightNode=t,n.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=n.linkedHeightNode=o,i.linkedWidthNode=o.linkedHeightNode=n);const r=this.splitview.sashes[0],s=e.splitview.sashes[0];return r.linkedSash=s,s.linkedSash=r,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),(0,C.OF)(()=>{r.linkedSash=s.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0,n.linkedHeightNode=n.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(const e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.splitview.dispose()}}class _e{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:S.ju.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:S.ju.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,o,n=0){this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=S.ju.None,this.onDidSashReset=S.ju.None,this._onDidLinkedWidthNodeChange=new S.ZD,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new S.ZD,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new S.Q5,this.disposables=new C.SL,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=o,this._size=n;const r=function id(c){const[e,t]=S.ju.split(c.onDidChange,A.o8);return S.ju.any(t,S.ju.map(S.ju.latch(S.ju.map(e,i=>[c.minimumWidth,c.maximumWidth,c.minimumHeight,c.maximumHeight]),L.fS),i=>{}))}(e);this._onDidViewChange=S.ju.map(r,s=>s&&(0===this.orientation?s.width:s.height),this.disposables),this.onDidChange=S.ju.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return 1===this.orientation?this.orthogonalSize:this.size}get height(){return 1===this.orientation?this.size:this.orthogonalSize}get top(){return 1===this.orientation?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return 1===this.orientation?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return 1===this.orientation?this.minimumHeight:this.minimumWidth}get maximumSize(){return 1===this.orientation?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return 1===this.orientation?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return 1===this.orientation?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.view.setBoundarySashes?.(function ed(c,e){return 1===e?{left:c.start,right:c.end,top:c.orthogonalStart,bottom:c.orthogonalEnd}:{top:c.start,bottom:c.end,left:c.orthogonalStart,right:c.orthogonalEnd}}(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,o){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===o||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=o,this.view.layout(e,t,i,o))}setVisible(e){this.view.setVisible?.(e)}dispose(){this.disposables.dispose()}}function Es(c,e,t){if(c instanceof ue){const i=new ue(kt(c.orientation),c.layoutController,c.styles,c.splitviewProportionalLayout,e,t,c.edgeSnapping);let o=0;for(let n=c.children.length-1;n>=0;n--){const r=c.children[n];let a=0===c.size?0:Math.round(e*(r instanceof ue?r.orthogonalSize:r.size)/c.size);o+=a,0===n&&(a+=e-o),i.addChild(Es(r,t,a),a,0,!0)}return i}return new _e(c.view,kt(c.orientation),c.layoutController,t)}class Di{get root(){return this._root}set root(e){const t=this._root;t&&(this.element.removeChild(t.element),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=S.ju.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;const{size:t,orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:n}=this._root;this.root=Es(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:n,absoluteOrthogonalOffset:o,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=function td(c,e){return 1===e?{start:c.left,end:c.right,orthogonalStart:c.top,orthogonalEnd:c.bottom}:{start:c.top,end:c.bottom,orthogonalStart:c.left,orthogonalEnd:c.right}}(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(e={}){this.onDidSashResetRelay=new S.ZD,this._onDidScroll=new S.ZD,this._onDidChange=new S.ZD,this._boundarySashes={},this.disposable2x2=C.JT.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.element=(0,g.$)(".monaco-grid-view"),this.styles=e.styles||Jc,this.proportionalLayout=!(typeof e.proportionalLayout<"u"&&!e.proportionalLayout),this.layoutController=new qc(!1),this.root=new ue(0,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t,i=0,o=0){this.layoutController.isLayoutEnabled=!0;const[n,r,s,a]=1===this.root.orientation?[t,e,i,o]:[e,t,o,i];this.root.layout(n,0,{orthogonalSize:r,absoluteOffset:s,absoluteOrthogonalOffset:a,absoluteSize:n,absoluteOrthogonalSize:r})}addView(e,t,i){this.disposable2x2.dispose(),this.disposable2x2=C.JT.None;const[o,n]=(0,L.JH)(i),[r,s]=this.getNode(o);if(s instanceof ue){const a=new _e(e,kt(s.orientation),this.layoutController,s.orthogonalSize);s.addChild(a,t,n)}else{const[,a]=(0,L.JH)(r),[,d]=(0,L.JH)(o);let l=0;const u=a.getChildCachedVisibleSize(d);"number"==typeof u&&(l=Re.M.Invisible(u)),a.removeChild(d);const f=new ue(s.orientation,s.layoutController,this.styles,this.proportionalLayout,s.size,s.orthogonalSize,a.edgeSnapping);a.addChild(f,s.size,d);const b=new _e(s.view,a.orientation,this.layoutController,s.size);f.addChild(b,l,0),"number"!=typeof t&&"split"===t.type&&(t=Re.M.Split(0));const E=new _e(e,a.orientation,this.layoutController,s.size);f.addChild(E,t,n)}this.trySet2x2()}removeView(e,t){this.disposable2x2.dispose(),this.disposable2x2=C.JT.None;const[i,o]=(0,L.JH)(e),[n,r]=this.getNode(i);if(!(r instanceof ue))throw new Error("Invalid location");const s=r.children[o];if(!(s instanceof _e))throw new Error("Invalid location");if(r.removeChild(o,t),0===r.children.length)throw new Error("Invalid grid state");if(r.children.length>1)return this.trySet2x2(),s.view;if(0===n.length){const b=r.children[0];return b instanceof _e||(r.removeChild(0),this.root=b,this.boundarySashes=this.boundarySashes,this.trySet2x2()),s.view}const[,a]=(0,L.JH)(n),[,d]=(0,L.JH)(i),l=r.children[0],u=r.isChildVisible(0);r.removeChild(0);const f=a.children.map((b,E)=>a.getChildSize(E));if(a.removeChild(d,t),l instanceof ue){f.splice(d,1,...l.children.map(b=>b.size));for(let b=0;b<l.children.length;b++){const E=l.children[b];a.addChild(E,E.size,d+b)}}else{const b=new _e(l.view,kt(l.orientation),this.layoutController,l.size),E=u?l.orthogonalSize:Re.M.Invisible(l.orthogonalSize);a.addChild(b,E,d)}for(let b=0;b<f.length;b++)a.resizeChild(b,f[b]);return this.trySet2x2(),s.view}moveView(e,t,i){const[,o]=this.getNode(e);if(!(o instanceof ue))throw new Error("Invalid location");o.moveChild(t,i),this.trySet2x2()}swapViews(e,t){const[i,o]=(0,L.JH)(e),[,n]=this.getNode(i);if(!(n instanceof ue))throw new Error("Invalid from location");const r=n.getChildSize(o),s=n.children[o];if(!(s instanceof _e))throw new Error("Invalid from location");const[a,d]=(0,L.JH)(t),[,l]=this.getNode(a);if(!(l instanceof ue))throw new Error("Invalid to location");const u=l.getChildSize(d),f=l.children[d];if(!(f instanceof _e))throw new Error("Invalid to location");n===l?n.swapChildren(o,d):(n.removeChild(o),l.removeChild(d),n.addChild(f,r,o),l.addChild(s,u,d)),this.trySet2x2()}resizeView(e,t){const[i,o]=(0,L.JH)(e),[n,r]=this.getNode(i);if(!(r instanceof ue))throw new Error("Invalid location");if(!t.width&&!t.height)return;const[s,a]=1===r.orientation?[t.width,t.height]:[t.height,t.width];if("number"==typeof a&&n.length>0){const[,d]=(0,L.JH)(n),[,l]=(0,L.JH)(i);d.resizeChild(l,a)}"number"==typeof s&&r.resizeChild(o,s),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};const[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){const[t,i]=(0,L.JH)(e),[,o]=this.getNode(t);if(!(o instanceof ue))throw new Error("Invalid location");return o.getChildCachedVisibleSize(i)}maximizeViewSize(e){const[t,i]=this.getNode(e);if(!(i instanceof _e))throw new Error("Invalid location");for(let o=0;o<t.length;o++)t[o].resizeChild(e[o],Number.POSITIVE_INFINITY)}isViewSizeMaximized(e){const[t,i]=this.getNode(e);if(!(i instanceof _e))throw new Error("Invalid location");for(let o=0;o<t.length;o++)if(!t[o].isChildSizeMaximized(e[o]))return!1;return!0}distributeViewSizes(e){if(!e)return void this.root.distributeViewSizes(!0);const[,t]=this.getNode(e);if(!(t instanceof ue))throw new Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){const[t,i]=(0,L.JH)(e),[,o]=this.getNode(t);if(!(o instanceof ue))throw new Error("Invalid from location");return o.isChildVisible(i)}setViewVisible(e,t){const[i,o]=(0,L.JH)(e),[,n]=this.getNode(i);if(!(n instanceof ue))throw new Error("Invalid from location");n.setChildVisible(o,t)}getView(e){const t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(e,t,i={}){if("number"!=typeof e.orientation)throw new Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof e.width)throw new Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof e.height)throw new Error("Invalid JSON: 'height' property must be a number.");if("branch"!==e.root?.type)throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");const o=e.orientation,n=e.height,r=new Di(i);return r._deserialize(e.root,o,t,n),r}_deserialize(e,t,i,o){this.root=this._deserializeNode(e,t,i,o)}_deserializeNode(e,t,i,o){let n;if("branch"===e.type){const s=e.data.map(a=>({node:this._deserializeNode(a,kt(t),i,e.size),visible:a.visible}));n=new ue(t,this.layoutController,this.styles,this.proportionalLayout,e.size,o,void 0,s)}else n=new _e(i.fromJSON(e.data),t,this.layoutController,o,e.size);return n}_getViews(e,t,i){const o={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof _e)return{view:e.view,box:o,cachedVisibleSize:i};const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],a=e.getChildCachedVisibleSize(r);n.push(this._getViews(s,kt(t),a))}return{children:n,box:o}}getNode(e,t=this.root,i=[]){if(0===e.length)return[i,t];if(!(t instanceof ue))throw new Error("Invalid location");const[o,...n]=e;if(o<0||o>=t.children.length)throw new Error("Invalid location");const r=t.children[o];return i.push(t),this.getNode(n,r,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=C.JT.None,2!==this.root.children.length)return;const[e,t]=this.root.children;!(e instanceof ue)||!(t instanceof ue)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof ue?t.children.forEach(i=>this.getViewMap(e,i)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}function ui(c){return!!c.children}function xs(c,e){if(0===e.length)return c;if(!ui(c))throw new Error("Invalid location");const[t,...i]=e;return xs(c.children[t],i)}function ks(c,e){const t=Ln(e);return{offset:0===e?c.top:3===e?c.left+c.width:1===e?c.top+c.height:c.left,range:{start:1===t?c.top:c.left,end:1===t?c.top+c.height:c.left+c.width}}}function Pn(c,e){return e.length%2==0?kt(c):c}function Ln(c){return 0===c||1===c?0:1}function Ds(c,e,t){if(Pn(c,e)===Ln(t)){let[n,r]=(0,L.JH)(e);return(3===t||1===t)&&(r+=1),[...n,r]}{const n=3===t||1===t?1:0;return[...e,n]}}function Is(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(e.className))return[];const t=function sd(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");let t=e.firstElementChild,i=0;for(;t!==c&&t!==e.lastElementChild&&t;)t=t.nextElementSibling,i++;return i}(e);return[...Is(e.parentElement.parentElement.parentElement.parentElement),t]}var zi,c;(c=zi||(zi={})).Distribute={type:"distribute"},c.Split={type:"split"},c.Invisible=function e(t){return{type:"invisible",cachedVisibleSize:t}};class ad extends C.JT{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e,t={}){super(),this.views=new Map,this.didLayout=!1,e instanceof Di?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new Di(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof Di||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll}style(e){this.gridview.style(e)}layout(e,t,i=0,o=0){this.gridview.layout(e,t,i,o),this.didLayout=!0}addView(e,t,i,o){if(this.views.has(e))throw new Error("Can't add same view twice");const n=Ln(o);1===this.views.size&&this.orientation!==n&&(this.orientation=n);const r=this.getViewLocation(i),s=Ds(this.gridview.orientation,r,o);let a;if("number"==typeof t)a=t;else if("split"===t.type){const[,d]=(0,L.JH)(r);a=Re.M.Split(d)}else a="distribute"===t.type?Re.M.Distribute:t;this._addView(e,a,s)}addViewAt(e,t,i){if(this.views.has(e))throw new Error("Can't add same view twice");let o;o="number"==typeof t?t:"distribute"===t.type?Re.M.Distribute:t,this._addView(e,o,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(1===this.views.size)throw new Error("Can't remove last view");const i=this.getViewLocation(e);this.gridview.removeView(i,t&&"distribute"===t.type?Re.M.Distribute:void 0),this.views.delete(e)}moveView(e,t,i,o){const n=this.getViewLocation(e),[r,s]=(0,L.JH)(n),a=this.getViewLocation(i),d=Ds(this.gridview.orientation,a,o),[l,u]=(0,L.JH)(d);(0,L.fS)(r,l)?this.gridview.moveView(r,s,u):(this.removeView(e,"number"==typeof t?void 0:t),this.addView(e,t,i,o))}moveViewTo(e,t){const i=this.getViewLocation(e),[o,n]=(0,L.JH)(i),[r,s]=(0,L.JH)(t);if((0,L.fS)(o,r))this.gridview.moveView(o,n,s);else{const a=this.getViewSize(e),d=Pn(this.gridview.orientation,i),l=this.getViewCachedVisibleSize(e),u=typeof l>"u"?1===d?a.width:a.height:zi.Invisible(l);this.removeView(e),this.addViewAt(e,u,t)}}swapViews(e,t){const i=this.getViewLocation(e),o=this.getViewLocation(t);return this.gridview.swapViews(i,o)}resizeView(e,t){const i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewSizeMaximized(e){const t=this.getViewLocation(e);return this.gridview.isViewSizeMaximized(t)}getViewSize(e){if(!e)return this.gridview.getViewSize();const t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){const t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeViewSize(e){const t=this.getViewLocation(e);this.gridview.maximizeViewSize(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){const t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){const i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t,i=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");const o=this.getViewLocation(e),n=this.getViews(),r=xs(n,o);let s=ks(r.box,t);return i&&(0===t&&0===r.box.top?s={offset:n.box.top+n.box.height,range:s.range}:3===t&&r.box.left+r.box.width===n.box.width||1===t&&r.box.top+r.box.height===n.box.height?s={offset:0,range:s.range}:2===t&&0===r.box.left&&(s={offset:n.box.left+n.box.width,range:s.range})),function rd(c,e,t){const i=[];return function o(n,r,s){if(ui(n))for(const a of n.children)o(a,r,s);else{const{offset:a,range:d}=ks(n.box,r);a===s.offset&&function nd(c,e){return!(c.start>=e.end||e.start>=c.end)}(d,s.range)&&i.push(n)}}(c,e,t),i}(n,function od(c){switch(c){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}}(t),s).map(a=>a.view)}getViewLocation(e){const t=this.views.get(e);if(!t)throw new Error("View not found");return Is(t)}onDidSashReset(e){const t=n=>{const r=this.gridview.getView(n);if(ui(r))return!1;const s=Pn(this.orientation,n),a=1===s?r.view.preferredWidth:r.view.preferredHeight;if("number"!=typeof a)return!1;const d=1===s?{width:Math.round(a)}:{height:Math.round(a)};return this.gridview.resizeView(n,d),!0};if(t(e))return;const[i,o]=(0,L.JH)(e);t([...i,o+1])||this.gridview.distributeViewSizes(i)}}class pi extends ad{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(e,t){const i=0===t?e.box.width:e.box.height;return ui(e)?{type:"branch",data:e.children.map(o=>pi.serializeNode(o,kt(t))),size:i}:"number"==typeof e.cachedVisibleSize?{type:"leaf",data:e.view.toJSON(),size:e.cachedVisibleSize,visible:!1}:{type:"leaf",data:e.view.toJSON(),size:i}}static deserialize(e,t,i={}){if("number"!=typeof e.orientation)throw new Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof e.width)throw new Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof e.height)throw new Error("Invalid JSON: 'height' property must be a number.");const o=Di.deserialize(e,t,i);return new pi(o,i)}static from(e,t={}){return pi.deserialize(Ms(e),{fromJSON:i=>i},t)}serialize(){return{root:pi.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t,i=0,o=0){super.layout(e,t,i,o),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}}function As(c){return!!c.groups}function _s(c,e){if(!e&&c.groups&&c.groups.length<=1&&(c.groups=void 0),!As(c))return;let t=0,i=0;for(const s of c.groups)_s(s,!1),s.size&&(t+=s.size,i++);const r=(i>0?t:1)/(c.groups.length-i);for(const s of c.groups)s.size||(s.size=r)}function Ts(c){return As(c)?{type:"branch",data:c.groups.map(e=>Ts(e)),size:c.size}:{type:"leaf",data:c.data,size:c.size}}function Vs(c,e){if("branch"===c.type){const t=c.data.map(i=>Vs(i,kt(e)));return 0===e?{width:c.size||(0===t.length?void 0:Math.max(...t.map(n=>n.width||0))),height:0===t.length?void 0:t.reduce((n,r)=>n+(r.height||0),0)}:{width:0===t.length?void 0:t.reduce((n,r)=>n+(r.width||0),0),height:c.size||(0===t.length?void 0:Math.max(...t.map(n=>n.height||0)))}}return{width:0===e?c.size:void 0,height:0===e?void 0:c.size}}function Ms(c){_s(c,!0);const e=Ts(c),{width:t,height:i}=Vs(e,c.orientation);return{root:e,orientation:c.orientation,width:t||1,height:i||1}}var Dt=m(38155);(0,ve.Z)('.monaco-workbench .part.editor>.content .editor-group-container{height:100%}.monaco-workbench .part.editor>.content .editor-group-container.empty{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container.empty.active,.monaco-workbench .part.editor>.content .editor-group-container.empty.dragged-over{opacity:1}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty.active:focus{outline:1px solid var(--vscode-editorGroup-focusedEmptyBorder);outline-offset:-2px}.monaco-workbench .part.editor>.content.empty .editor-group-container.empty.active:focus{outline:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;margin:auto;max-width:290px}.monaco-workbench .part.editor>.content .editor-group-container:not(.empty)>.editor-group-watermark{display:none}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-watermark{height:calc(100% - 70px);max-width:200px}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.letterpress{aspect-ratio:1/1;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4xIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=");background-position-x:center;background-repeat:no-repeat;background-size:contain;max-height:100%;width:100%}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4zIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=")}.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiNkOWQ5ZDkiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiMzQzNDM0MiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench .part.editor>.content .editor-group-container.max-height-478px>.editor-group-watermark>.shortcuts,.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container>.editor-group-watermark>.shortcuts{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts>.watermark-box{border-collapse:separate;border-spacing:11px 17px;display:inline-table}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl{cursor:default;display:table-row;opacity:.8}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{letter-spacing:.04em;text-align:right}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd{text-align:left}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{display:table-cell;vertical-align:middle}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{color:rgba(0,0,0,.68)}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:hsla(0,0%,100%,.6)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:var(--vscode-editor-foreground)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl{color:var(--vscode-editor-foreground);opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title{box-sizing:border-box;overflow:hidden;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title:not(.tabs){display:flex;flex-wrap:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title.title-border-bottom:after{background-color:var(--title-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container.empty>.title{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar{display:none;height:35px}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-container-toolbar{display:block}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .actions-container{justify-content:flex-end}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.empty>.editor-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-container>.editor-instance{height:100%}.monaco-workbench .part.editor>.content .grid-view-container{height:100%;width:100%}',{});var Ii=m(8288),x=m(48982),It=m(50348);(0,ve.Z)('.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container{display:flex;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.tabs-border-bottom:after{background-color:var(--tabs-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element{flex:1}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element .scrollbar{cursor:default;z-index:11}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container{display:flex;height:35px;scrollbar-width:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.scroll{overflow:scroll!important}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container{flex-wrap:wrap;height:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container::-webkit-scrollbar{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab{box-sizing:border-box;cursor:pointer;display:flex;height:35px;padding-left:10px;position:relative;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab:last-child{margin-right:var(--last-tab-margin-right)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.last-in-row:not(:last-child){border-right:0!important}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-right,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-right{padding-left:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit{flex-shrink:0;min-width:fit-content;width:120px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed{flex:1 0 0;max-width:var(--tab-sizing-current-width,var(--tab-sizing-fixed-max-width,160px));min-width:var(--tab-sizing-current-width,50px)}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.last-in-row{min-width:calc(var(--tab-sizing-current-width, 50px) - 1px)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.sizing-fit.last-in-row:not(:last-child){flex-grow:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink{flex-basis:0;flex-grow:1;max-width:fit-content;min-width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{flex-basis:0;flex-grow:0;position:sticky;z-index:8}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact{max-width:38px;min-width:38px;width:38px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{max-width:80px;min-width:80px;width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-shrink{position:static}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:after{content:"";display:flex;flex:0;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left{min-width:80px;padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged{transform:translateZ(0)}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged-over div{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-left{flex-direction:row-reverse;padding-left:0;padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-top-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{display:block;left:0;pointer-events:none;position:absolute;width:100%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container{background-color:var(--tab-border-top-color);height:1px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container{background-color:var(--tab-border-bottom-color);bottom:0;height:1px;z-index:10}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{background-color:var(--tab-dirty-border-top-color);height:2px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label{line-height:35px;margin-bottom:auto;margin-top:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink .tab-label{position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label>.monaco-icon-label-container:after{bottom:1px;content:"";height:calc(100% - 2px);opacity:1;padding:0;position:absolute;right:0;top:1px;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed:focus>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink:focus>.tab-label>.monaco-icon-label-container:after{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label.tab-label-has-badge:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label.tab-label-has-badge:after{padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky-compact:not(.has-icon) .monaco-icon-label{text-align:center}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label>.monaco-icon-label-container{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{flex:none;text-overflow:clip}.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions{margin-bottom:auto;margin-top:auto;width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions>.monaco-action-bar{width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions{flex:0;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions:focus-within,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions:focus-within{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky-compact>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off:not(.dirty):not(.sticky)>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label:focus{opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .actions-container{justify-content:center}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label.codicon{color:inherit;font-size:16px;height:16px;padding:2px;width:16px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ebb2"}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ea71"}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab:hover>.tab-actions .action-label{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .action-label{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off{padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:not(.sticky-compact){padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty-border-top>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty:not(.dirty-border-top):not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky:not(.sticky-compact){padding-right:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off>.tab-actions{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control{cursor:default;flex:1 100%;height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label{height:22px;line-height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .outline-element-icon{height:22px;line-height:22px;padding-right:3px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{max-width:80%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{align-items:center;display:flex;height:22px;justify-content:center;width:16px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions{cursor:default;flex:initial;height:35px;padding:0 8px 0 4px}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .editor-actions{bottom:0;position:absolute;right:0}',{});var ld=m(73533),Xt=m(32304);(0,ve.Z)(".monaco-workbench .part.editor>.content .editor-group-container>.title{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label{flex:1;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a{font-size:13px}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label span,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label h2{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before{height:35px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .monaco-icon-label:after,.monaco-workbench .part.editor>.content .editor-group-container>.title.tabs .monaco-icon-label:after{margin-right:0}.monaco-editor-group-drag-image{border-radius:10px;display:inline-block;font-size:12px;padding:1px 7px;position:absolute}",{});var gi=m(30106),Ps=m(18323),ye=m(21441),Ls=m(53683),ud=m(68589),pd=m.n(ud),gd=m(29712),fd=m.n(gd),md=m(95716),vd=m.n(md),bd=m(43434),wd=m.n(bd),yd=m(7229),Cd=m.n(yd),Sd=m(8016),Ed=m.n(Sd),Po=m(90075),Ai={};Ai.styleTagTransform=Ed(),Ai.setAttributes=wd(),Ai.insert=vd().bind(null,"head"),Ai.domAPI=fd(),Ai.insertStyleElement=Cd(),pd()(Po.Z,Ai);class Rn{dispose(){}}class xd{constructor(e,t,i,o){this._disposables=new C.SL,this._onDidSelectItem=new S.Q5,this._onDidFocusItem=new S.Q5,this._onDidChangeFocus=new S.Q5,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=new Array,this._nodes=new Array,this._freeNodes=new Array,this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Ls.s$(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(g.mu(this._domNode,"click",s=>this._onClick(s))),e.appendChild(this._scrollable.getDomNode());const n=g.dS(this._domNode);this._style(n,o);const r=g.go(this._domNode);this._disposables.add(r),this._disposables.add(r.onDidBlur(s=>this._onDidChangeFocus.fire(!1))),this._disposables.add(r.onDidFocus(s=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}dispose(){var e;this._disposables.dispose(),null===(e=this._pendingLayout)||void 0===e||e.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){var t;e&&g.Ro.equals(e,this._dimension)||(null===(t=this._pendingLayout)||void 0===t||t.dispose(),this._pendingLayout=e?this._updateDimensions(e):this._updateScrollbar())}_updateDimensions(e){const t=new C.SL;return t.add(g.Pj(()=>{this._dimension=e,this._domNode.style.width=`${e.width}px`,this._domNode.style.height=`${e.height}px`,t.add(this._updateScrollbar())})),t}_updateScrollbar(){return g.L8(()=>{g.L8(()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${t.breadcrumbsBackground}}`),t.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${t.breadcrumbsForeground}}\n`),t.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${t.breadcrumbsFocusForeground}}\n`),t.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${t.breadcrumbsFocusAndSelectionForeground}}\n`),t.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled\t) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${t.breadcrumbsHoverForeground}}\n`),e.innerText=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){const e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){let e=document.activeElement;for(;e;){if(this._domNode===e)return!0;e=e.parentElement}return!1}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("focused"):(this._focusedItemIdx=i,o.classList.add("focused"),o.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){const t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;const i=this._nodes[e];if(!i)return;const{width:o}=this._scrollable.getScrollDimensions(),{scrollLeft:n}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>n+o||i.offsetLeft<n)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("selected"):(this._selectedItemIdx=i,o.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=(0,L.Mh)(this._items,e,(o,n)=>o.equals(n)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),(0,C.B9)(i),this._focus(-1,void 0)}catch(o){const n=new Error(`BreadcrumbsItem#setItems: newItems: ${e.length}, prefix: ${t}, removed: ${i.length}`);throw n.name=o.name,n.stack=o.stack,n}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++)this._renderItem(this._items[e],this._nodes[e]),t=!0;for(;e<this._nodes.length;){const i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),t=!0)}for(;e<this._items.length;e++){const i=this._items[e],o=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");o&&(this._renderItem(i,o),this._domNode.appendChild(o),this._nodes.push(o),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){g.PO(t),t.className="";try{e.render(t)}catch(o){t.innerText="<<RENDER ERROR>>",console.error(o)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");const i=g.$(be.kS.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){const i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}}(0,ve.Z)(".monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control.hidden{display:none}.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .monaco-icon-label{text-decoration-line:underline}.monaco-workbench .monaco-breadcrumb-item.shows-symbol-icon .codicon[class*=codicon-symbol-]{padding-right:6px}.monaco-workbench .monaco-breadcrumbs-picker .arrow{border-style:solid;position:absolute;width:0}.monaco-workbench .monaco-breadcrumbs-picker .picker-item{flex:1;line-height:22px}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree{display:flex;flex-direction:column;height:100%;overflow:hidden}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.input{box-sizing:border-box;height:36px;padding:5px 9px;position:relative}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.tree{height:calc(100% - 36px)}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.input{display:none}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.tree{height:100%}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree .monaco-highlighted-label .highlight{font-weight:700}",{});var D=m(45414),Me=m(29175),Dd=m(59626);class Lo{constructor(e,t){this.uri=e,this.kind=t}}class Nn{constructor(e,t){this.element=e,this.outline=t}}let On=class{constructor(e,t,i,o,n){this.resource=e,this._workspaceService=o,this._outlineService=n,this._disposables=new C.SL,this._currentOutline=new C.XK,this._outlineDisposables=new C.SL,this._onDidUpdate=new S.Q5,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=ye.Ny.FilePath.bindTo(i),this._cfgSymbolPath=ye.Ny.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(r=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(r=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(n.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if("on"===this._cfgFilePath.getValue()?e=e.concat(this._fileInfo.path):"last"===this._cfgFilePath.getValue()&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),"off"===this._cfgSymbolPath.getValue()||!this._currentOutline.value)return e;const t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i="last"===this._cfgSymbolPath.getValue()&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new Nn(t[i],this._currentOutline.value));return 0===t.length&&!this._currentOutline.value.isEmpty&&e.push(new Nn(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){if((0,Zt.Gs)(e,Me.lg.untitled,Me.lg.data))return{folder:void 0,path:[]};const t={folder:(0,A.f6)(this._workspaceService.getWorkspaceFolder(e)),path:[]};let i=e;for(;i&&"/"!==i.path&&(!t.folder||!(0,J.Xy)(t.folder.uri,i));){t.path.unshift(new Lo(i,0===t.path.length?z.RR.FILE:z.RR.FOLDER));const o=i.path.length;if(i=(0,J.XX)(i),i.path.length===o)break}return t.folder&&3===this._workspaceService.getWorkbenchState()&&t.path.unshift(new Lo(t.folder.uri,z.RR.ROOT_FOLDER)),t}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){const t=new xe.A;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add((0,C.OF)(()=>t.dispose(!0))),this._outlineService.createOutline(e,2,t.token).then(i=>{t.token.isCancellationRequested&&(i?.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),(0,Xe.dL)(i)})}};On=(0,h.gn)([(0,h.fM)(2,G.Ui),(0,h.fM)(3,ce.ec),(0,h.fM)(4,Dd.h)],On);var Id=m(41058),Ui=m(53083),Rs=m(30030),Ro=m(48601),Ad=m(40411);let No=class{constructor(e,t,i,o,n){this.resource=t,this._instantiationService=i,this._themeService=o,this._configurationService=n,this._disposables=new C.SL,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new S.Q5,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new C.XK,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}show(e,t,i,o,n){var r=this;return(0,w.Z)(function*(){const a=r._themeService.getColorTheme().getColor(Y.SbC);r._arrow=document.createElement("div"),r._arrow.className="arrow",r._arrow.style.borderColor=`transparent transparent ${a?a.toString():""}`,r._domNode.appendChild(r._arrow),r._treeContainer=document.createElement("div"),r._treeContainer.style.background=a?a.toString():"",r._treeContainer.style.paddingTop="2px",r._treeContainer.style.borderRadius="3px",r._treeContainer.style.boxShadow=`0 0 8px 2px ${r._themeService.getColorTheme().getColor(Y.rh)}`,r._treeContainer.style.border=`1px solid ${r._themeService.getColorTheme().getColor(Y.A42)}`,r._domNode.appendChild(r._treeContainer),r._layoutInfo={maxHeight:t,width:i,arrowSize:o,arrowOffset:n,inputHeight:0},r._tree=r._createTree(r._treeContainer,e),r._disposables.add(r._tree.onDidOpen(function(){var d=(0,w.Z)(function*(l){const{element:u,editorOptions:f,sideBySide:b}=l;yield r._revealElement(u,{...f,preserveFocus:!1},b)});return function(l){return d.apply(this,arguments)}}())),r._disposables.add(r._tree.onDidChangeFocus(d=>{r._previewDispoables.value=r._previewElement(d.elements[0])})),r._disposables.add(r._tree.onDidChangeContentHeight(()=>{r._layout()})),r._domNode.focus();try{yield r._setInput(e),r._layout()}catch(d){(0,Xe.dL)(d)}})()}_layout(){const e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight);this._domNode.style.height=`${t+e}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${t}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};No=(0,h.gn)([(0,h.fM)(2,R.TG),(0,h.fM)(3,K.XE),(0,h.fM)(4,G.Ui)],No);class _d{getHeight(e){return 22}getTemplateId(e){return"FileStat"}}class Td{getId(e){return W.ov.isUri(e)?e.toString():(0,ce.MF)(e)?e.id:(0,ce.dV)(e)?e.uri.toString():e.resource.toString()}}let Hn=class{constructor(e){this._fileService=e}hasChildren(e){return W.ov.isUri(e)||(0,ce.MF)(e)||(0,ce.dV)(e)||e.isDirectory}getChildren(e){var t=this;return(0,w.Z)(function*(){if((0,ce.MF)(e))return e.folders;let i;return i=(0,ce.dV)(e)?e.uri:W.ov.isUri(e)?e:e.resource,(yield t._fileService.resolve(i)).children??[]})()}};Hn=(0,h.gn)([(0,h.fM)(0,z.sn)],Hn);let Bn=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){const o=this._configService.getValue("explorer.decorations"),{element:n}=e;let r,s;(0,ce.dV)(n)?(r=n.uri,s=z.RR.ROOT_FOLDER):(r=n.resource,s=n.isDirectory?z.RR.FOLDER:z.RR.FILE),i.setFile(r,{fileKind:s,hidePath:!0,fileDecorations:o,matches:(0,Ui.mB)(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};Bn=(0,h.gn)([(0,h.fM)(1,G.Ui)],Bn);class Vd{getKeyboardNavigationLabel(e){return e.name}}class Md{getWidgetAriaLabel(){return(0,p.NC)("breadcrumbs","Breadcrumbs")}getAriaLabel(e){return e.name}}let Fn=class{constructor(e,t){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new C.SL;const i=ye.Ny.FileExcludes.bindTo(t),o=()=>{e.getWorkspace().folders.forEach(n=>{const r=i.getValue({resource:n.uri});if(!r)return;const s={};for(const a in r)"boolean"==typeof r[a]&&(s[0!==a.indexOf("**/")?Ro.KR.join(n.uri.path,a):a]=r[a]);this._cachedExpressions.set(n.uri.toString(),Rs.Qc(s))})};o(),this._disposables.add(i),this._disposables.add(i.onDidChange(o)),this._disposables.add(e.onDidChangeWorkspaceFolders(o))}dispose(){this._disposables.dispose()}filter(e,t){if((0,ce.dV)(e))return!0;const i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())||!this._cachedExpressions.get(i.uri.toString())((0,Ro.Gf)(i.uri.path,e.resource.path),(0,J.EZ)(e.resource))}};Fn=(0,h.gn)([(0,h.fM)(0,ce.ec),(0,h.fM)(1,G.Ui)],Fn);class Pd{compare(e,t){return(0,ce.dV)(e)&&(0,ce.dV)(t)?e.index-t.index:e.isDirectory===t.isDirectory?(0,Id.Jq)(e.name,t.name):e.isDirectory?-1:1}}let Wn=class extends No{constructor(e,t,i,o,n,r,s){super(e,t,i,o,n),this._workspaceService=r,this._editorService=s}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");const t=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",!0===o.hidesExplorerArrows)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());const i=this._instantiationService.createInstance(Xt.RX,Xt.hh);return this._disposables.add(i),this._instantiationService.createInstance(D.ls,"BreadcrumbsFilePicker",e,new _d,[this._instantiationService.createInstance(Bn,i)],this._instantiationService.createInstance(Hn),{multipleSelectionSupport:!1,sorter:new Pd,filter:this._instantiationService.createInstance(Fn),identityProvider:new Td,keyboardNavigationLabelProvider:new Vd,accessibilityProvider:this._instantiationService.createInstance(Md),showNotFoundMessage:!1,overrideStyles:{listBackground:Y.SbC}})}_setInput(e){var t=this;return(0,w.Z)(function*(){const{uri:i,kind:o}=e;let n;n=o===z.RR.ROOT_FOLDER?t._workspaceService.getWorkspace():(0,J.XX)(i);const r=t._tree;let s;yield r.setInput(n);for(const{element:a}of r.getNode().children){if((0,ce.dV)(a)&&(0,J.Xy)(a.uri,i)){s=a;break}if((0,J.Xy)(a.resource,i)){s=a;break}}s&&(r.reveal(s,.5),r.setFocus([s],t._fakeEvent)),r.domFocus()})()}_previewElement(e){return C.JT.None}_revealElement(e,t,i){var o=this;return(0,w.Z)(function*(){return!((0,ce.dV)(e)||!e.isFile||(o._onWillPickElement.fire(),yield o._editorService.openEditor({resource:e.resource,options:t},i?U.O3:void 0),0))})()}};Wn=(0,h.gn)([(0,h.fM)(2,R.TG),(0,h.fM)(3,K.XE),(0,h.fM)(4,G.Ui),(0,h.fM)(5,ce.ec),(0,h.fM)(6,U.AR)],Wn);let Gn=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return"name"===this._order?this.comparator.compareByName(e,t):"type"===this._order?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};Gn=(0,h.gn)([(0,h.fM)(2,Ad.V)],Gn);class Ld extends No{_createTree(e,t){const{config:i}=t.outline;return this._instantiationService.createInstance(D.C7,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(Gn,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(e){const t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};const i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}_revealElement(e,t,i){var o=this;return(0,w.Z)(function*(){return o._onWillPickElement.fire(),yield o._tree.getInput().reveal(e,t,i),!0})()}}var te=m(59796);class Oo extends Rn{constructor(e,t,i){super(),this.model=e,this.element=t,this.options=i,this._disposables=new C.SL}dispose(){this._disposables.dispose()}equals(e){return e instanceof Oo&&this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons}render(e){const{element:t,outline:i}=this.element;if(t===i){const s=g.$("span",void 0,"\u2026");return void e.appendChild(s)}const o=i.config.delegate.getTemplateId(t),n=i.config.renderers.find(s=>s.templateId===o);if(!n)return void(e.innerText="<<NO RENDERER>>");const r=n.renderTemplate(e);n.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,r,void 0),this._disposables.add((0,C.OF)(()=>{n.disposeTemplate(r)}))}}class Ho extends Rn{constructor(e,t,i,o){super(),this.model=e,this.element=t,this.options=i,this._labels=o,this._disposables=new C.SL}dispose(){this._disposables.dispose()}equals(e){return e instanceof Ho&&J.SF.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons}render(e){const t=this._labels.create(e);t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===z.RR.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(z.RR[this.element.kind].toLowerCase()),this._disposables.add(t)}}const Rd=(0,he.q5)("breadcrumb-separator",$.lA.chevronRight,(0,p.NC)("separatorIcon","Icon for the separator in the breadcrumbs."));let j=class Bt{constructor(e,t,i,o,n,r,s,a,d,l,u,f){this._options=t,this._editorGroup=i,this._contextKeyService=o,this._contextViewService=n,this._instantiationService=r,this._quickInputService=s,this._fileService=a,this._editorService=d,this._labelService=l,this._disposables=new C.SL,this._breadcrumbsDisposables=new C.SL,this._model=new C.XK,this._breadcrumbsPickerShowing=!1,this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),g.R3(e,this.domNode),this._cfUseQuickPick=ye.Ny.UseQuickPick.bindTo(u),this._cfShowIcons=ye.Ny.Icons.bindTo(u),this._cfTitleScrollbarSizing=ye.Ny.TitleScrollbarSizing.bindTo(u),this._labels=this._instantiationService.createInstance(Xt.RX,Xt.hh);const b=this._cfTitleScrollbarSizing.getValue()??"default";this._widget=new xd(this.domNode,Bt.SCROLLBAR_SIZES[b],Rd,t.widgetStyles??zt.Db),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Bt.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Bt.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Bt.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._disposables.add(f.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0)}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();const e=x.zK.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:x.YX.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),!t&&(this.hide(),!0);const i=x.zK.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:x.YX.PRIMARY});this.domNode.classList.toggle("hidden",!1),this._ckBreadcrumbsVisible.set(!0),this._ckBreadcrumbsPossible.set(!0);const o=this._instantiationService.createInstance(On,i??e,this._editorGroup.activeEditorPane);this._model.value=o,this.domNode.classList.toggle("backslash-path","\\"===this._labelService.getSeparator(e.scheme,e.authority));const n=()=>{this.domNode.classList.toggle("relative-path",o.isRelative());const l=this._cfShowIcons.getValue(),u={...this._options,showFileIcons:this._options.showFileIcons&&l,showSymbolIcons:this._options.showSymbolIcons&&l},f=o.getElements().map(b=>b instanceof Lo?new Ho(o,b,u,this._labels):new Oo(o,b,u));0===f.length?(this._widget.setEnabled(!1),this._widget.setItems([new class extends Rn{render(b){b.innerText=(0,p.NC)("empty","no elements")}equals(b){return b===this}}])):(this._widget.setEnabled(!0),this._widget.setItems(f),this._widget.reveal(f[f.length-1]))},r=o.onDidUpdate(n),s=this._cfShowIcons.onDidChange(n);n(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add((0,C.OF)(()=>this._model.clear())),this._breadcrumbsDisposables.add(s),this._breadcrumbsDisposables.add((0,C.OF)(()=>this._widget.setItems([])));const a=()=>{const l=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(Bt.SCROLLBAR_SIZES[l])};a();const d=this._cfTitleScrollbarSizing.onDidChange(a);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem)return this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),void this._widget.setSelection(void 0);const{element:t}=e.item;this._editorGroup.focus();const i=this._getEditorGroup(e.payload);if(void 0!==i)return this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._revealInEditor(e,t,i);if(this._cfUseQuickPick.getValue())return this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._quickInputService.quickAccess.show(t instanceof Nn?"@":"");let o,n;this._contextViewService.showContextView({render:r=>{e.item instanceof Ho?o=this._instantiationService.createInstance(Wn,r,e.item.model.resource):e.item instanceof Oo&&(o=this._instantiationService.createInstance(Ld,r,e.item.model.resource));const s=o.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),a=Bi.PixelRatio.onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=g.go(r),l=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),(0,C.F8)(o,s,a,d,l)},getAnchor:()=>{if(!n){const r=window.innerWidth-8;let s=Math.min(.7*window.innerHeight,300);const a=Math.min(r,Math.max(240,r/4.17)),d=8;let l;const u=g.i(e.node.firstChild),f=u.top+u.height+d;f+s>=window.innerHeight&&(s=window.innerHeight-f-30);let b=u.left;if(b+a>=r&&(b=r-a),e.payload instanceof ct.nV){const E=a-2*d;l=e.payload.posx-b,l>E&&(b=Math.min(r-a,b+l-E),l=E)}else l=u.left+.3*u.width-b;o.show(t,s,a,d,Math.max(0,l)),n={x:b,y:f}}return n},onHide:r=>{r?.didPick||o.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),r?.source===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),o.dispose()}})}_updateCkBreadcrumbsActive(){const e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}_revealInEditor(e,t,i,o=!1){var n=this;return(0,w.Z)(function*(){if(t instanceof Lo)if(t.kind===z.RR.FILE)yield n._editorService.openEditor({resource:t.uri,options:{pinned:o}},i);else{const r=n._widget.getItems(),s=r.indexOf(e.item);n._widget.setFocused(r[s+1]),n._widget.setSelection(r[s+1],Bt.Payload_Pick)}else t.outline.reveal(t,{pinned:o},i===U.O3)})()}_getEditorGroup(e){return e===Bt.Payload_RevealAside?U.O3:e===Bt.Payload_Reveal?U.LP:void 0}};function zn(c,e){const t=c.get(te.Qw),o=c.get(ye._4).getWidget(t.activeGroup.id);if(o){const n=(0,L.eJ)(o.getItems());o.setFocused(n),e&&o.setSelection(n,j.Payload_Pick)}}j.HEIGHT=22,j.SCROLLBAR_SIZES={default:3,large:8},j.Payload_Reveal={},j.Payload_RevealAside={},j.Payload_Pick={},j.CK_BreadcrumbsPossible=new y.uy("breadcrumbsPossible",!1,(0,p.NC)("breadcrumbsPossible","Whether the editor can show breadcrumbs")),j.CK_BreadcrumbsVisible=new y.uy("breadcrumbsVisible",!1,(0,p.NC)("breadcrumbsVisible","Whether breadcrumbs are currently visible")),j.CK_BreadcrumbsActive=new y.uy("breadcrumbsActive",!1,(0,p.NC)("breadcrumbsActive","Whether breadcrumbs have focus")),j=(0,h.gn)([(0,h.fM)(3,y.i6),(0,h.fM)(4,ge.u),(0,h.fM)(5,R.TG),(0,h.fM)(6,St.eJ),(0,h.fM)(7,z.sn),(0,h.fM)(8,U.AR),(0,h.fM)(9,Ut.e),(0,h.fM)(10,G.Ui),(0,h.fM)(11,ye._4)],j),(0,v.r1)(class extends v.Ke{constructor(){super({id:"breadcrumbs.toggle",title:{value:(0,p.NC)("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:(0,p.NC)({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs"),original:"Toggle Breadcrumbs"},category:Ee.R.View,toggled:{condition:y.Ao.equals("config.breadcrumbs.enabled",!0),title:(0,p.NC)("cmd.toggle2","Breadcrumbs"),mnemonicTitle:(0,p.NC)({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"&&Breadcrumbs")},menu:[{id:v.eH.CommandPalette},{id:v.eH.MenubarAppearanceMenu,group:"4_editor",order:2},{id:v.eH.NotebookToolbar,group:"notebookLayout",order:2},{id:v.eH.StickyScrollContext}]})}run(e){const t=e.get(G.Ui),i=ye.Ny.IsEnabled.bindTo(t).getValue();ye.Ny.IsEnabled.bindTo(t).updateValue(!i)}}),(0,v.r1)(class extends v.Ke{constructor(){super({id:"breadcrumbs.focusAndSelect",title:{value:(0,p.NC)("cmd.focusAndSelect","Focus and Select Breadcrumbs"),original:"Focus and Select Breadcrumbs"},precondition:j.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:j.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){zn(e,!0)}}),(0,v.r1)(class extends v.Ke{constructor(){super({id:"breadcrumbs.focus",title:{value:(0,p.NC)("cmd.focus","Focus Breadcrumbs"),original:"Focus Breadcrumbs"},precondition:j.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:j.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){zn(e,!1)}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:y.Ao.not("config.breadcrumbs.enabled"),handler:function(){var c=(0,w.Z)(function*(e){const t=e.get(R.TG),i=e.get(G.Ui),o=ye.Ny.IsEnabled.bindTo(i);return o.getValue()||(yield o.updateValue(!0),yield(0,Ve.Vs)(50)),t.invokeFunction(zn,!0)});return function(t){return c.apply(this,arguments)}}()}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.focusNext()}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.focusPrev()}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:201,primary:2065,mac:{primary:529},when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive,D.CQ),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.focusNext()}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:201,primary:2063,mac:{primary:527},when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive,D.CQ),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.focusPrev()}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),j.Payload_Pick)}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),j.Payload_Reveal)}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:201,primary:9,when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive),handler(c){const e=c.get(te.Qw),i=c.get(ye._4).getWidget(e.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),e.activeGroup.activeEditorPane?.focus())}}),T.W.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:y.Ao.and(j.CK_BreadcrumbsVisible,j.CK_BreadcrumbsActive,D.CQ),handler(c){const e=c.get(U.AR),i=c.get(D.Lw).lastFocusedList;if(!(i instanceof D.C7||i instanceof D.ls))return;const o=i.getFocus()[0];if(W.ov.isUri(o?.resource))return e.openEditor({resource:o.resource,options:{pinned:!0}},U.O3);const n=i.getInput();return n&&"string"==typeof n.outlineKind?n.reveal(o,{pinned:!0,preserveFocus:!1},!0):void 0}});var Ke=m(69476);class Ns extends P.Wi{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return t?.preserveFocus&&(i={...this.context,preserveFocus:!0}),super.run(e,i)}}let Bo=class extends K.bB{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b){super(u),this.accessor=t,this.group=i,this.contextMenuService=o,this.instantiationService=n,this.contextKeyService=r,this.keybindingService=s,this.notificationService=a,this.menuService=d,this.quickInputService=l,this.configurationService=f,this.fileService=b,this.editorTransfer=Ke.Ej.getInstance(),this.groupTransfer=Ke.Ej.getInstance(),this.treeItemsTransfer=Ke.Ej.getInstance(),this.breadcrumbsControl=void 0,this.editorToolBarMenuDisposables=this._register(new C.SL),this.resourceContext=this._register(n.createInstance(N.f1)),this.editorPinnedContext=N.gI.bindTo(r),this.editorIsFirstContext=N.lr.bindTo(r),this.editorIsLastContext=N._B.bindTo(r),this.editorStickyContext=N.Vq.bindTo(r),this.editorCanSplitInGroupContext=N.gP.bindTo(r),this.sideBySideEditorContext=N.x3.bindTo(r),this.groupLockedContext=N.sp.bindTo(r),this.renderDropdownAsChildElement=!1,this.create(e)}createBreadcrumbsControl(e,t){const i=this._register(ye.Ny.IsEnabled.bindTo(this.configurationService));this._register(i.onDidChange(()=>{const o=i.getValue();!o&&this.breadcrumbsControl?(this.breadcrumbsControl.dispose(),this.breadcrumbsControl=void 0,this.handleBreadcrumbsEnablementChange()):o&&!this.breadcrumbsControl&&(this.breadcrumbsControl=this.instantiationService.createInstance(j,e,t,this.group),this.breadcrumbsControl.update(),this.handleBreadcrumbsEnablementChange())})),i.getValue()&&(this.breadcrumbsControl=this.instantiationService.createInstance(j,e,t,this.group)),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(o=>{this.breadcrumbsControl?.model&&this.breadcrumbsControl.model.resource.scheme!==o.scheme||this.breadcrumbsControl?.update()&&this.handleBreadcrumbsEnablementChange()}))}createEditorActionsToolBar(e){const t={groupId:this.group.id};this.editorActionsToolbar=this._register(this.instantiationService.createInstance(Qr.T,e,{actionViewItemProvider:i=>this.actionViewItemProvider(i),orientation:0,ariaLabel:(0,p.NC)("ariaLabelEditorActions","Editor actions"),getKeyBinding:i=>this.getKeybinding(i),actionRunner:this._register(new Ns(t)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:v.eH.EditorTitle,maxNumberOfItems:9})),this.editorActionsToolbar.context=t,this._register(this.editorActionsToolbar.actionRunner.onDidRun(i=>{i.error&&!(0,Xe.n2)(i.error)&&this.notificationService.error(i.error)}))}actionViewItemProvider(e){const t=this.group.activeEditorPane;if(t instanceof Ps.J){const i=t.getActionViewItem(e);if(i)return i}return(0,Be.Id)(this.instantiationService,e,{menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){const{primary:e,secondary:t}=this.prepareEditorActions(this.getEditorActions());(0,A.cW)(this.editorActionsToolbar).setActions((0,qe.c)(e),(0,qe.c)(t))}getEditorActions(){const e=[],t=[];if(this.editorToolBarMenuDisposables.clear(),this.contextKeyService.bufferChangeEvents(()=>{const o=this.group.activeEditor;this.resourceContext.set((0,A.M2)(x.zK.getOriginalUri(o,{supportSideBySide:x.YX.PRIMARY}))),this.editorPinnedContext.set(!!o&&this.group.isPinned(o)),this.editorIsFirstContext.set(!!o&&this.group.isFirst(o)),this.editorIsLastContext.set(!!o&&this.group.isLast(o)),this.editorStickyContext.set(!!o&&this.group.isSticky(o)),this.editorCanSplitInGroupContext.set(!!o&&o.hasCapability(32)),this.sideBySideEditorContext.set(o?.typeId===It.h.ID),this.groupLockedContext.set(this.group.isLocked)}),this.group.activeEditorPane instanceof Ps.J){const o=this.getEditorPaneAwareContextKeyService(),n=this.menuService.createMenu(v.eH.EditorTitle,o,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0});this.editorToolBarMenuDisposables.add(n),this.editorToolBarMenuDisposables.add(n.onDidChange(()=>{this.updateEditorActionsToolbar()}));const r=(s,a)=>"navigation"===a&&s.actions.length<=1;(0,Be.vr)(n,{arg:this.resourceContext.get(),shouldForwardArgs:!0},{primary:e,secondary:t},"navigation",r)}return{primary:e,secondary:t}}getEditorPaneAwareContextKeyService(){return this.group.activeEditorPane?.scopedContextKeyService??this.contextKeyService}clearEditorActionsToolbar(){this.editorActionsToolbar?.setActions([],[])}enableGroupDragging(e){this._register((0,g.nm)(e,g.tw.DRAG_START,t=>{if(t.target!==e)return;this.groupTransfer.setData([new B.r8(this.group.id)],B.r8.prototype),t.dataTransfer&&(t.dataTransfer.effectAllowed="copyMove");let i=!1;if(this.accessor.partOptions.showTabs?i=this.doFillResourceDataTransfers(this.group.getEditors(1),t):this.group.activeEditor&&(i=this.doFillResourceDataTransfers([this.group.activeEditor],t)),!i&&Bi.isFirefox&&t.dataTransfer?.setData(gi.go.TEXT,String(this.group.label)),this.group.activeEditor){let o=this.group.activeEditor.getName();this.accessor.partOptions.showTabs&&this.group.count>1&&(o=(0,p.NC)("draggedEditorGroup","{0} (+{1})",o,this.group.count-1)),(0,gi.br)(t,o,"monaco-editor-group-drag-image",this.getColor(Y.dCr),this.getColor(Y.M6C))}})),this._register((0,g.nm)(e,g.tw.DRAG_END,()=>{this.groupTransfer.clearData(B.r8.prototype)}))}doFillResourceDataTransfers(e,t){return!!e.length&&(this.instantiationService.invokeFunction(B.Gj,e.map(i=>({editor:i,groupId:this.group.id})),t),!0)}onContextMenu(e,t,i){const o=this.resourceContext.get();this.resourceContext.set((0,A.M2)(x.zK.getOriginalUri(e,{supportSideBySide:x.YX.PRIMARY})));const n=!!this.editorPinnedContext.get();this.editorPinnedContext.set(this.group.isPinned(e));const r=!!this.editorIsFirstContext.get();this.editorIsFirstContext.set(this.group.isFirst(e));const s=!!this.editorIsLastContext.get();this.editorIsLastContext.set(this.group.isLast(e));const a=!!this.editorStickyContext.get();this.editorStickyContext.set(this.group.isSticky(e));const d=!!this.groupLockedContext.get();this.groupLockedContext.set(this.group.isLocked);const l=!!this.editorCanSplitInGroupContext.get();this.editorCanSplitInGroupContext.set(e.hasCapability(32));const u=!!this.sideBySideEditorContext.get();this.sideBySideEditorContext.set(e.typeId===It.h.ID);let f=i;if(t instanceof MouseEvent){const b=new ct.nV(t);f={x:b.posx,y:b.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>f,menuId:v.eH.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextKeyService,getActionsContext:()=>({groupId:this.group.id,editorIndex:this.group.getIndexOfEditor(e)}),getKeyBinding:b=>this.getKeybinding(b),onHide:()=>{this.resourceContext.set(o||null),this.editorPinnedContext.set(n),this.editorIsFirstContext.set(r),this.editorIsLastContext.set(s),this.editorStickyContext.set(a),this.groupLockedContext.set(d),this.editorCanSplitInGroupContext.set(l),this.sideBySideEditorContext.set(u),this.accessor.activeGroup.focus()}})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){const t=this.getKeybinding(e);return t?(0,A.f6)(t.getLabel()):void 0}dispose(){(0,C.B9)(this.breadcrumbsControl),this.breadcrumbsControl=void 0,super.dispose()}};Bo=(0,h.gn)([(0,h.fM)(3,ge.i),(0,h.fM)(4,R.TG),(0,h.fM)(5,y.i6),(0,h.fM)(6,Se.d),(0,h.fM)(7,oe.lT),(0,h.fM)(8,v.co),(0,h.fM)(9,St.eJ),(0,h.fM)(10,K.XE),(0,h.fM)(11,G.Ui),(0,h.fM)(12,z.sn)],Bo);var _i=m(62844),Os=m(31096),Ki=m(81225),Fo=m(94927),Qe=m(24041),ut=m(88023),Un=m(38610),At=m(60108);let Rt=class je extends Bo{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X){var ee;super(e,t,i,o,n,r,s,a,d,l,u,f,b),ee=this,this.editorService=E,this.pathService=k,this.editorGroupService=M,this.treeViewsDragAndDropService=X,this.closeEditorAction=this._register(this.instantiationService.createInstance(_i.jH,_i.jH.ID,_i.jH.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance(_i.xJ,_i.xJ.ID,_i.xJ.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(Xt.RX,Xt.hh)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:g.Ro.None,available:g.Ro.None},this.layoutScheduler=this._register(new C.XK),this.path=F.ED?Ro.Ku:Ro.KR,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new Ve.pY(()=>this.doUpdateEditorLabels(),0)),(0,w.Z)(function*(){return ee.path=yield ee.pathService.path})(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){this.titleContainer=e,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(ae.o.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new C.SL),this.updateTabSizing(!1),this.tabsScrollbar=this._register(this.createTabsScrollbar(this.tabsContainer)),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.editorToolbarContainer=document.createElement("div"),this.editorToolbarContainer.classList.add("editor-actions"),this.tabsAndActionsContainer.appendChild(this.editorToolbarContainer),this.createEditorActionsToolBar(this.editorToolbarContainer);const t=document.createElement("div");t.classList.add("tabs-breadcrumbs"),this.titleContainer.appendChild(t),this.createBreadcrumbsControl(t,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0})}createTabsScrollbar(e){const t=new Ls.NB(e,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1});return t.onScroll(i=>{i.scrollLeftChanged&&(e.scrollLeft=i.scrollLeft)}),t}updateTabsScrollbarSizing(){this.tabsScrollbar?.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(e){const[t,i]=(0,A.ld)(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();const o=this.accessor.partOptions;"fixed"===o.tabSizing?(t.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),i.add((0,g.nm)(t,g.tw.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add((0,g.nm)(t,g.tw.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,o)=>{if(e){const{width:n}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${n}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return"large"!==this.accessor.partOptions.titleScrollbarSizing?je.SCROLLBAR_SIZES.default:je.SCROLLBAR_SIZES.large}registerTabsContainerListeners(e,t){this.enableGroupDragging(e),this._register((0,g.nm)(e,g.tw.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(const o of[ae.t.Tap,g.tw.DBLCLICK])this._register((0,g.nm)(e,o,n=>{if(o===g.tw.DBLCLICK){if(n.target!==e)return}else if(2!==n.tapCount||n.initialTarget!==e)return;g.zB.stop(n),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.group.count,override:x.Cr.id}},this.group.id)}));this._register((0,g.nm)(e,g.tw.MOUSE_DOWN,o=>{1===o.button&&o.preventDefault()})),this._register(new g.eg(e,{onDragEnter:o=>{if(e.classList.add("scroll"),o.target!==e)return void this.updateDropFeedback(e,!1);if(!this.isSupportedDropTransfer(o))return void(o.dataTransfer&&(o.dataTransfer.dropEffect="none"));let n=!1;if(this.editorTransfer.hasData(B.L5.prototype)){n=!0;const r=this.editorTransfer.getData(B.L5.prototype);if(Array.isArray(r)){const s=r[0].identifier;if(this.group.id===s.groupId&&this.group.getIndexOfEditor(s.editor)===this.group.count-1)return void(o.dataTransfer&&(o.dataTransfer.dropEffect="none"))}}n||o.dataTransfer&&(o.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0)},onDragLeave:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDragEnd:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDrop:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll"),o.target===e&&this.onDrop(o,this.group.count,e)}})),this._register((0,g.nm)(e,g.tw.MOUSE_WHEEL,o=>{const n=this.group.activeEditor;if(!n||this.group.count<2)return;if(!0===this.accessor.partOptions.scrollToSwitchTabs){if(o.shiftKey)return}else if(!o.shiftKey)return;const r=Date.now();if(r-this.lastMouseWheelEventTime<je.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(o.deltaX)+Math.abs(o.deltaY)))return;let s;if(this.lastMouseWheelEventTime=r,o.deltaX+o.deltaY<-je.MOUSE_WHEEL_DISTANCE_THRESHOLD)s=-1;else{if(!(o.deltaX+o.deltaY>je.MOUSE_WHEEL_DISTANCE_THRESHOLD))return;s=1}const a=this.group.getEditorByIndex(this.group.getIndexOfEditor(n)+s);a&&(this.group.openEditor(a),g.zB.stop(o,!0))}));const i=o=>{g.zB.stop(o);let n=e;if(o instanceof MouseEvent){const r=new ct.nV(o);n={x:r.posx,y:r.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>n,menuId:v.eH.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.group.id}),getKeyBinding:r=>this.getKeybinding(r),onHide:()=>this.group.focus()})};this._register((0,g.nm)(e,ae.t.Contextmenu,o=>i(o))),this._register((0,g.nm)(e,g.tw.CONTEXT_MENU,o=>i(o)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e){this.handleOpenedEditors()}openEditors(e){this.handleOpenedEditors()}handleOpenedEditors(){const[e,t]=(0,A.ld)(this.tabsContainer,this.tabsScrollbar);for(let r=e.children.length;r<this.group.count;r++)e.appendChild(this.createTab(r,e,t));const i=this.didActiveEditorChange(),o=this.activeTabLabel,n=this.tabLabels.length;this.computeTabLabels(),i||n!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),this.breadcrumbsControl?.update()):(this.layout(this.dimensions,{forceRevealActiveTab:!0}),this.breadcrumbsControl?.revealLast())}didActiveEditorChange(){return!(!(!this.activeTabLabel?.editor&&this.group.activeEditor||this.activeTabLabel?.editor&&!this.group.activeEditor)&&this.activeTabLabel?.editor&&this.group.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t||!(!e||!t)&&e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&"fixed"===this.accessor.partOptions.tabSizing){const t=this.group.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.group.activeEditor){const e=(0,A.cW)(this.tabsContainer);for(;e.children.length>this.group.count;)e.lastChild?.remove(),(0,C.B9)(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&(0,g.PO)(this.tabsContainer),this.tabDisposables=(0,C.B9)(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.breadcrumbsControl?.update()}moveEditor(e,t,i){const o=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,o),this.forEachTab((n,r,s,a,d,l)=>{this.redrawTab(n,r,s,a,d,l)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(t,i,o,n,r)=>this.redrawTabLabel(t,i,o,n,r))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(t,i,o,n,r,s)=>this.redrawTab(t,i,o,n,r,s)),this.forEachTab((t,i,o,n,r)=>{this.redrawTabBorders(i,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,o,n,r,s)=>{this.redrawTabActiveAndDirty(e,t,o,s)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,o,n)=>{this.redrawTabLabel(e,t,i,o,n)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(t,i,o,n,r,s)=>this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,t,o,s))}updateOptions(e,t){e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),(e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabCloseButton!==t.tabCloseButton||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||!(0,Fo.fS)(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.group.editors.forEach((o,n)=>{"number"==typeof t&&t>n||"number"==typeof i&&i<n||this.doWithTab(n,o,e)})}withTab(e,t){this.doWithTab(this.group.getIndexOfEditor(e),e,t)}doWithTab(e,t,i){const n=(0,A.cW)(this.tabsContainer).children[e],r=this.tabResourceLabels.get(e),s=this.tabLabels[e];n&&r&&s&&i(t,e,n,r,s,this.tabActionBars[e])}createTab(e,t,i){const o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(ae.o.addTarget(o));const n=document.createElement("div");n.classList.add("tab-border-top-container"),o.appendChild(n);const r=this.tabResourceLabels.create(o),s=document.createElement("div");s.classList.add("tab-actions"),o.appendChild(s);const a=new Ns({groupId:this.group.id,editorIndex:e}),d=new qe.o(s,{ariaLabel:(0,p.NC)("ariaLabelTabActions","Tab actions"),actionRunner:a});d.onWillRun(b=>{b.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()});const l=(0,C.F8)(d,(0,C.OF)((0,L.$T)(this.tabActionBars,d))),u=document.createElement("div");u.classList.add("tab-border-bottom-container"),o.appendChild(u);const f=this.registerTabListeners(o,e,t,i);return this.tabDisposables.push((0,C.F8)(f,l,a,r)),o}registerTabListeners(e,t,i,o){const n=new C.SL,r=(a,d)=>{if(e.blur(),a instanceof MouseEvent&&(0!==a.button||F.dz&&a.ctrlKey))return void(1===a.button&&a.preventDefault());if(this.originatesFromTabActionBar(a))return;const l=this.group.getEditorByIndex(t);l&&this.group.openEditor(l,{preserveFocus:d,activation:Qe.kn.ACTIVATE})},s=a=>{g.zB.stop(a);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)};n.add((0,g.nm)(e,g.tw.MOUSE_DOWN,a=>r(a,!1))),n.add((0,g.nm)(e,ae.t.Tap,a=>r(a,!0))),n.add((0,g.nm)(e,ae.t.Change,a=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-a.translationX})})),n.add((0,g.nm)(e,g.tw.MOUSE_UP,a=>{g.zB.stop(a),e.blur()})),n.add((0,g.nm)(e,g.tw.AUXCLICK,a=>{1===a.button&&(g.zB.stop(a,!0),this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.group.id,editorIndex:t}))})),n.add((0,g.nm)(e,g.tw.KEY_DOWN,a=>{const d=new dt.y1(a);d.shiftKey&&68===d.keyCode&&s(a)})),n.add((0,g.nm)(e,ae.t.Contextmenu,a=>{s(a)})),n.add((0,g.nm)(e,g.tw.KEY_UP,a=>{const d=new dt.y1(a);let l=!1;if(d.equals(3)||d.equals(10)){l=!0;const u=this.group.getEditorByIndex(t);u&&this.group.openEditor(u)}else if([15,17,16,18,14,13].some(u=>d.equals(u))){let u;u=d.equals(15)||d.equals(16)?t-1:d.equals(17)||d.equals(18)?t+1:d.equals(14)?0:this.group.count-1;const f=this.group.getEditorByIndex(u);f&&(l=!0,this.group.openEditor(f,{preserveFocus:!0}),i.childNodes[u].focus())}l&&g.zB.stop(a,!0),o.setScrollPosition({scrollLeft:i.scrollLeft})}));for(const a of[ae.t.Tap,g.tw.DBLCLICK])n.add((0,g.nm)(e,a,d=>{if(a===g.tw.DBLCLICK)g.zB.stop(d);else if(2!==d.tapCount)return;const l=this.group.getEditorByIndex(t);l&&this.group.isPinned(l)?this.accessor.arrangeGroups(2,this.group):this.group.pinEditor(l)}));return n.add((0,g.nm)(e,g.tw.CONTEXT_MENU,a=>{g.zB.stop(a,!0);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)},!0)),n.add((0,g.nm)(e,g.tw.DRAG_START,a=>{const d=this.group.getEditorByIndex(t);d&&(this.editorTransfer.setData([new B.L5({editor:d,groupId:this.group.id})],B.L5.prototype),a.dataTransfer&&(a.dataTransfer.effectAllowed="copyMove"),this.doFillResourceDataTransfers([d],a),e.classList.add("dragged"),(0,g.jL)(()=>e.classList.remove("dragged")))})),n.add(new g.eg(e,{onDragEnter:a=>{if(e.classList.add("dragged-over"),!this.isSupportedDropTransfer(a))return void(a.dataTransfer&&(a.dataTransfer.dropEffect="none"));let d=!1;if(this.editorTransfer.hasData(B.L5.prototype)){d=!0;const l=this.editorTransfer.getData(B.L5.prototype);if(Array.isArray(l)){const u=l[0].identifier;if(u.editor===this.group.getEditorByIndex(t)&&u.groupId===this.group.id)return void(a.dataTransfer&&(a.dataTransfer.dropEffect="none"))}}d||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,t)},onDragOver:(a,d)=>{if(d>=je.DRAG_OVER_OPEN_TAB_THRESHOLD){const l=this.group.getEditorByIndex(t);l&&this.group.activeEditor!==l&&this.group.openEditor(l,{preserveFocus:!0})}},onDragLeave:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t)},onDragEnd:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.editorTransfer.clearData(B.L5.prototype)},onDrop:a=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.onDrop(a,t,i)}})),n}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(B.r8.prototype)){const t=this.groupTransfer.getData(B.r8.prototype);return!(Array.isArray(t)&&t[0].identifier===this.group.id)}return!!(this.editorTransfer.hasData(B.L5.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i){const o="number"==typeof i,n="number"==typeof i?this.group.getEditorByIndex(i):void 0,r=o&&!!n&&this.group.isActive(n),s=o?this.getColor(r?I.Ug:I.$7):"";e.style.backgroundColor=(t?this.getColor(I.Xv):s)||"";const a=this.getColor(Y.xL1);a&&t?(e.style.outlineWidth="2px",e.style.outlineStyle="dashed",e.style.outlineColor=a,e.style.outlineOffset=o?"-5px":"-3px"):(e.style.outlineWidth="",e.style.outlineStyle="",e.style.outlineColor=a||"",e.style.outlineOffset="")}computeTabLabels(){const{labelFormat:e}=this.accessor.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),o=[];let n=-1;for(let r=0;r<this.group.editors.length;r++){const s=this.group.editors[r];o.push({editor:s,name:s.getName(),description:s.getDescription(t),forceDescription:s.hasCapability(64),title:s.getTitle(2),ariaLabel:(0,ld.Vm)(s,r,this.group,this.editorGroupService.count)}),s===this.group.activeEditor&&(n=r)}i&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[n]}shortenTabLabels(e){const t=new Map;for(const i of e)"string"==typeof i.description?(0,Te.XO)(t,i.name,[]).push(i):i.description="";for(const[,i]of t){if(1===i.length&&!i[0].forceDescription){i[0].description="";continue}const o=new Map;for(const a of i)(0,Te.XO)(o,a.description,[]).push(a);let n=!1;for(const[,a]of o)if(!n&&a.length>1){const[d,...l]=a.map(({editor:u})=>u.getDescription(2));n=l.some(u=>u!==d)}if(n){o.clear();for(const a of i)a.description=a.editor.getDescription(2),(0,Te.XO)(o,a.description,[]).push(a)}const r=[];for(const[a]of o)r.push(a);if(1===r.length){for(const a of o.get(r[0])||[])a.forceDescription||(a.description="");continue}const s=(0,lt.OV)(r,this.path.sep);r.forEach((a,d)=>{for(const l of o.get(a)||[])l.description=s[d]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let t=this.getColor(I.yD);!t&&(0,Ki.c3)(this.theme.type)&&(t=this.getColor(I.Sh)||this.getColor(Y.lRK)),t?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",t.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((t,i,o,n,r,s)=>{this.redrawTab(t,i,o,n,r,s)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,o,n,r){const s=this.group.isSticky(t),a=this.accessor.partOptions;this.redrawTabLabel(e,t,i,o,n);const d=s?this.unpinEditorAction:this.closeEditorAction;r.hasAction(d)||(r.isEmpty()||r.clear(),r.push(d,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(d)}));const l=s&&"compact"===a.pinnedTabSizing?"off":a.tabCloseButton;for(const f of["off","left","right"])i.classList.toggle(`tab-actions-${f}`,l===f);const u=s&&"shrink"===a.pinnedTabSizing?"shrink":a.tabSizing;for(const f of["fit","shrink","fixed"])i.classList.toggle(`sizing-${f}`,u===f);i.classList.toggle("has-icon",a.showIcons&&a.hasIcons),i.classList.toggle("sticky",s);for(const f of["normal","compact","shrink"])i.classList.toggle(`sticky-${f}`,s&&a.pinnedTabSizing===f);if(!a.wrapTabs&&s&&"normal"!==a.pinnedTabSizing){let f=0;switch(a.pinnedTabSizing){case"compact":f=je.TAB_WIDTH.compact;break;case"shrink":f=je.TAB_WIDTH.shrink}i.style.left=t*f+"px"}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,e,i,r)}redrawTabLabel(e,t,i,o,n){const r=this.accessor.partOptions;let s,l,a=!1,d=!!r.decorations?.badges;"compact"===r.pinnedTabSizing&&this.group.isSticky(t)?(s=r.showIcons&&r.hasIcons?"":n.name?.charAt(0).toUpperCase(),l="",a=!0,d=!1):(s=n.name,l=n.description||""),n.ariaLabel&&(i.setAttribute("aria-label",n.ariaLabel),i.setAttribute("aria-description",""));const u=n.title||"";i.title=u,o.setResource({name:s,description:l,resource:x.zK.getOriginalUri(e,{supportSideBySide:x.YX.BOTH})},{title:u,extraClasses:(0,L.kX)(["tab-label",d?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.group.isPinned(e),forceLabel:a,fileDecorations:{colors:!!r.decorations?.colors,badges:d}});const f=x.zK.getOriginalUri(e,{supportSideBySide:x.YX.PRIMARY});f?i.setAttribute("data-resource-name",(0,J.Hx)(f)):i.removeAttribute("data-resource-name")}redrawTabActiveAndDirty(e,t,i,o){const n=this.group.isActive(t),r=this.doRedrawTabDirty(e,n,t,i);this.doRedrawTabActive(e,!r,t,i,o)}doRedrawTabActive(e,t,i,o,n){if(this.group.isActive(i)){o.classList.add("active"),o.setAttribute("aria-selected","true"),o.tabIndex=0,o.style.backgroundColor=this.getColor(e?I.Ug:I.il)||"";const r=this.getColor(e?I._i:I.FB);r?(o.classList.add("tab-border-bottom"),o.style.setProperty("--tab-border-bottom-color",r.toString())):(o.classList.remove("tab-border-bottom"),o.style.removeProperty("--tab-border-bottom-color"));const s=t?this.getColor(e?I.ME:I.xR):void 0;s?(o.classList.add("tab-border-top"),o.style.setProperty("--tab-border-top-color",s.toString())):(o.classList.remove("tab-border-top"),o.style.removeProperty("--tab-border-top-color")),o.style.color=this.getColor(e?I.xJ:I.uE)||"",n.setFocusable(!0)}else o.classList.remove("active"),o.setAttribute("aria-selected","false"),o.tabIndex=-1,o.style.backgroundColor=this.getColor(e?I.$7:I.qM)||"",o.style.boxShadow="",o.style.color=this.getColor(e?I.ZE:I.rq)||"",n.setFocusable(!1)}doRedrawTabDirty(e,t,i,o){let n=!1;if(i.isDirty()&&!i.isSaving())if(o.classList.add("dirty"),this.accessor.partOptions.highlightModifiedTabs){let r;r=this.getColor(e&&t?I.Ld:e&&!t?I.yc:!e&&t?I._v:I.TN),r&&(n=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",r))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return n}redrawTabBorders(e,t){const n=(this.group.isSticky(e)&&this.group.stickyCount===e+1?this.getColor(I.rN):void 0)||this.getColor(I.Sh)||this.getColor(Y.lRK);t.style.borderRight=n?`1px solid ${n}`:"",t.style.outlineColor=this.getColor(Y.xL1)||""}prepareEditorActions(e){return this.accessor.activeGroup===this.group?e:{primary:e.primary.filter(i=>i.id===ut.yh),secondary:e.secondary}}getHeight(){const e=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden();return this.dimensions.used?{total:this.dimensions.used.height,offset:e?this.dimensions.used.height-j.HEIGHT:this.dimensions.used.height}:this.computeHeight()}computeHeight(){let e;e=this.accessor.partOptions.wrapTabs&&this.tabsAndActionsContainer?.classList.contains("wrapping")?this.tabsAndActionsContainer.offsetHeight:je.TAB_HEIGHT;const t=e;return this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&(e+=j.HEIGHT),{total:e,offset:t}}layout(e,t){if(Object.assign(this.dimensions,e),!this.layoutScheduler.value){const i=(0,g.jL)(()=>{this.doLayout(this.dimensions,this.layoutScheduler.value?.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>i.dispose()}}return t?.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0}),this.dimensions.used||(this.dimensions.used=new g.Ro(e.container.width,this.computeHeight().total)),this.dimensions.used}doLayout(e,t){const i=this.group.activeEditor?this.getTabAndIndex(this.group.activeEditor):void 0;if(i&&e.container!==g.Ro.None&&e.available!==g.Ro.None){this.doLayoutBreadcrumbs(e);const[r,s]=i;this.doLayoutTabs(r,s,e,t)}const o=this.dimensions.used,n=this.dimensions.used=new g.Ro(e.container.width,this.computeHeight().total);o&&o.height!==n.height&&this.group.relayout()}handleBreadcrumbsEnablementChange(){this.group.relayout()}doLayoutBreadcrumbs(e){this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&this.breadcrumbsControl.layout(new g.Ro(e.container.width,j.HEIGHT))}doLayoutTabs(e,t,i,o){this.doLayoutTabsWrapping(i)||this.doLayoutTabsNonWrapping(e,t,o)}doLayoutTabsWrapping(e){const[t,i,o,n]=(0,A.ld)(this.tabsAndActionsContainer,this.tabsContainer,this.editorToolbarContainer,this.tabsScrollbar),r=t.classList.contains("wrapping");let s=r;function a(d){s=d,t.classList.toggle("wrapping",s),i.style.setProperty("--last-tab-margin-right",s?`${o.offsetWidth}px`:"0")}if(this.accessor.partOptions.wrapTabs){const d=i.offsetWidth,l=i.scrollWidth,u=()=>{const f=this.getLastTab();return!(f&&f.offsetWidth+o.offsetWidth-e.available.width>1)};(s||l>d&&u())&&a(!0),s&&(i.offsetHeight>e.available.height||l===d&&i.offsetHeight===je.TAB_HEIGHT||!u())&&a(!1)}else r&&a(!1);if(s&&!r){const d=i.offsetWidth;n.setScrollDimensions({width:d,scrollWidth:d})}if(s){const d=new Map;let l,u;for(const f of i.children){const b=f,E=b.offsetTop;E!==l&&(l=E,u&&d.set(u,!0)),u=b,d.set(b,!1)}u&&d.set(u,!0);for(const[f,b]of d)f.classList.toggle("last-in-row",b)}return s}doLayoutTabsNonWrapping(e,t,i){const[o,n]=(0,A.ld)(this.tabsContainer,this.tabsScrollbar),r=o.offsetWidth,s=o.scrollWidth;let a=0;if(this.group.stickyCount>0){let De=0;switch(this.accessor.partOptions.pinnedTabSizing){case"compact":De=je.TAB_WIDTH.compact;break;case"shrink":De=je.TAB_WIDTH.shrink}a=this.group.stickyCount*De}let u,f,d="normal"!==this.accessor.partOptions.pinnedTabSizing&&this.group.isSticky(t),l=r-a;this.group.stickyCount>0&&l<je.TAB_WIDTH.fit?(o.classList.add("disable-sticky-tabs"),l=r,a=0,d=!1):o.classList.remove("disable-sticky-tabs"),this.blockRevealActiveTab||(u=e.offsetLeft,f=e.offsetWidth);const{width:b,scrollWidth:E}=n.getScrollDimensions();if(n.setScrollDimensions({width:r,scrollWidth:s}),this.blockRevealActiveTab||"number"!=typeof u||"number"!=typeof f||d||b===r&&E===s&&!i?.forceRevealActiveTab)return void(this.blockRevealActiveTab=!1);const M=n.getScrollPosition().scrollLeft,X=f<=l,ee=u-a;X&&M+l<ee+f?n.setScrollPosition({scrollLeft:M+(ee+f-(M+l))}):(M>ee||!X)&&n.setScrollPosition({scrollLeft:ee})}getTabAndIndex(e){const t=this.group.getIndexOfEditor(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return(0,A.cW)(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.group.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return t=e instanceof MouseEvent?e.target||e.srcElement:e.initialTarget,!!(0,g.Fx)(t,"action-item","tab")}onDrop(e,t,i){var o=this;return(0,w.Z)(function*(){if(g.zB.stop(e,!0),o.updateDropFeedback(i,!1),i.classList.remove("scroll"),o.groupTransfer.hasData(B.r8.prototype)){const n=o.groupTransfer.getData(B.r8.prototype);if(Array.isArray(n)){const r=o.accessor.getGroup(n[0].identifier);if(r){const s={index:t};o.isMoveOperation(e,r.id)||(s.mode=0),o.accessor.mergeGroup(r,o.group,s)}o.group.focus(),o.groupTransfer.clearData(B.r8.prototype)}}else if(o.editorTransfer.hasData(B.L5.prototype)){const n=o.editorTransfer.getData(B.L5.prototype);if(Array.isArray(n)){const r=n[0].identifier,s=o.accessor.getGroup(r.groupId);s&&(o.isMoveOperation(e,r.groupId,r.editor)?s.moveEditor(r.editor,o.group,{index:t}):s.copyEditor(r.editor,o.group,{index:t})),o.group.focus(),o.editorTransfer.clearData(B.L5.prototype)}}else if(o.treeItemsTransfer.hasData(At.f.prototype)){const n=o.treeItemsTransfer.getData(At.f.prototype);if(Array.isArray(n)){const r=[];for(const s of n){const a=yield o.treeViewsDragAndDropService.removeDragOperationTransfer(s.identifier);if(a){const d=yield(0,B.W$)(a);r.push(...d.map(l=>({...l,options:{...l.options,pinned:!0,index:t}})))}}o.editorService.openEditors(r,o.group,{validateTrust:!0})}o.treeItemsTransfer.clearData(At.f.prototype)}else o.instantiationService.createInstance(B.n5,{allowWorkspaceOpen:!1}).handleDrop(e,()=>o.group,()=>o.group.focus(),t)})()}isMoveOperation(e,t,i){return!!i?.hasCapability(8)||!(e.ctrlKey&&!F.dz||e.altKey&&F.dz)||t===this.group.id}dispose(){super.dispose(),this.tabDisposables=(0,C.B9)(this.tabDisposables)}};Rt.SCROLLBAR_SIZES={default:3,large:10},Rt.TAB_WIDTH={compact:38,shrink:80,fit:120},Rt.TAB_HEIGHT=35,Rt.DRAG_OVER_OPEN_TAB_THRESHOLD=1500,Rt.MOUSE_WHEEL_EVENT_THRESHOLD=150,Rt.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5,Rt=(0,h.gn)([(0,h.fM)(3,ge.i),(0,h.fM)(4,R.TG),(0,h.fM)(5,y.i6),(0,h.fM)(6,Se.d),(0,h.fM)(7,oe.lT),(0,h.fM)(8,v.co),(0,h.fM)(9,St.eJ),(0,h.fM)(10,K.XE),(0,h.fM)(11,G.Ui),(0,h.fM)(12,z.sn),(0,h.fM)(13,U.AR),(0,h.fM)(14,Os.a),(0,h.fM)(15,te.Qw),(0,h.fM)(16,Un.m)],Rt),(0,K.Ic)((c,e)=>{const t=c.getColor(I.Sh);t&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {\n\t\t\t\tborder-bottom: 1px solid ${t};\n\t\t\t}\n\t\t`);const i=c.getColor(Y.xL1);i&&e.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {\n\t\t\t\toutline: 1px solid;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {\n\t\t\t\toutline: 1px dotted;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\toutline: 1px dashed;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t");const o=c.getColor(Y.lRK);o&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {\n\t\t\t\toutline: 1px solid ${o}\n\t\t\t}\n\t\t`);const n=c.getColor(I.Bk);n&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\n\t\t\t\tbackground-color: ${n} !important;\n\t\t\t}\n\t\t`);const r=c.getColor(I.e5);r&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\tbackground-color: ${r} !important;\n\t\t\t}\n\t\t`);const s=c.getColor(I.B1);s&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\n\t\t\t\tcolor: ${s} !important;\n\t\t\t}\n\t\t`);const a=c.getColor(I._Z);a&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\tcolor: ${a} !important;\n\t\t\t}\n\t\t`);const d=c.getColor(I.uK);d&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ${d};\n\t\t\t}\n\t\t`);const l=c.getColor(I.Iw);if(l&&e.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ${l};\n\t\t\t}\n\t\t`),!(0,Ki.c3)(c.type)&&!Bi.isSafari&&!i){const u=(0,I.Xp)(c),f=c.getColor(Y.cvW),b=c.getColor(I.Fk),E=c.getColor(I.Xv);let k,M;b&&f&&(k=b.flatten(f,f,u)),b&&f&&E&&f&&(M=b.flatten(f,E,f,u));const X=(re,fe,vt=!1)=>`\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${vt?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${vt?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ${re}, transparent) !important;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${vt?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${vt?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ${fe}, transparent) !important;\n\t\t\t}\n\t\t`;if(n&&k&&M){const re=n.flatten(k),fe=n.flatten(M);e.addRule(X(re,fe,!0))}if(r&&k&&M){const re=r.flatten(k),fe=r.flatten(M);e.addRule(X(re,fe))}if(E&&M){const re=E.flatten(M);e.addRule(`\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${re}, transparent) !important;\n\t\t\t\t}\n\t\t`)}const ee=(re,fe,vt,Ni)=>`\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${vt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${Ni?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${vt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${Ni?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${re}, transparent);\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${vt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${Ni?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${vt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${Ni?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${fe}, transparent);\n\t\t\t\t}\n\t\t`,De=c.getColor(I.Ug);if(De&&k&&M){const re=De.flatten(k),fe=De.flatten(M);e.addRule(ee(re,fe,!0,!0))}const mt=c.getColor(I.il);if(mt&&k&&M){const re=mt.flatten(k),fe=mt.flatten(M);e.addRule(ee(re,fe,!1,!0))}const $e=c.getColor(I.$7);if($e&&k&&M){const re=$e.flatten(k),fe=$e.flatten(M);e.addRule(ee(re,fe,!0,!1))}const Q=c.getColor(I.qM);if(Q&&k&&M){const re=Q.flatten(k),fe=Q.flatten(M);e.addRule(ee(re,fe,!1,!1))}}});var Hs=m(69771),Kn=m(35837),Bs=m(98219),Zi=m(98179);let Zn=class extends C.JT{get minimumWidth(){return this._activeEditorPane?.minimumWidth??Dt.Tj.width}get minimumHeight(){return this._activeEditorPane?.minimumHeight??Dt.Tj.height}get maximumWidth(){return this._activeEditorPane?.maximumWidth??Dt.ax.width}get maximumHeight(){return this._activeEditorPane?.maximumHeight??Dt.ax.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,o,n,r,s,a,d){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=o,this.instantiationService=n,this.editorProgressService=r,this.workspaceTrustService=s,this.logService=a,this.dialogService=d,this._onDidFocus=this._register(new S.Q5),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new S.Q5),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.activeEditorPaneDisposables=this._register(new C.SL),this.editorOperation=this._register(new Gt.nR(this.editorProgressService)),this.editorPanesRegistry=me.B.as(x.bS.EditorPane),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){const e=this._activeEditorPane?.input,t=this._activeEditorPane?.options;e?.hasCapability(16)&&this.groupView.openEditor(e,t)}openEditor(e,t,i=Object.create(null)){var o=this;return(0,w.Z)(function*(){try{return yield o.doOpenEditor(o.getEditorPaneDescriptor(e),e,t,i)}catch(n){return t?.ignoreError?{error:n}:o.doShowError(n,e,t,i)}})()}doShowError(e,t,i,o){var n=this;return(0,w.Z)(function*(){n.logService.error(e);let r=!1;if(i?.source===Qe.vU.USER&&(!(0,x._I)(e)||e.allowDialog)&&(r=yield n.doShowErrorDialog(e,t)),r)return{error:e};const s={...i};return(0,Xe.n2)(e)||(s.error=e),{...yield n.doOpenEditor(Bs.Zd.DESCRIPTOR,t,s,o),error:e}})()}doShowErrorDialog(e,t){var i=this;return(0,w.Z)(function*(){let n,s,o=Hs.Z.Error,r=(0,Zi.yJ)(e);(0,x._I)(e)&&(s=e.actions,o=e.forceSeverity??Hs.Z.Error,e.forceMessage&&(n=e.message,r=void 0)),n||(n=(0,p.NC)("editorOpenErrorDialog","Unable to open '{0}'",t.getName()));const a=[];if(s&&s.length>0)for(const f of s)a.push({label:f.label,run:()=>f});else a.push({label:(0,p.NC)({key:"ok",comment:["&& denotes a mnemonic"]},"&&OK"),run:()=>{}});let d;1===a.length&&(d={run:()=>{l=!0}});let l=!1;const{result:u}=yield i.dialogService.prompt({type:o,message:n,detail:r,buttons:a,cancelButton:d});if(u){const f=u.run();f instanceof Promise&&f.catch(b=>i.dialogService.error((0,Zi.yJ)(b))),l=!0}return l})()}doOpenEditor(e,t,i,o=Object.create(null)){var n=this;return(0,w.Z)(function*(){const r=n.doShowEditorPane(e),s=document.activeElement,{changed:a,cancelled:d}=yield n.doSetInput(r,t,i,o);return!d&&(!i||!i.preserveFocus)&&n.shouldRestoreFocus(s)&&r.focus(),{pane:r,changed:a,cancelled:d}})()}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;const t=document.activeElement;return!(t&&t!==document.body&&e!==t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName)&&!(0,g.jg)(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(16)&&!this.workspaceTrustService.isWorkspaceTrusted()?Bs.vm.DESCRIPTOR:(0,A.cW)(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();const t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);const i=(0,A.cW)(t.getContainer());return this.editorPanesParent.appendChild(i),(0,g.$Z)(i),t.setVisible(!0,this.groupView),this.pagePosition&&t.layout(new g.Ro(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){const t=this.doInstantiateEditorPane(e);if(!t.getContainer()){const i=document.createElement("div");i.classList.add("editor-instance"),t.create(i)}return t}doInstantiateEditorPane(e){const t=this.editorPanes.find(o=>e.describes(o));if(t)return t;const i=this._register(e.instantiate(this.instantiationService));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(t=>this._onDidChangeSizeConstraints.fire(t))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}doSetInput(e,t,i,o){var n=this;return(0,w.Z)(function*(){const r=e.input?.matches(t);if(r&&!i?.forceReload)return e.setOptions(i),{changed:!1,cancelled:!1};const s=n.editorOperation.start(n.layoutService.isRestored()?800:3200);let a=!1;try{e.clearInput(),yield e.setInput(t,i,o,s.token),s.isCurrent()||(a=!0)}catch(d){if(s.isCurrent())throw d;a=!0}finally{s.stop()}return{changed:!r,cancelled:a}})()}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this._activeEditorPane.clearInput(),this._activeEditorPane.setVisible(!1,this.groupView);const e=this._activeEditorPane.getContainer();e&&(this.editorPanesParent.removeChild(e),(0,g.Cp)(e)),this.doSetActiveEditorPane(null)}closeEditor(e){this._activeEditorPane?.input&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){this._activeEditorPane?.setVisible(e,this.groupView)}layout(e){this.pagePosition=e,this._activeEditorPane?.layout(new g.Ro(e.width,e.height),e)}setBoundarySashes(e){this.boundarySashes=e,this._activeEditorPane?.setBoundarySashes(e)}};Zn=(0,h.gn)([(0,h.fM)(3,et.z),(0,h.fM)(4,R.TG),(0,h.fM)(5,Gt.ek),(0,h.fM)(6,Kn.Y2),(0,h.fM)(7,Ae.VZ),(0,h.fM)(8,ki.Ss)],Zn),(0,ve.Z)('.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container{align-items:center;display:flex;flex:auto;height:35px;justify-content:flex-start;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label{line-height:35px;overflow:hidden;padding-left:20px;position:relative;text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label>.monaco-icon-label-container{flex:initial}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .no-tabs.title-label{flex:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control{flex:1 50%;margin-left:.45em;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{font-size:.9em}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.preview .monaco-breadcrumb-item{font-style:italic}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{background-image:none;content:"/";height:inherit;opacity:1;width:inherit}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.backslash-path .monaco-breadcrumb-item:before{content:"\\\\"}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder+.monaco-breadcrumb-item:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.relative-path .monaco-breadcrumb-item:nth-child(2):before,.monaco-workbench.windows .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:nth-child(2):before{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:after{content:"\\00a0\u2022\\00a0";padding:0}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon[class*=codicon-symbol-]{padding:0 1px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:18px;padding-right:2px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions{display:flex;flex:initial;height:35px;opacity:.5;padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title>.title-actions{opacity:1}',{});let Od=(()=>{class c extends Bo{constructor(){super(...arguments),this.activeLabel=Object.create(null)}create(t){const i=this.titleContainer=t;i.draggable=!0,this.registerContainerListeners(i),this._register(ae.o.addTarget(i));const o=document.createElement("div");o.classList.add("label-container"),i.appendChild(o),this.editorLabel=this._register(this.instantiationService.createInstance(Xt.mn,o,void 0)).element,this._register((0,g.nm)(this.editorLabel.element,g.tw.CLICK,r=>this.onTitleLabelClick(r))),this.createBreadcrumbsControl(o,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...zt.Db,breadcrumbsBackground:jt.Il.transparent.toString()},showPlaceholder:!1}),i.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register((0,C.OF)(()=>i.classList.remove("breadcrumbs")));const n=document.createElement("div");n.classList.add("title-actions"),i.appendChild(n),this.createEditorActionsToolBar(n)}registerContainerListeners(t){this.enableGroupDragging(t),this._register((0,g.nm)(t,g.tw.DBLCLICK,i=>this.onTitleDoubleClick(i))),this._register((0,g.nm)(t,g.tw.AUXCLICK,i=>this.onTitleAuxClick(i))),this._register((0,g.nm)(t,ae.t.Tap,i=>this.onTitleTap(i)));for(const i of[g.tw.CONTEXT_MENU,ae.t.Contextmenu])this._register((0,g.nm)(t,i,o=>{this.group.activeEditor&&this.onContextMenu(this.group.activeEditor,o,t)}))}onTitleLabelClick(t){g.zB.stop(t,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(t){g.zB.stop(t),this.group.pinEditor()}onTitleAuxClick(t){1===t.button&&this.group.activeEditor&&(g.zB.stop(t,!0),this.group.closeEditor(this.group.activeEditor))}onTitleTap(t){const i=t.initialTarget;!(i instanceof HTMLElement)||!this.editorLabel||!(0,g.jg)(i,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(t){this.doHandleOpenEditor()}openEditors(t){this.doHandleOpenEditor()}doHandleOpenEditor(){this.ifActiveEditorChanged(()=>this.redraw())||this.ifActiveEditorPropertiesChanged(()=>this.redraw())}beforeCloseEditor(t){}closeEditor(t){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(t){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(t,i,o){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(t){this.ifEditorIsActive(t,()=>this.redraw())}stickEditor(t){}unstickEditor(t){}setActive(t){this.redraw()}updateEditorLabel(t){this.ifEditorIsActive(t,()=>this.redraw())}updateEditorDirty(t){this.ifEditorIsActive(t,()=>{const i=(0,A.cW)(this.titleContainer);t.isDirty()&&!t.isSaving()?i.classList.add("dirty"):i.classList.remove("dirty")})}updateOptions(t,i){(t.labelFormat!==i.labelFormat||!(0,Fo.fS)(t.decorations,i.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){(0,A.cW)(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(t){return!(!(!this.activeLabel.editor&&this.group.activeEditor||this.activeLabel.editor&&!this.group.activeEditor)&&this.activeLabel.editor&&this.group.isActive(this.activeLabel.editor)||(t(),0))}ifActiveEditorPropertiesChanged(t){!this.activeLabel.editor||!this.group.activeEditor||this.activeLabel.pinned!==this.group.isPinned(this.group.activeEditor)&&t()}ifEditorIsActive(t,i){this.group.isActive(t)&&i()}redraw(){const t=(0,A.f6)(this.group.activeEditor),i=this.accessor.partOptions,o=!!t&&this.group.isPinned(t),n=this.accessor.activeGroup===this.group;this.activeLabel={editor:t,pinned:o},this.breadcrumbsControl&&(n?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!o)):this.breadcrumbsControl.hide());const[r,s]=(0,A.ld)(this.titleContainer,this.editorLabel);if(t){this.updateEditorDirty(t);const{labelFormat:a}=this.accessor.partOptions;let d;d=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||"default"===a&&!n?"":t.getDescription(this.getVerbosity(a))||"";let l=t.getTitle(2);d===l&&(l=""),s.setResource({resource:x.zK.getOriginalUri(t,{supportSideBySide:x.YX.BOTH}),name:t.getName(),description:d},{title:l,italic:!o,extraClasses:["no-tabs","title-label"].concat(t.getLabelExtraClasses()),fileDecorations:{colors:!!i.decorations?.colors,badges:!!i.decorations?.badges}}),r.style.color=n?this.getColor(I.xJ)||"":this.getColor(I.uE)||"",this.updateEditorActionsToolbar()}else r.classList.remove("dirty"),s.clear(),this.clearEditorActionsToolbar()}getVerbosity(t){switch(t){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(t){return this.accessor.activeGroup===this.group?t:{primary:t.primary.filter(o=>o.id===ut.$Z||o.id===ut.yh),secondary:t.secondary}}getHeight(){return{total:c.HEIGHT,offset:0}}layout(t){return this.breadcrumbsControl?.layout(void 0),new g.Ro(t.container.width,this.getHeight().total)}}return c.HEIGHT=35,c})();var Hd=m(37089),Wo=m(51870),$i=m(18747),Fs=m(55660);const Ws={text:p.NC("watermark.showCommands","Show All Commands"),id:"workbench.action.showCommands"},Bd={text:p.NC("watermark.quickAccess","Go to File"),id:"workbench.action.quickOpen"},Fd={text:p.NC("watermark.openFile","Open File"),id:"workbench.action.files.openFile",mac:!1},Wd={text:p.NC("watermark.openFolder","Open Folder"),id:"workbench.action.files.openFolder",mac:!1},Gd={text:p.NC("watermark.openFileFolder","Open File or Folder"),id:"workbench.action.files.openFileFolder",mac:!0},zd={text:p.NC("watermark.openRecent","Open Recent"),id:"workbench.action.openRecent"},Ud={text:p.NC("watermark.newUntitledFile","New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},Kd=Object.assign({mac:!0},Ud),Zd={text:p.NC("watermark.findInFiles","Find in Files"),id:"workbench.action.findInFiles"},$d={text:p.NC({key:"watermark.toggleTerminal",comment:["toggle is a verb here"]},"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:y.Ao.equals("terminalProcessSupported",!0)},jd={text:p.NC("watermark.startDebugging","Start Debugging"),id:"workbench.action.debug.start",when:y.Ao.equals("terminalProcessSupported",!0)},Xd={text:p.NC({key:"watermark.toggleFullscreen",comment:["toggle is a verb here"]},"Toggle Full Screen"),id:"workbench.action.toggleFullScreen",when:y.Ao.equals("terminalProcessSupported",!0).negate()},Yd={text:p.NC("watermark.showSettings","Show Settings"),id:"workbench.action.openSettings",when:y.Ao.equals("terminalProcessSupported",!0).negate()},Gs=[Ws,Fd,Wd,Gd,zd,Kd],zs=[Ws,Bd,Zd,jd,$d,Xd,Yd];let $n=class extends C.JT{constructor(e,t,i,o,n,r,s){super(),this.lifecycleService=t,this.keybindingService=i,this.contextService=o,this.contextKeyService=n,this.configurationService=r,this.telemetryService=s,this.transientDisposables=this._register(new C.SL),this.enabled=!1;const a=(0,g.h)(".editor-group-watermark",[(0,g.h)(".letterpress"),(0,g.h)(".shortcuts@shortcuts")]);(0,g.R3)(e,a.root),this.shortcuts=a.shortcuts,this.registerListeners(),this.workbenchState=o.getWorkbenchState(),this.render()}registerListeners(){this.lifecycleService.onDidShutdown(()=>this.dispose()),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration("workbench.tips.enabled")&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(i=>{this.workbenchState!==i&&(this.workbenchState=i,this.render())}));const e=[...Gs,...zs].filter(i=>void 0!==i.when).map(i=>i.when),t=new Set;e.forEach(i=>i.keys().forEach(o=>t.add(o))),this._register(this.contextKeyService.onDidChangeContext(i=>{i.affectsSome(t)&&this.render()}))}render(){const e=this.configurationService.getValue("workbench.tips.enabled");if(e===this.enabled||(this.enabled=e,this.clear(),!e))return;const t=(0,g.R3)(this.shortcuts,(0,g.$)(".watermark-box"));(1!==this.workbenchState?zs:Gs).filter(n=>!("when"in n)||this.contextKeyService.contextMatchesRules(n.when)).filter(n=>!("mac"in n)||n.mac===(F.dz&&!F.$L)).filter(n=>!!Z.P.getCommand(n.id));const o=()=>{(0,g.PO)(t)};o(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(o)),this.telemetryService.publicLog("watermark:open")}clear(){(0,g.PO)(this.shortcuts),this.transientDisposables.clear()}dispose(){super.dispose(),this.clear()}};$n=(0,h.gn)([(0,h.fM)(1,Tn.g),(0,h.fM)(2,Se.d),(0,h.fM)(3,ce.ec),(0,h.fM)(4,y.i6),(0,h.fM)(5,G.Ui),(0,h.fM)(6,Ue.bU)],$n);let Ti=class yi extends K.bB{static createNew(e,t,i){return i.createInstance(yi,e,null,t)}static createFromSerialized(e,t,i,o){return o.createInstance(yi,t,e,i)}static createCopy(e,t,i,o){return o.createInstance(yi,t,e,i)}constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k){super(r),this.accessor=e,this._index=i,this.instantiationService=o,this.contextKeyService=n,this.telemetryService=s,this.keybindingService=a,this.menuService=d,this.contextMenuService=l,this.fileDialogService=u,this.editorService=f,this.filesConfigurationService=b,this.uriIdentityService=E,this.logService=k,this._onDidFocus=this._register(new S.Q5),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new S.Q5),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new S.Q5),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new S.Q5),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new S.Q5),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new S.Q5),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new S.Q5),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new S.Q5),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new S.Q5),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new Ve.F7(X=>this.handleDisposedEditors(X),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new C.XK),this.whenRestoredPromise=new Ve.CR,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=document.createElement("div"),this._onDidChange=this._register(new S.ZD),this.onDidChange=this._onDidChange.event,this.model=t instanceof yi?this._register(t.model.clone()):(0,Ii.Ti)(t)?this._register(o.createInstance(Ii.gn,t)):this._register(o.createInstance(Ii.gn,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add("editor-group-container"),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance($n,this.element)),this.progressBar=this._register(new Xr.k(this.element,zt.b5)),this.progressBar.hide(),this.scopedInstantiationService=this.instantiationService.createChild(new Yr.y([y.i6,this.scopedContextKeyService],[Gt.ek,this._register(new an.dZ(this.progressBar,this))])),this.handleGroupContextKeys(),this.titleContainer=document.createElement("div"),this.titleContainer.classList.add("title"),this.element.appendChild(this.titleContainer),this.titleAreaControl=this.createTitleAreaControl(),this.editorContainer=document.createElement("div"),this.editorContainer.classList.add("editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(Zn,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(this.restoreEditors(t)??Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){const e=N.$w.bindTo(this.scopedContextKeyService),t=N.gI.bindTo(this.scopedContextKeyService),i=N.lr.bindTo(this.scopedContextKeyService),o=N._B.bindTo(this.scopedContextKeyService),n=N.Vq.bindTo(this.scopedContextKeyService),r=N.mA.bindTo(this.scopedContextKeyService),s=N.sp.bindTo(this.scopedContextKeyService),a=new C.XK,d=()=>{a.clear();const l=this.model.activeEditor;l?(e.set(l.isDirty()&&!l.isSaving()),a.value=l.onDidChangeDirty(()=>{e.set(l.isDirty()&&!l.isSaving())})):e.set(!1)};this._register(this.onDidModelChange(l=>{switch(l.kind){case 2:s.set(this.isLocked);break;case 6:case 4:case 3:case 5:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case 9:l.editor&&l.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case 10:l.editor&&l.editor===this.model.activeEditor&&n.set(this.model.isSticky(this.model.activeEditor))}r.set(this.count)})),this._register(this.onDidActiveEditorChange(()=>{d()})),d()}registerContainerListeners(){this._register((0,g.nm)(this.element,g.tw.DBLCLICK,e=>{this.isEmpty&&(g.zB.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:x.Cr.id}},this.id))})),this._register((0,g.nm)(this.element,g.tw.AUXCLICK,e=>{this.isEmpty&&1===e.button&&(g.zB.stop(e,!0),this.accessor.removeGroup(this))}))}createContainerToolbar(){const e=document.createElement("div");e.classList.add("editor-group-container-toolbar"),this.element.appendChild(e);const t=this._register(new qe.o(e,{ariaLabel:(0,p.NC)("ariaLabelGroupActions","Empty editor group actions")})),i=this._register(this.menuService.createMenu(v.eH.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{const n={primary:[],secondary:[]};this.containerToolBarMenuDisposable.value=(0,C.OF)(()=>t.clear()),(0,Be.vr)(i,{arg:{groupId:this.id},shouldForwardArgs:!0},n,"navigation");for(const r of[...n.primary,...n.secondary]){const s=this.keybindingService.lookupKeybinding(r.id);t.push(r,{icon:!0,label:!1,keybinding:s?.getLabel()})}};o(),this._register(i.onDidChange(o))}createContainerContextMenu(){this._register((0,g.nm)(this.element,g.tw.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register((0,g.nm)(this.element,ae.t.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;if(e instanceof MouseEvent){const i=new ct.nV(e);t={x:i.posx,y:i.posy}}this.contextMenuService.showContextMenu({menuId:v.eH.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>{this.focus()}})}doTrackFocus(){const e=this._register((0,g.go)(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));const t=i=>{let o;if(i instanceof MouseEvent){if(0!==i.button||F.dz&&i.ctrlKey)return;o=i.target}else o=i.initialTarget;(0,g.Fx)(o,"monaco-action-bar",this.titleContainer)||(0,g.Fx)(o,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register((0,g.nm)(this.titleContainer,g.tw.MOUSE_DOWN,i=>t(i))),this._register((0,g.nm)(this.titleContainer,ae.t.Tap,i=>t(i))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",(0,p.NC)("emptyEditorGroup","{0} (empty)",this.label))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs",this.accessor.partOptions.showTabs),this.titleContainer.classList.toggle("show-file-icons",this.accessor.partOptions.showIcons)}createTitleAreaControl(){return this.titleAreaControl&&(this.titleAreaControl.dispose(),(0,g.PO)(this.titleContainer)),this.titleAreaControl=this.scopedInstantiationService.createInstance(this.accessor.partOptions.showTabs?Rt:Od,this.titleContainer,this.accessor,this),this.titleAreaControl}restoreEditors(e){if(0===this.count)return;let t;t=e instanceof yi?(0,Dt.J8)(e):Object.create(null);const i=this.model.activeEditor;if(!i)return;t.pinned=this.model.isPinned(i),t.sticky=this.model.isSticky(i),t.preserveFocus=!0;const o=document.activeElement;return this.doShowEditor(i,{active:!0,isNew:!1},t).then(()=>{this.accessor.activeGroup===this&&o===document.activeElement&&this.focus()})}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.accessor.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.accessor.onDidVisibilityChange(e=>this.onDidVisibilityChange(e)))}onDidGroupModelChange(e){if(this._onDidModelChange.fire(e),e.editor)switch(e.kind){case 3:(0,Ii.$X)(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case 4:(0,Ii.VL)(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case 12:this.onWillDisposeEditor(e.editor);break;case 11:this.onDidChangeEditorDirty(e.editor);break;case 7:this.onDidChangeEditorLabel(e.editor)}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,o){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o});const n=[e];e instanceof It.h&&n.push(e.primary,e.secondary);for(const r of n)this.canDispose(r)&&r.dispose();this.telemetryService.publicLog("editorClosed",this.toEditorTelemetryDescriptor(e)),this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o})}canDispose(e){for(const t of this.accessor.groups)if(t instanceof yi&&t.model.contains(e,{strictEquals:!0,supportSideBySide:x.YX.ANY}))return!1;return!0}toEditorTelemetryDescriptor(e){const t=e.getTelemetryDescriptor(),i=x.zK.getOriginalUri(e),o=i?i.scheme===Me.lg.file?i.fsPath:i.path:void 0;if(i&&o){let n=(0,J.DZ)(i);const r=n.indexOf("?");return n=-1!==r?n.substr(0,r):n,t.resource={mimeType:new Fs.NE((0,Hd.hm)(i).join(", ")),scheme:i.scheme,ext:n,path:(0,di.vp)(o)},t}return t}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t;const i=[];for(const o of e)this.model.isActive(o)?t=o:this.model.contains(o)&&i.push(o);for(const o of i)this.doCloseEditor(o,!1);t&&this.doCloseEditor(t,!1)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),e.oldPartOptions.showTabs!==e.newPartOptions.showTabs?(this.createTitleAreaControl(),this.relayout(),this.model.activeEditor&&this.titleAreaControl.openEditor(this.model.activeEditor)):this.titleAreaControl.updateOptions(e.oldPartOptions,e.newPartOptions),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleAreaControl.updateEditorDirty(e)}onDidChangeEditorLabel(e){this.titleAreaControl.updateEditorLabel(e)}onDidVisibilityChange(e){this.editorPane.setVisible(e)}get index(){return this._index}get label(){return(0,p.NC)("groupLabel","Group {0}",this._index+1)}get ariaLabel(){return(0,p.NC)("groupAriaLabel","Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return 0===this.count}get titleHeight(){return this.titleAreaControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}setActive(e){this.active=e,this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleAreaControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get editors(){return this.model.getEditors(1)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){return this.editorPane?(0,A.f6)(this.editorPane.activeEditorPane):void 0}get activeEditor(){return this.model.activeEditor}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){const i=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(1).filter(o=>{if(o.resource&&(0,J.Xy)(o.resource,i))return!0;if(t?.supportSideBySide===x.YX.PRIMARY||t?.supportSideBySide===x.YX.ANY){const n=x.zK.getCanonicalUri(o,{supportSideBySide:x.YX.PRIMARY});if(n&&(0,J.Xy)(n,i))return!0}if(t?.supportSideBySide===x.YX.SECONDARY||t?.supportSideBySide===x.YX.ANY){const n=x.zK.getCanonicalUri(o,{supportSideBySide:x.YX.SECONDARY});if(n&&(0,J.Xy)(n,i))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(e=this.activeEditor||void 0){if(e&&!this.model.isPinned(e)){const t=this.model.pin(e);t&&this.titleAreaControl.pinEditor(t)}}stickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!0)}unstickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){const i=this.getIndexOfEditor(e),o=t?this.model.stick(e):this.model.unstick(e);if(!o)return;const n=this.getIndexOfEditor(o);n!==i&&this.titleAreaControl.moveEditor(o,i,n),t?this.titleAreaControl.stickEditor(o):this.titleAreaControl.unstickEditor(o)}}openEditor(e,t){var i=this;return(0,w.Z)(function*(){return i.doOpenEditor(e,t,{supportSideBySide:x.YX.BOTH})})()}doOpenEditor(e,t,i){var o=this;return(0,w.Z)(function*(){if(!e||e.isDisposed())return;o._onWillOpenEditor.fire({editor:e,groupId:o.id});const n=t?.sticky||!o.accessor.partOptions.enablePreview||e.isDirty()||(t?.pinned??"number"==typeof t?.index)||"number"==typeof t?.index&&o.model.isSticky(t.index)||e.hasCapability(512),r={index:t?t.index:void 0,pinned:n,sticky:t?.sticky||"number"==typeof t?.index&&o.model.isSticky(t.index),active:0===o.count||!t||!t.inactive,supportSideBySide:i?.supportSideBySide};t?.sticky&&"number"==typeof t?.index&&!o.model.isSticky(t.index)&&(r.sticky=!1),!r.active&&!r.pinned&&o.model.activeEditor&&!o.model.isPinned(o.model.activeEditor)&&(r.active=!0);let s=!1,a=!1;if(t?.activation===Qe.kn.ACTIVATE?s=!0:t?.activation===Qe.kn.RESTORE?a=!0:t?.activation===Qe.kn.PRESERVE?(s=!1,a=!1):r.active&&(s=!t||!t.preserveFocus,a=!s),"number"==typeof r.index){const f=o.model.indexOf(e);-1!==f&&f!==r.index&&o.doMoveEditorInsideGroup(e,r)}const{editor:d,isNew:l}=o.model.openEditor(e,r);l&&1===o.count&&o.accessor.groups.length>1&&d.editorId&&o.accessor.partOptions.autoLockGroups?.has(d.editorId)&&o.lock(!0);const u=o.doShowEditor(d,{active:!!r.active,isNew:l},t,i);return s?o.accessor.activateGroup(o):a&&o.accessor.restoreGroup(o),u})()}doShowEditor(e,t,i,o){var n=this;let r;return r=t.active?(0,w.Z)(function*(){const{pane:s,changed:a,cancelled:d,error:l}=yield n.editorPane.openEditor(e,i,{newInGroup:t.isNew});if(!d)return a&&n._onDidActiveEditorChange.fire({editor:e}),l&&n._onDidOpenEditorFail.fire(e),s||n.activeEditor!==e||n.doCloseEditor(e,!i||!i.preserveFocus,{fromError:!0}),s})():Promise.resolve(void 0),o?.skipTitleUpdate||this.titleAreaControl.openEditor(e),r}openEditors(e){var t=this;return(0,w.Z)(function*(){const i=(0,L.kX)(e).filter(({editor:a})=>!a.isDisposed()),o=(0,L.Xh)(i);if(!o)return;const n={supportSideBySide:x.YX.BOTH};yield t.doOpenEditor(o.editor,o.options,n);const r=i.slice(1),s=t.getIndexOfEditor(o.editor)+1;return yield Ve.jT.settled(r.map(({editor:a,options:d},l)=>t.doOpenEditor(a,{...d,inactive:!0,pinned:!0,index:s+l},{...n,skipTitleUpdate:!0}))),t.titleAreaControl.openEditors(r.map(({editor:a})=>a)),(0,A.f6)(t.editorPane.activeEditorPane)})()}moveEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:n}of e)this.moveEditor(o,t,n,i);if(i.skipTitleUpdate){const o=e.map(({editor:n})=>n);t.titleAreaControl.openEditors(o),this.titleAreaControl.closeEditors(o)}}moveEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!1})}doMoveEditorInsideGroup(e,t){const i=t?t.index:void 0;if("number"!=typeof i)return;const o=this.model.indexOf(e);if(-1===o||o===i)return;const n=this.model.getEditorByIndex(o);n&&(this.model.moveEditor(n,i),this.model.pin(n),this.titleAreaControl.moveEditor(n,o,i),this.titleAreaControl.pinEditor(n))}doMoveOrCopyEditorAcrossGroups(e,t,i,o){const n=o?.keepCopy,r=(0,Dt.J8)(this,e,{...i,pinned:!0,sticky:!n&&this.model.isSticky(e)});n||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(n?e.copy():e,r,o),n||this.doCloseEditor(e,!1,{...o,context:x.Bb.MOVE})}copyEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:n}of e)this.copyEditor(o,t,n,i);if(i.skipTitleUpdate){const o=e.map(({editor:n})=>n);t.titleAreaControl.openEditors(o)}}copyEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!0})}closeEditor(e=this.activeEditor||void 0,t){var i=this;return(0,w.Z)(function*(){return i.doCloseEditorWithConfirmationHandling(e,t)})()}doCloseEditorWithConfirmationHandling(e=this.activeEditor||void 0,t,i){var o=this;return(0,w.Z)(function*(){return!(!e||(yield o.handleCloseConfirmation([e]))||(o.doCloseEditor(e,!t?.preserveFocus&&void 0,i),0))})()}doCloseEditor(e,t=this.accessor.activeGroup===this,i){i?.skipTitleUpdate||this.titleAreaControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),i?.skipTitleUpdate||this.titleAreaControl.closeEditor(e)}doCloseActiveEditor(e=this.accessor.activeGroup===this,t){const i=this.activeEditor,o=this.shouldRestoreFocus(this.element),n=this.accessor.partOptions.closeEmptyGroups;if(n&&this.active&&1===this.count){const a=this.accessor.getGroups(1)[1];a&&(o?a.focus():this.accessor.activateGroup(a))}i&&this.model.closeEditor(i,t?.context);const r=this.model.activeEditor;if(r){const s=!e;let a;s&&this.accessor.activeGroup!==this&&(a=Qe.kn.PRESERVE),this.doOpenEditor(r,{preserveFocus:s,activation:a,ignoreError:t?.fromError})}else i&&this.editorPane.closeEditor(i),o&&!n&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),n&&this.accessor.removeGroup(this)}shouldRestoreFocus(e){const t=document.activeElement;return t===document.body||(0,g.jg)(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,t?.context)}handleCloseConfirmation(e){var t=this;return(0,w.Z)(function*(){if(!e.length)return!1;const i=e.shift();let n,o=t.mapEditorToPendingConfirmation.get(i);o||(o=t.doHandleCloseConfirmation(i),t.mapEditorToPendingConfirmation.set(i,o));try{n=yield o}finally{t.mapEditorToPendingConfirmation.delete(i)}return n||t.handleCloseConfirmation(e)})()}doHandleCloseConfirmation(e,t){var i=this;return(0,w.Z)(function*(){if(!i.shouldConfirmClose(e)||e instanceof It.h&&i.model.contains(e.primary)||i.accessor.groups.some(s=>{if(s===i)return!1;const a=s;return!!(a.contains(e,{supportSideBySide:x.YX.BOTH})||e instanceof It.h&&a.contains(e.primary))}))return!1;let o=2,n=1,r=!1;if(!e.hasCapability(4)&&!t?.skipAutoSave&&!e.closeHandler&&(3===i.filesConfigurationService.getAutoSaveMode()?(r=!0,o=0,n=3):F.tY&&(F.ED||F.IJ)&&4===i.filesConfigurationService.getAutoSaveMode()&&(r=!0,o=0,n=4)),!r)if((!i.activeEditor||!i.activeEditor.matches(e))&&(yield i.doOpenEditor(e)),"function"==typeof e.closeHandler?.confirm)o=yield e.closeHandler.confirm([{editor:e,groupId:i.id}]);else{let s;s=e instanceof It.h?e.primary.getName():e.getName(),o=yield i.fileDialogService.showSaveConfirm([s])}if(!e.closeHandler&&!i.shouldConfirmClose(e))return 2===o;switch(o){case 0:return!(yield e.save(i.id,{reason:n}))&&r?i.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case 1:try{return yield e.revert(i.id),e.isDirty()}catch(s){return i.logService.error(s),yield e.revert(i.id,{soft:!0}),e.isDirty()}case 2:return!0}})()}shouldConfirmClose(e){return e.closeHandler?e.closeHandler.showConfirm():e.isDirty()&&!e.isSaving()}closeEditors(e,t){var i=this;return(0,w.Z)(function*(){if(i.isEmpty)return!0;const o=i.doGetEditorsToClose(e);return!(yield i.handleCloseConfirmation(o.slice(0)))&&(i.doCloseEditors(o,t),!0)})()}doGetEditorsToClose(e){if(Array.isArray(e))return e;const t=e,i="number"==typeof t.direction;let o=this.model.getEditors(i?1:0,t);return t.savedOnly?o=o.filter(n=>!n.isDirty()||n.isSaving()):i&&t.except?o=0===t.direction?o.slice(0,this.model.indexOf(t.except,o)):o.slice(this.model.indexOf(t.except,o)+1):t.except&&(o=o.filter(n=>t.except&&!n.matches(t.except))),o}doCloseEditors(e,t){let i=!1;for(const o of e)this.isActive(o)?i=!0:this.doCloseInactiveEditor(o);i&&this.doCloseActiveEditor(!t?.preserveFocus&&void 0),e.length&&this.titleAreaControl.closeEditors(e)}closeAllEditors(e){var t=this;return(0,w.Z)(function*(){return t.isEmpty?(t.accessor.partOptions.closeEmptyGroups&&t.accessor.removeGroup(t),!0):!(yield t.handleCloseConfirmation(t.model.getEditors(0,e)))&&(t.doCloseAllEditors(e),!0)})()}doCloseAllEditors(e){const t=[];for(const i of this.model.getEditors(1,e))this.isActive(i)||this.doCloseInactiveEditor(i),t.push(i);this.activeEditor&&t.includes(this.activeEditor)&&this.doCloseActiveEditor(),t.length&&this.titleAreaControl.closeEditors(t)}replaceEditors(e){var t=this;return(0,w.Z)(function*(){let i;const o=[];for(let{editor:n,replacement:r,forceReplaceDirty:s,options:a}of e){const d=t.getIndexOfEditor(n);if(d>=0){const l=t.isActive(n);a?a.index=d:a={index:d},a.inactive=!l,a.pinned=a.pinned??!0;const u={editor:n,replacement:r,forceReplaceDirty:s,options:a};l?i=u:o.push(u)}}for(const{editor:n,replacement:r,forceReplaceDirty:s,options:a}of o)if(yield t.doOpenEditor(r,a),!n.matches(r)){let d=!1;if(s?(t.doCloseEditor(n,!1,{context:x.Bb.REPLACE}),d=!0):d=yield t.doCloseEditorWithConfirmationHandling(n,{preserveFocus:!0},{context:x.Bb.REPLACE}),!d)return}if(i){const n=t.doOpenEditor(i.replacement,i.options);i.editor.matches(i.replacement)||(i.forceReplaceDirty?t.doCloseEditor(i.editor,!1,{context:x.Bb.REPLACE}):yield t.doCloseEditorWithConfirmationHandling(i.editor,{preserveFocus:!0},{context:x.Bb.REPLACE})),yield n}})()}get isLocked(){return 1!==this.accessor.groups.length&&this.model.isLocked}lock(e){1===this.accessor.groups.length&&(e=!1),this.model.lock(e)}updateStyles(){const e=this.isEmpty;this.element.style.backgroundColor=e&&this.getColor(I.AQ)||"";const t=this.getColor(I.DI)||this.getColor(Y.lRK);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));const{showTabs:i}=this.accessor.partOptions;this.titleContainer.style.backgroundColor=this.getColor(i?I.Fk:I.Yq)||"",this.editorContainer.style.backgroundColor=this.getColor(Y.cvW)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return!this.lastLayout||!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight)}layout(e,t,i,o){this.lastLayout={width:e,height:t,top:i,left:o},this.element.classList.toggle("max-height-478px",t<=478);const n=this.titleAreaControl.layout({container:new g.Ro(e,t),available:new g.Ro(e,t-this.editorPane.minimumHeight)}),r=Math.max(0,t-n.height);this.editorContainer.style.height=`${r}px`,this.editorPane.layout({width:e,height:r,top:i+n.height,left:o})}relayout(){if(this.lastLayout){const{width:e,height:t,top:i,left:o}=this.lastLayout;this.layout(e,t,i,o)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),this.titleAreaControl.dispose(),super.dispose()}};Ti=(0,h.gn)([(0,h.fM)(3,R.TG),(0,h.fM)(4,y.i6),(0,h.fM)(5,K.XE),(0,h.fM)(6,Ue.bU),(0,h.fM)(7,Se.d),(0,h.fM)(8,v.co),(0,h.fM)(9,ge.i),(0,h.fM)(10,ki.Z$),(0,h.fM)(11,U.AR),(0,h.fM)(12,Wo.LM),(0,h.fM)(13,$i.v),(0,h.fM)(14,Ae.VZ)],Ti),(0,ve.Z)("#monaco-workbench-editor-drop-overlay{height:100%;left:0;position:absolute;width:100%;z-index:10000}#monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{align-items:center;display:flex;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;top:0;width:100%}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{line-height:normal;margin:.2em;opacity:0;padding:.6em;text-align:center}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt i{background-color:hsla(0,0%,100%,.05);border:1px solid hsla(0,0%,80%,.4);border-radius:5px;font-style:normal;margin:0 1px;padding:0 8px}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator.overlay-move-transition{transition:top 70ms ease-out,left 70ms ease-out,width 70ms ease-out,height 70ms ease-out,opacity .15s ease-out}",{});var Jd=m(44492);function Us(c){return c.getValue("editor.dropIntoEditor.enabled")}function Ks(c){return c.shiftKey}let Go=class ja extends K.bB{get disposed(){return!!this._disposed}constructor(e,t,i,o,n,r,s,a,d){super(i),this.accessor=e,this.groupView=t,this.configurationService=o,this.instantiationService=n,this.editorService=r,this.editorGroupService=s,this.treeViewsDragAndDropService=a,this.contextService=d,this.editorTransfer=Ke.Ej.getInstance(),this.groupTransfer=Ke.Ej.getInstance(),this.treeItemsTransfer=Ke.Ej.getInstance(),this.cleanupOverlayScheduler=this._register(new Ve.pY(()=>this.dispose(),300)),this.enableDropIntoEditor=Us(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){const e=this.getOverlayOffsetHeight(),t=this.container=document.createElement("div");t.id=ja.OVERLAY_ID,t.style.top=`${e}px`,this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register((0,C.OF)(()=>{this.groupView.element.removeChild(t),this.groupView.element.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=(0,Jd.BO)((0,p.NC)("dropIntoEditorPrompt","Hold __{0}__ to drop into editor",F.dz?"\u21e7":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){const e=(0,A.cW)(this.overlay);e.style.backgroundColor=this.getColor(I.Xv)||"";const t=this.getColor(Y.xL1);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){this.dropIntoPromptElement.style.backgroundColor=this.getColor(I.MB)??"",this.dropIntoPromptElement.style.color=this.getColor(I.jp)??"";const i=this.getColor(I.tp);i?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=i):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new g.eg(e,{onDragEnter:t=>{},onDragOver:t=>{if(this.enableDropIntoEditor&&Ks(t))return void this.dispose();const i=this.groupTransfer.hasData(B.r8.prototype),o=this.editorTransfer.hasData(B.L5.prototype);!o&&!i&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy");let n=!0;if(i)n=this.isCopyOperation(t);else if(o){const s=this.editorTransfer.getData(B.L5.prototype);Array.isArray(s)&&(n=this.isCopyOperation(t,s[0].identifier))}if(!n){const s=this.findSourceGroupView();if(s===this.groupView&&(i||o&&s.count<2))return void this.hideOverlay()}let r=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(t)&&(r=!r),this.positionOverlay(t.offsetX,t.offsetY,i,r),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:t=>this.dispose(),onDragEnd:t=>this.dispose(),onDrop:t=>{g.zB.stop(t,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(t,this.currentDropOperation.splitDirection)}})),this._register((0,g.nm)(e,g.tw.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){return!!this.groupView.activeEditor?.hasCapability(128)}findSourceGroupView(){if(this.groupTransfer.hasData(B.r8.prototype)){const e=this.groupTransfer.getData(B.r8.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(B.L5.prototype)){const e=this.editorTransfer.getData(B.L5.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier.groupId)}}handleDrop(e,t){var i=this;return(0,w.Z)(function*(){const o=()=>{let n;return n="number"==typeof t?i.accessor.addGroup(i.groupView,t):i.groupView,n};if(i.groupTransfer.hasData(B.r8.prototype)){const n=i.groupTransfer.getData(B.r8.prototype);if(Array.isArray(n)){const r=i.accessor.getGroup(n[0].identifier);if(r){if("number"!=typeof t&&r===i.groupView)return;let s;if("number"==typeof t)s=i.isCopyOperation(e)?i.accessor.copyGroup(r,i.groupView,t):i.accessor.moveGroup(r,i.groupView,t);else{let a;i.isCopyOperation(e)&&(a={mode:0}),i.accessor.mergeGroup(r,i.groupView,a)}s&&i.accessor.activateGroup(s)}i.groupTransfer.clearData(B.r8.prototype)}}else if(i.editorTransfer.hasData(B.L5.prototype)){const n=i.editorTransfer.getData(B.L5.prototype);if(Array.isArray(n)){const r=n[0].identifier,s=o(),a=i.accessor.getGroup(r.groupId);if(a){if(a===s)return;const d=(0,Dt.J8)(a,r.editor,{pinned:!0,sticky:a.isSticky(r.editor)});i.isCopyOperation(e,r)?a.copyEditor(r.editor,s,d):a.moveEditor(r.editor,s,d),s.focus()}i.editorTransfer.clearData(B.L5.prototype)}}else if(i.treeItemsTransfer.hasData(At.f.prototype)){const n=i.treeItemsTransfer.getData(At.f.prototype);if(Array.isArray(n)){const r=[];for(const s of n){const a=yield i.treeViewsDragAndDropService.removeDragOperationTransfer(s.identifier);if(a){const d=yield(0,B.W$)(a);r.push(...d.map(l=>({...l,options:{...l.options,pinned:!0}})))}}r.length&&i.editorService.openEditors(r,o(),{validateTrust:!0})}i.treeItemsTransfer.clearData(At.f.prototype)}else i.instantiationService.createInstance(B.n5,{allowWorkspaceOpen:!F.$L||(0,ce.gC)(i.contextService.getWorkspace())}).handleDrop(e,()=>o(),r=>r?.focus())})()}isCopyOperation(e,t){return!t?.editor.hasCapability(8)&&(e.ctrlKey&&!F.dz||e.altKey&&F.dz)}isToggleSplitOperation(e){return e.altKey&&!F.dz||e.shiftKey&&F.dz}positionOverlay(e,t,i,o){const n="right"===this.accessor.partOptions.openSideBySideDirection,r=this.groupView.element.clientWidth,s=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();let a,d;o?(a=i&&n?.3:.1,d=i?n?.1:.3:.1):(a=0,d=0);const l=r*a,u=s*d,f=r/3,b=s/3;let E;switch(E=e>l&&e<r-l&&t>u&&t<s-u?void 0:n?e<f?2:e>2*f?3:t<s/2?0:1:t<b?0:t>2*b?1:e<r/2?2:3,E){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 1:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case 3:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}const k=(0,A.cW)(this.overlay);k.style.opacity="1",setTimeout(()=>k.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:E}}doPositionOverlay(e){const[t,i]=(0,A.ld)(this.container,this.overlay),o=this.getOverlayOffsetHeight();t.style.height=o?`calc(100% - ${o}px)`:"100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return!this.groupView.isEmpty&&this.accessor.partOptions.showTabs?this.groupView.titleHeight.offset:0}hideOverlay(){const e=(0,A.cW)(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}};Go.OVERLAY_ID="monaco-workbench-editor-drop-overlay",Go=(0,h.gn)([(0,h.fM)(2,K.XE),(0,h.fM)(3,G.Ui),(0,h.fM)(4,R.TG),(0,h.fM)(5,U.AR),(0,h.fM)(6,te.Qw),(0,h.fM)(7,Un.m),(0,h.fM)(8,ce.ec)],Go);let jn=class extends K.bB{constructor(e,t,i,o,n,r){super(o),this.accessor=e,this.container=t,this.delegate=i,this.configurationService=n,this.instantiationService=r,this.counter=0,this.editorTransfer=Ke.Ej.getInstance(),this.groupTransfer=Ke.Ej.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register((0,g.nm)(this.container,g.tw.DRAG_ENTER,e=>this.onDragEnter(e))),this._register((0,g.nm)(this.container,g.tw.DRAG_LEAVE,()=>this.onDragLeave())),[this.container,window].forEach(e=>this._register((0,g.nm)(e,g.tw.DRAG_END,()=>this.onDragEnd())))}onDragEnter(e){if(Us(this.configurationService)&&Ks(e))return;if(this.counter++,!this.editorTransfer.hasData(B.L5.prototype)&&!this.groupTransfer.hasData(B.r8.prototype)&&e.dataTransfer){const i=me.B.as(Ke.IP.DragAndDropContribution).getAll(),o=Array.from(i).map(n=>n.dataFormatKey);if(!(0,Ke.Mq)(e,gi.go.FILES,Ke.Km.FILES,gi.go.RESOURCES,Ke.Km.EDITORS,...o))return void(e.dataTransfer.dropEffect="none")}this.updateContainer(!0);const t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){const i=this.findTargetGroupView(t);i&&(this._overlay=this.instantiationService.createInstance(Go,this.accessor,i))}}onDragLeave(){this.counter--,0===this.counter&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.accessor.groups.find(i=>(0,g.jg)(e,i.element)||this.delegate.containsGroup?.(i))}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};jn=(0,h.gn)([(0,h.fM)(3,K.XE),(0,h.fM)(4,G.Ui),(0,h.fM)(5,R.TG)],jn);const ji={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},Xn={type:"distribute"};function Zs(c){const e=(0,g.$)(".centered-layout-margin");return e.style.height="100%",c&&(e.style.backgroundColor=c.toString()),{element:e,layout:()=>{},minimumSize:60,maximumSize:Number.POSITIVE_INFINITY,onDidChange:S.ju.None}}class el{constructor(e,t,i={...ji}){this.container=e,this.view=t,this.state=i,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new C.SL,this.centeredLayoutFixedWidth=!0,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,o){this.lastLayoutPosition={width:e,height:t,top:i,left:o},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,o),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){const e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{const e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){if(e!==this.isActive())if(e){this.container.removeChild(this.view.element),this.splitView=new Re.z(this.container,{inverseAltBehavior:!0,orientation:1,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state={...ji},this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);const t=this.style?this.style.background:void 0;this.emptyViews=[Zs(t),Zs(t)],this.splitView.addView(this.emptyViews[0],Xn,0),this.splitView.addView(function qd(c,e){return{element:c.element,get maximumSize(){return c.maximumWidth},get minimumSize(){return c.minimumWidth},onDidChange:S.ju.map(c.onDidChange,t=>t&&t.width),layout:(t,i,o)=>c.layout(t,e(),o?.top??0,(o?.left??0)+i)}}(this.view,()=>this.lastLayoutPosition.height),Xn,1),this.splitView.addView(this.emptyViews[1],Xn,2),this.resizeSplitViews()}else this.splitView&&this.container.removeChild(this.splitView.el),this.splitViewDisposables.clear(),this.splitView?.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===ji.targetWidth:e.leftMarginRatio===ji.leftMarginRatio&&e.rightMarginRatio===ji.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView.dispose(),this.splitView=void 0)}}function zo(c,e,t){const i=c.get(te.Qw),n=function tl(c,e,t,i){let o;const n=(0,x.uc)(c)?c.editor:c,r=c.options;if(e&&"number"!=typeof e)o=e;else if("number"==typeof e&&e>=0)o=t.getGroup(e);else if(e===U.O3){const s=(0,te.Nl)(i);let a=t.findGroup({direction:s});(!a||Uo(a,n))&&(a=t.addGroup(t.activeGroup,s)),o=a}else if(!r||"number"!=typeof r.index){const s=t.getGroups(1);if(r?.revealIfVisible)for(const a of s)if(il(a,n)){o=a;break}if(!o&&(r?.revealIfOpened||i.getValue("workbench.editor.revealIfOpen")||(0,x.Xl)(n)&&n.hasCapability(8))){let a,d;for(const l of s)if($s(l,n)&&(d||(d=l),!a&&l.isActive(n)&&(a=l)),d&&a)break;o=a||d}}if(!o){let s=t.activeGroup;if(Uo(s,n)){for(const a of t.getGroups(1))if(!Uo(a,n)){s=a;break}o=Uo(s,n)?t.addGroup(s,(0,te.Nl)(i)):s}else o=s}return o}(e,t,i,c.get(G.Ui));let r;return i.activeGroup!==n&&e.options&&!e.options.inactive&&e.options.preserveFocus&&"number"!=typeof e.options.activation&&t!==U.O3&&(r=Qe.kn.ACTIVATE),[n,r]}function Uo(c,e){return!(!c.isLocked||$s(c,e))}function il(c,e){return!!c.activeEditor&&c.activeEditor.matches(e)}function $s(c,e){for(const t of c.editors)if(t.matches(e))return!0;return!1}class ol{constructor(){this.element=(0,g.$)(".grid-view-container"),this._onDidChange=new S.ZD,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:Number.POSITIVE_INFINITY}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:Number.POSITIVE_INFINITY}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.innerText="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=S.ju.None,this._gridWidget=e}layout(e,t,i,o){this.gridWidget?.layout(e,t,i,o)}dispose(){this._onDidChange.dispose()}}let Xi=class oi extends yo{constructor(e,t,i,o,n){super("workbench.parts.editor",{hasTitle:!1},t,o,n),this.instantiationService=e,this.configurationService=i,this._onDidLayout=this._register(new S.Q5),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new S.Q5),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new S.Q5),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new S.Q5),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidActivateGroup=this._register(new S.Q5),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new S.Q5),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new S.Q5),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new S.Q5),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new S.Q5),this._onDidChangeSizeConstraints=this._register(new S.ZD),this.onDidChangeSizeConstraints=S.ju.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new S.ZD),this.onDidScroll=S.ju.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new S.Q5),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this.workspaceMemento=this.getMemento(1,1),this.profileMemento=this.getMemento(0,1),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.gridWidgetView=this._register(new ol),this.enforcedPartOptions=[],this._partOptions=(0,Dt._b)(this.configurationService,this.themeService),this._top=0,this._left=0,this.sideGroup={openEditor:(r,s)=>{const[a]=this.instantiationService.invokeFunction(d=>zo(d,{editor:r,options:s},U.O3));return a.openEditor(r,s)}},this._isReady=!1,this.whenReadyPromise=new Ve.CR,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new Ve.CR,this.whenRestored=this.whenRestoredPromise.p,this.priority=2,this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions()))}onConfigurationUpdated(e){(0,Dt.fj)(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){const e=this._partOptions,t=(0,Dt._b)(this.configurationService,this.themeService);for(const i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),(0,C.OF)(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&0===this.gridWidget.orientation?1:0}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[oi.EDITOR_PART_UI_STATE_STORAGE_KEY]}getGroups(e=0){switch(e){case 0:return this.groups;case 1:{const t=(0,L.kX)(this.mostRecentActiveGroups.map(i=>this.getGroup(i)));return(0,L.EB)([...t,...this.groups])}case 2:{const t=[];return this.gridWidget&&this.fillGridNodes(t,this.gridWidget.getViews()),t}}}fillGridNodes(e,t){ui(t)?t.children.forEach(i=>this.fillGridNodes(e,i)):e.push(t.view)}getGroup(e){return this.groupViews.get(e)}findGroup(e,t=this.activeGroup,i){if("number"==typeof e.direction)return this.doFindGroupByDirection(e.direction,t,i);if("number"==typeof e.location)return this.doFindGroupByLocation(e.location,t,i);throw new Error("invalid arguments")}doFindGroupByDirection(e,t,i){const o=this.assertGroupView(t),n=this.gridWidget.getNeighborViews(o,this.toGridViewDirection(e),i);return n.sort((r,s)=>this.mostRecentActiveGroups.indexOf(r.id)-this.mostRecentActiveGroups.indexOf(s.id)),n[0]}doFindGroupByLocation(e,t,i){const o=this.assertGroupView(t),n=this.getGroups(2),r=n.indexOf(o);switch(e){case 0:return n[0];case 1:return n[n.length-1];case 2:{let s=n[r+1];return!s&&i&&(s=this.doFindGroupByLocation(0,t)),s}case 3:{let s=n[r-1];return!s&&i&&(s=this.doFindGroupByLocation(1,t)),s}}}activateGroup(e){const t=this.assertGroupView(e);return this.doSetGroupActive(t),this._onDidActivateGroup.fire(t),t}restoreGroup(e){const t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){const t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){const i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e,t=this.activeGroup){if(!(this.count<2)&&this.gridWidget)switch(e){case 1:this.gridWidget.distributeViewSizes();break;case 0:this.gridWidget.maximizeViewSize(t);break;case 2:this.isGroupMaximized(t)?this.arrangeGroups(1):this.arrangeGroups(0)}}isGroupMaximized(e){return this.gridWidget.isViewSizeMaximized(e)}setGroupOrientation(e){if(!this.gridWidget)return;const t=0===e?1:0;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){const t=this.shouldRestoreFocus(this.container);let i=0;!function o(a){for(const d of a)Array.isArray(d.groups)?o(d.groups):i++}(e.groups);let n=this.getGroups(2);if(i<n.length){const a=n[i-1];n.forEach((d,l)=>{l>=i&&this.mergeGroup(d,a)}),n=this.getGroups(2)}const r=this.activeGroup,s=Ms({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:kt(this.gridWidget.orientation)),groups:e.groups});this.doCreateGridControlWithState(s,r.id,n),this.doLayout(this._contentDimension),this.updateContainer();for(const a of this.getGroups(2))n.includes(a)||this._onDidAddGroup.fire(a);this.notifyGroupIndexChange(),t&&this._activeGroup.focus()}getLayout(){const e=this.gridWidget.serialize();return{orientation:1===e.orientation?0:1,groups:this.serializedNodeToGroupLayoutArgument(e.root).groups}}serializedNodeToGroupLayoutArgument(e){return"branch"===e.type?{size:e.size,groups:e.data.map(t=>this.serializedNodeToGroupLayoutArgument(t))}:{size:e.size}}shouldRestoreFocus(e){if(!e)return!1;const t=document.activeElement;return t===document.body||(0,g.jg)(t,e)}isTwoDimensionalGrid(){const e=this.gridWidget.getViews();return!!ui(e)&&e.children.some(t=>ui(t))}addGroup(e,t,i){const o=this.assertGroupView(e),n=this.doAddGroup(o,t);return i?.activate&&this.doSetGroupActive(n),n}doAddGroup(e,t,i){const o=this.groupViews.size>1&&this.isGroupMaximized(e),n=this.doCreateGroupView(i);return this.gridWidget.addView(n,this.getSplitSizingStyle(),e,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(n),this.notifyGroupIndexChange(),o&&this.arrangeGroups(0,n),n}getSplitSizingStyle(){return"split"===this._partOptions.splitSizing?zi.Split:zi.Distribute}doCreateGroupView(e){let t;t=e instanceof Ti?Ti.createCopy(e,this,this.count,this.instantiationService):(0,Ii.Ti)(e)?Ti.createFromSerialized(e,this,this.count,this.instantiationService):Ti.createNew(this,this.count,this.instantiationService),this.groupViews.set(t.id,t);const i=new C.SL;return i.add(t.onDidFocus(()=>{this.doSetGroupActive(t)})),i.add(t.onDidModelChange(o=>{switch(o.kind){case 2:this._onDidChangeGroupLocked.fire(t);break;case 1:this._onDidChangeGroupIndex.fire(t)}})),i.add(t.onDidActiveEditorChange(()=>{this.updateContainer()})),S.ju.once(t.onWillDispose)(()=>{(0,C.B9)(i),this.groupViews.delete(t.id),this.doUpdateMostRecentActive(t)}),t}doSetGroupActive(e){if(this._activeGroup===e)return;const t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t?.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget){const t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(0,e)}}doUpdateMostRecentActive(e,t){const i=this.mostRecentActiveGroups.indexOf(e.id);-1!==i&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}}toGridViewOrientation(e,t){return"number"==typeof e?0===e?1:0:t}removeGroup(e){const t=this.assertGroupView(e);if(1!==this.count){if(t.isEmpty)return this.doRemoveEmptyGroup(t);this.doRemoveGroupWithEditors(t)}}doRemoveGroupWithEditors(e){const t=this.getGroups(1);let i;i=this._activeGroup===e?t[1]:t[0],this.mergeGroup(e,i)}doRemoveEmptyGroup(e){const t=this.shouldRestoreFocus(this.container);if(this._activeGroup===e){const o=this.getGroups(1)[1];this.activateGroup(o)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),t&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),1===this.count&&(0,L.Xh)(this.groups)?.lock(!1),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){const o=this.assertGroupView(e),n=this.assertGroupView(t);if(o.id===n.id)throw new Error("Cannot move group into its own");const r=this.shouldRestoreFocus(o.element);return this.gridWidget.moveView(o,this.getSplitSizingStyle(),n,this.toGridViewDirection(i)),r&&o.focus(),this._onDidMoveGroup.fire(o),this.notifyGroupIndexChange(),o}copyGroup(e,t,i){const o=this.assertGroupView(e),n=this.assertGroupView(t),r=this.shouldRestoreFocus(o.element),s=this.doAddGroup(n,i,o);return r&&s.focus(),s}mergeGroup(e,t,i){const o=this.assertGroupView(e),n=this.assertGroupView(t),r=[];let s=i&&"number"==typeof i.index?i.index:n.count;for(const a of o.editors){const d=!o.isActive(a)||this._activeGroup!==o,u={index:o.isSticky(a)?void 0:s,inactive:d,preserveFocus:d};r.push({editor:a,options:u}),s++}return 0===i?.mode?o.copyEditors(r,n):o.moveEditors(r,n),o.isEmpty&&!o.disposed&&this.removeGroup(o),n}mergeAllGroups(e=this.activeGroup){for(const t of this.getGroups(1))t!==e&&this.mergeGroup(t,e);return e}assertGroupView(e){let t;if(t="number"==typeof e?this.getGroup(e):e,!t)throw new Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return this.instantiationService.createInstance(jn,this,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions().width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions().height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return"center"===this.layoutService.getPanelAlignment()}get onDidChange(){return S.ju.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(I.pp)||this.theme.getColor(Y.lRK)||jt.Il.transparent}updateStyles(){(0,A.cW)(this.container).style.backgroundColor=this.getColor(Y.cvW)||"";const t={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(I.Qw)||jt.Il.transparent};this.gridWidget.style(t),this.centeredLayoutWidget.styles(t)}createContentArea(e,t){return this.element=e,this.container=document.createElement("div"),this.container.classList.add("content"),e.appendChild(this.container),this.doCreateGridControl(t),this.centeredLayoutWidget=this._register(new el(this.container,this.gridWidgetView,this.profileMemento[oi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY])),this._register(this.onDidChangeEditorPartOptions(i=>this.centeredLayoutWidget.setFixedWidth(i.newPartOptions.centeredLayoutFixedWidth??!1))),this.setupDragAndDropSupport(e,this.container),this.whenReadyPromise.complete(),this._isReady=!0,Ve.jT.settled(this.groups.map(i=>i.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));const i=document.createElement("div");let o,n,r,s;i.classList.add("drop-block-overlay"),e.appendChild(i),this._register((0,g.u0)(i,()=>i.classList.remove("visible"))),this._register(B.Mi.INSTANCE.registerTarget(this.element,{onDragStart:l=>i.classList.add("visible"),onDragEnd:l=>i.classList.remove("visible")}));const a=l=>{this.layoutService.isVisible("workbench.parts.panel")||l!==this.layoutService.getPanelPosition()?!this.layoutService.isVisible("workbench.parts.auxiliarybar")&&l===(1===this.layoutService.getSideBarPosition()?0:1)&&this.layoutService.setPartHidden(!1,"workbench.parts.auxiliarybar"):this.layoutService.setPartHidden(!1,"workbench.parts.panel")},d=()=>{o&&(clearTimeout(o),o=void 0),n&&(clearTimeout(n),n=void 0)};this._register(B.Mi.INSTANCE.registerTarget(i,{onDragOver:l=>{g.zB.stop(l.eventData,!0),l.eventData.dataTransfer&&(l.eventData.dataTransfer.dropEffect="none");const u=i.getBoundingClientRect();let f,b;l.eventData.clientX<u.left+100&&(f=0),l.eventData.clientX>u.right-100&&(f=1),l.eventData.clientY>u.bottom-100&&(b=2),o&&f!==r&&(clearTimeout(o),o=void 0),n&&b!==s&&(clearTimeout(n),n=void 0),!o&&void 0!==f&&(r=f,o=setTimeout(()=>a(f),200)),!n&&void 0!==b&&(s=b,n=setTimeout(()=>a(b),200))},onDragLeave:()=>d(),onDragEnd:()=>d(),onDrop:()=>d()}))}centerLayout(e){this.centeredLayoutWidget.activate(e),this._activeGroup.focus()}isLayoutCentered(){return!!this.centeredLayoutWidget&&this.centeredLayoutWidget.isActive()}doCreateGridControl(e){let t=!1;if((!e||e.restorePreviousState)&&(t=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||t){const i=this.doCreateGroupView();this.doSetGridWidget(new pi(i)),this.doSetGroupActive(i)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){const e=this.workspaceMemento[oi.EDITOR_PART_UI_STATE_STORAGE_KEY];if(e?.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup),this._activeGroup.focus()}catch(t){return(0,Xe.dL)(new Error(`Error restoring editor grid widget: ${t} (with state: ${JSON.stringify(e)})`)),this.groupViews.forEach(i=>i.dispose()),this.groupViews.clear(),this.mostRecentActiveGroups=[],!1}return!0}doCreateGridControlWithState(e,t,i){let o;o=i?i.slice(0):[];const n=[],r=pi.deserialize(e,{fromJSON:s=>{let a;return a=o.length>0?o.shift():this.doCreateGroupView(s),n.push(a),a.id===t&&this.doSetGroupActive(a),a}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(n[0]),this.mostRecentActiveGroups.some(s=>!this.getGroup(s))&&(this.mostRecentActiveGroups=n.map(s=>s.id)),this.doSetGridWidget(r)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.onDidSetGridWidget.fire(void 0)}updateContainer(){(0,A.cW)(this.container).classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(2).forEach((e,t)=>e.notifyIndexChanged(t))}get isEmpty(){return 1===this.count&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,o){this._top=i,this._left=o;const n=super.layoutContents(e,t).contentSize;this.doLayout(g.Ro.lift(n),i,o)}doLayout(e,t=this._top,i=this._left){this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget){const e={serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups};this.isEmpty?delete this.workspaceMemento[oi.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[oi.EDITOR_PART_UI_STATE_STORAGE_KEY]=e}if(this.centeredLayoutWidget){const e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[oi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[oi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}toJSON(){return{type:"workbench.parts.editor"}}dispose(){this.groupViews.forEach(e=>e.dispose()),this.groupViews.clear(),this.gridWidget?.dispose(),super.dispose()}};Xi.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state",Xi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview",Xi=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,K.XE),(0,h.fM)(2,G.Ui),(0,h.fM)(3,Ie.Uy),(0,h.fM)(4,et.z)],Xi);var _=m(96617),Yi=m(42965),nl=m(44617),Qi=m(39459),Ji=m(69046),Yn=m(48698),V=m(40145),rl=m(12246),sl=m(33811);T.W.registerCommandAndKeybindingRule({weight:200,when:_.AB,primary:2051,mac:{primary:259},id:V.EL,handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(U.AR),o=e.get(D.Lw),n=e.get(z.sn),r=e.get(we.gE),s=(0,we.kn)(t,o,i,r);if(s.length){const a=s.filter(b=>b.scheme===Me.lg.untitled),d=s.filter(b=>b.scheme!==Me.lg.untitled),f=(yield Promise.all(d.map(function(){var b=(0,w.Z)(function*(E){return r.findClosest(E)||(yield n.stat(E))});return function(E){return b.apply(this,arguments)}}()))).filter(b=>!b.isDirectory).map(b=>({resource:b.resource,options:{pinned:!0}})).concat(...a.map(b=>({resource:b,options:{pinned:!0}})));yield i.openEditors(f,U.O3)}});return function(t,i){return c.apply(this,arguments)}}()}),T.W.registerCommandAndKeybindingRule({weight:210,when:y.Ao.and(_.Ie,_.W$.toNegated()),primary:3,mac:{primary:2066},id:"explorer.openAndPassFocus",handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(U.AR),n=e.get(we.gE).getContext(!0);n.length&&(yield i.openEditors(n.map(r=>({resource:r.resource,options:{preserveFocus:!1,pinned:!0}}))))});return function(t,i){return c.apply(this,arguments)}}()});const Qn="showModifications";let Jn,qn,Yt=[];function er(c,e,t,i,o){return tr.apply(this,arguments)}function tr(){return tr=(0,w.Z)(function*(c,e,t,i,o){if(c.length){const n=F.ED?"\r\n":"\n";let r;if(e){const a=o.getValue("explorer.copyRelativePathSeparator");("/"===a||"\\"===a)&&(r=a)}const s=c.map(a=>i.getUriLabel(a,{relative:e,noPrefix:!0,separator:r})).join(n);yield t.writeText(s)}}),tr.apply(this,arguments)}T.W.registerCommandAndKeybindingRule({id:V.dR,when:void 0,weight:200,primary:(0,it.gx)(2089,34),handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(R.TG),o=e.get(Gi.S),n=e.get(U.AR),r=e.get(z.sn);let s=!1;if(0===Yt.length){s=!0;const d=i.createInstance(_.C9);Yt.push(d),Yt.push(o.registerTextModelContentProvider(Qn,d))}const a=(0,we.lq)(t,e.get(D.Lw),n);if(a&&r.hasProvider(a)){const d=(0,J.EZ)(a),l=p.NC("modifiedLabel","{0} (in file) \u2194 {1}",d,d);try{yield _.C9.open(a,Qn,l,n,{pinned:!0}),s&&Yt.push(n.onDidVisibleEditorsChange(()=>{n.editors.some(u=>!!x.zK.getCanonicalUri(u,{supportSideBySide:x.YX.SECONDARY,filterByScheme:Qn}))||(Yt=(0,C.B9)(Yt))}))}catch{Yt=(0,C.B9)(Yt)}}});return function(t,i){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.op,handler:(c,e)=>{const t=c.get(D.Lw);Jn=(0,we.lq)(e,t,c.get(U.AR)),qn||(qn=V.YV.bindTo(c.get(y.i6))),qn.set(!0)}}),Z.P.registerCommand({id:V.JH,handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(U.AR),o=e.get(we.gE),n=(0,we.kn)(t,e.get(D.Lw),i,o);return 2!==n.length||i.openEditor({original:{resource:n[0]},modified:{resource:n[1]},options:{pinned:!0}})});return function(t,i){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.P3,handler:(c,e)=>{const t=c.get(U.AR),i=c.get(D.Lw),o=(0,we.lq)(e,i,t);Jn&&o&&t.openEditor({original:{resource:Jn},modified:{resource:o},options:{pinned:!0}})}});const js=function(){var c=(0,w.Z)(function*(e,t){const i=(0,we.kn)(t,e.get(D.Lw),e.get(U.AR),e.get(we.gE));yield er(i,!1,e.get(Yi.p),e.get(Ut.e),e.get(G.Ui))});return function(t,i){return c.apply(this,arguments)}}();T.W.registerCommandAndKeybindingRule({weight:200,when:Qi.u.focus.toNegated(),primary:2593,win:{primary:1569},id:V.$g,handler:js}),T.W.registerCommandAndKeybindingRule({weight:200,when:Qi.u.focus,primary:(0,it.gx)(2089,2593),win:{primary:1569},id:V.$g,handler:js});const Xs=function(){var c=(0,w.Z)(function*(e,t){const i=(0,we.kn)(t,e.get(D.Lw),e.get(U.AR),e.get(we.gE));yield er(i,!0,e.get(Yi.p),e.get(Ut.e),e.get(G.Ui))});return function(t,i){return c.apply(this,arguments)}}();function ir(c,e){return or.apply(this,arguments)}function or(){return or=(0,w.Z)(function*(c,e){const t=c.get(D.Lw),i=c.get(te.Qw),o=c.get(Ji.$),n=c.get(vs.MM);let r=(0,we.YQ)(t);if(!r){const a=i.activeGroup;a.activeEditor&&(r=[],a.activeEditor instanceof It.h&&!e?.saveAs&&!a.activeEditor.primary.hasCapability(4)&&!a.activeEditor.secondary.hasCapability(4)?(r.push({groupId:a.id,editor:a.activeEditor.primary}),r.push({groupId:a.id,editor:a.activeEditor.secondary})):r.push({groupId:a.id,editor:a.activeEditor}))}if(!r||0===r.length)return;yield nr(c,r,e);const s=o.getFocusedCodeEditor();if(s instanceof Yn.H){const a=s.getModel()?.uri;a&&!r.some(({editor:d})=>(0,J.Xy)(x.zK.getCanonicalUri(d,{supportSideBySide:x.YX.PRIMARY}),a))&&(n.files.get(a)?.isReadonly()||(yield n.save(a,e)))}}),or.apply(this,arguments)}function Ys(c,e,t){const i=[];for(const o of e)for(const n of o.getEditors(0))n.isDirty()&&i.push({groupId:o.id,editor:n});return nr(c,i,t)}function nr(c,e,t){return rr.apply(this,arguments)}function rr(){return rr=(0,w.Z)(function*(c,e,t){const i=c.get(U.AR),o=c.get(oe.lT),n=c.get(R.TG);try{yield i.save(e,t)}catch(r){(0,Xe.n2)(r)||o.notify({id:e.map(({editor:s})=>(0,di.vp)(s.resource?.toString())).join(),severity:oe.zb.Error,message:p.NC({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",e.map(({editor:s})=>s.getName()).join(", "),(0,Zi.yJ)(r,!1)),actions:{primary:[(0,P.xw)({id:"workbench.action.files.saveEditors",label:p.NC("retry","Retry"),run:()=>n.invokeFunction(s=>nr(s,e,t))}),(0,P.xw)({id:"workbench.action.files.revertEditors",label:p.NC("discard","Discard"),run:()=>i.revert(e)})]}})}}),rr.apply(this,arguments)}T.W.registerCommandAndKeybindingRule({weight:200,when:Qi.u.focus.toNegated(),primary:3617,win:{primary:(0,it.gx)(2089,3105)},id:V.Lv,handler:Xs}),T.W.registerCommandAndKeybindingRule({weight:200,when:Qi.u.focus,primary:(0,it.gx)(2089,3617),win:{primary:(0,it.gx)(2089,3105)},id:V.Lv,handler:Xs}),T.W.registerCommandAndKeybindingRule({weight:200,when:void 0,primary:(0,it.gx)(2089,46),id:"workbench.action.files.copyPathOfActiveFile",handler:function(){var c=(0,w.Z)(function*(e){const i=e.get(U.AR).activeEditor,o=x.zK.getOriginalUri(i,{supportSideBySide:x.YX.PRIMARY});yield er(o?[o]:[],!1,e.get(Yi.p),e.get(Ut.e),e.get(G.Ui))});return function(t){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.UG,handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(O.qC),o=e.get(ce.ec),n=e.get(we.gE),r=(0,we.lq)(t,e.get(D.Lw),e.get(U.AR));if(r&&o.isInsideWorkspace(r)){const s=yield i.openView(_.nn,!1);s&&(s.setExpanded(!0),yield n.select(r,"force"),s.focus())}else{const s=yield i.openView(sl.M.ID,!1);s&&(s.setExpanded(!0),s.focus())}});return function(t,i){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.am,handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(U.AR),o=(0,we.lq)(t,e.get(D.Lw),e.get(U.AR));if(o)return i.openEditor({resource:o,options:{override:Qe.Cs.PICK,source:Qe.vU.USER}})});return function(t,i){return c.apply(this,arguments)}}()}),T.W.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:2097,id:V.jq,handler:c=>ir(c,{reason:1,force:!0})}),T.W.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:(0,it.gx)(2089,49),win:{primary:(0,it.gx)(2089,3121)},id:V.C0,handler:c=>ir(c,{reason:1,force:!0,skipSaveParticipants:!0})}),T.W.registerCommandAndKeybindingRule({id:V.W0,weight:200,when:void 0,primary:3121,handler:c=>ir(c,{reason:1,saveAs:!0})}),T.W.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:void 0,mac:{primary:2609},win:{primary:(0,it.gx)(2089,49)},id:V.xu,handler:c=>Ys(c,c.get(te.Qw).getGroups(1),{reason:1})}),Z.P.registerCommand({id:V.WR,handler:(c,e,t)=>{const i=c.get(te.Qw),o=(0,ut.I1)(t,c.get(D.Lw),c.get(te.Qw));let n;return n=o.length?(0,L.kX)(o.map(r=>i.getGroup(r.groupId))):i.getGroups(1),Ys(c,n,{reason:1})}}),Z.P.registerCommand({id:V.h5,handler:function(){var c=(0,w.Z)(function*(e){return(yield e.get(U.AR).saveAll({includeUntitled:!1,reason:1})).success});return function(t){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.tF,handler:function(){var c=(0,w.Z)(function*(e){const t=e.get(oe.lT),i=e.get(D.Lw),o=e.get(te.Qw),n=e.get(U.AR);let r=(0,we.YQ)(i);if(!r){const s=o.activeGroup;s.activeEditor&&(r=[{groupId:s.id,editor:s.activeEditor}])}if(r&&0!==r.length)try{yield n.revert(r.filter(({editor:s})=>!s.hasCapability(4)),{force:!0})}catch(s){t.error(p.NC("genericRevertError","Failed to revert '{0}': {1}",r.map(({editor:a})=>a.getName()).join(", "),(0,Zi.yJ)(s,!1)))}});return function(t){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.HE,handler:(c,e)=>{const t=c.get(nl.o),i=c.get(ce.ec),o=c.get($i.v),n=i.getWorkspace(),r=(0,we.kn)(e,c.get(D.Lw),c.get(U.AR),c.get(we.gE)).filter(s=>n.folders.some(a=>o.extUri.isEqual(a.uri,s)));return 0===r.length?c.get(Z.H).executeCommand(rl.zM.ID):t.removeFolders(r)}}),T.W.registerCommandAndKeybindingRule({weight:210,when:y.Ao.and(_.Ie,_.co,_.ob.negate()),primary:15,id:V.AO,handler:c=>{const t=c.get(si.c).getActivePaneComposite(0);t?.getId()===_.f3&&t.getViewPaneContainer().getExplorerView().previousCompressedStat()}}),T.W.registerCommandAndKeybindingRule({weight:210,when:y.Ao.and(_.Ie,_.co,_.VA.negate()),primary:17,id:V.L2,handler:c=>{const t=c.get(si.c).getActivePaneComposite(0);t?.getId()===_.f3&&t.getViewPaneContainer().getExplorerView().nextCompressedStat()}}),T.W.registerCommandAndKeybindingRule({weight:210,when:y.Ao.and(_.Ie,_.co,_.ob.negate()),primary:14,id:V.$2,handler:c=>{const t=c.get(si.c).getActivePaneComposite(0);t?.getId()===_.f3&&t.getViewPaneContainer().getExplorerView().firstCompressedStat()}}),T.W.registerCommandAndKeybindingRule({weight:210,when:y.Ao.and(_.Ie,_.co,_.VA.negate()),primary:13,id:V.Er,handler:c=>{const t=c.get(si.c).getActivePaneComposite(0);t?.getId()===_.f3&&t.getViewPaneContainer().getExplorerView().lastCompressedStat()}}),T.W.registerCommandAndKeybindingRule({weight:200,when:null,primary:F.$L?F.ED?(0,it.gx)(2089,44):2604:2092,secondary:F.$L?[2092]:void 0,id:V.mP,description:{description:V.RK,args:[{isOptional:!0,name:"New Untitled Text File arguments",description:"The editor view type or language ID if known",schema:{type:"object",properties:{viewType:{type:"string"},languageId:{type:"string"}}}}]},handler:function(){var c=(0,w.Z)(function*(e,t){yield e.get(U.AR).openEditor({resource:void 0,options:{override:t?.viewType,pinned:!0},languageId:t?.languageId})});return function(t,i){return c.apply(this,arguments)}}()}),Z.P.registerCommand({id:V.Hx,handler:function(){var c=(0,w.Z)(function*(e,t){const i=e.get(U.AR),o=e.get(ki.Z$),n=e.get(z.sn),r=p.NC("newFileCommand.saveLabel","Create File"),s=(0,J.Vo)(yield o.defaultFilePath(),t?.fileName??"Untitled.txt"),a=yield o.showSaveDialog({saveLabel:r,title:r,defaultUri:s});a&&(yield n.createFile(a,void 0,{overwrite:!0}),yield i.openEditor({resource:a,options:{override:t?.viewType,pinned:!0},languageId:t?.languageId}))});return function(t,i){return c.apply(this,arguments)}}()});var pe=m(99988),Qs=m(35111);const Js="renameFile";T.W.registerCommandAndKeybindingRule({id:Js,weight:210,when:y.Ao.and(_.Ie,_.RQ.toNegated(),_.lc),primary:60,mac:{primary:3},handler:pe.At});const qs="moveFileToTrash";T.W.registerCommandAndKeybindingRule({id:qs,weight:210,when:y.Ao.and(_.Ie,_.lc,_.RL),primary:20,mac:{primary:2049,secondary:[20]},handler:pe.Cy});const Ko="deleteFile";T.W.registerCommandAndKeybindingRule({id:Ko,weight:210,when:y.Ao.and(_.Ie,_.lc),primary:1044,mac:{primary:2561},handler:pe.ju}),T.W.registerCommandAndKeybindingRule({id:Ko,weight:210,when:y.Ao.and(_.Ie,_.lc,_.RL.toNegated()),primary:20,mac:{primary:2049},handler:pe.ju});const ea="filesExplorer.cut";T.W.registerCommandAndKeybindingRule({id:ea,weight:210,when:y.Ao.and(_.Ie,_.RQ.toNegated(),_.lc),primary:2102,handler:pe.vC});const ta="filesExplorer.copy";T.W.registerCommandAndKeybindingRule({id:ta,weight:210,when:y.Ao.and(_.Ie,_.RQ.toNegated()),primary:2081,handler:pe.k0});const ia="filesExplorer.paste";T.W.registerCommandAndKeybindingRule({id:ia,weight:210,when:y.Ao.and(_.Ie,_.lc),primary:2100,handler:pe.QE}),T.W.registerCommandAndKeybindingRule({id:"filesExplorer.cancelCut",weight:210,when:y.Ao.and(_.Ie,_.pL),primary:9,handler:function(){var c=(0,w.Z)(function*(e){yield e.get(we.gE).setToCopy([],!0)});return function(t){return c.apply(this,arguments)}}()}),T.W.registerCommandAndKeybindingRule({id:"filesExplorer.openFilePreserveFocus",weight:210,when:y.Ao.and(_.Ie,_.W$.toNegated()),primary:10,handler:pe.wS});const sr={id:V.$g,title:p.NC("copyPath","Copy Path")},ar={id:V.Lv,title:p.NC("copyRelativePath","Copy Relative Path")};function cr(c,e,t,i,o){v.BH.appendMenuItem(v.eH.EditorTitleContext,{command:{id:c,title:e},when:t,group:i,order:o})}function oa(c,e,t,i,o){v.BH.appendMenuItem(v.eH.EditorTitle,{command:{id:c,title:e,icon:t},when:y.Ao.equals("saveConflictResolutionContext",!0),group:"navigation",order:i})}function ot(c,e,t,i){v.BH.appendMenuItem(v.eH.CommandPalette,{command:{id:c,title:e,category:t},when:i})}cr(V.$g,sr.title,N.f1.IsFileSystemResource,"1_cutcopypaste"),cr(V.Lv,ar.title,N.f1.IsFileSystemResource,"1_cutcopypaste"),cr(V.UG,p.NC("revealInSideBar","Reveal in Explorer View"),N.f1.IsFileSystemResource,"2_files",1),oa("workbench.files.action.acceptLocalChanges",p.NC("acceptLocalChanges","Use your changes and overwrite file contents"),$.lA.check,-10),oa("workbench.files.action.revertLocalChanges",p.NC("revertLocalChanges","Discard your changes and revert to file contents"),$.lA.discard,-9),ot(V.$g,{value:p.NC("copyPathOfActive","Copy Path of Active File"),original:"Copy Path of Active File"},Ee.R.File),ot(V.Lv,{value:p.NC("copyRelativePathOfActive","Copy Relative Path of Active File"),original:"Copy Relative Path of Active File"},Ee.R.File),ot(V.jq,{value:V._L,original:"Save"},Ee.R.File),ot(V.C0,{value:V.Ap,original:"Save without Formatting"},Ee.R.File),ot(V.WR,{value:p.NC("saveAllInGroup","Save All in Group"),original:"Save All in Group"},Ee.R.File),ot(V.h5,{value:p.NC("saveFiles","Save All Files"),original:"Save All Files"},Ee.R.File),ot(V.tF,{value:p.NC("revert","Revert File"),original:"Revert File"},Ee.R.File),ot(V.dR,{value:p.NC("compareActiveWithSaved","Compare Active File with Saved"),original:"Compare Active File with Saved"},Ee.R.File),ot(V.W0,{value:V.ji,original:"Save As..."},Ee.R.File),ot(pe.Hx,{value:pe.J3,original:"New File"},Ee.R.File,N.Nz.notEqualsTo("0")),ot(pe.oC,{value:pe.wX,original:"New Folder"},Ee.R.File,N.Nz.notEqualsTo("0")),ot(V.mP,{value:V.RK,original:"New Untitled Text File"},Ee.R.File);const Zo=y.Ao.or(N.f1.IsFileSystemResource,N.f1.Scheme.isEqualTo(Me.lg.untitled)),na={id:V.EL,title:p.NC("openToSide","Open to the Side")};v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"navigation",order:10,command:na,when:Zo}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"1_open",order:10,command:{id:ut.NC,title:p.NC("reopenWith","Reopen Editor With...")},when:N.tK}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"1_cutcopypaste",order:10,command:sr,when:N.f1.IsFileSystemResource}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"1_cutcopypaste",order:20,command:ar,when:N.f1.IsFileSystemResource}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"2_save",order:10,command:{id:V.jq,title:V._L,precondition:V.TZ},when:y.Ao.or(N.f1.Scheme.isEqualTo(Me.lg.untitled),y.Ao.and(V.Tr.toNegated(),V.xd.toNegated(),Wo.MD.toNegated()))}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"2_save",order:20,command:{id:V.tF,title:p.NC("revert","Revert File"),precondition:V.TZ},when:y.Ao.and(V.Tr.toNegated(),V.xd.toNegated(),N.f1.Scheme.notEqualsTo(Me.lg.untitled),Wo.MD.toNegated())}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"2_save",order:30,command:{id:V.WR,title:p.NC("saveAll","Save All"),precondition:N.Y_},when:V.Tr}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"3_compare",order:10,command:{id:V.dR,title:p.NC("compareWithSaved","Compare with Saved"),precondition:V.TZ},when:y.Ao.and(N.f1.IsFileSystemResource,Wo.MD.toNegated(),D.DW.toNegated())});const ra={id:V.P3,title:p.NC("compareWithSelected","Compare with Selected")};v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"3_compare",order:20,command:ra,when:y.Ao.and(N.f1.HasResource,V.YV,Zo,D.DW.toNegated())});const sa={id:V.op,title:p.NC("compareSource","Select for Compare")};v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"3_compare",order:30,command:sa,when:y.Ao.and(N.f1.HasResource,Zo,D.DW.toNegated())});const aa={id:V.JH,title:p.NC("compareSelected","Compare Selected")};v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"3_compare",order:30,command:aa,when:y.Ao.and(N.f1.HasResource,D.DW,Zo)}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"4_close",order:10,command:{id:ut.$Z,title:p.NC("close","Close")},when:V.Tr.toNegated()}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"4_close",order:20,command:{id:ut.iX,title:p.NC("closeOthers","Close Others")},when:V.Tr.toNegated()}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"4_close",order:30,command:{id:ut.ZF,title:p.NC("closeSaved","Close Saved")}}),v.BH.appendMenuItem(v.eH.OpenEditorsContext,{group:"4_close",order:40,command:{id:ut.Hd,title:p.NC("closeAll","Close All")}}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"navigation",order:4,command:{id:pe.Hx,title:pe.J3,precondition:_.lc},when:_.W$}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"navigation",order:6,command:{id:pe.oC,title:pe.wX,precondition:_.lc},when:_.W$}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"navigation",order:10,command:na,when:y.Ao.and(_.W$.toNegated(),N.f1.HasResource)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"navigation",order:20,command:{id:V.am,title:p.NC("explorerOpenWith","Open With...")},when:y.Ao.and(_.W$.toNegated(),_.fB)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"3_compare",order:20,command:ra,when:y.Ao.and(_.W$.toNegated(),N.f1.HasResource,V.YV,D.DW.toNegated())}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"3_compare",order:30,command:sa,when:y.Ao.and(_.W$.toNegated(),N.f1.HasResource,D.DW.toNegated())}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"3_compare",order:30,command:aa,when:y.Ao.and(_.W$.toNegated(),N.f1.HasResource,D.DW)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"5_cutcopypaste",order:8,command:{id:ea,title:p.NC("cut","Cut")},when:y.Ao.and(_.RQ.toNegated(),_.lc)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"5_cutcopypaste",order:10,command:{id:ta,title:pe.qn},when:_.RQ.toNegated()}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"5_cutcopypaste",order:20,command:{id:ia,title:pe.YT,precondition:y.Ao.and(_.lc,pe.KK)},when:_.W$}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"5b_importexport",order:10,command:{id:pe.Jh,title:pe.JD},when:y.Ao.or(y.Ao.and(xi.Pf.toNegated(),N.f1.Scheme.notEqualsTo(Me.lg.file)),y.Ao.and(xi.Pf,_.W$.toNegated(),_.RQ.toNegated()),y.Ao.and(xi.Pf,N.Qn))}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"5b_importexport",order:20,command:{id:pe.q7,title:pe.YU},when:y.Ao.and(xi.Pf,_.W$,_.lc)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"6_copypath",order:10,command:sr,when:N.f1.IsFileSystemResource}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"6_copypath",order:20,command:ar,when:N.f1.IsFileSystemResource}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"2_workspace",order:10,command:{id:Qs._P,title:Qs.MA},when:y.Ao.and(_.RQ,y.Ao.or(N.ez,N.hX.isEqualTo("workspace")))}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"2_workspace",order:30,command:{id:V.HE,title:V.ov},when:y.Ao.and(_.RQ,_.W$,y.Ao.and(N.Nz.notEqualsTo("0"),y.Ao.or(N.ez,N.hX.isEqualTo("workspace"))))}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"7_modification",order:10,command:{id:Js,title:pe.sh,precondition:_.lc},when:_.RQ.toNegated()}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"7_modification",order:20,command:{id:qs,title:pe.pk,precondition:_.lc},alt:{id:Ko,title:p.NC("deleteFile","Delete Permanently"),precondition:_.lc},when:y.Ao.and(_.RQ.toNegated(),_.RL)}),v.BH.appendMenuItem(v.eH.ExplorerContext,{group:"7_modification",order:20,command:{id:Ko,title:p.NC("deleteFile","Delete Permanently"),precondition:_.lc},when:y.Ao.and(_.RQ.toNegated(),_.RL.toNegated())});for(const c of[v.eH.EmptyEditorGroupContext,v.eH.EditorTabsBarContext])v.BH.appendMenuItem(c,{command:{id:V.mP,title:p.NC("newFile","New Text File")},group:"1_file",order:10}),v.BH.appendMenuItem(c,{command:{id:"workbench.action.quickOpen",title:p.NC("openFile","Open File...")},group:"1_file",order:20});v.BH.appendMenuItem(v.eH.MenubarGoMenu,{group:"3_global_nav",command:{id:"workbench.action.quickOpen",title:p.NC({key:"miGotoFile",comment:["&& denotes a mnemonic"]},"Go to &&File...")},order:1});var qi=m(88733);(0,ve.Z)(".monaco-workbench .call-hierarchy .message,.monaco-workbench .call-hierarchy .results{display:none}.monaco-workbench .call-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .call-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .call-hierarchy .editor,.monaco-workbench .call-hierarchy .tree{height:100%}.monaco-editor .call-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-workbench .call-hierarchy .tree .callhierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .call-hierarchy .tree .callhierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .call-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-editor .call-hierarchy .call-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .call-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .call-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .call-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}",{});var ke=m(46528),dr=m(19608),ca=m(87808);class $o{constructor(e,t,i,o){this.item=e,this.locations=t,this.model=i,this.parent=o}static compare(e,t){let i=(0,Kt.qu)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=Ye.e.compareRangesUsingStarts(e.item.range,t.item.range)),i}}class dl{constructor(e){this.getDirection=e}hasChildren(){return!0}getChildren(e){var t=this;return(0,w.Z)(function*(){if(e instanceof qi.e)return e.roots.map(n=>new $o(n,void 0,e,void 0));const{model:i,item:o}=e;return"outgoingCalls"===t.getDirection()?(yield i.resolveOutgoingCalls(o,xe.T.None)).map(n=>new $o(n.to,n.fromRanges.map(r=>({range:r,uri:o.uri})),i,e)):(yield i.resolveIncomingCalls(o,xe.T.None)).map(n=>new $o(n.from,n.fromRanges.map(r=>({range:r,uri:n.from.uri})),i,e))})()}}class ll{compare(e,t){return $o.compare(e,t)}}class hl{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}}class ul{constructor(e,t){this.icon=e,this.label=t}}let da=(()=>{class c{constructor(){this.templateId=c.id}renderTemplate(t){t.classList.add("callhierarchy-element");const i=document.createElement("div");t.appendChild(i);const o=new dr.g(t,{supportHighlights:!0});return new ul(i,o)}renderElement(t,i,o){const{element:n,filterData:r}=t,s=n.item.tags?.includes(1);o.icon.className="",o.icon.classList.add("inline",...be.kS.asClassNameArray(ca.uZ.toIcon(n.item.kind))),o.label.setLabel(n.item.name,n.item.detail,{labelEscapeNewLines:!0,matches:(0,Ui.mB)(r),strikethrough:s})}disposeTemplate(t){t.label.dispose()}}return c.id="CallRenderer",c})();class pl{getHeight(e){return 22}getTemplateId(e){return da.id}}class gl{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,p.NC)("tree.aria","Call Hierarchy")}getAriaLabel(e){return"outgoingCalls"===this.getDirection()?(0,p.NC)("from","calls from {0}",e.item.name):(0,p.NC)("to","callers of {0}",e.item.name)}}var la=m(96237),ha=m(3345);class ua{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("callHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}}class fl extends D.ls{}let fi=class Xa extends ke.vk{constructor(e,t,i,o,n,r,s,a,d,l,u){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},u),this._where=t,this._direction=i,this._peekViewService=n,this._editorService=r,this._textModelService=s,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=u,this._treeViewStates=new Map,this._previewDisposable=new C.SL,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){ua.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(ke.SC)||jt.Il.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(ke.KY)||jt.Il.transparent,primaryHeadingColor:e.getColor(ke.IH),secondaryHeadingColor:e.getColor(ke.R7)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(Xa.TitleMenu,this._contextKeyService),i=()=>{const o=[];(0,Be.vr)(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=ua.retrieve(this._storageService),this._dim=new g.Ro(0,0),this._parent=e,e.classList.add("call-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Re.z(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(Yn.H,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);const r=document.createElement("div");r.classList.add("tree"),i.appendChild(r);const s={sorter:new ll,accessibilityProvider:new gl(()=>this._direction),identityProvider:new hl(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ke.M8}};this._tree=this._instantiationService.createInstance(fl,"CallHierarchyPeek",r,new pl,[this._instantiationService.createInstance(da)],this._instantiationService.createInstance(dl,()=>this._direction),s),this._splitView.addView({onDidChange:S.ju.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},Re.M.Distribute),this._splitView.addView({onDidChange:S.ju.None,element:r,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},Re.M.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(2!==d.detail)return;const[u]=this._tree.getFocus();u&&(this.dispose(),this._editorService.openEditor({resource:u.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==ha.sD.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}_updatePreview(){var e=this;return(0,w.Z)(function*(){const[t]=e._tree.getFocus();if(!t)return;e._previewDisposable.clear();const i={description:"call-hierarchy-decoration",stickiness:1,className:"call-decoration",overviewRuler:{color:(0,K.EN)(ke.WL),position:la.sh.Center}};let o;o="outgoingCalls"===e._direction?t.parent?t.parent.item.uri:t.model.root.uri:t.item.uri;const n=yield e._textModelService.createModelReference(o);e._editor.setModel(n.object.textEditorModel);const r=[];let s,a=t.locations;a||(a=[{uri:t.item.uri,range:t.item.selectionRange}]);for(const l of a)l.uri.toString()===o.toString()&&(r.push({range:l.range,options:i}),s=s?Ye.e.plusRange(l.range,s):l.range);if(s){e._editor.revealRangeInCenter(s,1);const l=e._editor.createDecorationsCollection(r);e._previewDisposable.add((0,C.OF)(()=>l.clear()))}e._previewDisposable.add(n);const d="outgoingCalls"===e._direction?(0,p.NC)("callFrom","Calls from '{0}'",t.model.root.name):(0,p.NC)("callsTo","Callers of '{0}'",t.model.root.name);e.setTitle(d)})()}showLoading(){this._parent.dataset.state="loading",this.setTitle((0,p.NC)("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}showModel(e){var t=this;return(0,w.Z)(function*(){t._show();const i=t._treeViewStates.get(t._direction);yield t._tree.setInput(e,i);const o=t._tree.getNode(e).children[0];yield t._tree.expand(o.element),0===o.children.length?t.showMessage("outgoingCalls"===t._direction?(0,p.NC)("empt.callsFrom","No calls from '{0}'",e.root.name):(0,p.NC)("empt.callsTo","No callers of '{0}'",e.root.name)):(t._parent.dataset.state="data",(!i||0===t._tree.getFocus().length)&&t._tree.setFocus([o.children[0].element]),t._tree.domFocus(),t._updatePreview())})()}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}updateDirection(e){var t=this;return(0,w.Z)(function*(){const i=t._tree.getInput();i&&e!==t._direction&&(t._treeViewStates.set(t._direction,t._tree.getViewState()),t._direction=e,yield t.showModel(i))})()}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(Ye.e.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new g.Ro(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};fi.TitleMenu=new v.eH("callhierarchy/title"),fi=(0,h.gn)([(0,h.fM)(3,K.XE),(0,h.fM)(4,ke.Fw),(0,h.fM)(5,U.AR),(0,h.fM)(6,Gi.S),(0,h.fM)(7,Ie.Uy),(0,h.fM)(8,v.co),(0,h.fM)(9,y.i6),(0,h.fM)(10,R.TG)],fi);var nt=m(38356);const lr=new y.uy("editorHasCallHierarchyProvider",!1,(0,p.NC)("editorHasCallHierarchyProvider","Whether a call hierarchy provider is available")),eo=new y.uy("callHierarchyVisible",!1,(0,p.NC)("callHierarchyVisible","Whether call hierarchy peek is currently showing")),to=new y.uy("callHierarchyDirection",void 0,{type:"string",description:(0,p.NC)("callHierarchyDirection","Whether call hierarchy shows incoming or outgoing calls")});let pt=class vo{static get(e){return e.getContribution(vo.Id)}constructor(e,t,i,o,n){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=n,this._dispoables=new C.SL,this._sessionDisposables=new C.SL,this._ctxIsVisible=eo.bindTo(this._contextKeyService),this._ctxHasProvider=lr.bindTo(this._contextKeyService),this._ctxDirection=to.bindTo(this._contextKeyService),this._dispoables.add(S.ju.any(e.onDidChangeModel,e.onDidChangeModelLanguage,qi.t.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&qi.t.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}startCallHierarchyFromEditor(){var e=this;return(0,w.Z)(function*(){if(e._sessionDisposables.clear(),!e._editor.hasModel())return;const t=e._editor.getModel(),i=e._editor.getPosition();if(!qi.t.has(t))return;const o=new xe.A,n=qi.e.create(t,i,o.token),r=function ml(c){return"outgoingCalls"===c||"incomingCalls"===c?c:"incomingCalls"}(e._storageService.get(vo._StorageDirection,0,"incomingCalls"));e._showCallHierarchyWidget(i,r,n,o)})()}startCallHierarchyFromCallHierarchy(){var e=this;return(0,w.Z)(function*(){if(!e._widget)return;const t=e._widget.getModel(),i=e._widget.getFocused();if(!i||!t)return;const o=yield e._editorService.openCodeEditor({resource:i.item.uri},e._editor);if(!o)return;const n=t.fork(i.item);e._sessionDisposables.clear(),vo.get(o)?._showCallHierarchyWidget(Ye.e.lift(n.root.selectionRange).getStartPosition(),e._widget.direction,Promise.resolve(n),new xe.A)})()}_showCallHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),S.ju.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(fi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(vo._StorageDirection,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(n=>{o.token.isCancellationRequested||(n?(this._sessionDisposables.add(n),this._widget.showModel(n)):this._widget.showMessage((0,p.NC)("no.item","No results")))}).catch(n=>{(0,Xe.n2)(n)?this.endCallHierarchy():this._widget.showMessage((0,p.NC)("error","Failed to show call hierarchy"))})}showOutgoingCalls(){this._widget?.updateDirection("outgoingCalls"),this._ctxDirection.set("outgoingCalls")}showIncomingCalls(){this._widget?.updateDirection("incomingCalls"),this._ctxDirection.set("incomingCalls")}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};pt.Id="callHierarchy",pt._StorageDirection="callHierarchy/defaultDirection",pt=(0,h.gn)([(0,h.fM)(1,y.i6),(0,h.fM)(2,Ie.Uy),(0,h.fM)(3,Ji.$),(0,h.fM)(4,R.TG)],pt),(0,nt._K)(pt.Id,pt,0),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showCallHierarchy",title:{value:(0,p.NC)("title","Peek Call Hierarchy"),original:"Peek Call Hierarchy"},menu:{id:v.eH.EditorContextPeek,group:"navigation",order:1e3,when:y.Ao.and(lr,ke.Jy.notInPeekEditor)},keybinding:{when:Qi.u.editorTextFocus,weight:200,primary:1574},precondition:y.Ao.and(lr,ke.Jy.notInPeekEditor)})}runEditorCommand(c,e){return(0,w.Z)(function*(){return pt.get(e)?.startCallHierarchyFromEditor()})()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showIncomingCalls",title:{value:(0,p.NC)("title.incoming","Show Incoming Calls"),original:"Show Incoming Calls"},icon:(0,he.q5)("callhierarchy-incoming",$.lA.callIncoming,(0,p.NC)("showIncomingCallsIcons","Icon for incoming calls in the call hierarchy view.")),precondition:y.Ao.and(eo,to.isEqualTo("outgoingCalls")),keybinding:{weight:200,primary:1574},menu:{id:fi.TitleMenu,when:to.isEqualTo("outgoingCalls"),order:1}})}runEditorCommand(c,e){return pt.get(e)?.showIncomingCalls()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showOutgoingCalls",title:{value:(0,p.NC)("title.outgoing","Show Outgoing Calls"),original:"Show Outgoing Calls"},icon:(0,he.q5)("callhierarchy-outgoing",$.lA.callOutgoing,(0,p.NC)("showOutgoingCallsIcon","Icon for outgoing calls in the call hierarchy view.")),precondition:y.Ao.and(eo,to.isEqualTo("incomingCalls")),keybinding:{weight:200,primary:1574},menu:{id:fi.TitleMenu,when:to.isEqualTo("incomingCalls"),order:1}})}runEditorCommand(c,e){return pt.get(e)?.showOutgoingCalls()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.refocusCallHierarchy",title:{value:(0,p.NC)("title.refocus","Refocus Call Hierarchy"),original:"Refocus Call Hierarchy"},precondition:eo,keybinding:{weight:200,primary:1027}})}runEditorCommand(c,e){return(0,w.Z)(function*(){return pt.get(e)?.startCallHierarchyFromCallHierarchy()})()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.closeCallHierarchy",title:(0,p.NC)("close","Close"),icon:$.lA.close,precondition:eo,keybinding:{weight:210,primary:9,when:y.Ao.not("config.editor.stablePeek")},menu:{id:fi.TitleMenu,order:1e3}})}runEditorCommand(c,e){return pt.get(e)?.endCallHierarchy()}}),(0,ve.Z)(".monaco-workbench .type-hierarchy .message,.monaco-workbench .type-hierarchy .results{display:none}.monaco-workbench .type-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .type-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .type-hierarchy .editor,.monaco-workbench .type-hierarchy .tree{height:100%}.monaco-editor .type-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-editor .type-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-workbench .type-hierarchy .tree .typehierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .type-hierarchy .tree .typehierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .type-hierarchy .type-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .type-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .type-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .type-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}",{});var io=m(98405);class jo{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=(0,Kt.qu)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=Ye.e.compareRangesUsingStarts(e.item.range,t.item.range)),i}}class bl{constructor(e){this.getDirection=e}hasChildren(){return!0}getChildren(e){var t=this;return(0,w.Z)(function*(){if(e instanceof io.S)return e.roots.map(n=>new jo(n,e,void 0));const{model:i,item:o}=e;return"supertypes"===t.getDirection()?(yield i.provideSupertypes(o,xe.T.None)).map(n=>new jo(n,i,e)):(yield i.provideSubtypes(o,xe.T.None)).map(n=>new jo(n,i,e))})()}}class wl{compare(e,t){return jo.compare(e,t)}}class yl{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}}class Cl{constructor(e,t){this.icon=e,this.label=t}}let pa=(()=>{class c{constructor(){this.templateId=c.id}renderTemplate(t){t.classList.add("typehierarchy-element");const i=document.createElement("div");t.appendChild(i);const o=new dr.g(t,{supportHighlights:!0});return new Cl(i,o)}renderElement(t,i,o){const{element:n,filterData:r}=t,s=n.item.tags?.includes(1);o.icon.classList.add("inline",...be.kS.asClassNameArray(ca.uZ.toIcon(n.item.kind))),o.label.setLabel(n.item.name,n.item.detail,{labelEscapeNewLines:!0,matches:(0,Ui.mB)(r),strikethrough:s})}disposeTemplate(t){t.label.dispose()}}return c.id="TypeRenderer",c})();class Sl{getHeight(e){return 22}getTemplateId(e){return pa.id}}class El{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,p.NC)("tree.aria","Type Hierarchy")}getAriaLabel(e){return"supertypes"===this.getDirection()?(0,p.NC)("supertypes","supertypes of {0}",e.item.name):(0,p.NC)("subtypes","subtypes of {0}",e.item.name)}}class ga{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("typeHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}}class xl extends D.ls{}let mi=class Ya extends ke.vk{constructor(e,t,i,o,n,r,s,a,d,l,u){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},u),this._where=t,this._direction=i,this._peekViewService=n,this._editorService=r,this._textModelService=s,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=u,this._treeViewStates=new Map,this._previewDisposable=new C.SL,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){ga.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(ke.SC)||jt.Il.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(ke.KY)||jt.Il.transparent,primaryHeadingColor:e.getColor(ke.IH),secondaryHeadingColor:e.getColor(ke.R7)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(Ya.TitleMenu,this._contextKeyService),i=()=>{const o=[];(0,Be.vr)(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=ga.retrieve(this._storageService),this._dim=new g.Ro(0,0),this._parent=e,e.classList.add("type-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Re.z(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(Yn.H,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);const r=document.createElement("div");r.classList.add("tree"),i.appendChild(r);const s={sorter:new wl,accessibilityProvider:new El(()=>this._direction),identityProvider:new yl(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ke.M8}};this._tree=this._instantiationService.createInstance(xl,"TypeHierarchyPeek",r,new Sl,[this._instantiationService.createInstance(pa)],this._instantiationService.createInstance(bl,()=>this._direction),s),this._splitView.addView({onDidChange:S.ju.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},Re.M.Distribute),this._splitView.addView({onDidChange:S.ju.None,element:r,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},Re.M.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(2!==d.detail)return;const[u]=this._tree.getFocus();u&&(this.dispose(),this._editorService.openEditor({resource:u.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==ha.sD.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}_updatePreview(){var e=this;return(0,w.Z)(function*(){const[t]=e._tree.getFocus();if(!t)return;e._previewDisposable.clear();const i={description:"type-hierarchy-decoration",stickiness:1,className:"type-decoration",overviewRuler:{color:(0,K.EN)(ke.WL),position:la.sh.Center}};let o;o="supertypes"===e._direction?t.parent?t.parent.item.uri:t.model.root.uri:t.item.uri;const n=yield e._textModelService.createModelReference(o);e._editor.setModel(n.object.textEditorModel);const r=[];let s;const a={uri:t.item.uri,range:t.item.selectionRange};if(a.uri.toString()===o.toString()&&(r.push({range:a.range,options:i}),s=s?Ye.e.plusRange(a.range,s):a.range),s){e._editor.revealRangeInCenter(s,1);const l=e._editor.createDecorationsCollection(r);e._previewDisposable.add((0,C.OF)(()=>l.clear()))}e._previewDisposable.add(n);const d="supertypes"===e._direction?(0,p.NC)("supertypes","Supertypes of '{0}'",t.model.root.name):(0,p.NC)("subtypes","Subtypes of '{0}'",t.model.root.name);e.setTitle(d)})()}showLoading(){this._parent.dataset.state="loading",this.setTitle((0,p.NC)("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}showModel(e){var t=this;return(0,w.Z)(function*(){t._show();const i=t._treeViewStates.get(t._direction);yield t._tree.setInput(e,i);const o=t._tree.getNode(e).children[0];yield t._tree.expand(o.element),0===o.children.length?t.showMessage("supertypes"===t._direction?(0,p.NC)("empt.supertypes","No supertypes of '{0}'",e.root.name):(0,p.NC)("empt.subtypes","No subtypes of '{0}'",e.root.name)):(t._parent.dataset.state="data",(!i||0===t._tree.getFocus().length)&&t._tree.setFocus([o.children[0].element]),t._tree.domFocus(),t._updatePreview())})()}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}updateDirection(e){var t=this;return(0,w.Z)(function*(){const i=t._tree.getInput();i&&e!==t._direction&&(t._treeViewStates.set(t._direction,t._tree.getViewState()),t._direction=e,yield t.showModel(i))})()}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(Ye.e.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new g.Ro(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};mi.TitleMenu=new v.eH("typehierarchy/title"),mi=(0,h.gn)([(0,h.fM)(3,K.XE),(0,h.fM)(4,ke.Fw),(0,h.fM)(5,U.AR),(0,h.fM)(6,Gi.S),(0,h.fM)(7,Ie.Uy),(0,h.fM)(8,v.co),(0,h.fM)(9,y.i6),(0,h.fM)(10,R.TG)],mi);const hr=new y.uy("editorHasTypeHierarchyProvider",!1,(0,p.NC)("editorHasTypeHierarchyProvider","Whether a type hierarchy provider is available")),oo=new y.uy("typeHierarchyVisible",!1,(0,p.NC)("typeHierarchyVisible","Whether type hierarchy peek is currently showing")),no=new y.uy("typeHierarchyDirection",void 0,{type:"string",description:(0,p.NC)("typeHierarchyDirection","whether type hierarchy shows super types or subtypes")});let gt=class bo{static get(e){return e.getContribution(bo.Id)}constructor(e,t,i,o,n){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=n,this._disposables=new C.SL,this._sessionDisposables=new C.SL,this._ctxHasProvider=hr.bindTo(this._contextKeyService),this._ctxIsVisible=oo.bindTo(this._contextKeyService),this._ctxDirection=no.bindTo(this._contextKeyService),this._disposables.add(S.ju.any(e.onDidChangeModel,e.onDidChangeModelLanguage,io.T.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&io.T.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}startTypeHierarchyFromEditor(){var e=this;return(0,w.Z)(function*(){if(e._sessionDisposables.clear(),!e._editor.hasModel())return;const t=e._editor.getModel(),i=e._editor.getPosition();if(!io.T.has(t))return;const o=new xe.A,n=io.S.create(t,i,o.token),r=function kl(c){return"subtypes"===c||"supertypes"===c?c:"subtypes"}(e._storageService.get(bo._storageDirectionKey,0,"subtypes"));e._showTypeHierarchyWidget(i,r,n,o)})()}_showTypeHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),S.ju.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(mi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(bo._storageDirectionKey,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(n=>{o.token.isCancellationRequested||(n?(this._sessionDisposables.add(n),this._widget.showModel(n)):this._widget.showMessage((0,p.NC)("no.item","No results")))}).catch(n=>{(0,Xe.n2)(n)?this.endTypeHierarchy():this._widget.showMessage((0,p.NC)("error","Failed to show type hierarchy"))})}startTypeHierarchyFromTypeHierarchy(){var e=this;return(0,w.Z)(function*(){if(!e._widget)return;const t=e._widget.getModel(),i=e._widget.getFocused();if(!i||!t)return;const o=yield e._editorService.openCodeEditor({resource:i.item.uri},e._editor);if(!o)return;const n=t.fork(i.item);e._sessionDisposables.clear(),bo.get(o)?._showTypeHierarchyWidget(Ye.e.lift(n.root.selectionRange).getStartPosition(),e._widget.direction,Promise.resolve(n),new xe.A)})()}showSupertypes(){this._widget?.updateDirection("supertypes"),this._ctxDirection.set("supertypes")}showSubtypes(){this._widget?.updateDirection("subtypes"),this._ctxDirection.set("subtypes")}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};gt.Id="typeHierarchy",gt._storageDirectionKey="typeHierarchy/defaultDirection",gt=(0,h.gn)([(0,h.fM)(1,y.i6),(0,h.fM)(2,Ie.Uy),(0,h.fM)(3,Ji.$),(0,h.fM)(4,R.TG)],gt),(0,nt._K)(gt.Id,gt,0),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showTypeHierarchy",title:{value:(0,p.NC)("title","Peek Type Hierarchy"),original:"Peek Type Hierarchy"},menu:{id:v.eH.EditorContextPeek,group:"navigation",order:1e3,when:y.Ao.and(hr,ke.Jy.notInPeekEditor)},precondition:y.Ao.and(hr,ke.Jy.notInPeekEditor)})}runEditorCommand(c,e){return(0,w.Z)(function*(){return gt.get(e)?.startTypeHierarchyFromEditor()})()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showSupertypes",title:{value:(0,p.NC)("title.supertypes","Show Supertypes"),original:"Show Supertypes"},icon:$.lA.typeHierarchySuper,precondition:y.Ao.and(oo,no.isEqualTo("subtypes")),keybinding:{weight:200,primary:1574},menu:{id:mi.TitleMenu,when:no.isEqualTo("subtypes"),order:1}})}runEditorCommand(c,e){return gt.get(e)?.showSupertypes()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.showSubtypes",title:{value:(0,p.NC)("title.subtypes","Show Subtypes"),original:"Show Subtypes"},icon:$.lA.typeHierarchySub,precondition:y.Ao.and(oo,no.isEqualTo("supertypes")),keybinding:{weight:200,primary:1574},menu:{id:mi.TitleMenu,when:no.isEqualTo("supertypes"),order:1}})}runEditorCommand(c,e){return gt.get(e)?.showSubtypes()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.refocusTypeHierarchy",title:{value:(0,p.NC)("title.refocusTypeHierarchy","Refocus Type Hierarchy"),original:"Refocus Type Hierarchy"},precondition:oo,keybinding:{weight:200,primary:1027}})}runEditorCommand(c,e){return(0,w.Z)(function*(){return gt.get(e)?.startTypeHierarchyFromTypeHierarchy()})()}}),(0,v.r1)(class extends nt.x1{constructor(){super({id:"editor.closeTypeHierarchy",title:(0,p.NC)("close","Close"),icon:$.lA.close,precondition:oo,keybinding:{weight:210,primary:9,when:y.Ao.not("config.editor.stablePeek")},menu:{id:mi.TitleMenu,order:1e3}})}runEditorCommand(c,e){return gt.get(e)?.endTypeHierarchy()}});var ro=m(82553),so=m(72962),Qt=m(66826),rt=m(39370),Jt=m(31957),ao=m(22227),Vi=m(92635);function ur(c){c&&c.getHTMLElement()!==document.activeElement&&c.domFocus()}function pr(){return pr=(0,w.Z)(function*(c,e){if(!D.Cl.getValue(c.contextKeyService))return e(c);const t=c.getFocus(),i=c.getSelection();yield e(c);const o=c.getFocus();if(i.length>1||!(0,L.fS)(t,i)||(0,L.fS)(t,o))return;const n=new KeyboardEvent("keydown");c.setSelection(o,n)}),pr.apply(this,arguments)}function _t(c,e){return gr.apply(this,arguments)}function gr(){return gr=(0,w.Z)(function*(c,e){if(!c)return;yield function Dl(c,e){return pr.apply(this,arguments)}(c,e);const t=c.getFocus();t.length&&c.reveal(t[0]),c.setAnchor(t[0]),ur(c)}),gr.apply(this,arguments)}function fa(c,e){if(c instanceof ro.aV||c instanceof so.j||c instanceof ao.i){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0,o=t.getSelection();o&&"number"==typeof i&&o.indexOf(i)>=0?t.setSelection(o.filter(n=>n!==e)):"number"==typeof i&&t.setSelection(o.concat(i))}else if(c instanceof Qt.H||c instanceof Jt.u||c instanceof rt.c){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0;if(e===i)return;const o=t.getSelection(),n=new KeyboardEvent("keydown",{shiftKey:!0});o&&o.indexOf(i)>=0?t.setSelection(o.filter(r=>r!==e),n):t.setSelection(o.concat(i),n)}}function fr(c,e){const t=c.get(D.Lw).lastFocusedList,i=(0,D.gN)("keydown",e);if(t instanceof ro.aV||t instanceof so.j||t instanceof ao.i){const o=t;o.setSelection(o.getFocus(),i),o.setAnchor(o.getFocus()[0])}else if(t instanceof Qt.H||t instanceof Jt.u||t instanceof rt.c){const o=t,n=o.getFocus();if(n.length>0){let r=!0;(!0===o.expandOnlyOnTwistieClick||"boolean"!=typeof o.expandOnlyOnTwistieClick&&o.expandOnlyOnTwistieClick(n[0]))&&(r=!1),r&&o.toggleCollapsed(n[0])}o.setSelection(n,i),o.setAnchor(n[0])}}T.W.registerCommandAndKeybindingRule({id:"list.focusDown",weight:200,when:D.CQ,primary:18,mac:{primary:18,secondary:[300]},handler:(c,e)=>{_t(c.get(D.Lw).lastFocusedList,function(){var t=(0,w.Z)(function*(i){const o=new KeyboardEvent("keydown");yield i.focusNext("number"==typeof e?e:1,!1,o)});return function(i){return t.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.focusUp",weight:200,when:D.CQ,primary:16,mac:{primary:16,secondary:[302]},handler:(c,e)=>{_t(c.get(D.Lw).lastFocusedList,function(){var t=(0,w.Z)(function*(i){const o=new KeyboardEvent("keydown");yield i.focusPrevious("number"==typeof e?e:1,!1,o)});return function(i){return t.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:200,when:D.CQ,primary:12,handler:c=>{_t(c.get(D.Lw).lastFocusedList,function(){var e=(0,w.Z)(function*(t){const i=new KeyboardEvent("keydown");yield t.focusNextPage(i)});return function(t){return e.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:200,when:D.CQ,primary:11,handler:c=>{_t(c.get(D.Lw).lastFocusedList,function(){var e=(0,w.Z)(function*(t){const i=new KeyboardEvent("keydown");yield t.focusPreviousPage(i)});return function(t){return e.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:200,when:D.CQ,primary:14,handler:c=>{_t(c.get(D.Lw).lastFocusedList,function(){var e=(0,w.Z)(function*(t){const i=new KeyboardEvent("keydown");yield t.focusFirst(i)});return function(t){return e.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.focusLast",weight:200,when:D.CQ,primary:13,handler:c=>{_t(c.get(D.Lw).lastFocusedList,function(){var e=(0,w.Z)(function*(t){const i=new KeyboardEvent("keydown");yield t.focusLast(i)});return function(t){return e.apply(this,arguments)}}())}}),T.W.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:200,when:y.Ao.and(D.CQ,D.bn),primary:1042,handler:(c,e)=>{const t=c.get(D.Lw).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusNext("number"==typeof e?e:1,!1,o),fa(t,i);const n=t.getFocus();n.length&&t.reveal(n[0]),ur(t)}}),T.W.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:200,when:y.Ao.and(D.CQ,D.bn),primary:1040,handler:(c,e)=>{const t=c.get(D.Lw).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusPrevious("number"==typeof e?e:1,!1,o),fa(t,i);const n=t.getFocus();n.length&&t.reveal(n[0]),ur(t)}}),T.W.registerCommandAndKeybindingRule({id:"list.collapse",weight:200,when:y.Ao.and(D.CQ,y.Ao.or(D.PS,D.RM)),primary:15,mac:{primary:15,secondary:[2064]},handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(!e||!(e instanceof Qt.H||e instanceof Jt.u||e instanceof rt.c))return;const t=e,i=t.getFocus();if(0===i.length)return;const o=i[0];if(!t.collapse(o)){const n=t.getParentElement(o);n&&_t(e,r=>{const s=new KeyboardEvent("keydown");r.setFocus([n],s)})}}}),T.W.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:200,when:D.CQ,primary:2063,mac:{primary:2063,secondary:[3088]},handler:c=>{const e=c.get(D.Lw).lastFocusedList;e&&!(e instanceof ro.aV||e instanceof so.j||e instanceof ao.i)&&e.collapseAll()}}),T.W.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:200,when:D.CQ,handler:c=>{const e=c.get(D.Lw).lastFocusedList,t=(0,D.gN)("keydown",!0);if(e instanceof Qt.H||e instanceof Jt.u||e instanceof rt.c){const i=e,o=i.getFocus();o.length>0&&i.collapse(o[0],!0),i.setSelection(o,t),i.setAnchor(o[0])}}}),T.W.registerCommandAndKeybindingRule({id:"list.focusParent",weight:200,when:D.CQ,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(!e||!(e instanceof Qt.H||e instanceof Jt.u||e instanceof rt.c))return;const t=e,i=t.getFocus();if(0===i.length)return;const n=t.getParentElement(i[0]);n&&_t(e,r=>{const s=new KeyboardEvent("keydown");r.setFocus([n],s)})}}),T.W.registerCommandAndKeybindingRule({id:"list.expand",weight:200,when:y.Ao.and(D.CQ,y.Ao.or(D.uJ,D.Zs)),primary:17,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(e)if(e instanceof Qt.H||e instanceof Jt.u){const t=e.getFocus();if(0===t.length)return;const i=t[0];if(!e.expand(i)){const o=e.getFirstElementChild(i);o&&e.getNode(o).visible&&_t(e,r=>{const s=new KeyboardEvent("keydown");r.setFocus([o],s)})}}else if(e instanceof rt.c){const t=e.getFocus();if(0===t.length)return;const i=t[0];e.expand(i).then(o=>{if(i&&!o){const n=e.getFirstElementChild(i);n&&e.getNode(n).visible&&_t(e,s=>{const a=new KeyboardEvent("keydown");s.setFocus([n],a)})}})}}}),T.W.registerCommandAndKeybindingRule({id:"list.select",weight:200,when:D.CQ,primary:3,mac:{primary:3,secondary:[2066]},handler:c=>{fr(c,!1)}}),T.W.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:200,when:D.CQ,handler:c=>{fr(c,!0)}}),T.W.registerCommandAndKeybindingRule({id:"list.selectAll",weight:200,when:y.Ao.and(D.CQ,D.bn),primary:2079,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(e instanceof ro.aV||e instanceof so.j||e instanceof ao.i){const t=e,i=new KeyboardEvent("keydown");t.setSelection((0,L.w6)(t.length),i)}else if(e instanceof Qt.H||e instanceof Jt.u||e instanceof rt.c){const t=e,i=t.getFocus(),o=t.getSelection();let n,r;i.length>0&&(0===o.length||!o.includes(i[0]))&&(n=i[0]),!n&&o.length>0&&(n=o[0]),r=n?t.getParentElement(n):void 0;const s=[],a=l=>{for(const u of l.children)u.visible&&(s.push(u.element),u.collapsed||a(u))};a(t.getNode(r)),r&&o.length===s.length&&s.unshift(r);const d=new KeyboardEvent("keydown");t.setSelection(s,d)}}}),T.W.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:200,when:D.CQ,primary:3075,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(!e)return;const t=e.getFocus();if(0===t.length)return;const i=e.getSelection(),o=i.indexOf(t[0]);e.setSelection(o>-1?[...i.slice(0,o),...i.slice(o+1)]:[...i,t[0]])}}),T.W.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:200,when:D.CQ,primary:10,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(e instanceof Qt.H||e instanceof Jt.u||e instanceof rt.c){const t=e,i=t.getFocus();if(i.length>0&&t.isCollapsible(i[0]))return void t.toggleCollapsed(i[0])}fr(c,!0)}}),T.W.registerCommandAndKeybindingRule({id:"list.clear",weight:200,when:y.Ao.and(D.CQ,D.Eu),primary:9,handler:c=>{const e=c.get(D.Lw).lastFocusedList;if(!e)return;const t=e.getSelection(),i=new KeyboardEvent("keydown");if(t.length>1)if(D.Cl.getValue(e.contextKeyService)){const n=e.getFocus();e.setSelection([n[0]],i)}else e.setSelection([],i);else e.setSelection([],i),e.setFocus([],i);e.setAnchor(void 0)}}),Z.P.registerCommand({id:"list.triggerTypeNavigation",handler:c=>{c.get(D.Lw).lastFocusedList?.triggerTypeNavigation()}}),Z.P.registerCommand({id:"list.toggleFindMode",handler:c=>{const e=c.get(D.Lw).lastFocusedList;(e instanceof Vi.CH||e instanceof rt.c)&&(e.findMode=e.findMode===Vi.sZ.Filter?Vi.sZ.Highlight:Vi.sZ.Filter)}}),Z.P.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation"),Z.P.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode"),T.W.registerCommandAndKeybindingRule({id:"list.find",weight:200,when:y.Ao.and(D.s2,D.hR),primary:2084,secondary:[61],handler:c=>{const e=c.get(D.Lw).lastFocusedList;e instanceof ro.aV||e instanceof so.j||e instanceof ao.i||(e instanceof Vi.CH||e instanceof rt.c)&&e.openFind()}}),T.W.registerCommandAndKeybindingRule({id:"list.closeFind",weight:200,when:y.Ao.and(D.s2,D.DG),primary:9,handler:c=>{const e=c.get(D.Lw).lastFocusedList;(e instanceof Vi.CH||e instanceof rt.c)&&e.closeFind()}}),T.W.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:200,when:D.CQ,primary:2064,handler:c=>{const e=c.get(D.Lw).lastFocusedList;e&&(e.scrollTop-=10)}}),T.W.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:200,when:D.CQ,primary:2066,handler:c=>{const e=c.get(D.Lw).lastFocusedList;e&&(e.scrollTop+=10)}}),T.W.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:200,when:D.CQ,handler:c=>{const e=c.get(D.Lw).lastFocusedList;e&&(e.scrollLeft-=10)}}),T.W.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:200,when:D.CQ,handler:c=>{const e=c.get(D.Lw).lastFocusedList;e&&(e.scrollLeft+=10)}}),(0,ve.Z)('.file-icon-themable-tree .align-icon-with-twisty .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree .monaco-tl-twistie.force-no-twistie,.file-icon-themable-tree.align-icons-and-twisties .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree.hide-arrows .monaco-tl-twistie:not(.force-twistie){background-image:none!important;padding-right:0!important;visibility:hidden;width:0!important}.file-icon-themable-tree .monaco-list-row .content .monaco-highlighted-label .highlight,.monaco-tl-contents .monaco-highlighted-label .highlight{background-color:var(--vscode-list-filterMatchBackground);color:unset!important;outline:1px dotted var(--vscode-list-filterMatchBorder);outline-offset:-1px}.monaco-workbench .tree-explorer-viewlet-tree-view{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .message{display:flex;padding:4px 12px 4px 18px;user-select:text;-webkit-user-select:text}.monaco-workbench .tree-explorer-viewlet-tree-view .message p{margin-bottom:0;margin-top:0;padding-bottom:4px}.monaco-workbench .tree-explorer-viewlet-tree-view .message ul{padding-left:24px}.monaco-workbench .tree-explorer-viewlet-tree-view .message.hide{display:none}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree.hide{display:none}.monaco-workbench .pane>.pane-body>.welcome-view{box-sizing:border-box;display:flex;flex-direction:column;height:100%;width:100%}.monaco-workbench .pane>.pane-body.welcome>:not(.welcome-view),.monaco-workbench .pane>.pane-body:not(.welcome)>.welcome-view{display:none}.monaco-workbench .pane>.pane-body .welcome-view-content{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;padding:0 20px 1em}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container{max-width:300px;width:100%}.monaco-workbench:not(.reduce-motion) .pane>.pane-body .welcome-view-content>.button-container{transition:max-width .2s ease-out}.monaco-workbench .pane>.pane-body .welcome-view-content.wide>.button-container{max-width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container>.monaco-button{max-width:300px}.monaco-workbench .pane>.pane-body .welcome-view-content>p{width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>*{margin-block-end:0;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.customview-tree .monaco-list-row .monaco-tl-contents.align-icon-with-twisty:before{display:none}.customview-tree .monaco-list-row .monaco-tl-contents:not(.align-icon-with-twisty):before{display:inline-block}.customview-tree .monaco-list .monaco-list-row{padding-left:0;padding-right:12px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item{display:flex;flex:1;flex-wrap:nowrap;height:22px;line-height:22px;overflow:hidden;padding-left:3px;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-selectBackground);border:1px solid var(--vscode-checkbox-selectBorder)}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-background);border:1px solid var(--vscode-checkbox-border);height:16px;margin:3px 6px 3px 0;opacity:1;padding:0;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox.codicon{font-size:13px;line-height:15px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-inputbox{flex:1;line-height:normal}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel{flex:1;overflow:hidden;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-icon-label-container:after{content:"";display:block}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon,.timeline-tree-view .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-icon{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;align-items:center;background-position:0;background-repeat:no-repeat;background-size:16px;display:flex;height:22px;justify-content:center;padding-right:6px;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.disabled{opacity:.6}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon.codicon-modifier-spin{margin-left:-6px;padding-left:6px}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon{color:currentColor!important}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel .monaco-icon-label-container>.monaco-icon-name-container{flex:1}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel:after{margin-right:4px;padding-right:0}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions{display:none}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions .action-label{padding:2px}.customview-tree .monaco-list .monaco-list-row.focused .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row:hover .custom-view-tree-node-item .actions{display:block}.viewpane-filter-container{cursor:default;display:flex}.viewpane-filter-container.grow{flex:1}.viewpane-filter-container>.viewpane-filter{align-items:center;display:flex;flex:1;position:relative}.viewpane-filter-container>.viewpane-filter .monaco-inputbox{flex:1;font-size:12px;height:24px}.pane-header .viewpane-filter-container>.viewpane-filter .monaco-inputbox .monaco-inputbox{height:20px;line-height:18px}.monaco-workbench.vs .viewpane-filter-container>.viewpane-filter .monaco-inputbox{height:25px}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls{align-items:center;bottom:0;display:flex;position:absolute;right:0;top:0}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge{border-radius:2px;margin:4px 0;padding:0 8px}.viewpane-filter.small>.viewpane-filter-controls>.viewpane-filter-badge,.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge.hidden{display:none}.viewpane-filter>.viewpane-filter-controls>.monaco-action-bar .action-item .action-label.codicon.filter{padding:2px}.panel>.title .monaco-action-bar .action-item.viewpane-filter-container{margin-right:10px;max-width:400px;min-width:150px}.pane-body .viewpane-filter-container:not(:empty){flex:1;height:auto;margin:10px 20px}.pane-body .viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-item{margin-right:4px}.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-label.codicon.codicon-filter.checked{background-color:var(--vscode-inputOption-activeBackground);border-color:var(--vscode-inputOption-activeBorder);color:var(--vscode-inputOption-activeForeground)}',{});var mr=m(22806),Al=m(4306),vr=m(94485);class _l extends P.aU{constructor(e,t){super("vs.tree.collapse",p.NC("collapse all","Collapse All"),"collapse-all",t),this.viewer=e}run(){var e=this;return(0,w.Z)(function*(){e.viewer.collapseAll(),e.viewer.setSelection([]),e.viewer.setFocus([])})()}}var br=m(94035),Tl=m(22313),ma=m(17671),va=m(97591),Vl=m(29637);class Ml extends C.JT{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new S.Q5),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}}let ba=(()=>{class c extends C.JT{constructor(t,i){super(),this.checkboxStateHandler=i,this.isDisposed=!1,this._onDidChangeState=new S.Q5,this.onDidChangeState=this._onDidChangeState.event,this.checkboxContainer=t}render(t){t.checkbox&&(this.toggle?(this.toggle.checked=t.checkbox.isChecked,this.toggle.setIcon(this.toggle.checked?$.lA.check:void 0)):this.createCheckbox(t))}createCheckbox(t){t.checkbox&&(this.toggle=new Vl.ZD({isChecked:t.checkbox.isChecked,title:this.createCheckboxTitle(t.checkbox),icon:t.checkbox.isChecked?$.lA.check:void 0,...zt.pl}),this.setAccessibilityInformation(t.checkbox),this.toggle.domNode.classList.add(c.checkboxClass),g.R3(this.checkboxContainer,this.toggle.domNode),this.registerListener(t))}registerListener(t){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(t)})))}setCheckbox(t){this.toggle&&t.checkbox&&(t.checkbox.isChecked=this.toggle.checked,this.toggle.setIcon(this.toggle.checked?$.lA.check:void 0),this.toggle.setTitle(this.createCheckboxTitle(t.checkbox)),this.setAccessibilityInformation(t.checkbox),this.checkboxStateHandler.setCheckboxState(t))}createCheckboxTitle(t){return t.tooltip?t.tooltip:t.isChecked?(0,p.NC)("checked","Checked"):(0,p.NC)("unchecked","Unchecked")}setAccessibilityInformation(t){this.toggle&&t.accessibilityInformation&&(this.toggle.domNode.ariaLabel=t.accessibilityInformation.label,t.accessibilityInformation.role&&(this.toggle.domNode.role=t.accessibilityInformation.role))}removeCheckbox(){const t=this.checkboxContainer.children;for(const i of t)this.checkboxContainer.removeChild(i)}}return c.checkboxClass="custom-view-tree-node-item-checkbox",c})(),wr=class extends Mo.qV{constructor(e,t,i,o,n,r,s,a,d,l,u){super({...e,titleMenuId:v.eH.ViewTitle,donotForwardArgs:!1},t,i,o,n,r,s,a,d,l);const{treeView:f}=me.B.as(O.IP.ViewsRegistry).getView(e.id);this.treeView=f,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(b=>this.updateTitle(b))),this._register(this.treeView.onDidChangeDescription(b=>this.updateTitleDescription(b))),this._register((0,C.OF)(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=new Ca(u,()=>this.treeView.getSelection()),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(void 0===this.treeView.dataProvider||!!this.treeView.dataProvider.isTreeEmpty)&&void 0===this.treeView.message}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};wr=(0,h.gn)([(0,h.fM)(1,Se.d),(0,h.fM)(2,ge.i),(0,h.fM)(3,G.Ui),(0,h.fM)(4,y.i6),(0,h.fM)(5,O.XH),(0,h.fM)(6,R.TG),(0,h.fM)(7,Zt.v4),(0,h.fM)(8,K.XE),(0,h.fM)(9,Ue.bU),(0,h.fM)(10,oe.lT)],wr);class yr{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=O.oC.Expanded,this.children=void 0}}function wa(c,e){const t=Z.P.getCommand(c.originalId?c.originalId:c.id);if(t){const i=v.BH.getCommand(t.id),o=i&&i.precondition;if(o)return e.contextMatchesRules(o)}return!0}const Pl=(0,p.NC)("no-dataprovider","There is no data provider registered that can provide view data."),ya=new y.uy("customTreeView",!1);class Ll extends D.ls{}let Cr=class extends C.JT{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=o,this.commandService=n,this.configurationService=r,this.progressService=s,this.contextMenuService=a,this.keybindingService=d,this.notificationService=l,this.viewDescriptorService=u,this.hoverService=f,this.contextKeyService=b,this.activityService=E,this.logService=k,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this._onDidExpandItem=this._register(new S.Q5),this.onDidExpandItem=this._onDidExpandItem.event,this._onDidCollapseItem=this._register(new S.Q5),this.onDidCollapseItem=this._onDidCollapseItem.event,this._onDidChangeSelection=this._register(new S.Q5),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeFocus=this._register(new S.Q5),this.onDidChangeFocus=this._onDidChangeFocus.event,this._onDidChangeVisibility=this._register(new S.Q5),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeActions=this._register(new S.Q5),this.onDidChangeActions=this._onDidChangeActions.event,this._onDidChangeWelcomeState=this._register(new S.Q5),this.onDidChangeWelcomeState=this._onDidChangeWelcomeState.event,this._onDidChangeTitle=this._register(new S.Q5),this.onDidChangeTitle=this._onDidChangeTitle.event,this._onDidChangeDescription=this._register(new S.Q5),this.onDidChangeDescription=this._onDidChangeDescription.event,this._onDidChangeCheckboxState=this._register(new S.Q5),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCompleteRefresh=this._register(new S.Q5),this._isInitialized=!1,this._height=0,this._width=0,this.refreshing=!1,this.root=new yr}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(xr,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(({views:e})=>{e.some(o=>o.id===this.id)&&this.tree?.updateOptions({overrideStyles:{listBackground:1===this.viewLocation?I.v9:I.Qd}})})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){const t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new S.Q5,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}getChildren(i){var o=this;return(0,w.Z)(function*(){let n;if(i&&i.children?n=i.children:((i=i??t.root).children=yield i instanceof yr?e.getChildren():e.getChildren(i),n=i.children??[],n.forEach(r=>r.parent=i)),i instanceof yr){const r=o._isEmpty;o._isEmpty=0===n.length,r!==o._isEmpty&&o._onDidChangeEmpty.fire()}return n})()}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){if((this._badge?.value!==e?.value||this._badge?.tooltip!==e?.tooltip)&&(this._badgeActivity&&(this._badgeActivity.dispose(),this._badgeActivity=void 0),this._badge=e,e)){const t={badge:new yt.mA(e.value,()=>e.tooltip),priority:50};this._badgeActivity=this.activityService.showViewActivity(this.id,t)}}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){const t=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==t&&this.tree?.updateOptions({multipleSelectionSupport:this.canSelectMany})}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(e=!1){return this.collapseAllContext||(this.collapseAllContextKey=new y.uy(`treeView.${this.id}.enableCollapseAll`,e,(0,p.NC)("treeView.enableCollapseAll","Whether the the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContext=this.collapseAllContextKey.bindTo(this.contextKeyService)),!0}get showCollapseAllAction(){return this.initializeShowCollapseAllAction(),!!this.collapseAllContext?.get()}set showCollapseAllAction(e){this.initializeShowCollapseAllAction(e),this.collapseAllContext?.set(e)}initializeShowRefreshAction(e=!1){this.refreshContext||(this.refreshContextKey=new y.uy(`treeView.${this.id}.enableRefresh`,e,(0,p.NC)("treeView.enableRefresh","Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContext=this.refreshContextKey.bindTo(this.contextKeyService))}get showRefreshAction(){return this.initializeShowRefreshAction(),!!this.refreshContext?.get()}set showRefreshAction(e){this.initializeShowRefreshAction(e),this.refreshContext?.set(e)}registerActions(){const e=this;this._register((0,v.r1)(class extends v.Ke{constructor(){super({id:`workbench.actions.treeView.${e.id}.refresh`,title:(0,p.NC)("refresh","Refresh"),menu:{id:v.eH.ViewTitle,when:y.Ao.and(y.Ao.equals("view",e.id),e.refreshContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER-1},icon:$.lA.refresh})}run(){return(0,w.Z)(function*(){return e.refresh()})()}})),this._register((0,v.r1)(class extends v.Ke{constructor(){super({id:`workbench.actions.treeView.${e.id}.collapseAll`,title:(0,p.NC)("collapseAll","Collapse All"),menu:{id:v.eH.ViewTitle,when:y.Ao.and(y.Ao.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER},precondition:e.collapseAllToggleContextKey,icon:$.lA.collapseAll})}run(){return(0,w.Z)(function*(){if(e.tree)return new _l(e.tree,!0).run()})()}}))}setVisibility(e){this.initialize(),this.isVisible!==(e=!!e)&&(this.isVisible=e,this.tree&&(this.isVisible?g.$Z(this.tree.getHTMLElement()):g.Cp(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),(0,F.fn)(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(e=!0,t){if(this.tree&&this.root.children&&this.root.children.length>0){const i=t??this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,g.R3(e,this.domNode)}create(){this.domNode=g.$(".tree-explorer-viewlet-tree-view"),this.messageElement=g.R3(this.domNode,g.$(".message")),this.updateMessage(),this.treeContainer=g.R3(this.domNode,g.$(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");const e=this._register(g.go(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}updateCheckboxes(e){const t=[];if(!this.manuallyManageCheckboxes)for(const i of e)if(void 0!==i.checkbox){let o=function(s){for(const a of s.children??[])void 0!==a.checkbox&&void 0!==s.checkbox&&(a.checkbox.isChecked=s.checkbox.isChecked,t.push(a),o(a))},r=function(s){if(s.parent&&void 0!==s.parent.checkbox&&s.parent.children){if(n.has(s.parent))return;n.add(s.parent);let a=!1,d=!1;for(const l of s.parent.children){if(a&&d)break;void 0!==l.checkbox&&(l.checkbox.isChecked?d=!0:a=!0)}d&&!a?(s.parent.checkbox.isChecked=!0,t.push(s.parent),r(s.parent)):a&&!d&&(s.parent.checkbox.isChecked=!1,t.push(s.parent),r(s.parent))}};o(i);const n=new Set;r(i)}(e=e.concat(t)).forEach(i=>this.tree?.rerender(i)),this._onDidChangeCheckboxState.fire(e)}createTree(){var e=this;const t=Be.Id.bind(void 0,this.instantiationService),i=this._register(this.instantiationService.createInstance(Sr,this.id));this.treeLabels=this._register(this.instantiationService.createInstance(Xt.RX,this));const o=this.instantiationService.createInstance(Ol,this,u=>this.progressService.withProgress({location:this.id},()=>u)),n=new Hl(this.themeService),r=this._register(new Ml);this._register(r.onDidChangeCheckboxState(u=>{this.updateCheckboxes(u)}));const s=this.instantiationService.createInstance(vi,this.id,i,this.treeLabels,t,n,r),a=this._title;this.tree=this._register(this.instantiationService.createInstance(Ll,this.id,this.treeContainer,new Nl,[s],o,{identityProvider:new Rl,accessibilityProvider:{getAriaLabel(u){if(u.accessibilityInformation)return u.accessibilityInformation.label;if((0,A.HD)(u.tooltip))return u.tooltip;{if(u.resourceUri&&!u.label)return null;let f="";return u.label&&(f+=u.label.label+" "),u.description&&(f+=u.description),f}},getRole:u=>u.accessibilityInformation?.role??"treeitem",getWidgetAriaLabel:()=>a},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:u=>u.label?u.label.label:u.resourceUri?(0,J.EZ)(W.ov.revive(u.resourceUri)):void 0},expandOnlyOnTwistieClick:u=>!!u.command||!!u.checkbox||"doubleClick"===this.configurationService.getValue("workbench.tree.expandMode"),collapseByDefault:u=>u.collapsibleState!==O.oC.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:{listBackground:1===this.viewLocation?I.v9:I.Qd}})),i.setContextKeyService(this.tree.contextKeyService),n.tree=this.tree;const d=new Ca(this.notificationService,()=>this.tree.getSelection());s.actionRunner=d,this.tree.contextKeyService.createKey(this.id,!0),ya.bindTo(this.tree.contextKeyService).set(!0),this._register(this.tree.onContextMenu(u=>this.onContextMenu(i,u,d))),this._register(this.tree.onDidChangeSelection(u=>this._onDidChangeSelection.fire(u.elements))),this._register(this.tree.onDidChangeFocus(u=>{u.elements.length&&this._onDidChangeFocus.fire(u.elements[0])})),this._register(this.tree.onDidChangeCollapseState(u=>{if(!u.node.element)return;const f=Array.isArray(u.node.element.element)?u.node.element.element[0]:u.node.element.element;u.node.collapsed?this._onDidCollapseItem.fire(f):this._onDidExpandItem.fire(f)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this._register(this.tree.onDidOpen(function(){var u=(0,w.Z)(function*(f){if(!f.browserEvent||f.browserEvent.target&&f.browserEvent.target.classList.contains(ba.checkboxClass))return;const b=e.tree.getSelection(),E=yield e.resolveCommand(1===b.length?b[0]:void 0);if(E&&wa(E,e.contextKeyService)){let k=E.arguments||[];(E.id===ut.hg||E.id===ut.oj)&&(k=[...k,f]);try{yield e.commandService.executeCommand(E.id,...k)}catch(M){e.notificationService.error(M)}}});return function(f){return u.apply(this,arguments)}}())),this._register(i.onDidChange(u=>{this.tree?.hasNode(u)&&this.tree?.rerender(u)}))}resolveCommand(e){return(0,w.Z)(function*(){let t=e?.command;return e&&!t&&e instanceof O.W6&&e.hasResolve&&(yield e.resolve((new xe.A).token),t=e.command),t})()}onContextMenu(e,t,i){this.hoverService.hideHover();const o=t.element;if(null===o)return;const n=t.browserEvent;n.preventDefault(),n.stopPropagation(),this.tree.setFocus([o]);const r=e.getResourceContextActions(o);r.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>r,getActionViewItem:s=>{const a=this.keybindingService.lookupKeybinding(s.id);if(a)return new vr.gU(s,s,{label:!0,keybinding:a.getLabel()})},onHide:s=>{s&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:o.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(Pl),this.updateContentAreas()}showMessage(e){this._messageValue=e,this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),(0,Kt.m5)(this._message)||(this.messageElement.textContent=this._messageValue),this.layout(this._height,this._width))}hideMessage(){this.resetMessageElement(),this.messageElement?.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&g.PO(this.messageElement)}layout(e,t){if(e&&t&&this.messageElement&&this.treeContainer){this._height=e,this._width=t;const i=e-g.wn(this.messageElement);this.treeContainer.style.height=i+"px",this.tree?.layout(i,t)}}getOptimalWidth(){if(this.tree){const e=this.tree.getHTMLElement(),t=[].slice.call(e.querySelectorAll(".outline-item-label > a"));return g.TW(e,t)}return 0}refresh(e){var t=this;return(0,w.Z)(function*(){if(t.dataProvider&&t.tree){t.refreshing&&(yield S.ju.toPromise(t._onDidCompleteRefresh.event)),e||(e=[t.root],t.elementsToRefresh=[]);for(const i of e)i.children=void 0;if(t.isVisible)return t.doRefresh(e);if(t.elementsToRefresh.length){const i=new Set;t.elementsToRefresh.forEach(o=>i.add(o.handle));for(const o of e)i.has(o.handle)||t.elementsToRefresh.push(o)}else t.elementsToRefresh.push(...e)}})()}expand(e){var t=this;return(0,w.Z)(function*(){const i=t.tree;if(i)try{e=Array.isArray(e)?e:[e];for(const o of e)yield i.expand(o,!1)}catch{}})()}isCollapsed(e){return!!this.tree?.isCollapsed(e)}setSelection(e){this.tree?.setSelection(e)}getSelection(){return this.tree?.getSelection()??[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):this.tree.setFocus([]))}reveal(e){var t=this;return(0,w.Z)(function*(){if(t.tree)return t.tree.reveal(e)})()}doRefresh(e){var t=this;return(0,w.Z)(function*(){const i=t.tree;if(i&&t.visible){t.refreshing=!0;const o=i.getSelection();try{yield Promise.all(e.map(r=>i.updateChildren(r,!0,!0)))}catch(r){t.logService.error(r)}const n=i.getSelection();(o.length!==n.length||o.some((r,s)=>r.handle!==n[s].handle))&&t._onDidChangeSelection.fire(n),t.refreshing=!1,t._onDidCompleteRefresh.fire(),t.updateContentAreas(),t.focused&&t.focus(!1),t.updateCollapseAllToggle()}})()}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContextKey=new y.uy(`treeView.${this.id}.toggleCollapseAll`,!1,(0,p.NC)("treeView.toggleCollapseAll","Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContext=this.collapseAllToggleContextKey.bindTo(this.contextKeyService))}updateCollapseAllToggle(){this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),this.collapseAllToggleContext?.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(e=>e.collapsibleState!==O.oC.None)))}updateContentAreas(){!this._messageValue||this.root.children&&0!==this.root.children.length||this.refreshing||!this.treeContainer?this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode.removeAttribute("tabindex")):(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0"))}get container(){return this._container}};Cr=(0,h.gn)([(0,h.fM)(2,K.XE),(0,h.fM)(3,R.TG),(0,h.fM)(4,Z.H),(0,h.fM)(5,G.Ui),(0,h.fM)(6,Gt.R9),(0,h.fM)(7,ge.i),(0,h.fM)(8,Se.d),(0,h.fM)(9,oe.lT),(0,h.fM)(10,O.XH),(0,h.fM)(11,tt.B),(0,h.fM)(12,y.i6),(0,h.fM)(13,yt.By),(0,h.fM)(14,Ae.VZ)],Cr);class Rl{getId(e){return e.handle}}class Nl{getHeight(e){return vi.ITEM_HEIGHT}getTemplateId(e){return vi.TREE_TEMPLATE_ID}}class Ol{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==O.oC.None}getChildren(e){var t=this;return(0,w.Z)(function*(){let i=[];if(t.treeView.dataProvider)try{i=(yield t.withProgress(t.treeView.dataProvider.getChildren(e)))??[]}catch(o){if(!o.message.startsWith("Bad progress location:"))throw o}return i})()}}let vi=class Qa extends C.JT{constructor(e,t,i,o,n,r,s,a,d,l,u,f){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=o,this.aligner=n,this.checkboxStateHandler=r,this.themeService=s,this.configurationService=a,this.labelService=d,this.hoverService=l,this.treeViewsService=u,this.contextKeyService=f,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate={showHover:b=>this.hoverService.showHover(b),delay:this.configurationService.getValue("workbench.hover.delay")},this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender()))}get templateId(){return Qa.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");const t=g.R3(e,g.$("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),o=g.Ce(i.element,g.$(".custom-view-tree-node-item-icon")),n=g.R3(i.element,g.$(".actions"));return{resourceLabel:i,icon:o,checkboxContainer:t,actionBar:new qe.o(n,{actionViewItemProvider:this.actionViewItemProvider}),container:e,elementDisposable:new C.SL}}getHover(e,t,i){return i instanceof O.W6&&i.hasResolve?{markdown:"string"==typeof i.tooltip?i.tooltip:o=>new Promise(n=>{i.resolve(o).then(()=>n(i.tooltip))}),markdownNotSupportedFallback:t?void 0:e??""}:t&&!i.tooltip?void 0:void 0===i.tooltip?e:(0,A.HD)(i.tooltip)?""!==i.tooltip?i.tooltip:void 0:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:(0,Al.DI)(i.tooltip)}}renderElement(e,t,i){const o=e.element,n=o.resourceUri?W.ov.revive(o.resourceUri):null,r=o.label?o.label:n?{label:(0,J.EZ)(n)}:void 0,s=(0,A.HD)(o.description)?o.description:n&&!0===o.description?this.labelService.getUriLabel((0,J.XX)(n),{relative:!0}):void 0,a=r?r.label:void 0,d=r&&r.highlights&&a?r.highlights.map(([k,M])=>{if(k<0&&(k=a.length+k),M<0&&(M=a.length+M),k>=a.length||M>a.length)return{start:0,end:0};if(k>M){const X=k;k=M,M=X}return{start:k,end:M}}):void 0,l=this.themeService.getColorTheme().type===Ki.eL.LIGHT?o.icon:o.iconDark,u=l?W.ov.revive(l):void 0,f=this.getHover(a,n,o);i.actionBar.clear(),i.icon.style.color="";let b=!0;if(o.command&&(b=wa(o.command,this.contextKeyService)),this.renderCheckbox(o,i),n){const k=this.configurationService.getValue("explorer.decorations"),M=n||W.ov.parse("missing:_icon_resource");i.resourceLabel.setResource({name:a,description:s,resource:M},{fileKind:this.getFileKind(o),title:f,hideIcon:this.shouldHideResourceLabelIcon(u,o.themeIcon),fileDecorations:k,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||(0,Ui.mB)(e.filterData),strikethrough:r?.strikethrough,disabledCommand:!b,labelEscapeNewLines:!0})}else i.resourceLabel.setResource({name:a,description:s},{title:f,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||(0,Ui.mB)(e.filterData),strikethrough:r?.strikethrough,disabledCommand:!b,labelEscapeNewLines:!0});if(u)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=g.wY(u);else{let k;this.shouldShowThemeIcon(!!n,o.themeIcon)&&(k=be.kS.asClassName(o.themeIcon),o.themeIcon.color&&(i.icon.style.color=this.themeService.getColorTheme().getColor(o.themeIcon.color.id)?.toString()??"")),i.icon.className=k?`custom-view-tree-node-item-icon ${k}`:"",i.icon.style.backgroundImage=""}b||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:o.handle};const E=this.menus.getResourceActions(o);E.menu&&i.elementDisposable.add(E.menu),i.actionBar.push(E.actions,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,o),this.treeViewsService.addRenderedTreeItemElement(o,i.container),this._renderedElements.set(e,i)}rerender(){const e=new Set(this._renderedElements.keys());for(const t of e){const i=this._renderedElements.get(t);i&&(this.disposeElement(t,0,i),this.renderElement(t,0,i))}}renderCheckbox(e,t){if(e.checkbox){if(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),!t.checkbox){const i=new ba(t.checkboxContainer,this.checkboxStateHandler);t.checkbox=i}t.checkbox.render(e)}else t.checkbox&&(t.checkbox.dispose(),t.checkbox=void 0)}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",!this._hasCheckbox&&this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return!(!t||e&&this.isFileKindThemeIcon(t))}isFolderThemeIcon(e){return e?.id===K.gT.id}isFileKindThemeIcon(e){return!!e&&(e.id===K.Cs.id||this.isFolderThemeIcon(e))}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case K.Cs.id:return z.RR.FILE;case K.gT.id:return z.RR.FOLDER}return e.collapsibleState===O.oC.Collapsed||e.collapsibleState===O.oC.Expanded?z.RR.FOLDER:z.RR.FILE}disposeElement(e,t,i){i.elementDisposable.clear(),this._renderedElements.delete(e),this.treeViewsService.removeRenderedTreeItemElement(e.element),i.checkbox?.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose()}};vi.ITEM_HEIGHT=22,vi.TREE_TEMPLATE_ID="treeExplorer",vi=(0,h.gn)([(0,h.fM)(6,K.XE),(0,h.fM)(7,G.Ui),(0,h.fM)(8,Ut.e),(0,h.fM)(9,tt.B),(0,h.fM)(10,ma.C),(0,h.fM)(11,y.i6)],vi);class Hl extends C.JT{constructor(e){super(),this.themeService=e}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==O.oC.None||!this.hasIcon(e))return!1;if(this._tree){const t=this._tree.getParentElement(e)||this._tree.getInput();return this.hasIcon(t)?!!t.children&&t.children.some(i=>i.collapsibleState!==O.oC.None&&!this.hasIcon(i)):!!t.children&&t.children.every(i=>i.collapsibleState===O.oC.None||!this.hasIcon(i))}return!1}hasIcon(e){if(this.themeService.getColorTheme().type===Ki.eL.LIGHT?e.icon:e.iconDark)return!0;if(e.resourceUri||e.themeIcon){const i=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===K.gT.id:e.collapsibleState!==O.oC.None)?i.hasFileIcons&&i.hasFolderIcons:i.hasFileIcons}return!1}}class Ca extends P.Wi{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(i=>{i.error&&!(0,Xe.n2)(i.error)&&e.error((0,p.NC)("command-error","Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",i.error.message,i.action.id))}))}runAction(e,t){var i=this;return(0,w.Z)(function*(){const o=i.getSelectedResources();let n,r=!1;o.length>1&&(n=o.map(s=>((s.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(r=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:s.handle}))),r||(n=void 0),yield e.run(t,n)})()}}let Sr=class extends C.JT{constructor(e,t){super(),this.id=e,this.menuService=t,this._onDidChange=new S.Q5,this.onDidChange=this._onDidChange.event}getResourceActions(e){const t=this.getActions(v.eH.ViewItemContext,e,!0);return{menu:t.menu,actions:t.primary}}getResourceContextActions(e){return this.getActions(v.eH.ViewItemContext,e).secondary}setContextKeyService(e){this.contextKeyService=e}getActions(e,t,i=!1){if(!this.contextKeyService)return{primary:[],secondary:[]};const o=this.contextKeyService.createOverlay([["view",this.id],["viewItem",t.contextValue]]),n=this.menuService.createMenu(e,o),a={primary:[],secondary:[],menu:n};return(0,Be.LJ)(n,{shouldForwardArgs:!0},a,"inline"),i?this._register(n.onDidChange(()=>this._onDidChange.fire(t))):n.dispose(),a}dispose(){this.contextKeyService=void 0,super.dispose()}};Sr=(0,h.gn)([(0,h.fM)(1,v.co)],Sr);let Er=class extends Cr{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X,ee){super(e,t,o,n,r,s,a,d,l,u,f,E,b,M,ee),this.extensionId=i,this.extensionService=k,this.telemetryService=X,this.activated=!1}activate(){this.activated||(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new Fs.NE(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent(`onView:${this.id}`)).then(()=>(0,Ve.Vs)(2e3)).then(()=>{this.updateMessage()}),this.activated=!0)}};Er=(0,h.gn)([(0,h.fM)(3,K.XE),(0,h.fM)(4,R.TG),(0,h.fM)(5,Z.H),(0,h.fM)(6,G.Ui),(0,h.fM)(7,Gt.R9),(0,h.fM)(8,ge.i),(0,h.fM)(9,Se.d),(0,h.fM)(10,oe.lT),(0,h.fM)(11,O.XH),(0,h.fM)(12,y.i6),(0,h.fM)(13,tt.B),(0,h.fM)(14,Pt.QS),(0,h.fM)(15,yt.By),(0,h.fM)(16,Ue.bU),(0,h.fM)(17,Ae.VZ)],Er);let xr=class{constructor(e,t,i,o,n){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=o,this.logService=n,this.treeItemsTransfer=Ke.Ej.getInstance(),this.treeMimeType=`application/vnd.code.tree.${e.toLowerCase()}`}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,o){return e.handleDrag(t,i,o).then(n=>{if(n){const r=[];for(const s of n)s[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(a=>a===s[0])<0&&r.push(s[0]);r.length&&this.logService.warn(`Drag and drop controller for tree ${this.treeId} adds the following data transfer types but does not declare them in dragMimeTypes: ${r.join(", ")}`)}return n})}addExtensionProvidedTransferTypes(e,t){if(!e.dataTransfer||!this.dndController)return;const i=(0,qr.R)();this.dragCancellationToken=new xe.A,this.treeViewsDragAndDropService.addDragOperationTransfer(i,this.handleDragAndLog(this.dndController,t,i,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new At.f(i)],At.f.prototype),e.dataTransfer.clearData(br.vW.text),this.dndController.dragMimeTypes.find(o=>o===br.vW.uriList)&&e.dataTransfer?.setData(gi.go.RESOURCES,""),this.dndController.dragMimeTypes.forEach(o=>{e.dataTransfer?.setData(o,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(o=>(0,B.Gj)(o,t,e));const i=t.filter(o=>o.scheme===Me.lg.file).map(o=>o.fsPath);i.length&&e.dataTransfer.setData(Ke.Km.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){const i=e.getData(),o=[],n={id:this.treeId,itemHandles:[]};i.forEach(r=>{n.itemHandles.push(r.handle),r.resourceUri&&o.push(W.ov.revive(r.resourceUri))}),this.addResourceInfoToTransfer(t,o),this.addExtensionProvidedTransferTypes(t,n.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(n))}}debugLog(e){this.logService.debug(e.size?`TreeView dragged mime types: ${Array.from(e).join(", ")}`:"TreeView dragged with no supported mime types.")}onDragOver(e,t,i,o){const n=(0,va.L)(o.dataTransfer),r=new Set(Array.from(n,d=>d[0]));if(o.dataTransfer)for(const d of o.dataTransfer.items)if("file"===d.kind||d.type===gi.go.RESOURCES.toLowerCase()){r.add(br.vW.uriList);break}this.debugLog(r);const s=this.dndController;return!(!s||!o.dataTransfer||0===s.dropMimeTypes.length)&&!!Array.from(r).some((d,l)=>d===this.treeMimeType||s.dropMimeTypes.indexOf(d)>=0)&&{accept:!0,bubble:0,autoExpand:!0}}getDragURI(e){return this.dndController?e.resourceUri?W.ov.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);const t=e[0];return t.label?t.label.label:t.resourceUri?this.labelService.getUriLabel(W.ov.revive(t.resourceUri)):void 0}drop(e,t,i,o){var n=this;return(0,w.Z)(function*(){const r=n.dndController;if(!o.dataTransfer||!r)return;let s,a;n.treeItemsTransfer.hasData(At.f.prototype)&&(a=n.treeItemsTransfer.getData(At.f.prototype)[0].identifier);const d=(0,va.L)(o.dataTransfer,!0),l=new Tl.Hl;for(const[f,b]of d)if((f===n.treeMimeType||r.dropMimeTypes.includes(f)||b.asFile()&&r.dropMimeTypes.includes(gi.go.FILES.toLowerCase()))&&(l.append(f,b),f===n.treeMimeType))try{s=JSON.parse(yield b.asString())}catch{}const u=yield n.treeViewsDragAndDropService.removeDragOperationTransfer(a);if(u)for(const[f,b]of u)l.append(f,b);return r.handleDrop(l,t,xe.T.None,a,s?.id,s?.itemHandles)})()}onDragEnd(e){"none"===e.dataTransfer?.dropEffect&&this.dragCancellationToken?.cancel()}};xr=(0,h.gn)([(0,h.fM)(1,Ut.e),(0,h.fM)(2,R.TG),(0,h.fM)(3,Un.m),(0,h.fM)(4,Ae.VZ)],xr);var Bl=m(94014),Sa=m(86390),H=m(23448),Fl=m(17912),Wl=m(41312);const Ne=(0,R.yh)("remoteExplorerService"),kr="remote.tunnels.toRestore",Dr="~remote.forwardedPorts";var ne=(()=>((ne=ne||{}).Candidate="Candidate",ne.Detected="Detected",ne.Forwarded="Forwarded",ne.Add="Add",ne))(),Je=(()=>((Je=Je||{}).Other="Other",Je.User="User",Je.AutoForwardEnd="AutoForwardEnd",Je))(),de=(()=>((de=de||{})[de.None=0]="None",de[de.New=1]="New",de[de.Label=2]="Label",de[de.LocalPort=3]="LocalPort",de))(),Oe=(()=>((Oe=Oe||{})[Oe.User=0]="User",Oe[Oe.Auto=1]="Auto",Oe[Oe.Extension=2]="Extension",Oe))();const Ir={source:Oe.User,description:p.NC("tunnel.source.user","User Forwarded")};function Ce(c,e){return c+":"+e}function Xo(c){const e=c.match(/^([a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*:)?([0-9]+)$/);if(e)return{host:e[1]?.substring(0,e[1].length-1)||"localhost",port:Number(e[2])}}function Ea(c,e,t){const i=c.get(Ce(e,t));if(i)return i;if((0,H.a8)(e))for(const o of H.y1){const n=Ce(o,t);if(c.has(n))return c.get(n)}else if((0,H.BP)(e))for(const o of H.r1){const n=Ce(o,t);if(c.has(n))return c.get(n)}}function He(c,e,t){const i=Ea(c,e,t);if(i)return i;const o=(0,H.BP)(e)?"localhost":(0,H.a8)(e)?"0.0.0.0":void 0;return o?Ea(c,o,t):void 0}p.NC("tunnel.source.auto","Auto Forwarded");var Ge=(()=>((Ge=Ge||{}).Notify="notify",Ge.OpenBrowser="openBrowser",Ge.OpenBrowserOnce="openBrowserOnce",Ge.OpenPreview="openPreview",Ge.Silent="silent",Ge.Ignore="ignore",Ge))();let xa=(()=>{class c extends C.JT{constructor(t){super(),this.configurationService=t,this.portsAttributes=[],this._onDidChangeAttributes=new S.Q5,this.onDidChangeAttributes=this._onDidChangeAttributes.event,this._register(t.onDidChangeConfiguration(i=>{(i.affectsConfiguration(c.SETTING)||i.affectsConfiguration(c.DEFAULTS))&&this.updateAttributes()})),this.updateAttributes()}updateAttributes(){this.portsAttributes=this.readSetting(),this._onDidChangeAttributes.fire()}getAttributes(t,i,o){let n=this.findNextIndex(t,i,o,this.portsAttributes,0);const r={label:void 0,onAutoForward:void 0,elevateIfNeeded:void 0,requireLocalPort:void 0,protocol:void 0};for(;n>=0;){const s=this.portsAttributes[n];s.key===t?(r.onAutoForward=s.onAutoForward??r.onAutoForward,r.elevateIfNeeded=void 0!==s.elevateIfNeeded?s.elevateIfNeeded:r.elevateIfNeeded,r.label=s.label??r.label,r.requireLocalPort=s.requireLocalPort,r.protocol=s.protocol):(r.onAutoForward=r.onAutoForward??s.onAutoForward,r.elevateIfNeeded=void 0!==r.elevateIfNeeded?r.elevateIfNeeded:s.elevateIfNeeded,r.label=r.label??s.label,r.requireLocalPort=void 0!==r.requireLocalPort?r.requireLocalPort:void 0,r.protocol=r.protocol??s.protocol),n=this.findNextIndex(t,i,o,this.portsAttributes,n+1)}return void 0!==r.onAutoForward||void 0!==r.elevateIfNeeded||void 0!==r.label||void 0!==r.requireLocalPort||void 0!==r.protocol?r:this.getOtherAttributes()}hasStartEnd(t){return void 0!==t.start&&void 0!==t.end}hasHostAndPort(t){return void 0!==t.host&&void 0!==t.port&&(0,A.HD)(t.host)&&(0,A.hj)(t.port)}findNextIndex(t,i,o,n,r){if(r>=n.length)return-1;const s=!(0,H.a8)(i)&&!(0,H.BP)(i),d=n.slice(r).findIndex(l=>(0,A.hj)(l.key)?!s&&l.key===t:this.hasStartEnd(l.key)?!s&&t>=l.key.start&&t<=l.key.end:this.hasHostAndPort(l.key)?t===l.key.port&&i===l.key.host:!!o&&l.key.test(o));return d>=0?d+r:-1}readSetting(){const t=this.configurationService.getValue(c.SETTING);if(!t||!(0,A.Kn)(t))return[];const i=[];for(const n in t){if(void 0===n)continue;const r=t[n];let s;if(Number(n))s=Number(n);else if((0,A.HD)(n))if(c.RANGE.test(n)){const a=n.match(c.RANGE);s={start:Number(a[1]),end:Number(a[2])}}else if(c.HOST_AND_PORT.test(n)){const a=n.match(c.HOST_AND_PORT);s={host:a[1],port:Number(a[2])}}else{let a;try{a=RegExp(n)}catch{}a&&(s=a)}s&&i.push({key:s,elevateIfNeeded:r.elevateIfNeeded,onAutoForward:r.onAutoForward,label:r.label,requireLocalPort:r.requireLocalPort,protocol:r.protocol})}const o=this.configurationService.getValue(c.DEFAULTS);return o&&(this.defaultPortAttributes={elevateIfNeeded:o.elevateIfNeeded,label:o.label,onAutoForward:o.onAutoForward,requireLocalPort:o.requireLocalPort,protocol:o.protocol}),this.sortAttributes(i)}sortAttributes(t){function i(o,n){return(0,A.hj)(o.key)?o.key:n.hasStartEnd(o.key)?o.key.start:n.hasHostAndPort(o.key)?o.key.port:Number.MAX_VALUE}return t.sort((o,n)=>i(o,this)-i(n,this))}getOtherAttributes(){return this.defaultPortAttributes}static providedActionToAction(t){switch(t){case H.PO.Notify:return Ge.Notify;case H.PO.OpenBrowser:return Ge.OpenBrowser;case H.PO.OpenBrowserOnce:return Ge.OpenBrowserOnce;case H.PO.OpenPreview:return Ge.OpenPreview;case H.PO.Silent:return Ge.Silent;case H.PO.Ignore:return Ge.Ignore;default:return}}addAttributes(t,i,o){var n=this;return(0,w.Z)(function*(){const s=n.configurationService.inspect(c.SETTING).userRemoteValue;let a;a=s&&(0,A.Kn)(s)?(0,Fo.I8)(s):{},a[`${t}`]||(a[`${t}`]={});for(const d in i)a[`${t}`][d]=i[d];return n.configurationService.updateValue(c.SETTING,a,o)})()}}return c.SETTING="remote.portsAttributes",c.DEFAULTS="remote.otherPortsAttributes",c.RANGE=/^(\d+)\-(\d+)$/,c.HOST_AND_PORT=/^([a-z0-9\-]+):(\d{1,5})$/,c})(),Yo=class extends C.JT{constructor(e,t,i,o,n,r,s,a){var d;super(),d=this,this.tunnelService=e,this.storageService=t,this.configurationService=i,this.environmentService=o,this.remoteAuthorityResolverService=n,this.workspaceContextService=r,this.logService=s,this.dialogService=a,this.inProgress=new Map,this._onForwardPort=new S.Q5,this.onForwardPort=this._onForwardPort.event,this._onClosePort=new S.Q5,this.onClosePort=this._onClosePort.event,this._onPortName=new S.Q5,this.onPortName=this._onPortName.event,this._onCandidatesChanged=new S.Q5,this.onCandidatesChanged=this._onCandidatesChanged.event,this._onEnvironmentTunnelsSet=new S.Q5,this.onEnvironmentTunnelsSet=this._onEnvironmentTunnelsSet.event,this._environmentTunnelsSet=!1,this.unrestoredExtensionTunnels=new Map,this.sessionCachedProperties=new Map,this.portAttributesProviders=[],this.mismatchCooldown=new Date,this.configPortsAttributes=new xa(i),this.tunnelRestoreValue=this.getTunnelRestoreValue(),this._register(this.configPortsAttributes.onDidChangeAttributes(this.updateAttributes,this)),this.forwarded=new Map,this.remoteTunnels=new Map,this.tunnelService.tunnels.then(function(){var l=(0,w.Z)(function*(u){const f=yield d.getAttributes(u.map(b=>({port:b.tunnelRemotePort,host:b.tunnelRemoteHost})));for(const b of u)if(b.localAddress){const E=Ce(b.tunnelRemoteHost,b.tunnelRemotePort),k=He(d._candidates??new Map,b.tunnelRemoteHost,b.tunnelRemotePort);d.forwarded.set(E,{remotePort:b.tunnelRemotePort,remoteHost:b.tunnelRemoteHost,localAddress:b.localAddress,protocol:f?.get(b.tunnelRemotePort)?.protocol??H.hh.Http,localUri:yield d.makeLocalUri(b.localAddress,f?.get(b.tunnelRemotePort)),localPort:b.tunnelLocalPort,runningProcess:k?.detail,hasRunningProcess:!!k,pid:k?.pid,privacy:b.privacy,source:Ir}),d.remoteTunnels.set(E,b)}});return function(u){return l.apply(this,arguments)}}()),this.detected=new Map,this._register(this.tunnelService.onTunnelOpened(function(){var l=(0,w.Z)(function*(u){const f=Ce(u.tunnelRemoteHost,u.tunnelRemotePort);if(!He(d.forwarded,u.tunnelRemoteHost,u.tunnelRemotePort)&&!He(d.detected,u.tunnelRemoteHost,u.tunnelRemotePort)&&!He(d.inProgress,u.tunnelRemoteHost,u.tunnelRemotePort)&&u.localAddress){const b=He(d._candidates??new Map,u.tunnelRemoteHost,u.tunnelRemotePort),E=(yield d.getAttributes([{port:u.tunnelRemotePort,host:u.tunnelRemoteHost}]))?.get(u.tunnelRemotePort);d.forwarded.set(f,{remoteHost:u.tunnelRemoteHost,remotePort:u.tunnelRemotePort,localAddress:u.localAddress,protocol:E?.protocol??H.hh.Http,localUri:yield d.makeLocalUri(u.localAddress,E),localPort:u.tunnelLocalPort,closeable:!0,runningProcess:b?.detail,hasRunningProcess:!!b,pid:b?.pid,privacy:u.privacy,source:Ir})}yield d.storeForwarded(),d.remoteTunnels.set(f,u),d._onForwardPort.fire(d.forwarded.get(f))});return function(u){return l.apply(this,arguments)}}())),this._register(this.tunnelService.onTunnelClosed(l=>this.onTunnelClosed(l,Je.Other)))}onTunnelClosed(e,t){var i=this;return(0,w.Z)(function*(){const o=Ce(e.host,e.port);i.forwarded.has(o)&&(i.forwarded.delete(o),yield i.storeForwarded(),i._onClosePort.fire(e))})()}makeLocalUri(e,t){return e.startsWith("http")?W.ov.parse(e):W.ov.parse(`${t?.protocol??"http"}://${e}`)}getStorageKey(){var e=this;return(0,w.Z)(function*(){const t=e.workspaceContextService.getWorkspace(),i=t.configuration?(0,di.vp)(t.configuration.path):t.folders.length>0?(0,di.vp)(t.folders[0].uri.path):void 0;if(void 0!==i)return`${kr}.${e.environmentService.remoteAuthority}.${i}`;e.logService.debug("Could not get workspace hash for forwarded ports storage key.")})()}getTunnelRestoreValue(){var e=this;return(0,w.Z)(function*(){const t=e.storageService.get(kr,1);if(t)return e.storageService.remove(kr,1),yield e.storeForwarded(),t;const i=yield e.getStorageKey();return i?e.storageService.get(i,0):void 0})()}restoreForwarded(){var e=this;return(0,w.Z)(function*(){if(e.configurationService.getValue("remote.restoreForwardedPorts")){const t=yield e.tunnelRestoreValue;if(t&&t!==e.knownPortsRestoreValue){const i=JSON.parse(t)??[];e.logService.trace(`ForwardedPorts: (TunnelModel) restoring ports ${i.map(o=>o.remotePort).join(", ")}`);for(const o of i){const n=He(e.detected,o.remoteHost,o.remotePort);o.source.source===Oe.User&&!n||o.source.source===Oe.Extension&&n?yield e.forward({remote:{host:o.remoteHost,port:o.remotePort},local:o.localPort,name:o.name,privacy:o.privacy,elevateIfNeeded:!0}):o.source.source===Oe.Extension&&!n&&e.unrestoredExtensionTunnels.set(Ce(o.remoteHost,o.remotePort),o)}}}if(!e.restoreListener){const t=yield e.getStorageKey();e.restoreListener=e._register(e.storageService.onDidChangeValue(function(){var i=(0,w.Z)(function*(o){o.key===t&&(e.tunnelRestoreValue=Promise.resolve(e.storageService.get(t,0)),yield e.restoreForwarded())});return function(o){return i.apply(this,arguments)}}()))}})()}storeForwarded(){var e=this;return(0,w.Z)(function*(){if(e.configurationService.getValue("remote.restoreForwardedPorts")){const t=JSON.stringify(Array.from(e.forwarded.values()).filter(i=>i.source.source!==Oe.Auto));if(t!==e.knownPortsRestoreValue){e.knownPortsRestoreValue=t;const i=yield e.getStorageKey();i&&e.storageService.store(i,e.knownPortsRestoreValue,0,0)}}})()}showPortMismatchModalIfNeeded(e,t,i){var o=this;return(0,w.Z)(function*(){if(!e.tunnelLocalPort||!i?.requireLocalPort||e.tunnelLocalPort===t)return;const n=new Date;if(o.mismatchCooldown.getTime()+1e4>n.getTime())return;o.mismatchCooldown=n;const r=p.NC("remote.localPortMismatch.single","Local port {0} could not be used for forwarding to remote port {1}.\n\nThis usually happens when there is already another process using local port {0}.\n\nPort number {2} has been used instead.",t,e.tunnelRemotePort,e.tunnelLocalPort);return o.dialogService.info(r)})()}forward(e,t){var i=this;return(0,w.Z)(function*(){const o=He(i.forwarded,e.remote.host,e.remote.port);t=t??(null!==t?(yield i.getAttributes([e.remote]))?.get(e.remote.port):void 0);const n=void 0!==e.local?e.local:e.remote.port;if(o)return i.mergeAttributesIntoExistingTunnel(o,e,t);{const r=i.environmentService.remoteAuthority,s=r?{getAddress:(l=(0,w.Z)(function*(){return(yield i.remoteAuthorityResolverService.resolveAuthority(r)).authority}),function(){return l.apply(this,arguments)})}:void 0,a=Ce(e.remote.host,e.remote.port);i.inProgress.set(a,!0),e=i.mergeCachedAndUnrestoredProperties(a,e);const d=yield i.tunnelService.openTunnel(s,e.remote.host,e.remote.port,void 0,n,e.elevateIfNeeded?e.elevateIfNeeded:t?.elevateIfNeeded,e.privacy,t?.protocol);if(d&&d.localAddress){const l=He(i._candidates??new Map,e.remote.host,e.remote.port),u=d.protocol?d.protocol===H.hh.Https?H.hh.Https:H.hh.Http:t?.protocol??H.hh.Http,f={remoteHost:d.tunnelRemoteHost,remotePort:d.tunnelRemotePort,localPort:d.tunnelLocalPort,name:t?.label??e.name,closeable:!0,localAddress:d.localAddress,protocol:u,localUri:yield i.makeLocalUri(d.localAddress,t),runningProcess:l?.detail,hasRunningProcess:!!l,pid:l?.pid,source:e.source??Ir,privacy:d.privacy};return i.forwarded.set(a,f),i.remoteTunnels.set(a,d),i.inProgress.delete(a),yield i.storeForwarded(),yield i.showPortMismatchModalIfNeeded(d,n,t),i._onForwardPort.fire(f),d}i.inProgress.delete(a)}var l})()}mergeCachedAndUnrestoredProperties(e,t){const i=this.unrestoredExtensionTunnels.has(e)?this.unrestoredExtensionTunnels:this.sessionCachedProperties.has(e)?this.sessionCachedProperties:void 0;if(i){const o=i.get(e);i.delete(e),o&&(t.name=o.name??t.name,t.local=("local"in o?o.local:"localPort"in o?o.localPort:void 0)??t.local,t.privacy=o.privacy??t.privacy)}return t}mergeAttributesIntoExistingTunnel(e,t,i){var o=this;return(0,w.Z)(function*(){const n=i?.label??t.name;let r;var a;(a=r||(r={}))[a.None=0]="None",a[a.Fire=1]="Fire",a[a.Reopen=2]="Reopen";let s=r.None;switch(n!==e.name&&(e.name=n,s=r.Fire),(i?.protocol||e.protocol!==H.hh.Http)&&i?.protocol!==e.protocol&&(t.source=e.source,s=r.Reopen),t.privacy&&e.privacy!==t.privacy&&(s=r.Reopen),s){case r.Fire:o._onForwardPort.fire();break;case r.Reopen:yield o.close(e.remoteHost,e.remotePort,Je.User),yield o.forward(t,i)}return He(o.remoteTunnels,t.remote.host,t.remote.port)})()}name(e,t,i){var o=this;return(0,w.Z)(function*(){const n=He(o.forwarded,e,t),r=Ce(e,t);if(n)return n.name=i,yield o.storeForwarded(),void o._onPortName.fire({host:e,port:t});o.detected.has(r)&&(o.detected.get(r).name=i,o._onPortName.fire({host:e,port:t}))})()}close(e,t,i){var o=this;return(0,w.Z)(function*(){const n=Ce(e,t),r=o.forwarded.get(n);return i===Je.AutoForwardEnd&&o.sessionCachedProperties.set(n,{local:r.localPort,name:r.name,privacy:r.privacy}),yield o.tunnelService.closeTunnel(e,t),o.onTunnelClosed({host:e,port:t},i)})()}address(e,t){const i=Ce(e,t);return(this.forwarded.get(i)||this.detected.get(i))?.localAddress}get environmentTunnelsSet(){return this._environmentTunnelsSet}addEnvironmentTunnels(e){if(e)for(const t of e){const i=He(this._candidates??new Map,t.remoteAddress.host,t.remoteAddress.port),o="string"==typeof t.localAddress?t.localAddress:Ce(t.localAddress.host,t.localAddress.port);this.detected.set(Ce(t.remoteAddress.host,t.remoteAddress.port),{remoteHost:t.remoteAddress.host,remotePort:t.remoteAddress.port,localAddress:o,protocol:H.hh.Http,localUri:this.makeLocalUri(o),closeable:!1,runningProcess:i?.detail,hasRunningProcess:!!i,pid:i?.pid,privacy:H.xh.ConstantPrivate,source:{source:Oe.Extension,description:p.NC("tunnel.staticallyForwarded","Statically Forwarded")}}),this.tunnelService.setEnvironmentTunnel(t.remoteAddress.host,t.remoteAddress.port,o,H.xh.ConstantPrivate,H.hh.Http)}this._environmentTunnelsSet=!0,this._onEnvironmentTunnelsSet.fire(),this._onForwardPort.fire()}setCandidateFilter(e){this._candidateFilter=e}setCandidates(e){var t=this;return(0,w.Z)(function*(){let i=e;t._candidateFilter&&(i=yield t._candidateFilter(e));const o=t.updateInResponseToCandidates(i);t.logService.trace(`ForwardedPorts: (TunnelModel) removed candidates ${Array.from(o.values()).map(n=>n.port).join(", ")}`),t._onCandidatesChanged.fire(o)})()}updateInResponseToCandidates(e){const t=this._candidates??new Map,i=new Map;return this._candidates=i,e.forEach(o=>{const n=Ce(o.host,o.port);i.set(n,{host:o.host,port:o.port,detail:o.detail,pid:o.pid}),t.has(n)&&t.delete(n);const r=He(this.forwarded,o.host,o.port);r&&(r.runningProcess=o.detail,r.hasRunningProcess=!0,r.pid=o.pid)}),t.forEach((o,n)=>{const r=Xo(n);if(!r)return;const s=He(this.forwarded,r.host,r.port);s&&(s.runningProcess=void 0,s.hasRunningProcess=!1,s.pid=void 0);const a=He(this.detected,r.host,r.port);a&&(a.runningProcess=void 0,a.hasRunningProcess=!1,a.pid=void 0)}),t}get candidates(){return this._candidates?Array.from(this._candidates.values()):[]}get candidatesOrUndefined(){return this._candidates?this.candidates:void 0}updateAttributes(){var e=this;return(0,w.Z)(function*(){const t=Array.from(e.forwarded.values()),i=yield e.getAttributes(t.map(o=>({port:o.remotePort,host:o.remoteHost})),!1);if(i)for(const o of t){const n=i.get(o.remotePort);(n?.protocol||o.protocol!==H.hh.Http)&&n?.protocol!==o.protocol&&(yield e.forward({remote:{host:o.remoteHost,port:o.remotePort},local:o.localPort,name:o.name,source:o.source},n)),n&&n.label&&n.label!==o.name&&(yield e.name(o.remoteHost,o.remotePort,n.label))}})()}getAttributes(e,t=!0){var i=this;return(0,w.Z)(function*(){const o=new Map,n=new Map;e.forEach(l=>{const u=He(i._candidates??new Map,H.y1[0],l.port);u&&(o.set(l.port,u),n.has(u.pid)||n.set(u.pid,[]),n.get(u.pid)?.push(l.port))});const r=new Map;if(e.forEach(l=>{const u=i.configPortsAttributes.getAttributes(l.port,l.host,o.get(l.port)?.detail);u&&r.set(l.port,u)}),0===i.portAttributesProviders.length||!t)return r.size>0?r:void 0;const s=yield Promise.all((0,L.xH)(i.portAttributesProviders.map(l=>Array.from(n.entries()).map(u=>{const f=u[1],b=o.get(f[0]);return l.providePortAttributes(f,b?.pid,b?.detail,(new xe.A).token)})))),a=new Map;if(s.forEach(l=>l.forEach(u=>{u&&a.set(u.port,u)})),!r&&!a)return;const d=new Map;return e.forEach(l=>{const u=r.get(l.port),f=a.get(l.port);d.set(l.port,{elevateIfNeeded:u?.elevateIfNeeded,label:u?.label,onAutoForward:u?.onAutoForward??xa.providedActionToAction(f?.autoForwardAction),requireLocalPort:u?.requireLocalPort,protocol:u?.protocol})}),d})()}addAttributesProvider(e){this.portAttributesProviders.push(e)}};Yo.__decorator=(0,h.gn)([(0,Wl.Ds)(1e3)],Yo.prototype,"storeForwarded",null),Yo=(0,h.gn)([(0,h.fM)(0,H.XN),(0,h.fM)(1,Ie.Uy),(0,h.fM)(2,G.Ui),(0,h.fM)(3,wt.n),(0,h.fM)(4,Fl.SR),(0,h.fM)(5,ce.ec),(0,h.fM)(6,Ae.VZ),(0,h.fM)(7,ki.Ss)],Yo),(0,ve.Z)('.ports-view .monaco-icon-label,.ports-view .monaco-list .monaco-list-row.focused .monaco-icon-label,.ports-view .monaco-list .monaco-list-row:hover:not(.highlighted) .monaco-icon-label{flex:1}.ports-view .monaco-list .monaco-list-row .actionBarContainer{flex:1 0 auto;flex:0 0 auto;text-align:right}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell{display:flex;flex:1;flex-wrap:nowrap;height:22px;overflow:hidden;text-overflow:ellipsis}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-inputbox{flex:1;height:22px;line-height:19px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-inputbox input{margin-top:-40px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-localaddress:hover{text-decoration:underline}.ports-view .monaco-table-td[data-col-index="0"],.ports-view .monaco-table-th,.ports-view .monaco-table-th[data-col-index="0"]{padding-left:10px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-button{line-height:1.4em;margin-bottom:3px;margin-left:3px;margin-top:4px;padding:2px 14px;width:auto}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell>.ports-view-actionbar-cell-icon.codicon{margin-top:3px;padding-right:3px}.ports-view .monaco-list .monaco-list-row.selected .ports-view-actionbar-cell>.ports-view-actionbar-cell-icon.codicon{color:currentColor!important}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-resourceLabel .monaco-icon-label-container>.monaco-icon-name-container{flex:1}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-resourceLabel:after{padding-right:0}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .actions{display:none}.ports-view .monaco-list .monaco-list-row.focused .ports-view-actionbar-cell .actions,.ports-view .monaco-list .monaco-list-row.selected .ports-view-actionbar-cell .actions,.ports-view .monaco-list .monaco-list-row:hover .ports-view-actionbar-cell .actions{display:block}.ports-view .monaco-list .ports-view-actionbar-cell .actions .action-label{background-position:50% 50%;background-repeat:no-repeat;background-size:16px;height:100%;padding:2px;width:16px}.monaco-workbench .codicon.codicon-ports-forwarded-with-process-icon{color:var(--vscode-ports-iconRunningProcessForeground)}',{});var Ul=m(27331),Kl=m(383);(0,he.q5)("remote-explorer-get-started",$.lA.star,p.NC("getStartedIcon","Getting started icon in the remote explorer view.")),(0,he.q5)("remote-explorer-documentation",$.lA.book,p.NC("documentationIcon","Documentation icon in the remote explorer view.")),(0,he.q5)("remote-explorer-feedback",$.lA.twitter,p.NC("feedbackIcon","Feedback icon in the remote explorer view.")),(0,he.q5)("remote-explorer-review-issues",$.lA.issues,p.NC("reviewIssuesIcon","Review issue icon in the remote explorer view.")),(0,he.q5)("remote-explorer-report-issues",$.lA.comment,p.NC("reportIssuesIcon","Report issue icon in the remote explorer view.")),(0,he.q5)("remote-explorer-view-icon",$.lA.remoteExplorer,p.NC("remoteExplorerViewIcon","View icon of the remote explorer view.")),(0,he.q5)("ports-view-icon",$.lA.plug,p.NC("portsViewIcon","View icon of the remote ports view.")),(0,he.q5)("ports-view-icon",$.lA.plug,p.NC("portIcon","Icon representing a remote port."));const Zl=(0,he.q5)("private-ports-view-icon",$.lA.lock,p.NC("privatePortIcon","Icon representing a private remote port.")),$l=(0,he.q5)("ports-forward-icon",$.lA.plus,p.NC("forwardPortIcon","Icon for the forward action.")),jl=(0,he.q5)("ports-stop-forward-icon",$.lA.x,p.NC("stopForwardIcon","Icon for the stop forwarding action.")),Xl=(0,he.q5)("ports-open-browser-icon",$.lA.globe,p.NC("openBrowserIcon","Icon for the open browser action.")),Yl=(0,he.q5)("ports-open-preview-icon",$.lA.openPreview,p.NC("openPreviewIcon","Icon for the open preview action.")),Ql=(0,he.q5)("ports-copy-address-icon",$.lA.clippy,p.NC("copyAddressIcon","Icon for the copy local address action.")),ka=(0,he.q5)("ports-label-icon",$.lA.tag,p.NC("labelPortIcon","Icon for the label port action.")),Jl=(0,he.q5)("ports-forwarded-without-process-icon",$.lA.circleOutline,p.NC("forwardedPortWithoutProcessIcon","Icon for forwarded ports that don't have a running process.")),ql=(0,he.q5)("ports-forwarded-with-process-icon",$.lA.circleFilled,p.NC("forwardedPortWithProcessIcon","Icon for forwarded ports that do have a running process.")),eh=(0,R.yh)("externalUriOpenerService");var th=m(95270);const Qo=new y.uy("forwardedPortsViewEnabled",!1,p.NC("tunnel.forwardedPortsViewEnabled","Whether the Ports view is enabled."));new y.uy("openPreviewEnabled",!1);class ih{constructor(e){this.remoteExplorerService=e,this.headerRowHeight=22}getHeight(e){return e.tunnelType!==ne.Add||this.remoteExplorerService.getEditableData(void 0)?22:30}}function co(c){return{label:"",tunnel:c,editId:de.None,tooltip:""}}class oh{constructor(){this.label="",this.tooltip="",this.weight=1,this.minimumWidth=40,this.maximumWidth=40,this.templateId="actionbar"}project(e){if(e.tunnelType===ne.Add)return co(e);let i="";return e instanceof Pe&&(i=`${e.iconTooltip} ${e.tooltipPostfix}`),{label:"",icon:e.processDescription?ql:Jl,tunnel:e,editId:de.None,tooltip:i}}}class nh{constructor(){this.label=p.NC("tunnel.portColumn.label","Port"),this.tooltip=p.NC("tunnel.portColumn.tooltip","The label and remote port number of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){const i=e.label;let o="";return o=e instanceof Pe&&e.tunnelType!==ne.Add?`${e.portTooltip} ${e.tooltipPostfix}`:i,{label:i,tunnel:e,menuId:v.eH.TunnelPortInline,editId:e.tunnelType===ne.Add?de.New:de.Label,tooltip:o}}}class Ar{constructor(){this.label=p.NC("tunnel.addressColumn.label","Local Address"),this.tooltip=p.NC("tunnel.addressColumn.tooltip","The address that the forwarded port is available at locally."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ne.Add)return co(e);const t=e.localAddress??"";let i=t;return e instanceof Pe&&(i=e.tooltipPostfix),{label:t,menuId:v.eH.TunnelLocalAddressInline,tunnel:e,editId:de.LocalPort,tooltip:i,markdownTooltip:t?Ar.getHoverText(t):void 0}}static getHoverText(e){return function(t){let o="";o="ctrlCmd"===t.getValue("editor").multiCursorModifier?F.dz?p.NC("portsLink.followLinkAlt.mac","option + click"):p.NC("portsLink.followLinkAlt","alt + click"):F.dz?p.NC("portsLink.followLinkCmd","cmd + click"):p.NC("portsLink.followLinkCtrl","ctrl + click");const n=new li.W5("",!0),r=e.startsWith("http")?e:`http://${e}`;return n.appendLink(r,"Follow link").appendMarkdown(` (${o})`)}}}class rh{constructor(){this.label=p.NC("tunnel.processColumn.label","Running Process"),this.tooltip=p.NC("tunnel.processColumn.tooltip","The command line of the process that is using the port."),this.weight=2,this.templateId="actionbar"}project(e){return e.tunnelType===ne.Add?co(e):{label:e.processDescription??"",tunnel:e,editId:de.None,tooltip:e instanceof Pe?e.processTooltip:""}}}class sh{constructor(){this.label=p.NC("tunnel.originColumn.label","Origin"),this.tooltip=p.NC("tunnel.originColumn.tooltip","The source that a forwarded port originates from. Can be an extension, user forwarded, statically forwarded, or automatically forwarded."),this.weight=1,this.templateId="actionbar"}project(e){return e.tunnelType===ne.Add?co(e):{label:e.source.description,menuId:v.eH.TunnelOriginInline,tunnel:e,editId:de.None,tooltip:`${e instanceof Pe?e.originTooltip:""}. ${e instanceof Pe?e.tooltipPostfix:""}`}}}class ah{constructor(){this.label=p.NC("tunnel.privacyColumn.label","Visibility"),this.tooltip=p.NC("tunnel.privacyColumn.tooltip","The availability of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ne.Add)return co(e);const t=e.privacy?.label;let i="";return e instanceof Pe&&(i=`${e.privacy.label} ${e.tooltipPostfix}`),{label:t,tunnel:e,icon:{id:e.privacy.themeIcon},editId:de.None,tooltip:i}}}let _r=class extends C.JT{constructor(e,t,i,o,n,r,s,a){super(),this.instantiationService=e,this.contextKeyService=t,this.menuService=i,this.contextViewService=o,this.remoteExplorerService=n,this.commandService=r,this.configurationService=s,this.hoverService=a,this.templateId="actionbar"}set actionRunner(e){this._actionRunner=e}renderTemplate(e){const t=g.R3(e,g.$(".ports-view-actionbar-cell")),i=g.R3(t,g.$(".ports-view-actionbar-cell-icon")),o=new dr.g(t,{supportHighlights:!0,hoverDelegate:{showHover:s=>this.hoverService.showHover(s),delay:this.configurationService.getValue("workbench.hover.delay")}}),n=g.R3(t,g.$(".actions"));return{label:o,icon:i,actionBar:new qe.o(n,{actionViewItemProvider:Be.Id.bind(void 0,this.instantiationService)}),container:t,elementDisposable:C.JT.None}}renderElement(e,t,i){let o;i.actionBar.clear(),i.icon.className="ports-view-actionbar-cell-icon",i.icon.style.display="none",i.label.setLabel(""),i.label.element.style.display="none",i.container.style.height="22px",i.button&&(i.button.element.style.display="none",i.button.dispose()),i.container.style.paddingLeft="0px",i.elementDisposable.dispose(),e.editId===de.New&&(o=this.remoteExplorerService.getEditableData(void 0))?this.renderInputBox(i.container,o):(o=this.remoteExplorerService.getEditableData(e.tunnel,e.editId),o?this.renderInputBox(i.container,o):e.tunnel.tunnelType===ne.Add&&e.menuId===v.eH.TunnelPortInline?this.renderButton(e,i):this.renderActionBarItem(e,i))}renderButton(e,t){t.container.style.paddingLeft="7px",t.container.style.height="28px",t.button=this._register(new th.zx(t.container,zt.wG)),t.button.label=e.label,t.button.element.title=e.tooltip,this._register(t.button.onDidClick(()=>{this.commandService.executeCommand(Le.INLINE_ID)}))}tunnelContext(e){let t;return e instanceof Pe&&(t=e.strip()),t||(t={tunnelType:e.tunnelType,remoteHost:e.remoteHost,remotePort:e.remotePort,localAddress:e.localAddress,protocol:e.protocol,localUri:e.localUri,localPort:e.localPort,name:e.name,closeable:e.closeable,source:e.source,privacy:e.privacy,processDescription:e.processDescription,label:e.label}),t}renderActionBarItem(e,t){t.label.element.style.display="flex",t.label.setLabel(e.label,void 0,{title:e.markdownTooltip?{markdown:e.markdownTooltip(this.configurationService),markdownNotSupportedFallback:e.tooltip}:e.tooltip,extraClasses:e.menuId===v.eH.TunnelLocalAddressInline?["ports-view-actionbar-cell-localaddress"]:void 0}),t.actionBar.context=this.tunnelContext(e.tunnel),t.container.style.paddingLeft="10px";const o=this.contextKeyService.createOverlay([["view",Dr],[lo.key,e.tunnel.tunnelType],[ho.key,e.tunnel.closeable],[Tr.key,e.tunnel.privacy.id],[Jo.key,e.tunnel.protocol]]),n=new C.SL;if(t.elementDisposable=n,e.menuId){const r=n.add(this.menuService.createMenu(e.menuId,o));let s=[];if((0,Be.vr)(r,{shouldForwardArgs:!0},s),s){const a=s.filter(d=>d.id.toLowerCase().indexOf("label")>=0);a.length>1&&(a.sort((d,l)=>d.label.length-l.label.length),a.pop(),s=s.filter(d=>a.indexOf(d)<0)),t.actionBar.push(s,{icon:!0,label:!1}),this._actionRunner&&(t.actionBar.actionRunner=this._actionRunner)}}e.icon&&(t.icon.className=`ports-view-actionbar-cell-icon ${be.kS.asClassName(e.icon)}`,t.icon.title=e.tooltip,t.icon.style.display="inline")}renderInputBox(e,t){var i=this;this.inputDone&&(this.inputDone(!1,!1),this.inputDone=void 0),e.style.paddingLeft="5px";const o=t.startingValue||"",n=new Ul.Wz(e,this.contextViewService,{ariaLabel:p.NC("remote.tunnelsView.input","Press Enter to confirm or Escape to cancel."),validationOptions:{validation:a=>{const d=t.validationMessage(a);return d?{content:d.content,formatContent:!0,type:d.severity===oe.zb.Error?3:1}:null}},placeholder:t.placeholder||"",inputBoxStyles:zt.Hc});n.value=o,n.focus(),n.select({start:0,end:t.startingValue?t.startingValue.length:0});const r=(0,Kl.I)(function(){var a=(0,w.Z)(function*(d,l){if((0,C.B9)(s),i.inputDone&&(i.inputDone=void 0),n.element.style.display="none",l)return t.onFinish(n.value,d)});return function(d,l){return a.apply(this,arguments)}}());this.inputDone=r;const s=[n,g.mu(n.inputElement,g.tw.KEY_DOWN,function(){var a=(0,w.Z)(function*(d){return d.equals(3)?(d.stopPropagation(),3!==n.validate()?r(!0,!0):r(!1,!0)):d.equals(9)?(d.preventDefault(),d.stopPropagation(),r(!1,!0)):void 0});return function(d){return a.apply(this,arguments)}}()),g.nm(n.inputElement,g.tw.BLUR,()=>r(3!==n.validate(),!0))];return(0,C.OF)(()=>{r(!1,!1)})}disposeElement(e,t,i,o){i.elementDisposable.dispose()}disposeTemplate(e){e.label.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose(),e.button?.dispose()}};_r=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,y.i6),(0,h.fM)(2,v.co),(0,h.fM)(3,ge.u),(0,h.fM)(4,Ne),(0,h.fM)(5,Z.H),(0,h.fM)(6,G.Ui),(0,h.fM)(7,tt.B)],_r);class Pe{static createFromTunnel(e,t,i,o=ne.Forwarded,n){return new Pe(o,i.remoteHost,i.remotePort,i.source,!!i.hasRunningProcess,i.protocol,i.localUri,i.localAddress,i.localPort,void 0===n?i.closeable:n,i.name,i.runningProcess,i.pid,i.privacy,e,t)}strip(){return new Pe(this.tunnelType,this.remoteHost,this.remotePort,this.source,this.hasRunningProcess,this.protocol,this.localUri,this.localAddress,this.localPort,this.closeable,this.name,this.runningProcess,this.pid,this._privacy)}constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M){this.tunnelType=e,this.remoteHost=t,this.remotePort=i,this.source=o,this.hasRunningProcess=n,this.protocol=r,this.localUri=s,this.localAddress=a,this.localPort=d,this.closeable=l,this.name=u,this.runningProcess=f,this.pid=b,this._privacy=E,this.remoteExplorerService=k,this.tunnelService=M}get label(){if(this.tunnelType===ne.Add&&this.name)return this.name;const e=(0,H.a8)(this.remoteHost)||(0,H.BP)(this.remoteHost)?`${this.remotePort}`:`${this.remoteHost}:${this.remotePort}`;return this.name?`${this.name} (${e})`:e}set processDescription(e){this.runningProcess=e}get processDescription(){let e="";return this.runningProcess?(e=this.pid&&this.remoteExplorerService?.namedProcesses.has(this.pid)?this.remoteExplorerService.namedProcesses.get(this.pid):this.runningProcess.replace(/\0/g," ").trim(),this.pid&&(e+=` (${this.pid})`)):this.hasRunningProcess&&(e=p.NC("tunnelView.runningProcess.inacessable","Process information unavailable")),e}get tooltipPostfix(){let e;return e=this.localAddress?p.NC("remote.tunnel.tooltipForwarded","Remote port {0}:{1} forwarded to local address {2}. ",this.remoteHost,this.remotePort,this.localAddress):p.NC("remote.tunnel.tooltipCandidate","Remote port {0}:{1} not forwarded. ",this.remoteHost,this.remotePort),e}get iconTooltip(){return this.tunnelType===ne.Add?this.label:`${this.processDescription?p.NC("tunnel.iconColumn.running","Port has running process."):p.NC("tunnel.iconColumn.notRunning","No running process.")}`}get portTooltip(){return this.tunnelType===ne.Add?"":`${this.name?p.NC("remote.tunnel.tooltipName","Port labeled {0}. ",this.name):""}`}get processTooltip(){return this.processDescription??""}get originTooltip(){return this.source.description}get privacy(){return this.tunnelService?.privacyOptions?this.tunnelService?.privacyOptions.find(e=>e.id===this._privacy)??{id:"",themeIcon:$.lA.question.id,label:p.NC("tunnelPrivacy.unknown","Unknown")}:{id:H.xh.Private,themeIcon:Zl.id,label:p.NC("tunnelPrivacy.private","Private")}}}const lo=new y.uy("tunnelType",ne.Add,!0),ho=new y.uy("tunnelCloseable",!1,!0),Tr=new y.uy("tunnelPrivacy",void 0,!0),Da=new y.uy("tunnelPrivacyEnabled",!1,!0),Jo=new y.uy("tunnelProtocol",H.hh.Http,!0),qo=new y.uy("tunnelViewFocus",!1,p.NC("tunnel.focusContext","Whether the Ports view has focus.")),uo="tunnelViewSelection",ch=new y.uy(uo,void 0,!0),Ia="tunnelViewMultiSelection",Aa=new y.uy(Ia,void 0,!0),_a=new y.uy("portChangable",!1,!0);let po=class Ja extends Mo.qV{constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X,ee){super(t,i,o,r,n,a,s,d,b,k),this.viewModel=e,this.quickInputService=l,this.commandService=u,this.menuService=f,this.remoteExplorerService=E,this.tunnelService=M,this.contextViewService=X,this.hoverService=ee,this.isEditing=!1,this.titleActions=[],this.lastFocus=[],this.tunnelTypeContext=lo.bindTo(n),this.tunnelCloseableContext=ho.bindTo(n),this.tunnelPrivacyContext=Tr.bindTo(n),this.tunnelPrivacyEnabledContext=Da.bindTo(n),this.tunnelPrivacyEnabledContext.set(0!==M.privacyOptions.length),this.tunnelProtocolContext=Jo.bindTo(n),this.tunnelViewFocusContext=qo.bindTo(n),this.tunnelViewSelectionContext=ch.bindTo(n),this.tunnelViewMultiSelectionContext=Aa.bindTo(n),this.portChangableContextKey=_a.bindTo(n);const De=this.contextKeyService.createOverlay([["view",Ja.ID]]),mt=this._register(this.menuService.createMenu(v.eH.TunnelTitle,De)),$e=()=>{this.titleActions=[],(0,Be.vr)(mt,void 0,this.titleActions),this.updateActions()};this._register(mt.onDidChange($e)),$e(),this._register((0,C.OF)(()=>{this.titleActions=[]})),this.registerPrivacyActions()}registerPrivacyActions(){for(const e of this.tunnelService.privacyOptions){const t=`remote.tunnel.privacy${e.id}`;Z.P.registerCommand(t,Mr.handler(e.id)),v.BH.appendMenuItem(v.eH.TunnelPrivacy,{order:0,command:{id:t,title:e.label,toggled:Tr.isEqualTo(e.id)}})}}get portCount(){return this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size}renderBody(e){super.renderBody(e);const t=g.R3(e,g.$(".tree-explorer-viewlet-tree-view")),i=g.R3(t,g.$(".customview-tree"));i.classList.add("ports-view"),i.classList.add("file-icon-themable-tree","show-file-icons");const o=new _r(this.instantiationService,this.contextKeyService,this.menuService,this.contextViewService,this.remoteExplorerService,this.commandService,this.configurationService,this.hoverService),n=[new oh,new nh,new Ar,new rh];this.tunnelService.canChangePrivacy&&n.push(new ah),n.push(new sh),this.table=this.instantiationService.createInstance(D.On,"RemoteTunnels",i,new ih(this.remoteExplorerService),n,[o],{keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:d=>d.label},multipleSelectionSupport:!0,accessibilityProvider:{getAriaLabel:d=>d instanceof Pe?`${d.tooltipPostfix} ${d.portTooltip} ${d.iconTooltip} ${d.processTooltip} ${d.originTooltip} ${this.tunnelService.canChangePrivacy?d.privacy.label:""}`:d.label,getWidgetAriaLabel:()=>p.NC("tunnelView","Tunnel View")},openOnSingleClick:!0});const r=new P.Wi;o.actionRunner=r,this._register(this.table.onContextMenu(d=>this.onContextMenu(d,r))),this._register(this.table.onMouseDblClick(d=>this.onMouseDblClick(d))),this._register(this.table.onDidChangeFocus(d=>this.onFocusChanged(d))),this._register(this.table.onDidChangeSelection(d=>this.onSelectionChanged(d))),this._register(this.table.onDidFocus(()=>this.tunnelViewFocusContext.set(!0))),this._register(this.table.onDidBlur(()=>this.tunnelViewFocusContext.set(!1)));const s=()=>this.table.splice(0,Number.POSITIVE_INFINITY,this.viewModel.all);s();let a=this.portCount;this._register(S.ju.debounce(this.viewModel.onForwardedPortsChanged,(d,l)=>l,50)(()=>{const d=this.portCount;(0===a||0===d)&&a!==d&&this._onDidChangeViewWelcomeState.fire(),a=d,s()})),this._register(this.table.onMouseClick(d=>{if(this.hasOpenLinkModifier(d.browserEvent)){const l=this.table.getSelectedElements();(0===l.length||1===l.length&&l[0]===d.element)&&this.commandService.executeCommand(Tt.ID,d.element)}})),this._register(this.table.onDidOpen(d=>{!d.element||d.element.tunnelType!==ne.Forwarded||"dblclick"===d.browserEvent?.type&&this.commandService.executeCommand(Ot.ID)})),this._register(this.remoteExplorerService.onDidChangeEditable(d=>{this.isEditing=!!this.remoteExplorerService.getEditableData(d?.tunnel,d?.editId),this._onDidChangeViewWelcomeState.fire(),this.isEditing||i.classList.remove("highlight"),s(),this.isEditing?(i.classList.add("highlight"),d||this.table.reveal(this.table.indexOf(this.viewModel.input))):(d&&d.tunnel.tunnelType!==ne.Add&&this.table.setFocus(this.lastFocus),this.focus())}))}shouldShowWelcome(){return this.viewModel.isEmpty()&&!this.isEditing}focus(){super.focus(),this.table.domFocus()}onFocusChanged(e){e.indexes.length>0&&e.elements.length>0&&(this.lastFocus=[...e.indexes]);const t=e.elements,i=t&&t.length?t[0]:void 0;i?(this.tunnelViewSelectionContext.set(Ce(i.remoteHost,i.remotePort)),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(H.hh.Https),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.reset(),this.tunnelViewSelectionContext.reset(),this.tunnelCloseableContext.reset(),this.tunnelPrivacyContext.reset(),this.tunnelProtocolContext.reset(),this.portChangableContextKey.reset())}hasOpenLinkModifier(e){let i=!1;return i="ctrlCmd"===this.configurationService.getValue("editor").multiCursorModifier?e.altKey:F.dz?e.metaKey:e.ctrlKey,i}onSelectionChanged(e){const t=e.elements;this.tunnelViewMultiSelectionContext.set(t.length>1?t.map(i=>Ce(i.remoteHost,i.remotePort)):void 0)}onContextMenu(e,t){if(void 0!==e.element&&!(e.element instanceof Pe))return;e.browserEvent.preventDefault(),e.browserEvent.stopPropagation();const i=e.element;i?(this.table.setFocus([this.table.indexOf(i)]),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(i.protocol),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.set(ne.Add),this.tunnelCloseableContext.set(!1),this.tunnelPrivacyContext.set(void 0),this.tunnelProtocolContext.set(void 0),this.portChangableContextKey.set(!1)),this.contextMenuService.showContextMenu({menuId:v.eH.TunnelContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:this.table.contextKeyService,getAnchor:()=>e.anchor,getActionViewItem:o=>{const n=this.keybindingService.lookupKeybinding(o.id);if(n)return new vr.gU(o,o,{label:!0,keybinding:n.getLabel()})},onHide:o=>{o&&this.table.domFocus()},getActionsContext:()=>i?.strip(),actionRunner:t})}onMouseDblClick(e){e.element||this.commandService.executeCommand(Le.INLINE_ID)}layoutBody(e,t){super.layoutBody(e,t),this.table.layout(e,t)}};function qt(c){return c&&c.tunnelType&&c.remoteHost&&c.source}var Ot;po.ID=Dr,po.TITLE=p.NC("remote.tunnel","Ports"),po=(0,h.gn)([(0,h.fM)(2,Se.d),(0,h.fM)(3,ge.i),(0,h.fM)(4,y.i6),(0,h.fM)(5,G.Ui),(0,h.fM)(6,R.TG),(0,h.fM)(7,O.XH),(0,h.fM)(8,Zt.v4),(0,h.fM)(9,St.eJ),(0,h.fM)(10,Z.H),(0,h.fM)(11,v.co),(0,h.fM)(12,K.XE),(0,h.fM)(13,Ne),(0,h.fM)(14,Ue.bU),(0,h.fM)(15,H.XN),(0,h.fM)(16,ge.u),(0,h.fM)(17,tt.B)],po),function(c){c.ID="remote.tunnel.label",c.LABEL=p.NC("remote.tunnel.label","Set Port Label"),c.COMMAND_ID_KEYWORD="label",c.handler=function e(){return function(){var t=(0,w.Z)(function*(i,o){const n=i.get(Ne);let r;if(qt(o))r=o;else{const s=i.get(y.i6).getContextKeyValue(uo),a=s?n.tunnelModel.forwarded.get(s):void 0;if(a){const d=i.get(H.XN);r=Pe.createFromTunnel(n,d,a)}}if(r){const s=r;return new Promise(a=>{const d=s.name?s.name:`${s.remotePort}`;var l;n.setEditable(s,de.Label,{onFinish:(l=(0,w.Z)(function*(u,f){u=u.trim(),n.setEditable(s,de.Label,null);const b=f&&u!==d;b&&(yield n.tunnelModel.name(s.remoteHost,s.remotePort,u)),a(b?{port:s.remotePort,label:u}:void 0)}),function(f,b){return l.apply(this,arguments)}),validationMessage:()=>null,placeholder:p.NC("remote.tunnelsView.labelPlaceholder","Port label"),startingValue:d})})}});return function(i,o){return t.apply(this,arguments)}}()}}(Ot||(Ot={}));const Ta=p.NC("remote.tunnelsView.portNumberValid","Forwarded port should be a number or a host:port."),Va=p.NC("remote.tunnelsView.portNumberToHigh","Port number must be \u2265 0 and < {0}.",65536),Ma=p.NC("remote.tunnelView.inlineElevationMessage","May Require Sudo"),dh=p.NC("remote.tunnelView.alreadyForwarded","Port is already forwarded");var Le,st,Tt,ei,Mi,at,Pi,Mr,Vt;function Pa(c,e,t){const i=c.map(o=>{const n=Pe.createFromTunnel(e,t,o);return{label:n.label,description:n.processDescription,tunnel:n}});return 0===i.length&&i.push({label:p.NC("remote.tunnel.closeNoPorts","No ports currently forwarded. Try running the {0} command",Le.LABEL.value)}),i}!function(c){c.INLINE_ID="remote.tunnel.forwardInline",c.COMMANDPALETTE_ID="remote.tunnel.forwardCommandPalette",c.LABEL={value:p.NC("remote.tunnel.forward","Forward a Port"),original:"Forward a Port"},c.TREEITEM_LABEL=p.NC("remote.tunnel.forwardItem","Forward Port");const e=p.NC("remote.tunnel.forwardPrompt","Port number or address (eg. 3000 or 10.10.10.10:2000).");function t(r,s,a,d){const l=Xo(a);return l?l.port>=65536?{content:Va,severity:oe.zb.Error}:d&&s.isPortPrivileged(l.port)?{content:Ma,severity:oe.zb.Info}:He(r.tunnelModel.forwarded,l.host,l.port)?{content:dh,severity:oe.zb.Error}:null:{content:Ta,severity:oe.zb.Error}}function i(r,s,a,d){s||r.warn(p.NC("remote.tunnel.forwardError","Unable to forward {0}:{1}. The host may not be available or that remote port may already be forwarded",a,d))}c.inlineHandler=function o(){return function(){var r=(0,w.Z)(function*(s,a){const d=s.get(Ne),l=s.get(oe.lT),u=s.get(H.XN);var f;d.setEditable(void 0,de.New,{onFinish:(f=(0,w.Z)(function*(b,E){let k;d.setEditable(void 0,de.New,null),E&&(k=Xo(b))&&d.forward({remote:{host:k.host,port:k.port},elevateIfNeeded:!0}).then(M=>i(l,M,k.host,k.port))}),function(E,k){return f.apply(this,arguments)}),validationMessage:f=>t(d,u,f,u.canElevate),placeholder:e})});return function(s,a){return r.apply(this,arguments)}}()},c.commandPaletteHandler=function n(){return function(){var r=(0,w.Z)(function*(s,a){const d=s.get(Ne),l=s.get(oe.lT),u=s.get(O.qC),f=s.get(St.eJ),b=s.get(H.XN);yield u.openView(po.ID,!0);const E=yield f.input({prompt:e,validateInput:M=>Promise.resolve(t(d,b,M,b.canElevate))});let k;E&&(k=Xo(E))&&d.forward({remote:{host:k.host,port:k.port},elevateIfNeeded:!0}).then(M=>i(l,M,k.host,k.port))});return function(s,a){return r.apply(this,arguments)}}()}}(Le||(Le={})),function(c){c.INLINE_ID="remote.tunnel.closeInline",c.COMMANDPALETTE_ID="remote.tunnel.closeCommandPalette",c.LABEL={value:p.NC("remote.tunnel.close","Stop Forwarding Port"),original:"Stop Forwarding Port"},c.inlineHandler=function e(){return function(){var i=(0,w.Z)(function*(o,n){const r=o.get(y.i6),s=o.get(Ne);let a=[];const d=r.getContextKeyValue(Ia);if(d)d.forEach(l=>{const u=s.tunnelModel.forwarded.get(l);u&&a?.push(u)});else if(qt(n))a=[n];else{const l=r.getContextKeyValue(uo),u=l?s.tunnelModel.forwarded.get(l):void 0;u&&(a=[u])}if(a&&0!==a.length)return Promise.all(a.map(l=>s.close({host:l.remoteHost,port:l.remotePort},Je.User)))});return function(o,n){return i.apply(this,arguments)}}()},c.commandPaletteHandler=function t(){return function(){var i=(0,w.Z)(function*(o){const n=o.get(St.eJ),r=o.get(Ne),s=o.get(H.XN),a=o.get(Z.H),d=Pa(Array.from(r.tunnelModel.forwarded.values()).filter(u=>u.closeable),r,s),l=yield n.pick(d,{placeHolder:p.NC("remote.tunnel.closePlaceholder","Choose a port to stop forwarding")});l&&l.tunnel?yield r.close({host:l.tunnel.remoteHost,port:l.tunnel.remotePort},Je.User):l&&(yield a.executeCommand(Le.COMMANDPALETTE_ID))});return function(o){return i.apply(this,arguments)}}()}}(st||(st={})),function(c){function t(i,o,n){const r=i.forwarded.get(n)||i.detected.get(n);return r?o.open(r.localUri,{allowContributedOpeners:!1}):Promise.resolve()}c.ID="remote.tunnel.open",c.LABEL=p.NC("remote.tunnel.open","Open in Browser"),c.handler=function e(){return function(){var i=(0,w.Z)(function*(o,n){let r;if(qt(n)?r=Ce(n.remoteHost,n.remotePort):n.tunnelRemoteHost&&n.tunnelRemotePort&&(r=Ce(n.tunnelRemoteHost,n.tunnelRemotePort)),r)return t(o.get(Ne).tunnelModel,o.get(Zt.v4),r)});return function(o,n){return i.apply(this,arguments)}}()},c.run=t}(Tt||(Tt={})),function(c){function t(o,n,r,s){return i.apply(this,arguments)}function i(){return(i=(0,w.Z)(function*(o,n,r,s){const a=o.forwarded.get(s)||o.detected.get(s);if(a){const d=a.remoteHost.includes(":")?`[${a.remoteHost}]`:a.remoteHost,l=W.ov.parse(`http://${d}:${a.remotePort}`),u=yield r.getOpener(a.localUri,{sourceUri:l},(new xe.A).token);return u?u.openExternalUri(a.localUri,{sourceUri:l},(new xe.A).token):n.open(a.localUri)}return Promise.resolve()})).apply(this,arguments)}c.ID="remote.tunnel.openPreview",c.LABEL=p.NC("remote.tunnel.openPreview","Preview in Editor"),c.handler=function e(){return function(){var o=(0,w.Z)(function*(n,r){let s;if(qt(r)?s=Ce(r.remoteHost,r.remotePort):r.tunnelRemoteHost&&r.tunnelRemotePort&&(s=Ce(r.tunnelRemoteHost,r.tunnelRemotePort)),s)return t(n.get(Ne).tunnelModel,n.get(Zt.v4),n.get(eh),s)});return function(n,r){return o.apply(this,arguments)}}()},c.run=t}(ei||(ei={})),function(c){c.ID="remote.tunnel.openCommandPalette",c.LABEL=p.NC("remote.tunnel.openCommandPalette","Open Port in Browser"),c.handler=function e(){return function(){var t=(0,w.Z)(function*(i,o){const n=i.get(Ne),r=i.get(H.XN),s=n.tunnelModel,a=i.get(St.eJ),d=i.get(Zt.v4),l=i.get(Z.H),u=[...s.forwarded,...s.detected].map(b=>{const E=Pe.createFromTunnel(n,r,b[1]);return{label:E.label,description:E.processDescription,tunnel:E}});u.push(0===u.length?{label:p.NC("remote.tunnel.openCommandPaletteNone","No ports currently forwarded. Open the Ports view to get started.")}:{label:p.NC("remote.tunnel.openCommandPaletteView","Open the Ports view...")});const f=yield a.pick(u,{placeHolder:p.NC("remote.tunnel.openCommandPalettePick","Choose the port to open")});return f&&f.tunnel?Tt.run(s,d,Ce(f.tunnel.remoteHost,f.tunnel.remotePort)):f?l.executeCommand(`${Dr}.focus`):void 0});return function(i,o){return t.apply(this,arguments)}}()}}(Mi||(Mi={})),function(c){function e(n,r,s){return t.apply(this,arguments)}function t(){return(t=(0,w.Z)(function*(n,r,s){const a=n.tunnelModel.address(s.remoteHost,s.remotePort);a&&(yield r.writeText(a.toString()))})).apply(this,arguments)}c.INLINE_ID="remote.tunnel.copyAddressInline",c.COMMANDPALETTE_ID="remote.tunnel.copyAddressCommandPalette",c.INLINE_LABEL=p.NC("remote.tunnel.copyAddressInline","Copy Local Address"),c.COMMANDPALETTE_LABEL=p.NC("remote.tunnel.copyAddressCommandPalette","Copy Forwarded Port Address"),c.inlineHandler=function i(){return function(){var n=(0,w.Z)(function*(r,s){const a=r.get(Ne);let d;if(qt(s))d=s;else{const l=r.get(y.i6).getContextKeyValue(uo);d=l?a.tunnelModel.forwarded.get(l):void 0}if(d)return e(a,r.get(Yi.p),d)});return function(r,s){return n.apply(this,arguments)}}()},c.commandPaletteHandler=function o(){return function(){var n=(0,w.Z)(function*(r,s){const a=r.get(St.eJ),d=r.get(Ne),l=r.get(H.XN),u=r.get(Z.H),f=r.get(Yi.p),b=Array.from(d.tunnelModel.forwarded.values()).concat(Array.from(d.tunnelModel.detected.values())),E=yield a.pick(Pa(b,d,l),{placeHolder:p.NC("remote.tunnel.copyAddressPlaceholdter","Choose a forwarded port")});E&&E.tunnel?yield e(d,f,E.tunnel):E&&(yield u.executeCommand(Le.COMMANDPALETTE_ID))});return function(r,s){return n.apply(this,arguments)}}()}}(at||(at={})),function(c){c.ID="remote.tunnel.changeLocalPort",c.LABEL=p.NC("remote.tunnel.changeLocalPort","Change Local Address Port"),c.handler=function t(){return function(){var i=(0,w.Z)(function*(o,n){const r=o.get(Ne),s=o.get(oe.lT),a=o.get(H.XN);let d;if(qt(n))d=n;else{const l=o.get(y.i6).getContextKeyValue(uo),u=l?r.tunnelModel.forwarded.get(l):void 0;if(u){const f=o.get(H.XN);d=Pe.createFromTunnel(r,f,u)}}if(d){const l=d;r.setEditable(l,de.LocalPort,{onFinish:(u=(0,w.Z)(function*(f,b){if(r.setEditable(l,de.LocalPort,null),b){yield r.close({host:l.remoteHost,port:l.remotePort},Je.Other);const E=Number(f),k=yield r.forward({remote:{host:l.remoteHost,port:l.remotePort},local:E,name:l.name,elevateIfNeeded:!0,source:l.source});k&&k.tunnelLocalPort!==E&&s.warn(p.NC("remote.tunnel.changeLocalPortNumber","The local port {0} is not available. Port number {1} has been used instead",f,k.tunnelLocalPort??k.localAddress))}}),function(b,E){return u.apply(this,arguments)}),validationMessage:u=>function e(i,o,n){return o.match(/^[0-9]+$/)?Number(o)>=65536?{content:Va,severity:oe.zb.Error}:n&&i.isPortPrivileged(Number(o))?{content:Ma,severity:oe.zb.Info}:null:{content:Ta,severity:oe.zb.Error}}(a,u,a.canElevate),placeholder:p.NC("remote.tunnelsView.changePort","New local port")})}var u});return function(o,n){return i.apply(this,arguments)}}()}}(Pi||(Pi={})),function(c){c.handler=function e(t){return function(){var i=(0,w.Z)(function*(o,n){if(qt(n)){const r=o.get(Ne);return yield r.close({host:n.remoteHost,port:n.remotePort},Je.Other),r.forward({remote:{host:n.remoteHost,port:n.remotePort},local:n.localPort,name:n.name,elevateIfNeeded:!0,privacy:t,source:n.source})}});return function(o,n){return i.apply(this,arguments)}}()}}(Mr||(Mr={})),function(c){function e(n,r,s){return t.apply(this,arguments)}function t(){return(t=(0,w.Z)(function*(n,r,s){if(qt(n))return s.tunnelModel.configPortsAttributes.addAttributes(n.remotePort,{protocol:r},4)})).apply(this,arguments)}c.ID_HTTP="remote.tunnel.setProtocolHttp",c.ID_HTTPS="remote.tunnel.setProtocolHttps",c.LABEL_HTTP=p.NC("remote.tunnel.protocolHttp","HTTP"),c.LABEL_HTTPS=p.NC("remote.tunnel.protocolHttps","HTTPS"),c.handlerHttp=function i(){return function(){var n=(0,w.Z)(function*(r,s){return e(s,H.hh.Http,r.get(Ne))});return function(r,s){return n.apply(this,arguments)}}()},c.handlerHttps=function o(){return function(){var n=(0,w.Z)(function*(r,s){return e(s,H.hh.Https,r.get(Ne))});return function(r,s){return n.apply(this,arguments)}}()}}(Vt||(Vt={}));const bi=lo.isEqualTo(ne.Forwarded),wi=y.Ao.or(bi,lo.isEqualTo(ne.Detected)),ti=Aa.isEqualTo(void 0);T.W.registerCommandAndKeybindingRule({id:Ot.ID,weight:210,when:y.Ao.and(qo,bi,ti),primary:60,mac:{primary:3},handler:Ot.handler()}),Z.P.registerCommand(Le.INLINE_ID,Le.inlineHandler()),Z.P.registerCommand(Le.COMMANDPALETTE_ID,Le.commandPaletteHandler()),T.W.registerCommandAndKeybindingRule({id:st.INLINE_ID,weight:210,when:y.Ao.and(ho,qo),primary:20,mac:{primary:2049,secondary:[20]},handler:st.inlineHandler()}),Z.P.registerCommand(st.COMMANDPALETTE_ID,st.commandPaletteHandler()),Z.P.registerCommand(Tt.ID,Tt.handler()),Z.P.registerCommand(ei.ID,ei.handler()),Z.P.registerCommand(Mi.ID,Mi.handler()),T.W.registerCommandAndKeybindingRule({id:at.INLINE_ID,weight:210,when:y.Ao.and(qo,wi,ti),primary:2081,handler:at.inlineHandler()}),Z.P.registerCommand(at.COMMANDPALETTE_ID,at.commandPaletteHandler()),Z.P.registerCommand(Pi.ID,Pi.handler()),Z.P.registerCommand(Vt.ID_HTTP,Vt.handlerHttp()),Z.P.registerCommand(Vt.ID_HTTPS,Vt.handlerHttps()),v.BH.appendMenuItem(v.eH.CommandPalette,{command:{id:st.COMMANDPALETTE_ID,title:st.LABEL},when:Qo}),v.BH.appendMenuItem(v.eH.CommandPalette,{command:{id:Le.COMMANDPALETTE_ID,title:Le.LABEL},when:Qo}),v.BH.appendMenuItem(v.eH.CommandPalette,{command:{id:at.COMMANDPALETTE_ID,title:at.COMMANDPALETTE_LABEL},when:Qo}),v.BH.appendMenuItem(v.eH.CommandPalette,{command:{id:Mi.ID,title:Mi.LABEL},when:Qo}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"._open",order:0,command:{id:Tt.ID,title:Tt.LABEL},when:y.Ao.and(wi,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"._open",order:1,command:{id:ei.ID,title:ei.LABEL},when:y.Ao.and(wi,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"0_manage",order:1,command:{id:Ot.ID,title:Ot.LABEL,icon:ka},when:y.Ao.and(bi,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"2_localaddress",order:0,command:{id:at.INLINE_ID,title:at.INLINE_LABEL},when:y.Ao.and(wi,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"2_localaddress",order:1,command:{id:Pi.ID,title:Pi.LABEL},when:y.Ao.and(bi,_a,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"2_localaddress",order:2,submenu:v.eH.TunnelPrivacy,title:p.NC("tunnelContext.privacyMenu","Port Visibility"),when:y.Ao.and(bi,Da)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"2_localaddress",order:3,submenu:v.eH.TunnelProtocol,title:p.NC("tunnelContext.protocolMenu","Change Port Protocol"),when:y.Ao.and(bi,ti)}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"3_forward",order:0,command:{id:st.INLINE_ID,title:st.LABEL},when:ho}),v.BH.appendMenuItem(v.eH.TunnelContext,{group:"3_forward",order:1,command:{id:Le.INLINE_ID,title:Le.LABEL}}),v.BH.appendMenuItem(v.eH.TunnelProtocol,{order:0,command:{id:Vt.ID_HTTP,title:Vt.LABEL_HTTP,toggled:Jo.isEqualTo(H.hh.Http)}}),v.BH.appendMenuItem(v.eH.TunnelProtocol,{order:1,command:{id:Vt.ID_HTTPS,title:Vt.LABEL_HTTPS,toggled:Jo.isEqualTo(H.hh.Https)}}),v.BH.appendMenuItem(v.eH.TunnelPortInline,{group:"0_manage",order:0,command:{id:Le.INLINE_ID,title:Le.TREEITEM_LABEL,icon:$l},when:lo.isEqualTo(ne.Candidate)}),v.BH.appendMenuItem(v.eH.TunnelPortInline,{group:"0_manage",order:4,command:{id:Ot.ID,title:Ot.LABEL,icon:ka},when:bi}),v.BH.appendMenuItem(v.eH.TunnelPortInline,{group:"0_manage",order:5,command:{id:st.INLINE_ID,title:st.LABEL,icon:jl},when:ho}),v.BH.appendMenuItem(v.eH.TunnelLocalAddressInline,{order:-1,command:{id:at.INLINE_ID,title:at.INLINE_LABEL,icon:Ql},when:wi}),v.BH.appendMenuItem(v.eH.TunnelLocalAddressInline,{order:0,command:{id:Tt.ID,title:Tt.LABEL,icon:Xl},when:wi}),v.BH.appendMenuItem(v.eH.TunnelLocalAddressInline,{order:1,command:{id:ei.ID,title:ei.LABEL,icon:Yl},when:wi}),(0,Y.P6G)("ports.iconRunningProcessForeground",{light:I.eH,dark:I.eH,hcDark:I.eH,hcLight:I.eH},p.NC("portWithRunningProcess.foreground","The color of the icon for a port that has an associated running process."));const Lr="workbench.view.remote",La="workbench.view.scm";var lh=m(8742),Ra=m(24895);class hh extends C.JT{constructor(e){super(),this._register(g.nm(window,g.tw.DRAG_START,()=>{e()?.windowDidDragStart()}));const t=()=>{e()?.windowDidDragEnd()};this._register(g.nm(window,g.tw.DRAG_END,t)),this._register(g.nm(window,g.tw.MOUSE_MOVE,i=>{0===i.buttons&&t()}))}}const uh=(0,R.yh)("webviewViewService");let Nr=class qa extends Mo.qV{static getOriginStore(e){return this._originStore??=new Ra.UE("webviewViews.origins",e),this._originStore}constructor(e,t,i,o,n,r,s,a,d,l,u,f,b,E,k,M,X){super({...e,titleMenuId:v.eH.ViewTitle},r,o,t,i,l,n,s,d,a),this.activityService=u,this.extensionService=f,this.progressService=b,this.storageService=E,this.viewService=k,this.webviewService=M,this.webviewViewService=X,this._webview=this._register(new C.XK),this._webviewDisposables=this._register(new C.SL),this._activated=!1,this._onDidChangeVisibility=this._register(new S.Q5),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new S.Q5),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new lh.N(`webviewView.${this.id}`,E),this.viewState=this.memento.getMemento(1,1),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(ee=>{ee.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){super.focus(),this._webview.value?.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register((0,C.OF)(()=>{this._resizeObserver.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState.webviewState=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new g.Ro(t,e))}updateTreeVisibility(){this.isBodyVisible()?(this.activate(),this._webview.value?.claim(this,void 0)):this._webview.value?.release(this)}activate(){var e=this;if(this._activated)return;this._activated=!0;const t=this.extensionId?qa.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,i=this.webviewService.createWebviewOverlay({origin:t,providedViewType:this.id,title:this.title,options:{purpose:"webviewView"},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});i.state=this.viewState.webviewState,this._webview.value=i,this._container&&this.layoutWebview(),this._webviewDisposables.add((0,C.OF)(()=>{this._webview.value?.release(this)})),this._webviewDisposables.add(i.onDidUpdateState(()=>{this.viewState.webviewState=i.state}));for(const n of[g.tw.DRAG,g.tw.DRAG_END,g.tw.DRAG_ENTER,g.tw.DRAG_LEAVE,g.tw.DRAG_START])this._webviewDisposables.add((0,g.nm)(this._webview.value.container,n,r=>{r.preventDefault(),r.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(r.type,r))}));this._webviewDisposables.add(new hh(()=>this._webview.value));const o=this._webviewDisposables.add(new xe.A);this.withProgress((0,w.Z)(function*(){yield e.extensionService.activateByEvent(`onView:${e.id}`);const n=e,r={webview:i,onDidChangeVisibility:e.onDidChangeBodyVisibility,onDispose:e.onDispose,get title(){return n.setTitle},set title(s){n.updateTitle(s)},get description(){return n.titleDescription},set description(s){n.updateTitleDescription(s)},get badge(){return n.badge},set badge(s){n.updateBadge(s)},dispose:()=>{e._activated=!1,e._webview.clear(),e._webviewDisposables.clear()},show:s=>{e.viewService.openView(e.id,!s)}};yield e.webviewViewService.resolve(e.id,r,o.token)}))}updateTitle(e){this.setTitle=e,super.updateTitle("string"==typeof e?e:this.defaultTitle)}updateBadge(e){if((this.badge?.value!==e?.value||this.badge?.tooltip!==e?.tooltip)&&(this.activity&&(this.activity.dispose(),this.activity=void 0),this.badge=e,e)){const t={badge:new yt.mA(e.value,()=>e.tooltip),priority:150};this.activityService.showViewActivity(this.id,t)}}withProgress(e){var t=this;return(0,w.Z)(function*(){return t.progressService.withProgress({location:t.id,delay:500},e)})()}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){const t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){return(0,A.f6)((0,g.Fx)(e,"monaco-scrollable-element"))}};Nr=(0,h.gn)([(0,h.fM)(1,G.Ui),(0,h.fM)(2,y.i6),(0,h.fM)(3,ge.i),(0,h.fM)(4,R.TG),(0,h.fM)(5,Se.d),(0,h.fM)(6,Zt.v4),(0,h.fM)(7,Ue.bU),(0,h.fM)(8,K.XE),(0,h.fM)(9,O.XH),(0,h.fM)(10,yt.By),(0,h.fM)(11,Pt.QS),(0,h.fM)(12,Gt.R9),(0,h.fM)(13,Ie.Uy),(0,h.fM)(14,O.qC),(0,h.fM)(15,Ra.JN),(0,h.fM)(16,uh)],Nr);var Na=m(8155);const Oa={type:"object",properties:{id:{description:(0,p.NC)({key:"vscode.extension.contributes.views.containers.id",comment:["Contribution refers to those that an extension contributes to VS Code through an extension/contribution point. "]},"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:(0,p.NC)("vscode.extension.contributes.views.containers.title","Human readable string used to render the container"),type:"string"},icon:{description:(0,p.NC)("vscode.extension.contributes.views.containers.icon","Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},ph={description:(0,p.NC)("vscode.extension.contributes.viewsContainers","Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:(0,p.NC)("views.container.activitybar","Contribute views containers to Activity Bar"),type:"array",items:Oa},panel:{description:(0,p.NC)("views.container.panel","Contribute views containers to Panel"),type:"array",items:Oa}}};var ft=(()=>((ft=ft||{}).Tree="tree",ft.Webview="webview",ft))(),Mt=(()=>((Mt=Mt||{}).Visible="visible",Mt.Hidden="hidden",Mt.Collapsed="collapsed",Mt))();const go={type:"object",required:["id","name"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}"}}],properties:{type:{markdownDescription:(0,p.NC)("vscode.extension.contributes.view.type","Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[(0,p.NC)("vscode.extension.contributes.view.tree","The view is backed by a `TreeView` created by `createTreeView`."),(0,p.NC)("vscode.extension.contributes.view.webview","The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:(0,p.NC)("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,p.NC)("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,p.NC)("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},icon:{description:(0,p.NC)("vscode.extension.contributes.view.icon","Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:(0,p.NC)("vscode.extension.contributes.view.contextualTitle","Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:(0,p.NC)("vscode.extension.contributes.view.initialState","Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[(0,p.NC)("vscode.extension.contributes.view.initialState.visible","The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),(0,p.NC)("vscode.extension.contributes.view.initialState.hidden","The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),(0,p.NC)("vscode.extension.contributes.view.initialState.collapsed","The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:(0,p.NC)("vscode.extension.contributs.view.size","The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")}}},gh={type:"object",required:["id","name"],properties:{id:{description:(0,p.NC)("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,p.NC)("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,p.NC)("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},group:{description:(0,p.NC)("vscode.extension.contributes.view.group","Nested group in the viewlet"),type:"string"},remoteName:{description:(0,p.NC)("vscode.extension.contributes.view.remoteName","The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},fh={description:(0,p.NC)("vscode.extension.contributes.views","Contributes views to the editor"),type:"object",properties:{explorer:{description:(0,p.NC)("views.explorer","Contributes views to Explorer container in the Activity bar"),type:"array",items:go,default:[]},debug:{description:(0,p.NC)("views.debug","Contributes views to Debug container in the Activity bar"),type:"array",items:go,default:[]},scm:{description:(0,p.NC)("views.scm","Contributes views to SCM container in the Activity bar"),type:"array",items:go,default:[]},test:{description:(0,p.NC)("views.test","Contributes views to Test container in the Activity bar"),type:"array",items:go,default:[]},remote:{description:(0,p.NC)("views.remote","Contributes views to Remote container in the Activity bar. To contribute to this container, enableProposedApi needs to be turned on"),type:"array",items:gh,default:[]}},additionalProperties:{description:(0,p.NC)("views.contributed","Contributes views to contributed views container"),type:"array",items:go,default:[]}},Ha=Na.ut.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:ph}),mh=Na.ut.registerExtensionPoint({extensionPoint:"views",deps:[Ha],jsonSchema:fh,activationEventsGenerator:(c,e)=>{for(const t of c)for(const i of Object.values(t))for(const o of i)o.id&&e.push(`onView:${o.id}`)}});let Or=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=me.B.as(O.IP.ViewContainersRegistry),this.viewsRegistry=me.B.as(O.IP.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews();let i=new xe.A;var o;T.W.registerCommandAndKeybindingRule({id:"workbench.action.showTreeHover",handler:(o=(0,w.Z)(function*(n,...r){i.cancel(),i=new xe.A;const s=n.get(D.Lw),a=n.get(ma.C),d=n.get(tt.B),l=s.lastFocusedList;if(!(l instanceof rt.c))return;const u=l.getFocus();if(!u||0===u.length)return;const f=u[0];if(f instanceof O.W6&&(yield f.resolve(i.token)),!f.tooltip)return;const b=a.getRenderedTreeElement(f);b&&d.showHover({content:f.tooltip,target:b,hoverPosition:2,hideOnHover:!1},!0)}),function(r){return o.apply(this,arguments)}),weight:200,primary:(0,it.gx)(2089,2087),when:y.Ao.and(ya,D.CQ)})}handleAndRegisterCustomViewContainers(){Ha.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeCustomViewContainers(i),t.length&&this.addCustomViewContainers(t,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){const i=me.B.as(O.IP.ViewContainersRegistry);let o=7+i.all.filter(r=>!!r.extensionId&&0===i.getViewContainerLocation(r)).length,n=5+i.all.filter(r=>!!r.extensionId&&1===i.getViewContainerLocation(r)).length+1;for(const{value:r,collector:s,description:a}of e)Object.entries(r).forEach(([d,l])=>{if(this.isValidViewsContainer(l,s))switch(d){case"activitybar":o=this.registerCustomViewContainers(l,a,o,t,0);break;case"panel":n=this.registerCustomViewContainers(l,a,n,t,1)}})}removeCustomViewContainers(e){const t=me.B.as(O.IP.ViewContainersRegistry),i=e.reduce((o,n)=>(o.add(n.description.identifier),o),new mr.o$);for(const o of t.all)if(o.extensionId&&i.has(o.extensionId)){const n=this.viewsRegistry.getViews(o);n.length&&this.viewsRegistry.moveViews(n,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(o)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error((0,p.NC)("viewcontainer requirearray","views containers must be an array")),!1;for(const i of e){if("string"!=typeof i.id&&(0,Kt.m5)(i.id)||!/^[a-z0-9_-]+$/i.test(i.id))return t.error((0,p.NC)("requireidstring","property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if("string"!=typeof i.title)return t.error((0,p.NC)("requirestring","property `{0}` is mandatory and must be of type `string`","title")),!1;if("string"!=typeof i.icon)return t.error((0,p.NC)("requirestring","property `{0}` is mandatory and must be of type `string`","icon")),!1;if((0,Kt.m5)(i.title))return t.warn((0,p.NC)("requirenonemptystring","property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,o,n){return e.forEach(r=>{const a=be.kS.fromString(r.icon)||J.Vo(t.extensionLocation,r.icon),d=`workbench.view.extension.${r.id}`,u=this.registerCustomViewContainer(d,r.title||d,a,i++,t.identifier,n);if(o.length){const f=[];for(const b of o)u!==b&&f.push(...this.viewsRegistry.getViews(b).filter(E=>E.originalContainerId===r.id));f.length&&this.viewsRegistry.moveViews(f,u)}}),i}registerCustomViewContainer(e,t,i,o,n,r){let s=this.viewContainersRegistry.get(e);return s||(s=this.viewContainersRegistry.registerViewContainer({id:e,title:t,extensionId:n,ctorDescriptor:new ie.M(Ci.XV,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:o,icon:i},r)),s}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),me.B.as(Co.IP.Viewlets).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){mh.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeViews(i),t.length&&this.addViews(t)})}addViews(e){const t=new Set,i=[];for(const o of e){const{value:n,collector:r}=o;Object.entries(n).forEach(([s,a])=>{if(!this.isValidViewDescriptors(a,r))return;if("remote"===s&&!(0,Pt.$x)(o.description,"contribViewsRemote"))return void r.warn((0,p.NC)("ViewContainerRequiresProposedAPI","View container '{0}' requires 'enabledApiProposals: [\"contribViewsRemote\"]' to be added to 'Remote'.",s));const d=this.getViewContainer(s);d||r.warn((0,p.NC)("ViewContainerDoesnotExist","View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",s));const l=d||this.getDefaultViewContainer(),u=[];for(let f=0;f<a.length;f++){const b=a[f];if(t.has(b.id)){r.error((0,p.NC)("duplicateView1","Cannot register multiple views with same id `{0}`",b.id));continue}if(null!==this.viewsRegistry.getView(b.id)){r.error((0,p.NC)("duplicateView2","A view with id `{0}` is already registered.",b.id));continue}const E=mr.kP.equals(o.description.identifier,l.extensionId)?f+1:l.viewOrderDelegate?l.viewOrderDelegate.getOrder(b.group):void 0;let k;"string"==typeof b.icon&&(k=be.kS.fromString(b.icon)||J.Vo(o.description.extensionLocation,b.icon));const M=this.convertInitialVisibility(b.visibility),X=this.getViewType(b.type);if(!X){r.error((0,p.NC)("unknownViewType","Unknown view type `{0}`.",b.type));continue}let ee;"number"==typeof b.initialSize&&(l.extensionId?.value===o.description.identifier.value?ee=b.initialSize:this.logService.warn(`${o.description.identifier.value} tried to set the view size of ${b.id} but it was ignored because the view container does not belong to it.`));const De={type:X,ctorDescriptor:new ie.M(X===ft.Tree?wr:Nr),id:b.id,name:b.name,when:y.Ao.deserialize(b.when),containerIcon:k||d?.icon,containerTitle:b.contextualTitle||d?.title,canToggleVisibility:!0,canMoveView:d?.id!==Lr,treeView:X===ft.Tree?this.instantiationService.createInstance(Er,b.id,b.name,o.description.identifier.value):void 0,collapsed:this.showCollapsed(l)||M===Mt.Collapsed,order:E,extensionId:o.description.identifier,originalContainerId:s,group:b.group,remoteAuthority:b.remoteName||b.remoteAuthority,virtualWorkspace:b.virtualWorkspace,hideByDefault:M===Mt.Hidden,workspace:d?.id===Lr||void 0,weight:ee};t.add(De.id),u.push(De)}i.push({viewContainer:l,views:u})})}this.viewsRegistry.registerViews2(i)}getViewType(e){return e===ft.Webview?ft.Webview:e&&e!==ft.Tree?void 0:ft.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get(_.f3)}removeViews(e){const t=e.reduce((i,o)=>(i.add(o.description.identifier),i),new mr.o$);for(const i of this.viewContainersRegistry.all){const o=this.viewsRegistry.getViews(i).filter(n=>n.extensionId&&t.has(n.extensionId));if(o.length){this.viewsRegistry.deregisterViews(o,i);for(const n of o)n.treeView&&n.treeView.dispose()}}}convertInitialVisibility(e){if(Object.values(Mt).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error((0,p.NC)("requirearray","views must be an array")),!1;for(const i of e){if("string"!=typeof i.id)return t.error((0,p.NC)("requirestring","property `{0}` is mandatory and must be of type `string`","id")),!1;if("string"!=typeof i.name)return t.error((0,p.NC)("requirestring","property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&"string"!=typeof i.when)return t.error((0,p.NC)("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&"string"!=typeof i.icon)return t.error((0,p.NC)("optstring","property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&"string"!=typeof i.contextualTitle)return t.error((0,p.NC)("optstring","property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error((0,p.NC)("optenum","property `{0}` can be omitted or must be one of {1}","visibility",Object.values(Mt).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get(_.f3);case"debug":return this.viewContainersRegistry.get(Sa.f3);case"scm":return this.viewContainersRegistry.get(La);case"remote":return this.viewContainersRegistry.get(Lr);default:return this.viewContainersRegistry.get(`workbench.view.extension.${e}`)}}showCollapsed(e){switch(e.id){case _.f3:case La:case Sa.f3:return!0}return!1}};Or=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,Ae.VZ)],Or),me.B.as(Bl.I.Workbench).registerWorkbenchContribution(Or,1),m(56918),m(6577);const bh=(0,R.yh)("editorDropService");var wh=m(92765),yh=m(96563);let en=class sn extends C.JT{get count(){return this.mostRecentEditorsMap.size}get editors(){return[...this.mostRecentEditorsMap.values()]}hasEditor(e){return this.editorsPerResourceCounter.get(e.resource)?.has(this.toIdentifier(e))??!1}hasEditors(e){return this.editorsPerResourceCounter.has(e)}toIdentifier(e,t){return"string"!=typeof e?this.toIdentifier(e.typeId,e.editorId):t?`${e}/${t}`:e}constructor(e,t){super(),this.editorGroupsService=e,this.storageService=t,this.keyMap=new Map,this.mostRecentEditorsMap=new Te.lC,this.editorsPerResourceCounter=new Te.Y9,this._onDidMostRecentlyActiveEditorsChange=this._register(new S.Q5),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.registerListeners()}registerListeners(){this._register(this.storageService.onWillSaveState(()=>this.saveState())),this._register(this.editorGroupsService.onDidAddGroup(e=>this.onGroupAdded(e))),this._register(this.editorGroupsService.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this.editorGroupsService.whenReady.then(()=>this.loadState())}onGroupAdded(e){const t=e.getEditors(0);for(let i=t.length-1;i>=0;i--)this.addMostRecentEditor(e,t[i],!1,!0);this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1),this.registerGroupListeners(e)}registerGroupListeners(e){const t=new C.SL;t.add(e.onDidModelChange(i=>{switch(i.kind){case 0:this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1);break;case 3:i.editor&&(this.addMostRecentEditor(e,i.editor,!1,!0),this.ensureOpenedEditorsLimit({groupId:e.id,editor:i.editor},e.id))}})),t.add(e.onDidCloseEditor(i=>{this.removeMostRecentEditor(e,i.editor)})),t.add(e.onDidActiveEditorChange(i=>{i.editor&&this.addMostRecentEditor(e,i.editor,this.editorGroupsService.activeGroup===e,!1)})),S.ju.once(e.onWillDispose)(()=>(0,C.B9)(t))}onDidChangeEditorPartOptions(e){if(!(0,Fo.fS)(e.newPartOptions.limit,e.oldPartOptions.limit)){const t=this.editorGroupsService.activeGroup;let i;t.activeEditor&&(i={editor:t.activeEditor,groupId:t.id}),this.ensureOpenedEditorsLimit(i)}}addMostRecentEditor(e,t,i,o){const n=this.ensureKey(e,t),r=this.mostRecentEditorsMap.first;i||!r?this.mostRecentEditorsMap.set(n,n,r?1:void 0):(this.mostRecentEditorsMap.set(n,n,1),this.mostRecentEditorsMap.set(r,r,1)),o&&this.updateEditorResourcesMap(t,!0),this._onDidMostRecentlyActiveEditorsChange.fire()}updateEditorResourcesMap(e,t){let i,o,n;if(e instanceof It.h?(i=e.primary.resource,o=e.primary.typeId,n=e.primary.editorId):(i=e.resource,o=e.typeId,n=e.editorId),!i)return;const r=this.toIdentifier(o,n);if(t){let s=this.editorsPerResourceCounter.get(i);s||(s=new Map,this.editorsPerResourceCounter.set(i,s)),s.set(r,(s.get(r)??0)+1)}else{const s=this.editorsPerResourceCounter.get(i);if(s){const a=s.get(r)??0;a>1?s.set(r,a-1):(s.delete(r),0===s.size&&this.editorsPerResourceCounter.delete(i))}}}removeMostRecentEditor(e,t){this.updateEditorResourcesMap(t,!1);const i=this.findKey(e,t);if(i){this.mostRecentEditorsMap.delete(i);const o=this.keyMap.get(e.id);o&&o.delete(i.editor)&&0===o.size&&this.keyMap.delete(e.id),this._onDidMostRecentlyActiveEditorsChange.fire()}}findKey(e,t){const i=this.keyMap.get(e.id);if(i)return i.get(t)}ensureKey(e,t){let i=this.keyMap.get(e.id);i||(i=new Map,this.keyMap.set(e.id,i));let o=i.get(t);return o||(o={groupId:e.id,editor:t},i.set(t,o)),o}ensureOpenedEditorsLimit(e,t){var i=this;return(0,w.Z)(function*(){if(!i.editorGroupsService.partOptions.limit?.enabled||"number"!=typeof i.editorGroupsService.partOptions.limit.value||i.editorGroupsService.partOptions.limit.value<=0)return;const o=i.editorGroupsService.partOptions.limit.value;if(i.editorGroupsService.partOptions.limit?.perEditorGroup)if("number"==typeof t){const n=i.editorGroupsService.getGroup(t);n&&(yield i.doEnsureOpenedEditorsLimit(o,n.getEditors(0).map(r=>({editor:r,groupId:t})),e))}else for(const n of i.editorGroupsService.groups)yield i.ensureOpenedEditorsLimit(e,n.id);else yield i.doEnsureOpenedEditorsLimit(o,[...i.mostRecentEditorsMap.values()],e)})()}doEnsureOpenedEditorsLimit(e,t,i){var o=this;return(0,w.Z)(function*(){let n;if(n=o.editorGroupsService.partOptions.limit?.excludeDirty?t.filter(({editor:d})=>!(d.isDirty()&&!d.isSaving()||d.hasCapability(512))):t,e>=n.length)return;const r=n.reverse().filter(({editor:d,groupId:l})=>!(d.isDirty()&&!d.isSaving()||d.hasCapability(512)||i&&d===i.editor&&l===i.groupId||o.editorGroupsService.getGroup(l)?.isSticky(d)));let s=n.length-e;const a=new Map;for(const{groupId:d,editor:l}of r){let u=a.get(d);if(u||(u=[],a.set(d,u)),u.push(l),s--,0===s)break}for(const[d,l]of a){const u=o.editorGroupsService.getGroup(d);u&&(yield u.closeEditors(l,{preserveFocus:!0}))}})()}saveState(){this.mostRecentEditorsMap.isEmpty()?this.storageService.remove(sn.STORAGE_KEY,1):this.storageService.store(sn.STORAGE_KEY,JSON.stringify(this.serialize()),1,1)}serialize(){const e=me.B.as(x.bS.EditorFactory),t=[...this.mostRecentEditorsMap.values()],i=new Map;return{entries:(0,L.kX)(t.map(({editor:o,groupId:n})=>{const r=this.editorGroupsService.getGroup(n);if(!r)return;let s=i.get(r);s||(s=r.getEditors(1).filter(d=>e.getEditorSerializer(d)?.canSerialize(d)),i.set(r,s));const a=s.indexOf(o);return-1!==a?{groupId:n,index:a}:void 0}))}}loadState(){const e=this.storageService.get(sn.STORAGE_KEY,1);if(e)this.deserialize(JSON.parse(e));else{const t=this.editorGroupsService.getGroups(1);for(let i=t.length-1;i>=0;i--){const o=t[i],n=o.getEditors(0);for(let r=n.length-1;r>=0;r--)this.addMostRecentEditor(o,n[r],!0,!0)}}for(const t of this.editorGroupsService.groups)this.registerGroupListeners(t)}deserialize(e){const t=[];for(const{groupId:i,index:o}of e.entries){const n=this.editorGroupsService.getGroup(i);if(!n)continue;const r=n.getEditorByIndex(o);if(!r)continue;const s=this.ensureKey(n,r);t.push([s,s]),this.updateEditorResourcesMap(r,!0)}this.mostRecentEditorsMap.fromJSON(t)}};en.STORAGE_KEY="editors.mru",en=(0,h.gn)([(0,h.fM)(0,te.Qw),(0,h.fM)(1,Ie.Uy)],en);var Ch=m(96343),le=m(742),tn=m(48970);let Hr=class extends C.JT{constructor(e,t,i,o,n,r,s,a,d,l){super(),this.editorGroupService=e,this.instantiationService=t,this.fileService=i,this.configurationService=o,this.contextService=n,this.uriIdentityService=r,this.editorResolverService=s,this.workspaceTrustRequestService=a,this.hostService=d,this.textEditorService=l,this._onDidActiveEditorChange=this._register(new S.Q5),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidVisibleEditorsChange=this._register(new S.Q5),this.onDidVisibleEditorsChange=this._onDidVisibleEditorsChange.event,this._onDidEditorsChange=this._register(new S.Q5),this.onDidEditorsChange=this._onDidEditorsChange.event,this._onDidCloseEditor=this._register(new S.Q5),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onDidOpenEditorFail=this._register(new S.Q5),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onDidMostRecentlyActiveEditorsChange=this._register(new S.Q5),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.lastActiveEditor=void 0,this.activeOutOfWorkspaceWatchers=new Te.Y9,this.closeOnFileDelete=!1,this.editorsObserver=this._register(this.instantiationService.createInstance(en)),this.onConfigurationUpdated(),this.registerListeners()}registerListeners(){this.editorGroupService.whenReady.then(()=>this.onEditorGroupsReady()),this.editorGroupService.onDidChangeActiveGroup(e=>this.handleActiveEditorChange(e)),this.editorGroupService.onDidAddGroup(e=>this.registerGroupListeners(e)),this.editorsObserver.onDidMostRecentlyActiveEditorsChange(()=>this._onDidMostRecentlyActiveEditorsChange.fire()),this._register(this.onDidVisibleEditorsChange(()=>this.handleVisibleEditorsChange())),this._register(this.fileService.onDidRunOperation(e=>this.onDidRunFileOperation(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onEditorGroupsReady(){for(const e of this.editorGroupService.groups)this.registerGroupListeners(e);this.activeEditor&&(this.doHandleActiveEditorChangeEvent(),this._onDidVisibleEditorsChange.fire())}handleActiveEditorChange(e){e===this.editorGroupService.activeGroup&&(!this.lastActiveEditor&&!e.activeEditor||this.doHandleActiveEditorChangeEvent())}doHandleActiveEditorChangeEvent(){this.lastActiveEditor=(0,A.f6)(this.editorGroupService.activeGroup.activeEditor),this._onDidActiveEditorChange.fire()}registerGroupListeners(e){const t=new C.SL;t.add(e.onDidModelChange(i=>{this._onDidEditorsChange.fire({groupId:e.id,event:i})})),t.add(e.onDidActiveEditorChange(()=>{this.handleActiveEditorChange(e),this._onDidVisibleEditorsChange.fire()})),t.add(e.onDidCloseEditor(i=>{this._onDidCloseEditor.fire(i)})),t.add(e.onDidOpenEditorFail(i=>{this._onDidOpenEditorFail.fire({editor:i,groupId:e.id})})),S.ju.once(e.onWillDispose)(()=>{(0,C.B9)(t)})}handleVisibleEditorsChange(){const e=new Te.XV;for(const t of this.visibleEditors){const i=(0,L.EB)((0,L.kX)([x.zK.getCanonicalUri(t,{supportSideBySide:x.YX.PRIMARY}),x.zK.getCanonicalUri(t,{supportSideBySide:x.YX.SECONDARY})]),o=>o.toString());for(const o of i)this.fileService.hasProvider(o)&&!this.contextService.isInsideWorkspace(o)&&e.add(o)}for(const t of this.activeOutOfWorkspaceWatchers.keys())e.has(t)||((0,C.B9)(this.activeOutOfWorkspaceWatchers.get(t)),this.activeOutOfWorkspaceWatchers.delete(t));for(const t of e.keys())if(!this.activeOutOfWorkspaceWatchers.get(t)){const i=this.fileService.watch(t);this.activeOutOfWorkspaceWatchers.set(t,i)}}onDidRunFileOperation(e){var t=this;return(0,w.Z)(function*(){e.isOperation(2)&&t.handleMovedFile(e.resource,e.target.resource),(e.isOperation(1)||e.isOperation(2))&&t.handleDeletedFile(e.resource,!1,e.target?e.target.resource:void 0)})()}onDidFilesChange(e){e.gotDeleted()&&this.handleDeletedFile(e,!0)}handleMovedFile(e,t){var i=this;return(0,w.Z)(function*(){for(const o of i.editorGroupService.groups){const n=[];for(const r of o.editors){const s=r.resource;if(!s||!i.uriIdentityService.extUri.isEqualOrParent(s,e))continue;let a;if(i.uriIdentityService.extUri.isEqual(e,s))a=t;else{const u=(0,Ch.s4)(s.path,e.path,i.uriIdentityService.extUri.ignorePathCasing(s));a=(0,J.Vo)(t,s.path.substr(u+e.path.length+1))}const d=yield r.rename(o.id,a);if(!d)return;const l={preserveFocus:!0,pinned:o.isPinned(r),sticky:o.isSticky(r),index:o.getIndexOfEditor(r),inactive:!o.isActive(r)};(0,x.Xl)(d.editor)?n.push({editor:r,replacement:d.editor,options:{...d.options,...l}}):n.push({editor:r,replacement:{...d.editor,options:{...d.editor.options,...l}}})}n.length&&i.replaceEditors(n,o)}})()}onConfigurationUpdated(e){if(e&&!e.affectsConfiguration("workbench.editor.closeOnFileDelete"))return;const t=this.configurationService.getValue();this.closeOnFileDelete="boolean"==typeof t.workbench?.editor?.closeOnFileDelete&&t.workbench.editor.closeOnFileDelete}handleDeletedFile(e,t,i){var o=this;for(const n of this.getAllNonDirtyEditors({includeUntitled:!1,supportSideBySide:!0}))(0,w.Z)(function*(){const r=n.resource;if(r&&(o.closeOnFileDelete||!t)){if(i&&o.uriIdentityService.extUri.isEqualOrParent(r,i))return;let s=!1;if(s=e instanceof z.G9?e.contains(r,2):o.uriIdentityService.extUri.isEqualOrParent(r,e),!s)return;let a=!1;t&&o.fileService.hasProvider(r)&&(yield(0,Ve.Vs)(100),a=yield o.fileService.exists(r)),!a&&!n.isDisposed()&&n.dispose()}})()}getAllNonDirtyEditors(e){const t=[];function i(o){o.hasCapability(4)&&!e.includeUntitled||o.isDirty()||t.push(o)}for(const o of this.editors)e.supportSideBySide&&o instanceof It.h?(i(o.primary),i(o.secondary)):i(o);return t}get activeEditorPane(){return this.editorGroupService.activeGroup?.activeEditorPane}get activeTextEditorControl(){const e=this.activeEditorPane;if(e){const t=e.getControl();if((0,$t.CL)(t)||(0,$t.QI)(t))return t;if((0,$t.sd)(t)&&(0,$t.CL)(t.activeCodeEditor))return t.activeCodeEditor}}get activeTextEditorLanguageId(){let e;const t=this.activeTextEditorControl;return e=(0,$t.QI)(t)?t.getModifiedEditor():t,e?.getModel()?.getLanguageId()}get count(){return this.editorsObserver.count}get editors(){return this.getEditors(1).map(({editor:e})=>e)}getEditors(e,t){switch(e){case 0:return t?.excludeSticky?this.editorsObserver.editors.filter(({groupId:i,editor:o})=>!this.editorGroupService.getGroup(i)?.isSticky(o)):this.editorsObserver.editors;case 1:{const i=[];for(const o of this.editorGroupService.getGroups(2))i.push(...o.getEditors(1,t).map(n=>({editor:n,groupId:o.id})));return i}}}get activeEditor(){const e=this.editorGroupService.activeGroup;return e?(0,A.f6)(e.activeEditor):void 0}get visibleEditorPanes(){return(0,L.kX)(this.editorGroupService.groups.map(e=>e.activeEditorPane))}get visibleTextEditorControls(){const e=[];for(const t of this.visibleEditorPanes){const i=t.getControl();((0,$t.CL)(i)||(0,$t.QI)(i))&&e.push(i)}return e}get visibleEditors(){return(0,L.kX)(this.editorGroupService.groups.map(e=>e.activeEditor))}openEditor(e,t,i){var o=this;return(0,w.Z)(function*(){let n,s,r=(0,x.Xl)(e)?t:e.options;if((0,U.DY)(t)&&(i=t),!(0,x.Xl)(e)){const a=yield o.editorResolverService.resolveEditor(e,i);if(1===a)return;(0,x.uF)(a)&&(n=a.editor,r=a.options,s=a.group)}if(n||(n=(0,x.Xl)(e)?e:yield o.textEditorService.resolveTextEditor(e)),!s){let a;[s,a]=o.instantiationService.invokeFunction(zo,{editor:n,options:r},i),a&&(r={...r,activation:a})}return s.openEditor(n,r)})()}openEditors(e,t,i){var o=this;return(0,w.Z)(function*(){if(i?.validateTrust&&!(yield o.handleWorkspaceTrust(e)))return[];const n=new Map;for(const s of e){let a,d;if(!(0,x.uc)(s)){const u=yield o.editorResolverService.resolveEditor(s,t);if(1===u)continue;(0,x.uF)(u)&&(a=u,d=u.group)}a||(a=(0,x.uc)(s)?s:{editor:yield o.textEditorService.resolveTextEditor(s),options:s.options}),d||([d]=o.instantiationService.invokeFunction(zo,a,t));let l=n.get(d);l||(l=[],n.set(d,l)),l.push(a)}const r=[];for(const[s,a]of n)r.push(s.openEditors(a));return(0,L.kX)(yield Ve.jT.settled(r))})()}handleWorkspaceTrust(e){var t=this;return(0,w.Z)(function*(){const{resources:i,diffMode:o,mergeMode:n}=t.extractEditorResources(e);switch(yield t.workspaceTrustRequestService.requestOpenFilesTrust(i)){case 1:return!0;case 2:return yield t.hostService.openWindow(i.map(s=>({fileUri:s})),{forceNewWindow:!0,diffMode:o,mergeMode:n}),!1;case 3:return!1}})()}extractEditorResources(e){const t=new Te.XV;let i=!1,o=!1;for(const n of e)if((0,x.uc)(n)){const r=x.zK.getOriginalUri(n.editor,{supportSideBySide:x.YX.BOTH});W.ov.isUri(r)?t.add(r):r&&(r.primary&&t.add(r.primary),r.secondary&&t.add(r.secondary),i=n.editor instanceof yh.$)}else(0,x.B)(n)&&(W.ov.isUri(n.input1)&&t.add(n.input1.resource),W.ov.isUri(n.input2)&&t.add(n.input2.resource),W.ov.isUri(n.base)&&t.add(n.base.resource),W.ov.isUri(n.result)&&t.add(n.result.resource),o=!0),(0,x.hG)(n)?(W.ov.isUri(n.original.resource)&&t.add(n.original.resource),W.ov.isUri(n.modified.resource)&&t.add(n.modified.resource),i=!0):(0,x.BR)(n)&&t.add(n.resource);return{resources:Array.from(t.keys()),diffMode:i,mergeMode:o}}isOpened(e){return this.editorsObserver.hasEditor({resource:this.uriIdentityService.asCanonicalUri(e.resource),typeId:e.typeId,editorId:e.editorId})}isVisible(e){for(const t of this.editorGroupService.groups)if(t.activeEditor?.matches(e))return!0;return!1}closeEditor({editor:e,groupId:t},i){var o=this;return(0,w.Z)(function*(){yield o.editorGroupService.getGroup(t)?.closeEditor(e,i)})()}closeEditors(e,t){var i=this;return(0,w.Z)(function*(){const o=new Map;for(const{editor:n,groupId:r}of e){const s=i.editorGroupService.getGroup(r);if(!s)continue;let a=o.get(s);a||(a=[],o.set(s,a)),a.push(n)}for(const[n,r]of o)yield n.closeEditors(r,t)})()}findEditors(e,t,i){const o=W.ov.isUri(e)?e:e.resource,n=W.ov.isUri(e)?void 0:e.typeId;if(t?.supportSideBySide!==x.YX.ANY&&t?.supportSideBySide!==x.YX.SECONDARY&&!this.editorsObserver.hasEditors(o))return W.ov.isUri(e)||(0,A.o8)(i)?[]:void 0;if((0,A.o8)(i)){const r=[];for(const s of this.editorGroupService.getGroups(1)){const a=[];if(W.ov.isUri(e))a.push(...this.findEditors(e,t,s));else{const d=this.findEditors(e,t,s);d&&a.push(d)}r.push(...a.map(d=>({editor:d,groupId:s.id})))}return r}{const r="number"==typeof i?this.editorGroupService.getGroup(i):i;if(W.ov.isUri(e))return r?r.findEditors(o,t):[];{if(!r)return;const s=r.findEditors(o,t);for(const a of s)if(a.typeId===n)return a;return}}}replaceEditors(e,t){var i=this;return(0,w.Z)(function*(){const o="number"==typeof t?i.editorGroupService.getGroup(t):t,n=[];for(const r of e){let s;if(!(0,x.Xl)(r.replacement)){const a=yield i.editorResolverService.resolveEditor(r.replacement,o);if(1===a)continue;(0,x.uF)(a)&&(s={editor:r.editor,replacement:a.editor,options:a.options,forceReplaceDirty:r.forceReplaceDirty})}s||(s={editor:r.editor,replacement:(0,te.XP)(r)?r.replacement:yield i.textEditorService.resolveTextEditor(r.replacement),options:(0,te.XP)(r)?r.options:r.replacement.options,forceReplaceDirty:r.forceReplaceDirty}),n.push(s)}return o?.replaceEditors(n)})()}save(e,t){var i=this;return(0,w.Z)(function*(){Array.isArray(e)||(e=[e]);const o=i.getUniqueEditors(e),n=[],r=[];if(t?.saveAs)r.push(...o);else for(const{groupId:a,editor:d}of o)d.hasCapability(4)?r.push({groupId:a,editor:d}):n.push({groupId:a,editor:d});const s=yield Ve.jT.settled(n.map(({groupId:a,editor:d})=>(1===t?.reason&&i.editorGroupService.getGroup(a)?.pinEditor(d),d.save(a,t))));for(const{groupId:a,editor:d}of r){if(d.isDisposed())continue;const u={pinned:!0,viewState:(yield i.openEditor(d,a))?.getViewState()},f=t?.saveAs?yield d.saveAs(a,t):yield d.save(a,t);if(s.push(f),!f)break;if(!d.matches(f)){const b=d.hasCapability(4)?i.editorGroupService.groups.map(E=>E.id):[a];for(const E of b)f instanceof wh.Q?yield i.replaceEditors([{editor:d,replacement:f,options:u}],E):yield i.replaceEditors([{editor:d,replacement:{...f,options:u}}],E)}}return{success:s.every(a=>!!a),editors:(0,L.kX)(s)}})()}saveAll(e){return this.save(this.getAllDirtyEditors(e),e)}revert(e,t){var i=this;return(0,w.Z)(function*(){Array.isArray(e)||(e=[e]);const o=i.getUniqueEditors(e);return yield Ve.jT.settled(o.map(function(){var n=(0,w.Z)(function*({groupId:r,editor:s}){return i.editorGroupService.getGroup(r)?.pinEditor(s),s.revert(r,t)});return function(r){return n.apply(this,arguments)}}())),!o.some(({editor:n})=>n.isDirty())})()}revertAll(e){var t=this;return(0,w.Z)(function*(){return t.revert(t.getAllDirtyEditors(e),e)})()}getAllDirtyEditors(e){const t=[];for(const i of this.editorGroupService.getGroups(1))for(const o of i.getEditors(0))o.isDirty()&&(!e?.includeUntitled&&o.hasCapability(4)||e?.excludeSticky&&i.isSticky(o)||t.push({groupId:i.id,editor:o}));return t}getUniqueEditors(e){const t=[];for(const{editor:i,groupId:o}of e)t.some(n=>n.editor.matches(i))||t.push({editor:i,groupId:o});return t}dispose(){super.dispose(),this.activeOutOfWorkspaceWatchers.forEach(e=>(0,C.B9)(e)),this.activeOutOfWorkspaceWatchers.clear()}};Hr=(0,h.gn)([(0,h.fM)(0,te.Qw),(0,h.fM)(1,R.TG),(0,h.fM)(2,z.sn),(0,h.fM)(3,G.Ui),(0,h.fM)(4,ce.ec),(0,h.fM)(5,$i.v),(0,h.fM)(6,le.es),(0,h.fM)(7,Kn.N2),(0,h.fM)(8,Do.$),(0,h.fM)(9,tn.X)],Hr);let Li=class ni extends C.JT{constructor(e,t,i,o,n,r,s,a,d){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=o,this.notificationService=n,this.telemetryService=r,this.storageService=s,this.extensionService=a,this.logService=d,this._onDidChangeEditorRegistrations=this._register(new S.K3),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(ni.cacheStorageID,0,JSON.stringify([])))),this.storageService.remove(ni.cacheStorageID,0),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0})}resolveUntypedInputAndGroup(e,t){const i=e,[o,n]=this.instantiationService.invokeFunction(zo,i,t);return[i,o,n]}resolveEditor(e,t){var i=this;return(0,w.Z)(function*(){if(i._flattenedEditors=i._flattenEditorsMap(),(0,x.eq)(e))return i.doResolveSideBySideEditor(e,t);const o=i.resolveUntypedInputAndGroup(e,t);if(!o)return 2;const[n,r,s]=o;s&&(n.options={...n.options,activation:s});let a=x.zK.getCanonicalUri(n,{supportSideBySide:x.YX.PRIMARY});if(i.cache&&a&&i.resourceMatchesCache(a)&&(yield i.extensionService.whenInstalledExtensionsRegistered()),void 0===a)a=W.ov.from({scheme:Me.lg.untitled});else if(void 0===a.scheme||null===a)return 2;if(n.options?.override===Qe.Cs.PICK){const f=yield i.doPickEditor(n);if(!f)return 1;n.options=f}let{editor:d,conflictingDefault:l}=i.getEditor(a,n.options?.override);if(!d&&(n.options?.override||(0,x.uc)(e)))return 2;if(!d){const f=i.getEditor(a,x.Cr.id);if(d=f?.editor,l=f?.conflictingDefault,!d)return 2}if((0,x.hG)(n)&&void 0===n.options?.override){let f=x.zK.getCanonicalUri(n,{supportSideBySide:x.YX.SECONDARY});f||(f=W.ov.from({scheme:Me.lg.untitled}));const{editor:b}=i.getEditor(f,void 0);if(!b||d.editorInfo.id!==b.editorInfo.id){const{editor:E,conflictingDefault:k}=i.getEditor(a,x.Cr.id);d=E,l=k}if(!d)return 2}if(n.options={override:d.editorInfo.id,...n.options},void 0===d.editorFactoryObject.createDiffEditorInput&&(0,x.hG)(n))return 2;const u=yield i.doResolveEditor(n,r,d);return l&&u&&(yield i.doHandleConflictingDefaults(a,d.editorInfo.label,n,u.editor,r)),u?(i.sendEditorResolutionTelemetry(u.editor),u.editor.editorId!==d.editorInfo.id&&i.logService.warn(`Editor ID Mismatch: ${u.editor.editorId} !== ${d.editorInfo.id}. This will cause bugs. Please ensure editorInput.editorId matches the registered id`),{...u,group:r}):1})()}doResolveSideBySideEditor(e,t){var i=this;return(0,w.Z)(function*(){const o=yield i.resolveEditor(e.primary,t);if(!(0,x.uF)(o))return 2;const n=yield i.resolveEditor(e.secondary,o.group??t);return(0,x.uF)(n)?{group:o.group??n.group,editor:i.instantiationService.createInstance(It.h,e.label,e.description,n.editor,o.editor),options:e.options}:2})()}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,o){let n=this._editors.get(e);void 0===n&&(n=new Map,this._editors.set(e,n));let r=n.get(t.id);void 0===r&&(r=[]);const s=(0,L.$T)(r,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:o});return n.set(t.id,r),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),(0,C.OF)(()=>{s(),r&&0===r.length&&n?.delete(t.id),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){const i=this.getAllUserAssociations().filter(n=>n.filenamePattern&&(0,le.M9)(n.filenamePattern,e)),o=this._registeredEditors;return i.filter(n=>o.find(r=>r.editorInfo.id===n.viewType))}getAllUserAssociations(){const e=this.configurationService.inspect(le.x8)||{},i=e.userValue??{},o={...e.workspaceValue??{}};for(const[r,s]of Object.entries(i))void 0===o[r]&&(o[r]=s);const n=[];for(const[r,s]of Object.entries(o))n.push({filenamePattern:r,viewType:s});return n}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;const e=new Map;for(const[t,i]of this._editors){const o=[];for(const n of i.values()){let r;for(const s of n)r||(r={editorInfo:s.editorInfo,globPattern:s.globPattern,options:{},editorFactoryObject:{}}),r.options={...r.options,...s.options},r.editorFactoryObject={...r.editorFactoryObject,...s.editorFactoryObject};r&&o.push(r)}e.set(t,o)}return e}get _registeredEditors(){return(0,L.xH)(Array.from(this._flattenedEditors.values()))}updateUserAssociations(e,t){const i={viewType:t,filenamePattern:e},o=this.getAllUserAssociations(),n=Object.create(null);for(const r of[...o,i])r.filenamePattern&&(n[r.filenamePattern]=r.viewType);this.configurationService.updateValue(le.x8,n)}findMatchingEditors(e){const t=this.getAssociationsForResource(e),i=[];for(const[o,n]of this._flattenedEditors)for(const r of n)(t.find(a=>a.viewType===r.editorInfo.id)&&r.editorInfo.priority!==le.OP.exclusive||(0,le.M9)(o,e))&&i.push(r);return i.sort((o,n)=>(0,le.YV)(n.editorInfo.priority)===(0,le.YV)(o.editorInfo.priority)&&"string"==typeof n.globPattern&&"string"==typeof o.globPattern?n.globPattern.length-o.globPattern.length:(0,le.YV)(n.editorInfo.priority)-(0,le.YV)(o.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),W.ov.isUri(e)){const t=this.findMatchingEditors(e);return t.find(i=>i.editorInfo.priority===le.OP.exclusive)?[]:t.map(i=>i.editorInfo)}return(0,L.EB)(this._registeredEditors.map(t=>t.editorInfo),t=>t.id)}getEditor(e,t){const i=(l,u)=>l.find(f=>f.options&&void 0!==f.options.canSupportResource?f.editorInfo.id===u&&f.options.canSupportResource(e):f.editorInfo.id===u);if(t&&t!==Qe.Cs.EXCLUSIVE_ONLY)return{editor:i(this._registeredEditors,t),conflictingDefault:!1};const o=this.findMatchingEditors(e),n=this.getAssociationsForResource(e),r=t===Qe.Cs.EXCLUSIVE_ONLY?le.OP.exclusive:le.OP.builtin;let s=o.filter(l=>(0,le.YV)(l.editorInfo.priority)>=(0,le.YV)(r)&&l.editorInfo.id!==x.Cr.id);if(0===s.length)return{editor:n[0]&&r!==le.OP.exclusive?i(o,n[0].viewType):void 0,conflictingDefault:!1};const a=s[0].editorInfo.priority===le.OP.exclusive?s[0].editorInfo.id:n[0]?.viewType||s[0].editorInfo.id;let d=!1;return s=s.filter(l=>l.editorInfo.priority!==le.OP.exclusive),0===n.length&&s.length>1&&(d=!0),{editor:i(o,a),conflictingDefault:d}}doResolveEditor(e,t,i){var o=this;return(0,w.Z)(function*(){let n=e.options;const r=x.zK.getCanonicalUri(e,{supportSideBySide:x.YX.PRIMARY});if(n&&typeof n.activation>"u"&&(n={...n,activation:n.preserveFocus?Qe.kn.RESTORE:void 0}),(0,x.B)(e)){if(!i.editorFactoryObject.createMergeEditorInput)return;const l=yield i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:l.editor,options:l.options??n}}if((0,x.hG)(e)){if(!i.editorFactoryObject.createDiffEditorInput)return;const l=yield i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:l.editor,options:l.options??n}}if((0,x.eq)(e))throw new Error("Untyped side by side editor input not supported here.");if((0,x.Eg)(e)){if(!i.editorFactoryObject.createUntitledEditorInput)return;const l=yield i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:l.editor,options:l.options??n}}if(void 0===r)throw new Error("Undefined resource on non untitled editor input.");if("function"==typeof i.options?.singlePerResource?i.options.singlePerResource():i.options?.singlePerResource){const l=yield o.moveExistingEditorForResource(r,i.editorInfo.id,t);if(l)return{editor:l,options:n}}if(!i.editorFactoryObject.createEditorInput)return;const a=yield i.editorFactoryObject.createEditorInput(e,t);return n=a.options??n,{editor:a.editor,options:n}})()}moveExistingEditorForResource(e,t,i){var o=this;return(0,w.Z)(function*(){const n=o.findExistingEditorsForResource(e,t);if(!n.length)return;const r=n[0];for(const{editor:s,group:a}of n)if(s!==r.editor&&!(yield a.closeEditor(s)))return;return i.id!==r.group.id?(r.group.moveEditor(r.editor,i),r.editor):void 0})()}findExistingEditorsForResource(e,t){const i=[],o=(0,L.EB)([...this.editorGroupService.groups]);for(const n of o)for(const r of n.editors)(0,J.Xy)(r.resource,e)&&r.editorId===t&&i.push({editor:r,group:n});return i}doHandleConflictingDefaults(e,t,i,o,n){var r=this;return(0,w.Z)(function*(){const s=r.findMatchingEditors(e),a=JSON.parse(r.storageService.get(ni.conflictingDefaultsStorageID,0,"{}")),d=`*${(0,J.DZ)(e)}`,l=()=>{a[d]=[],s.forEach(b=>a[d].push(b.editorInfo.id)),r.storageService.store(ni.conflictingDefaultsStorageID,JSON.stringify(a),0,1)};if(a[d]&&a[d].find(b=>b===o.editorId))return;const f=r.notificationService.prompt(oe.zb.Warning,(0,p.NC)("editorResolver.conflictingDefaults","There are multiple default editors available for the resource."),[{label:(0,p.NC)("editorResolver.configureDefault","Configure Default"),run:(b=(0,w.Z)(function*(){const E=yield r.doPickEditor(i,!0);if(!E)return;i.options=E;const k=yield r.resolveEditor(i,n);1===k||2===k||n.replaceEditors([{editor:o,replacement:k.editor,options:k.options??E}])}),function(){return b.apply(this,arguments)})},{label:(0,p.NC)("editorResolver.keepDefault","Keep {0}",t),run:l}]).onDidClose(()=>{l(),f.dispose()});var b})()}mapEditorsToQuickPickEntry(e,t){const i=(0,L.Xh)(this.editorGroupService.activeGroup.findEditors(e));let o=e.scheme===Me.lg.untitled?this._registeredEditors.filter(u=>u.editorInfo.priority!==le.OP.exclusive):this.findMatchingEditors(e);o=(0,L.EB)(o,u=>u.editorInfo.id);const n=this.getAssociationsForResource(e)[0]?.viewType;o=o.sort((u,f)=>u.editorInfo.id===x.Cr.id?-1:f.editorInfo.id===x.Cr.id?1:(0,le.YV)(f.editorInfo.priority)-(0,le.YV)(u.editorInfo.priority));const r=[],s=(0,p.NC)("promptOpenWith.currentlyActive","Active"),a=(0,p.NC)("promptOpenWith.currentDefault","Default"),d=(0,p.NC)("promptOpenWith.currentDefaultAndActive","Active and Default");let l=n;if(!l&&o.length>2&&o[1]?.editorInfo.priority!==le.OP.option&&(l=o[1]?.editorInfo.id),l||(l=x.Cr.id),o.forEach(u=>{const b=!!i&&u.editorInfo.id===(i?.editorId??x.Cr.id),E=u.editorInfo.id===l;r.push({id:u.editorInfo.id,label:u.editorInfo.label,description:b&&E?d:b?s:E?a:void 0,detail:u.editorInfo.detail??u.editorInfo.priority})}),!t&&""!==(0,J.DZ)(e)){r.push({type:"separator"});const f={id:ni.configureDefaultID,label:(0,p.NC)("promptOpenWith.configureDefault","Configure default editor for '{0}'...",`*${(0,J.DZ)(e)}`)};r.push(f)}return r}doPickEditor(e,t){var i=this;return(0,w.Z)(function*(){let o=x.zK.getOriginalUri(e,{supportSideBySide:x.YX.PRIMARY});void 0===o&&(o=W.ov.from({scheme:Me.lg.untitled}));const n=i.mapEditorsToQuickPickEntry(o,t),r=i.quickInputService.createQuickPick(),s=t?(0,p.NC)("promptOpenWith.updateDefaultPlaceHolder","Select new default editor for '{0}'",`*${(0,J.DZ)(o)}`):(0,p.NC)("promptOpenWith.placeHolder","Select editor for '{0}'",(0,J.EZ)(o));r.placeholder=s,r.canAcceptInBackground=!0,r.items=n;const a=r.items.find(l=>"item"===l.type);a&&(r.selectedItems=[a]);const d=yield new Promise(l=>{r.onDidAccept(u=>{let f;1===r.selectedItems.length&&(f={item:r.selectedItems[0],keyMods:r.keyMods,openInBackground:u.inBackground}),o&&t&&f?.item.id&&i.updateUserAssociations(`*${(0,J.DZ)(o)}`,f.item.id),l(f)}),r.onDidHide(()=>l(void 0)),r.onDidTriggerItemButton(u=>{l({item:u.item,openInBackground:!1}),o&&u.item&&u.item.id&&i.updateUserAssociations(`*${(0,J.DZ)(o)}`,u.item.id)}),r.show()});if(r.dispose(),d)return d.item.id===ni.configureDefaultID?i.doPickEditor(e,!0):{...e.options,override:d.item.id,preserveFocus:d.openInBackground||e.options?.preserveFocus}})()}sendEditorResolutionTelemetry(e){e.editorId&&this.telemetryService.publicLog2("override.viewType",{viewType:e.editorId})}cacheEditors(){const e=new Set;for(const[i,o]of this._flattenedEditors)o.find(r=>r.editorInfo.priority!==le.OP.option&&r.editorInfo.id!==x.Cr.id)&&(Rs._U(i)?e.add(`${i.pattern}`):e.add(i));const t=this.getAllUserAssociations();for(const i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(ni.cacheStorageID,JSON.stringify(Array.from(e)),0,1)}resourceMatchesCache(e){if(!this.cache)return!1;for(const t of this.cache)if((0,le.M9)(t,e))return!0;return!1}};Li.configureDefaultID="promptOpenWith.configureDefault",Li.cacheStorageID="editorOverrideService.cache",Li.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults",Li=(0,h.gn)([(0,h.fM)(0,te.Qw),(0,h.fM)(1,R.TG),(0,h.fM)(2,G.Ui),(0,h.fM)(3,St.eJ),(0,h.fM)(4,oe.lT),(0,h.fM)(5,Ue.bU),(0,h.fM)(6,Ie.Uy),(0,h.fM)(7,Pt.QS),(0,h.fM)(8,Ae.VZ)],Li);var Sh=m(66136),Eh=m(21234),Ba=m(25050);(0,ve.Z)('.monaco-workbench .part.statusbar{box-sizing:border-box;cursor:default;display:flex;font-size:12px;height:22px;overflow:hidden;width:100%}.monaco-workbench:not(.reduce-motion) .part.statusbar{transition:background-color .15s ease-out}.monaco-workbench .part.statusbar.status-border-top:after{background-color:var(--status-border-top-color);content:"";height:1px;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:5}.monaco-workbench .part.statusbar>.left-items,.monaco-workbench .part.statusbar>.right-items{display:flex}.monaco-workbench .part.statusbar>.right-items{flex-direction:row-reverse;flex-wrap:wrap}.monaco-workbench .part.statusbar>.left-items{flex-grow:1}.monaco-workbench .part.statusbar>.items-container>.statusbar-item{display:inline-block;font-variant-numeric:tabular-nums;height:100%;line-height:22px;max-width:40vw;vertical-align:top}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak{position:relative}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container{height:5px;left:calc(50% - 5px);position:absolute;top:-5px;width:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container:before{border-bottom-style:solid;border-bottom-width:5px;border-left:5px solid transparent;border-right:5px solid transparent;content:"";position:fixed}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{margin-left:3px;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label{margin-left:0;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{margin-left:3px;margin-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.left.first-visible-item{padding-left:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.right.last-visible-item{margin-right:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.left.first-visible-item,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.right.last-visible-item{padding-left:0;padding-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color>.statusbar-item-label{margin-left:0;margin-right:0;padding-left:10px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left.has-background-color>.statusbar-item-label{padding-left:3px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right.has-background-color>.statusbar-item-label{padding-left:10px;padding-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{align-items:center;cursor:pointer;display:flex;height:100%;outline-width:0;overflow:hidden;padding:0 5px;text-overflow:ellipsis;white-space:pre}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{padding:0 3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a:hover:not(.disabled){text-decoration:none}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a.disabled{cursor:default}.monaco-workbench .part.statusbar>.items-container>.statusbar-item span.codicon{color:inherit;font-size:14px;text-align:center}.monaco-workbench .part.statusbar>.items-container>.statusbar-item .status-bar-info{background-color:var(--vscode-statusBarItem-prominentBackground);color:var(--vscode-statusBarItem-prominentForeground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a.status-bar-info:hover:not(.disabled){background-color:var(--vscode-statusBarItem-prominentHoverBackground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){outline:1px solid var(--vscode-contrastActiveBorder)!important;outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){background-color:var(--vscode-statusBarItem-activeBackground)!important}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){outline:1px dashed var(--vscode-contrastActiveBorder);outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){background-color:var(--vscode-statusBarItem-hoverBackground)}',{});var Ze=m(98536);class kh extends P.aU{constructor(e,t,i){super(e,t,void 0,!0),this.model=i,this.checked=!i.isHidden(e)}run(){var e=this;return(0,w.Z)(function*(){e.model.isHidden(e.id)?e.model.show(e.id):e.model.hide(e.id)})()}}class Dh extends P.aU{constructor(e,t,i){super(e,(0,p.NC)("hide","Hide '{0}'",t),void 0,!0),this.model=i}run(){var e=this;return(0,w.Z)(function*(){e.model.hide(e.id)})()}}T.W.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:200,primary:15,secondary:[16],when:N.RP,handler:c=>{c.get(Ze.iq).focusPreviousEntry()}}),T.W.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:200,primary:17,secondary:[18],when:N.RP,handler:c=>{c.get(Ze.iq).focusNextEntry()}}),T.W.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:200,primary:14,when:N.RP,handler:c=>{const e=c.get(Ze.iq);e.focus(!1),e.focusNextEntry()}}),T.W.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:200,primary:13,when:N.RP,handler:c=>{const e=c.get(Ze.iq);e.focus(!1),e.focusPreviousEntry()}}),T.W.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:200,primary:9,when:N.RP,handler:c=>{const e=c.get(Ze.iq),t=c.get(U.AR);e.isEntryFocused()?e.focus(!1):t.activeEditorPane&&t.activeEditorPane.focus()}}),(0,v.r1)(class Ih extends v.Ke{constructor(){super({id:"workbench.action.focusStatusBar",title:{value:(0,p.NC)("focusStatusBar","Focus Status Bar"),original:"Focus Status Bar"},category:Ee.R.View,f1:!0})}run(e){return(0,w.Z)(function*(){e.get(et.z).focusPart("workbench.parts.statusbar")})()}});let Ah=(()=>{class c extends C.JT{get entries(){return this._entries.slice(0)}get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}constructor(t){super(),this.storageService=t,this._onDidChangeEntryVisibility=this._register(new S.Q5),this.onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event,this._entries=[],this.hidden=new Set,this.restoreState(),this.registerListeners()}restoreState(){const t=this.storageService.get(c.HIDDEN_ENTRIES_KEY,0);if(t)try{const i=JSON.parse(t);this.hidden=new Set(i)}catch{}}registerListeners(){this._register(this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t)))}onDidStorageValueChange(t){if(t.key===c.HIDDEN_ENTRIES_KEY&&0===t.scope){const i=new Set(this.hidden);this.hidden.clear(),this.restoreState();const o=new Set;for(const n of i)this.hidden.has(n)||o.add(n);for(const n of this.hidden)i.has(n)||o.add(n);if(o.size>0)for(const n of this._entries)o.has(n.id)&&(this.updateVisibility(n.id,!0),o.delete(n.id))}}add(t){this._entries.push(t),this.updateVisibility(t,!1),this.sort(),this.markFirstLastVisibleEntry()}remove(t){const i=this._entries.indexOf(t);i>=0&&(this._entries.splice(i,1),this._entries.some(o=>(0,Ze.iV)(o.priority.primary)&&o.priority.primary.id===t.id)&&this.sort(),this.markFirstLastVisibleEntry())}isHidden(t){return this.hidden.has(t)}hide(t){this.hidden.has(t)||(this.hidden.add(t),this.updateVisibility(t,!0),this.saveState())}show(t){this.hidden.has(t)&&(this.hidden.delete(t),this.updateVisibility(t,!0),this.saveState())}findEntry(t){return this._entries.find(i=>i.container===t)}getEntries(t){return this._entries.filter(i=>i.alignment===t)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(t=>(0,g.jg)(document.activeElement,t.container))}focusEntry(t,i){const o=s=>{let a=s,d=a>=0&&a<this._entries.length?this._entries[a]:void 0;for(;d&&this.isHidden(d.id);)a+=t,d=a>=0&&a<this._entries.length?this._entries[a]:void 0;return d},n=this.getFocusedEntry();if(n){const s=o(this._entries.indexOf(n)+t);if(s)return this._lastFocusedEntry=s,void s.labelContainer.focus()}const r=o(i);r&&(this._lastFocusedEntry=r,r.labelContainer.focus())}updateVisibility(t,i){if("string"==typeof t){const o=t;for(const n of this._entries)n.id===o&&this.updateVisibility(n,i)}else{const o=t,n=this.isHidden(o.id);n?(0,g.Cp)(o.container):(0,g.$Z)(o.container),i&&this._onDidChangeEntryVisibility.fire({id:o.id,visible:!n}),this.markFirstLastVisibleEntry()}}saveState(){this.hidden.size>0?this.storageService.store(c.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),0,0):this.storageService.remove(c.HIDDEN_ENTRIES_KEY,0)}sort(){const t=new Map,i=new Map;for(let r=0;r<this._entries.length;r++){const s=this._entries[r];if("number"==typeof s.priority.primary)t.set(s,r);else{let a=i.get(s.priority.primary.id);a||(a=[],i.set(s.priority.primary.id,a)),a.push(s)}}const o=Array.from(t.keys());let n;if(o.sort((r,s)=>r.alignment===s.alignment?r.priority.primary!==s.priority.primary?Number(s.priority.primary)-Number(r.priority.primary):r.priority.secondary!==s.priority.secondary?s.priority.secondary-r.priority.secondary:t.get(r)-t.get(s):0===r.alignment?-1:0===s.alignment?1:0),i.size>0){n=[];for(const r of o){const s=i.get(r.id);s&&n.push(...s.filter(a=>(0,Ze.iV)(a.priority.primary)&&0===a.priority.primary.alignment)),n.push(r),s&&n.push(...s.filter(a=>(0,Ze.iV)(a.priority.primary)&&1===a.priority.primary.alignment)),i.delete(r.id)}for(const[,r]of i)n.push(...r)}else n=o;this._entries=n}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(0)),this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(1))}doMarkFirstLastVisibleStatusbarItem(t){let i,o;for(const n of t)n.container.classList.remove("first-visible-item","last-visible-item"),!this.isHidden(n.id)&&(i||(i=n),o=n);i?.container.classList.add("first-visible-item"),o?.container.classList.add("last-visible-item")}}return c.HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden",c})();var _h=m(71151),Th=m(21788),Br=m(61909),Vh=m(28863);let Fr=class extends C.JT{get name(){return(0,A.cW)(this.entry).name}get hasCommand(){return typeof this.entry?.command<"u"}constructor(e,t,i,o,n,r,s){super(),this.container=e,this.hoverDelegate=i,this.commandService=o,this.notificationService=n,this.telemetryService=r,this.themeService=s,this.entry=void 0,this.foregroundListener=this._register(new C.XK),this.backgroundListener=this._register(new C.XK),this.commandMouseListener=this._register(new C.XK),this.commandTouchListener=this._register(new C.XK),this.commandKeyboardListener=this._register(new C.XK),this.hover=void 0,this.labelContainer=document.createElement("a"),this.labelContainer.tabIndex=-1,this.labelContainer.setAttribute("role","button"),this.labelContainer.className="statusbar-item-label",this._register(ae.o.addTarget(this.labelContainer)),this.label=new Mh(this.labelContainer),this.container.appendChild(this.labelContainer),this.beakContainer=document.createElement("div"),this.beakContainer.className="status-bar-item-beak-container",this.container.appendChild(this.beakContainer),this.update(t)}update(e){if(this.label.showProgress=e.showProgress??!1,(!this.entry||e.text!==this.entry.text)&&(this.label.text=e.text,e.text?(0,g.$Z)(this.labelContainer):(0,g.Cp)(this.labelContainer)),(!this.entry||e.ariaLabel!==this.entry.ariaLabel)&&(this.container.setAttribute("aria-label",e.ariaLabel),this.labelContainer.setAttribute("aria-label",e.ariaLabel)),(!this.entry||e.role!==this.entry.role)&&this.labelContainer.setAttribute("role",e.role||"button"),!this.entry||!this.isEqualTooltip(this.entry,e)){const t=(0,li.Fr)(e.tooltip)?{markdown:e.tooltip,markdownNotSupportedFallback:void 0}:e.tooltip;this.hover?this.hover.update(t):this.hover=this._register((0,Vh.g)(this.hoverDelegate,this.container,t))}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear(),this.commandTouchListener.clear(),this.commandKeyboardListener.clear();const t=e.command;t&&(t!==Ze.bB||this.hover)?(this.commandMouseListener.value=(0,g.nm)(this.labelContainer,g.tw.CLICK,()=>this.executeCommand(t)),this.commandTouchListener.value=(0,g.nm)(this.labelContainer,ae.t.Tap,()=>this.executeCommand(t)),this.commandKeyboardListener.value=(0,g.nm)(this.labelContainer,g.tw.KEY_DOWN,i=>{const o=new dt.y1(i);(o.equals(10)||o.equals(3))&&(g.zB.stop(i),this.executeCommand(t))}),this.labelContainer.classList.remove("disabled")):this.labelContainer.classList.add("disabled")}(!this.entry||e.showBeak!==this.entry.showBeak)&&(e.showBeak?this.container.classList.add("has-beak"):this.container.classList.remove("has-beak")),(!this.entry||e.color!==this.entry.color)&&this.applyColor(this.labelContainer,e.color),(!this.entry||e.backgroundColor!==this.entry.backgroundColor)&&(this.container.classList.toggle("has-background-color",!!e.backgroundColor),this.applyColor(this.container,e.backgroundColor,!0)),this.entry=e}isEqualTooltip({tooltip:e},{tooltip:t}){return void 0===e?void 0===t:(0,li.Fr)(e)?(0,li.Fr)(t)&&(0,li.g_)(e,t):e===t}executeCommand(e){var t=this;return(0,w.Z)(function*(){if(e===Ze.bB)t.hover?.show(!0);else{const i="string"==typeof e?e:e.id,o="string"==typeof e?[]:e.arguments??[];t.telemetryService.publicLog2("workbenchActionExecuted",{id:i,from:"status bar"});try{yield t.commandService.executeCommand(i,...o)}catch(n){t.notificationService.error((0,Zi.yJ)(n))}}})()}applyColor(e,t,i){let o;if(i?this.backgroundListener.clear():this.foregroundListener.clear(),t)if((0,Th.I)(t)){o=this.themeService.getColorTheme().getColor(t.id)?.toString();const n=this.themeService.onDidColorThemeChange(r=>{const s=r.getColor(t.id)?.toString();i?e.style.backgroundColor=s??"":e.style.color=s??""});i?this.backgroundListener.value=n:this.foregroundListener.value=n}else o=t;i?e.style.backgroundColor=o??"":e.style.color=o??""}};Fr=(0,h.gn)([(0,h.fM)(3,Z.H),(0,h.fM)(4,oe.lT),(0,h.fM)(5,Ue.bU),(0,h.fM)(6,K.XE)],Fr);class Mh extends _h.C{constructor(e){super(e),this.container=e,this.progressCodicon=(0,Br.h)(he.cW),this.currentText="",this.currentShowProgress=!1}set showProgress(e){this.currentShowProgress!==e&&(this.currentShowProgress=e,this.progressCodicon=(0,Br.h)("loading"===e?he.Tk:he.cW),this.text=this.currentText)}set text(e){if(this.currentShowProgress){this.container.firstChild!==this.progressCodicon&&this.container.appendChild(this.progressCodicon);for(const i of Array.from(this.container.childNodes))i!==this.progressCodicon&&i.remove();let t=e??"";t&&(t=` ${t}`),(0,g.R3)(this.container,...(0,Br.T)(t))}else super.text=e}}let Wr=class extends yo{constructor(e,t,i,o,n,r,s,a,d){super("workbench.parts.statusbar",{hasTitle:!1},t,o,n),this.instantiationService=e,this.contextService=i,this.storageService=o,this.contextMenuService=r,this.contextKeyService=s,this.hoverService=a,this.configurationService=d,this.minimumWidth=0,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=22,this.maximumHeight=22,this.pendingEntries=[],this.viewModel=this._register(new Ah(this.storageService)),this.onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility,this.hoverDelegate=new class{get delay(){return Date.now()-this.lastHoverHideTime<200?0:this.configurationService.getValue("workbench.hover.delay")}constructor(l,u){this.configurationService=l,this.hoverService=u,this.lastHoverHideTime=0,this.placement="element"}showHover(l,u){return this.hoverService.showHover({...l,hideOnKeyDown:!0},u)}onDidHideHover(){this.lastHoverHideTime=Date.now()}}(this.configurationService,this.hoverService),this.compactEntriesDisposable=this._register(new C.XK),this.styleOverrides=new Set,this.registerListeners()}registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}addEntry(e,t,i,o=0){let n;return n=(0,Ze.Qj)(o)?o:{primary:o,secondary:(0,di.vp)(t)},this.element?this.doAddEntry(e,t,i,n):this.doAddPendingEntry(e,t,i,n)}doAddPendingEntry(e,t,i,o){const n={entry:e,id:t,alignment:i,priority:o};return this.pendingEntries.push(n),{update:s=>{n.accessor?n.accessor.update(s):n.entry=s},dispose:()=>{n.accessor?n.accessor.dispose():this.pendingEntries=this.pendingEntries.filter(s=>s!==n)}}}doAddEntry(e,t,i,o){const n=this.doCreateStatusItem(t,i,...(0,L.kX)([e.showBeak?"has-beak":void 0])),r=this.instantiationService.createInstance(Fr,n,e,this.hoverDelegate),s=new class{constructor(){this.id=t,this.alignment=i,this.priority=o,this.container=n,this.labelContainer=r.labelContainer}get name(){return r.name}get hasCommand(){return r.hasCommand}},{needsFullRefresh:a}=this.doAddOrRemoveModelEntry(s,!0);return a?this.appendStatusbarEntries():this.appendStatusbarEntry(s),{update:d=>{r.update(d)},dispose:()=>{const{needsFullRefresh:d}=this.doAddOrRemoveModelEntry(s,!1);d?this.appendStatusbarEntries():n.remove(),(0,C.B9)(r)}}}doCreateStatusItem(e,t,...i){const o=document.createElement("div");return o.id=e,o.classList.add("statusbar-item"),i&&o.classList.add(...i),o.classList.add(1===t?"right":"left"),o}doAddOrRemoveModelEntry(e,t){const i=this.viewModel.entries;t?this.viewModel.add(e):this.viewModel.remove(e);const o=this.viewModel.entries;return t?i.splice(o.indexOf(e),0,e):i.splice(i.indexOf(e),1),{needsFullRefresh:!(0,L.fS)(i,o)}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,t){t?this.viewModel.show(e):this.viewModel.hide(e)}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=!0){this.getContainer()?.focus();const t=this.viewModel.lastFocusedEntry;e&&t&&setTimeout(()=>t.labelContainer.focus(),0)}createContentArea(e){this.element=e;const t=this.contextKeyService.createScoped(this.element);return N.RP.bindTo(t).set(!0),this.leftItemsContainer=document.createElement("div"),this.leftItemsContainer.classList.add("left-items","items-container"),this.element.appendChild(this.leftItemsContainer),this.element.tabIndex=0,this.rightItemsContainer=document.createElement("div"),this.rightItemsContainer.classList.add("right-items","items-container"),this.element.appendChild(this.rightItemsContainer),this._register((0,g.nm)(e,g.tw.CONTEXT_MENU,i=>this.showContextMenu(i))),this._register(ae.o.addTarget(e)),this._register((0,g.nm)(e,ae.t.Contextmenu,i=>this.showContextMenu(i))),this.createInitialStatusbarEntries(),this.element}createInitialStatusbarEntries(){for(this.appendStatusbarEntries();this.pendingEntries.length;){const e=this.pendingEntries.shift();e&&(e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary))}}appendStatusbarEntries(){const e=(0,A.cW)(this.leftItemsContainer),t=(0,A.cW)(this.rightItemsContainer);(0,g.PO)(e),(0,g.PO)(t);for(const i of[...this.viewModel.getEntries(0),...this.viewModel.getEntries(1).reverse()])(0===i.alignment?e:t).appendChild(i.container);this.updateCompactEntries()}appendStatusbarEntry(e){const t=this.viewModel.getEntries(e.alignment);1===e.alignment&&t.reverse();const i=(0,A.cW)(0===e.alignment?this.leftItemsContainer:this.rightItemsContainer),o=t.indexOf(e);o+1===t.length?i.appendChild(e.container):i.insertBefore(e.container,t[o+1].container),this.updateCompactEntries()}updateCompactEntries(){const e=this.viewModel.entries,t=new Map;for(const r of e)this.viewModel.isHidden(r.id)||t.set(r.id,r),r.container.classList.remove("compact-left","compact-right");const i=new Map;for(const r of t.values())if((0,Ze.iV)(r.priority.primary)&&r.priority.primary.compact){const s=r.priority.primary.id,a=t.get(s);if(!a)continue;let d=i.get(s);d?d.add(r):(d=new Set([r,a]),i.set(s,d)),0===r.priority.primary.alignment?(a.container.classList.add("compact-left"),r.container.classList.add("compact-right")):(a.container.classList.add("compact-right"),r.container.classList.add("compact-left"))}const o=this.getColor(I.b$),n=this.getColor(I.YR);if(this.compactEntriesDisposable.value=new C.SL,o&&n&&!(0,Ki.c3)(this.theme.type))for(const[,r]of i)for(const s of r)s.hasCommand&&(this.compactEntriesDisposable.value.add((0,g.nm)(s.labelContainer,g.tw.MOUSE_OVER,()=>{r.forEach(a=>a.labelContainer.style.backgroundColor=o),s.labelContainer.style.backgroundColor=n})),this.compactEntriesDisposable.value.add((0,g.nm)(s.labelContainer,g.tw.MOUSE_OUT,()=>{r.forEach(a=>a.labelContainer.style.backgroundColor="")})))}showContextMenu(e){g.zB.stop(e,!0);const t=new ct.nV(e);let i;this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>(i=this.getContextMenuActions(t),i),onHide:()=>{i&&(0,C.ex)(i)}})}getContextMenuActions(e){const t=[];t.push((0,P.xw)({id:ci.FY.ID,label:(0,p.NC)("hideStatusBar","Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(n=>(new ci.FY).run(n))})),t.push(new P.Z0);const i=new Set;for(const n of this.viewModel.entries)i.has(n.id)||(t.push(new kh(n.id,n.name,this.viewModel)),i.add(n.id));let o;for(let n=e.target;n;n=n.parentElement){const r=this.viewModel.findEntry(n);if(r){o=r;break}}return o&&(t.push(new P.Z0),t.push(new Dh(o.id,o.name,this.viewModel))),t}updateStyles(){super.updateStyles();const e=(0,A.cW)(this.getContainer()),t=[...this.styleOverrides].sort((a,d)=>a.priority-d.priority)[0],i=this.getColor(t?.background??(1!==this.contextService.getWorkbenchState()?I.$B:I.$))||"";e.style.backgroundColor=i;const o=this.getColor(t?.foreground??(1!==this.contextService.getWorkbenchState()?I.he:I.w0))||"";e.style.color=o;const n=this.getColor(I.pb),r=this.getColor(t?.border??(1!==this.contextService.getWorkbenchState()?I.g4:I.fE))||this.getColor(Y.lRK);r?(e.classList.add("status-border-top"),e.style.setProperty("--status-border-top-color",r)):(e.classList.remove("status-border-top"),e.style.removeProperty("--status-border-top-color"));const s=this.getColor(I.cf);this.styleElement||(this.styleElement=(0,g.dS)(e)),this.styleElement.textContent=`\n\n\t\t\t\t/* Status bar focus outline */\n\t\t\t\t.monaco-workbench .part.statusbar:focus {\n\t\t\t\t\toutline-color: ${s};\n\t\t\t\t}\n\n\t\t\t\t/* Status bar item focus outline */\n\t\t\t\t.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible:not(.disabled) {\n\t\t\t\t\toutline: 1px solid ${this.getColor(Y.xL1)??n};\n\t\t\t\t\toutline-offset: ${r?"-2px":"-1px"};\n\t\t\t\t}\n\n\t\t\t\t/* Notification Beak */\n\t\t\t\t.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {\n\t\t\t\t\tborder-bottom-color: ${i};\n\t\t\t\t}\n\t\t\t`}layout(e,t,i,o){super.layout(e,t,i,o),super.layoutContents(e,t)}overrideStyle(e){return this.styleOverrides.add(e),this.updateStyles(),(0,C.OF)(()=>{this.styleOverrides.delete(e),this.updateStyles()})}toJSON(){return{type:"workbench.parts.statusbar"}}};Wr=(0,h.gn)([(0,h.fM)(0,R.TG),(0,h.fM)(1,K.XE),(0,h.fM)(2,ce.ec),(0,h.fM)(3,Ie.Uy),(0,h.fM)(4,et.z),(0,h.fM)(5,ge.i),(0,h.fM)(6,y.i6),(0,h.fM)(7,tt.B),(0,h.fM)(8,G.Ui)],Wr);var Fa=m(54824),Ph=m(95126),Wa=m(59699),Lh=m(33028);let ii=class Ft extends C.JT{constructor(e,t,i,o,n,r,s,a,d,l){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=o,this.configurationService=n,this.fileService=r,this.workspacesService=s,this.instantiationService=a,this.layoutService=d,this.contextKeyService=l,this.activeEditorListeners=this._register(new C.SL),this.lastActiveEditor=void 0,this.editorHelper=this.instantiationService.createInstance(on),this.canNavigateBackContextKey=new y.uy("canNavigateBack",!1,(0,p.NC)("canNavigateBack","Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new y.uy("canNavigateForward",!1,(0,p.NC)("canNavigateForward","Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new y.uy("canNavigateBackInNavigationLocations",!1,(0,p.NC)("canNavigateBackInNavigationLocations","Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new y.uy("canNavigateForwardInNavigationLocations",!1,(0,p.NC)("canNavigateForwardInNavigationLocations","Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new y.uy("canNavigateToLastNavigationLocation",!1,(0,p.NC)("canNavigateToLastNavigationLocation","Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new y.uy("canNavigateBackInEditLocations",!1,(0,p.NC)("canNavigateBackInEditLocations","Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new y.uy("canNavigateForwardInEditLocations",!1,(0,p.NC)("canNavigateForwardInEditLocations","Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new y.uy("canNavigateToLastEditLocation",!1,(0,p.NC)("canNavigateToLastEditLocation","Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new y.uy("canReopenClosedEditor",!1,(0,p.NC)("canReopenClosedEditor","Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this._onDidChangeEditorNavigationStack=this._register(new S.Q5),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=0,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=new Map,this.resourceExcludeMatcher=this._register(new Ve.Ue(()=>{const u=this._register(this.instantiationService.createInstance(Lh.Q,f=>(0,Wa.$C)(f?this.configurationService.getValue({resource:f}):this.configurationService.getValue())||Object.create(null),f=>f.affectsConfiguration(z.Au)||f.affectsConfiguration(Wa.XG)));return this._register(u.onExpressionChange(()=>this.removeExcludedFromHistory())),u})),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){const e=this._register(new C.SL),t=()=>{e.clear(),this.configurationService.getValue(Ft.MOUSE_NAVIGATION_SETTING)&&(e.add((0,g.nm)(this.layoutService.container,g.tw.MOUSE_DOWN,i=>this.onMouseDownOrUp(i,!0))),e.add((0,g.nm)(this.layoutService.container,g.tw.MOUSE_UP,i=>this.onMouseDownOrUp(i,!1))))};this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(Ft.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:g.zB.stop(e),t&&this.goBack();break;case 4:g.zB.stop(e),t&&this.goForward()}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){const e=this.editorGroupService.activeGroup,t=e.activeEditorPane;this.lastActiveEditor&&this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t)||(this.lastActiveEditor=t?.input&&t.group?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),this.handleActiveEditorChange(e,t),(0,x.fE)(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>this.handleActiveEditorSelectionChangeEvent(e,t,i))),this.updateContextKeys())}onDidFilesChange(e){e instanceof z.G9?e.gotDeleted()&&this.remove(e):e.isOperation(1)?this.remove(e):e.isOperation(2)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;(0,x.Xl)(e)?t=x.zK.getOriginalUri(e):e instanceof z.G9||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{const e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(0)),this.canNavigateForwardContextKey.set(e.canGoForward(0)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(2)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(2)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(2)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(1)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(1)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(1)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){const e=()=>{this.disposeEditorNavigationStacks();const t=this.configurationService.getValue(Ft.NAVIGATION_SCOPE_SETTING);this.editorNavigationScope="editorGroup"===t?1:"editor"===t?2:0};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ft.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(e=this.editorGroupService.activeGroup,t=e.activeEditor){switch(this.editorNavigationScope){case 2:{if(!t)return new Rh;let i=this.editorScopedNavigationStacks.get(e.id);i||(i=new Map,this.editorScopedNavigationStacks.set(e.id,i));let o=i.get(t)?.stack;if(!o){const n=new C.SL;o=n.add(this.instantiationService.createInstance(fo,2)),n.add(o.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),i.set(t,{stack:o,disposable:n})}return o}case 1:{let i=this.editorGroupScopedNavigationStacks.get(e.id)?.stack;if(!i){const o=new C.SL;i=o.add(this.instantiationService.createInstance(fo,1)),o.add(i.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:i,disposable:o})}return i}case 0:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance(fo,0)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,t?.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){const t=this.editorScopedNavigationStacks.get(e.groupId);if(t){const i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),0===t.size&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){this.defaultScopedEditorNavigationStack?.remove(e.id);const t=this.editorGroupScopedNavigationStacks.get(e.id);t&&(t.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(const[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){this.defaultScopedEditorNavigationStack?.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(const[,e]of this.editorGroupScopedNavigationStacks)e.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(const[,e]of this.editorScopedNavigationStacks)for(const[,t]of e)t.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}doNavigateInRecentlyUsedEditorsStack(e,t){var i=this;return(0,w.Z)(function*(){if(e){const o="number"!=typeof t||!i.editorGroupService.getGroup(t);o?i.navigatingInRecentlyUsedEditorsStack=!0:i.navigatingInRecentlyUsedEditorsInGroupStack=!0;const n=i.editorGroupService.getGroup(e.groupId)??i.editorGroupService.activeGroup;try{yield n.openEditor(e.editor)}finally{o?i.navigatingInRecentlyUsedEditorsStack=!1:i.navigatingInRecentlyUsedEditorsInGroupStack=!1}}})()}ensureRecentlyUsedStack(e,t){let i,o;const n="number"==typeof t?this.editorGroupService.getGroup(t):void 0;n?(i=this.recentlyUsedEditorsInGroupStack||n.getEditors(0).map(s=>({groupId:n.id,editor:s})),o=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(0),o=this.recentlyUsedEditorsStackIndex);let r=e(o);return r<0?r=0:r>i.length-1&&(r=i.length-1),n?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=r):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=r),[i,r]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;const{editor:t,context:i}=e;if(i===x.Bb.REPLACE||i===x.Bb.MOVE)return;const o=t.toUntyped();if(!o)return;const n=[],r=x.zK.getOriginalUri(t,{supportSideBySide:x.YX.BOTH});W.ov.isUri(r)?n.push(r):r&&n.push(...(0,L.kX)([r.primary,r.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:o,resource:x.zK.getOriginalUri(t),associatedResources:n,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Ft.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}reopenLastClosedEditor(){var e=this;return(0,w.Z)(function*(){const t=e.recentlyClosedEditors.pop();let i;return t&&(i=e.doReopenLastClosedEditor(t)),e.canReopenClosedEditorContextKey.set(e.recentlyClosedEditors.length>0),i})()}doReopenLastClosedEditor(e){var t=this;return(0,w.Z)(function*(){const i={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};let o;if((e.sticky&&!t.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&t.editorGroupService.activeGroup.isSticky(e.index))&&(i.index=void 0),!t.editorGroupService.activeGroup.contains(e.editor)){t.ignoreEditorCloseEvent=!0;try{o=yield t.editorService.openEditor({...e.editor,options:{...e.editor.options,...i}})}finally{t.ignoreEditorCloseEvent=!1}}o||((0,L.Od)(t.recentlyClosedEditors,e),t.reopenLastClosedEditor())})()}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>!(!(0,x.Xl)(e)||t.editorId===e.editorId)||!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(i=>this.editorHelper.matchesFile(i,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){const t=e?.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e,t=!0){this.ensureHistoryLoaded(this.history);const i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Ft.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),(0,x.Xl)(i)&&this.editorHelper.onEditorDispose(i,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if((0,x.G$)(e)){const t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(const o of i){const n=this.editorHelper.preferResourceEditorInput(o);(0,x.BR)(n)&&t.push(n)}this.replaceInHistory(e,...t)}else this.removeFromHistory(e)}includeInHistory(e){return!!(0,x.Xl)(e)||!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{const t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(2)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{const o=this.editorHelper.matchesEditor(e,i);return o&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!o}),t}replaceInHistory(e,...t){this.ensureHistoryLoaded(this.history);let i=!1;const o=[];for(const n of this.history)this.editorHelper.matchesEditor(e,n)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),i||(o.push(...t),i=!0)):t.some(r=>this.editorHelper.matchesEditor(r,n))||o.push(n);i||o.push(...t),this.history=o}clearRecentlyOpened(){this.history=[];for(const[,e]of this.editorHistoryListeners)(0,C.B9)(e);this.editorHistoryListeners.clear()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){var t=this;this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(0,w.Z)(function*(){yield t.editorGroupService.whenReady,t.loadHistory()})())}loadHistory(){this.history=[];const e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(0)].reverse(),i=new Set;for(const{editor:o}of t)this.includeInHistory(o)&&(this.addToHistory(o),o.resource&&i.add(`${o.resource.toString()}/${o.editorId}`));for(const o of e)i.has(`${o.resource.toString()}/${o.options?.override}`)||this.addToHistory(o,!1)}loadHistoryFromStorage(){const e=[],t=this.storageService.get(Ft.HISTORY_STORAGE_KEY,1);if(t)try{const i=JSON.parse(t);for(const o of i)if(o.editor&&o.editor.resource)try{e.push({...o.editor,resource:"string"==typeof o.editor.resource?W.ov.parse(o.editor.resource):W.ov.from(o.editor.resource)})}catch(n){(0,Xe.dL)(n)}}catch(i){(0,Xe.dL)(i)}return e}saveState(){if(!this.history)return;const e=[];for(const t of this.history)(0,x.Xl)(t)||!(0,x.BR)(t)||e.push({editor:{...t,resource:t.resource.toString()}});this.storageService.store(Ft.HISTORY_STORAGE_KEY,JSON.stringify(e),1,1)}getLastActiveWorkspaceRoot(e){const t=this.contextService.getWorkspace().folders;if(0!==t.length){if(1===t.length){const i=t[0].uri;return e&&i.scheme!==e?void 0:i}for(const i of this.getHistory()){if((0,x.Xl)(i)||e&&i.resource.scheme!==e)continue;const o=this.contextService.getWorkspaceFolder(i.resource);if(o)return o.uri}for(const i of t){const o=i.uri;if(!e||o.scheme===e)return o}}}getLastActiveFile(e){for(const t of this.getHistory()){let i;if(i=(0,x.Xl)(t)?x.zK.getOriginalUri(t,{filterByScheme:e}):t.resource,i?.scheme===e)return i}}};ii.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate",ii.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope",ii.MAX_RECENTLY_CLOSED_EDITORS=20,ii.MAX_HISTORY_ITEMS=200,ii.HISTORY_STORAGE_KEY="history.entries",ii=(0,h.gn)([(0,h.fM)(0,U.AR),(0,h.fM)(1,te.Qw),(0,h.fM)(2,ce.ec),(0,h.fM)(3,Ie.Uy),(0,h.fM)(4,G.Ui),(0,h.fM)(5,z.sn),(0,h.fM)(6,Ct.Dc),(0,h.fM)(7,R.TG),(0,h.fM)(8,et.z),(0,h.fM)(9,y.i6)],ii);class Ga{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;const t=this.selection.compare(e.selection);return 2===t&&(4===e.reason||5===e.reason)||3===t}}let fo=class extends C.JT{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(Ri,0,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(Ri,1,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(Ri,2,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=S.ju.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(e=0){switch(e){case 0:return this.selectionsStack;case 1:return this.editsStack;case 2:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){const i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),3===t.reason?this.editsStack.notifyNavigation(e,t):(4===t.reason||5===t.reason)&&!this.selectionsStack.isNavigating()&&(5===t.reason&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(const e of this.stacks)e.clear()}remove(e){for(const t of this.stacks)t.remove(e)}move(e){for(const t of this.stacks)t.move(e)}};fo=(0,h.gn)([(0,h.fM)(1,R.TG)],fo);class Rh{constructor(){this.onDidChange=S.ju.None}canGoForward(){return!1}goForward(){return(0,w.Z)(function*(){})()}canGoBack(){return!1}goBack(){return(0,w.Z)(function*(){})()}goPrevious(){return(0,w.Z)(function*(){})()}canGoLast(){return!1}goLast(){return(0,w.Z)(function*(){})()}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}}let Ri=class ec extends C.JT{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,o,n,r){super(),this.filter=e,this.scope=t,this.instantiationService=i,this.editorService=o,this.editorGroupService=n,this.logService=r,this._onDidChange=this._register(new S.Q5),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=new Map,this.mapGroupToDisposable=new Map,this.editorHelper=this.instantiationService.createInstance(on),this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack()))}traceStack(){if(this.logService.getLevel()!==Ae.in.Trace)return;const e=[];for(const t of this.stack)e.push("function"==typeof t.selection?.log?`- group: ${t.groupId}, editor: ${t.editor.resource?.toString()}, selection: ${t.selection.log()}`:`- group: ${t.groupId}, editor: ${t.editor.resource?.toString()}, selection: <none>`);this.trace(0===e.length?`index: ${this.index}, navigating: ${this.isNavigating()}: <empty>`:`index: ${this.index}, navigating: ${this.isNavigating()}\n${e.join("\n")}\n\t\t\t`)}trace(e,t=null,i){if(this.logService.getLevel()!==Ae.in.Trace)return;let o,n;switch(this.filter){case 0:o="global";break;case 1:o="edits";break;case 2:o="navigation"}switch(this.scope){case 0:n="default";break;case 1:n="editorGroup";break;case 2:n="editor"}this.logService.trace(null!==t?`[History stack ${o}-${n}]: ${e} (editor: ${t?.resource?.toString()}, event: ${this.traceEvent(i)})`:`[History stack ${o}-${n}]: ${e}`)}traceEvent(e){if(!e)return"<none>";switch(e.reason){case 3:return"edit";case 4:return"navigation";case 5:return"jump";case 1:return"programmatic";case 2:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){const t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(i=>this.onWillMoveEditor(i)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),1!==this.scope)for(const t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",e?.input,t);const i=(0,x.fE)(e),o=e?.group&&e.input&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",e?.input,t),i&&o?(this.trace("notifyNavigation() updating current selection state",e?.input,t),this.currentSelectionState=new Ga({groupId:e.group.id,editor:e.input},e.getSelection(),t?.reason)):(this.trace("notifyNavigation() dropping current selection state",e?.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",e?.input,t),i&&o?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,o&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,o){if(this.current?.groupId===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,o);const n=new Ga({groupId:e,editor:t},i,o?.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(n)?this.doAdd(e,t,n.selection):this.doReplace(e,t,n.selection),this.currentSelectionState=n}onNonSelectionAwareEditorNavigation(e,t){this.current?.groupId===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,o){this.registerGroupListeners(e);let n=!1;this.current&&(o||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(n=!0);const r=this.editorHelper.preferResourceEditorInput(t);if(!r)return;this.trace(n?"replace()":"add()",r);const s={groupId:e,editor:r,selection:i},a=[];if(n)this.current&&a.push(this.current),this.current=s;else{if(this.stack.length>this.index+1){for(let d=this.index+1;d<this.stack.length;d++)a.push(this.stack[d]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,s),this.stack.length>ec.MAX_STACK_SIZE?(a.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(const d of a)this.editorHelper.clearOnEditorDispose(d.editor,this.mapEditorToDisposable);(0,x.Xl)(r)&&this.editorHelper.onEditorDispose(r,()=>this.remove(r),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return!(e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor)||e.selection&&(!t.selection||1!==e.selection.compare(t.selection)))}move(e){if(e.isOperation(2))for(const t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){this.stack=this.stack.filter(t=>{const i="number"==typeof e?t.groupId===e:this.editorHelper.matchesEditor(e,t.editor);return i&&this.editorHelper.clearOnEditorDispose(t.editor,this.mapEditorToDisposable),!i}),this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,"number"==typeof e&&(this.mapGroupToDisposable.get(e)?.dispose(),this.mapGroupToDisposable.delete(e)),this._onDidChange.fire()}flatten(){const e=[];let t;for(const i of this.stack)t&&this.shouldReplaceStackEntry(i,t)||(t=i,e.push(i));this.stack=e}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0);for(const[,e]of this.mapEditorToDisposable)(0,C.B9)(e);this.mapEditorToDisposable.clear();for(const[,e]of this.mapGroupToDisposable)(0,C.B9)(e);this.mapGroupToDisposable.clear()}dispose(){super.dispose(),this.clear()}canGoForward(){return this.stack.length>this.index+1}goForward(){var e=this;return(0,w.Z)(function*(){if(!(yield e.maybeGoCurrent())&&e.canGoForward())return e.setIndex(e.index+1),e.navigate()})()}canGoBack(){return this.index>0}goBack(){var e=this;return(0,w.Z)(function*(){if(!(yield e.maybeGoCurrent())&&e.canGoBack())return e.setIndex(e.index-1),e.navigate()})()}goPrevious(){var e=this;return(0,w.Z)(function*(){if(!(yield e.maybeGoCurrent()))return-1===e.previousIndex?e.goBack():(e.setIndex(e.previousIndex),e.navigate())})()}canGoLast(){return this.stack.length>0}goLast(){var e=this;return(0,w.Z)(function*(){if(e.canGoLast())return e.setIndex(e.stack.length-1),e.navigate()})()}maybeGoCurrent(){var e=this;return(0,w.Z)(function*(){return 0!==e.filter&&!e.isCurrentSelectionActive()&&(yield e.navigate(),!0)})()}isCurrentSelectionActive(){if(!this.current?.selection)return!1;const e=this.editorService.activeEditorPane;if(!(0,x.fE)(e)||e.group?.id!==this.current.groupId||!e.input||!this.editorHelper.matchesEditor(e.input,this.current.editor))return!1;const t=e.getSelection();return!!t&&1===t.compare(this.current.selection)}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}navigate(){var e=this;return(0,w.Z)(function*(){e.navigating=!0;try{e.current&&(yield e.doNavigate(e.current))}finally{e.navigating=!1}})()}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),(0,x.Xl)(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}},e.groupId)}isNavigating(){return this.navigating}};Ri.MAX_STACK_SIZE=50,Ri=(0,h.gn)([(0,h.fM)(2,R.TG),(0,h.fM)(3,U.AR),(0,h.fM)(4,te.Qw),(0,h.fM)(5,Ae.VZ)],Ri);let on=class{constructor(e,t,i,o){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=o}preferResourceEditorInput(e){const t=x.zK.getOriginalUri(e);if(t?.scheme===Me.lg.file||t?.scheme===Me.lg.vscodeRemote||t?.scheme===Me.lg.vscodeUserData||t?.scheme===this.pathService.defaultUriScheme){if((0,x.Xl)(e)){const o=e.toUntyped();if((0,x.BR)(o))return o}return e}return(0,x.Xl)(e)?e:void 0}matchesEditor(e,t){return e instanceof z.G9||e instanceof z.Zk?!(0,x.Xl)(t)&&(e instanceof z.G9?e.contains(t.resource,2):this.matchesFile(t.resource,e)):(0,x.Xl)(e)?(0,x.Xl)(t)?e.matches(t):this.matchesFile(t.resource,e):(0,x.Xl)(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof z.G9)return t.contains(e,2);if(t instanceof z.Zk)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if((0,x.Xl)(t)){const i=t.resource;return!(!i||this.lifecycleService.phase>=3&&!this.fileService.hasProvider(i))&&this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(t?.resource,e)}matchesEditorIdentifier(e,t){return!(!t?.group||e.groupId!==t.group.id)&&!!t.input&&e.editor.matches(t.input)}onEditorDispose(e,t,i){const o=S.ju.once(e.onWillDispose)(()=>t());let n=i.get(e);n||(n=new C.SL,i.set(e,n)),n.add(o)}clearOnEditorDispose(e,t){if(!(0,x.Xl)(e))return;const i=t.get(e);i&&((0,C.B9)(i),t.delete(e))}};on=(0,h.gn)([(0,h.fM)(0,$i.v),(0,h.fM)(1,Tn.g),(0,h.fM)(2,z.sn),(0,h.fM)(3,Os.a)],on);var Nh=m(50944),Oh=m(38050);const nn=new Map,Gr=new Map;class Hh{constructor(){this.onDidPaneCompositeOpen=S.ju.None,this.onDidPaneCompositeClose=S.ju.None}openPaneComposite(e,t,i){var o=this;return(0,w.Z)(function*(){return o.getPartByLocation(t)?.openPaneComposite(e,i)})()}getActivePaneComposite(e){return this.getPartByLocation(e)?.getActivePaneComposite()}getPaneComposite(e,t){return this.getPartByLocation(t)?.getPaneComposite(e)}getPaneComposites(e){return this.getPartByLocation(e)?.getPaneComposites()??[]}getPinnedPaneCompositeIds(e){return this.getSelectorPartByLocation(e)?.getPinnedPaneCompositeIds()??[]}getVisiblePaneCompositeIds(e){return this.getSelectorPartByLocation(e)?.getVisiblePaneCompositeIds()??[]}getProgressIndicator(e,t){return this.getPartByLocation(t)?.getProgressIndicator(e)}hideActivePaneComposite(e){this.getPartByLocation(e)?.hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}showActivity(e,t,i,o,n){return this.getSelectorPartByLocation(t).showActivity(e,i,o,n)}getPartByLocation(e){return nn.get(e)}getSelectorPartByLocation(e){return Gr.get(e)}}function mo(c,e,t){const i=document.createElement("div");function o(){c.layout(Math.max(c.minimumWidth,Math.min(c.maximumWidth,e.offsetWidth)),Math.max(c.minimumHeight,Math.min(c.maximumHeight,e.offsetHeight)),0,0)}e.append(i),i.classList.add(...t),i.oncontextmenu=()=>!1,c.create(i),c.onDidVisibilityChange(r=>{r&&o()}),o();const n=new ResizeObserver(o);return n.observe(e),{dispose:()=>n.disconnect()}}function Bh(c){const e=Wt.IO.get(R.TG).createInstance(Lt,nn.get(0));return Gr.set(0,e),e._register(mo(e,c,["part","activitybar","left"])),e}function Fh(c){const e=Wt.IO.get(R.TG).createInstance(So);return nn.set(0,e),e._register(mo(e,c,["part","sidebar","left"])),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function Wh(c){const e=Wt.IO.get(R.TG).createInstance(Vo);return Gr.set(1,e),nn.set(1,e),e._register(mo(e,c,["part","panel","basepanel"])),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function Gh(c){return mo(Wt.IO.get(te.Qw),c,["part","editor"])}function zh(c){return mo(Wt.IO.get(Ze.iq),c,["part","statusbar"])}function Uh(c){const e=null!=c.icon?W.ov.parse(c.icon):void 0,t=me.B.as(O.IP.ViewContainersRegistry).registerViewContainer({id:c.id,title:c.name,order:c.order,ctorDescriptor:new ie.M(Ci.XV,[c.id,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,icon:e},c.location),i=[{id:c.id,name:c.name,canToggleVisibility:!1,ctorDescriptor:new ie.M(class extends Mo.qV{renderBody(n){super.renderBody(n),this.content=(0,g.$)(".view-pane-content"),this.content.style.display="flex",this.content.style.alignItems="stretch",(0,g.R3)(n,this.content),this._register(c.renderBody(this.content))}getActionViewItem(n,r){const s=(c.actions??[]).find(a=>a.id===n.id);return null!=s?.render?new class extends vr.YH{constructor(){super(null,n),this.render=s.render}}:super.getActionViewItem(n,r)}layoutBody(n,r){this.content.style.height=`${n}px`,this.content.style.width=`${r}px`}}),canMoveView:c.canMoveView??!0,containerIcon:e}];me.B.as(O.IP.ViewsRegistry).registerViews(i,t);const o=new C.SL;o.add({dispose(){me.B.as(O.IP.ViewsRegistry).deregisterViews(i,t),me.B.as(O.IP.ViewContainersRegistry).deregisterViewContainer(t)}});for(const n of c.actions??[])o.add((0,v.r1)(class extends v.Ke{constructor(){super({id:n.id,title:{value:n.title,original:n.title},category:Ee.R.View,menu:[{id:v.eH.ViewTitle,when:y.Ao.equals("view",c.id),group:"navigation",order:n.order},{id:v.eH.CommandPalette}],tooltip:n.tooltip,icon:null!=n.icon?$.lA[n.icon]:void 0}),this.run=n.run??(0,w.Z)(function*(){})}}));return o}let zr=class{constructor(e){this.editorPart=e}createEditorDropTarget(e,t){return this.editorPart.createEditorDropTarget(e,t)}};zr=(0,h.gn)([(0,h.fM)(0,te.Qw)],zr);let Ur=class extends Hr{constructor(e,t,i,o,n,r,s,a,d,l,u,f){super(t,i,o,n,r,s,a,d,l,u),this._editorGroupService=t,this.openEditor=(0,Nh.D)(f,this.openEditor.bind(this),e)}get activeTextEditorControl(){return super.activeTextEditorControl??Wt.IO.get(Ji.$).getFocusedCodeEditor()??void 0}openEditor(e,t,i){var o=()=>super.openEditor,n=this;return(0,w.Z)(function*(){if(n._editorGroupService.getContainer()?.isConnected)return o().call(n,e,t,i)})()}};function Kh(c){return{...(0,Oh.Z)(),[O.qC.toString()]:new ie.M(tc.h),[O.XH.toString()]:new ie.M(Oi),[yt.By.toString()]:new ie.M(pn),[si.c.toString()]:new ie.M(Hh),[tt.B.toString()]:new ie.M(Sn),[we.gE.toString()]:new ie.M(Nc.N),[xt.vu.toString()]:new ie.M(Mn),[Ji.$.toString()]:new ie.M(Eh.h),[tn.X.toString()]:new ie.M(tn.a),[te.Qw.toString()]:new ie.M(Xi),[Ze.iq.toString()]:new ie.M(Wr),[bh.toString()]:new ie.M(zr),[U.AR.toString()]:new ie.M(Ur,[c]),[le.es.toString()]:new ie.M(Li),[ye._4.toString()]:new ie.M(ye.dN),[ge.u.toString()]:new ie.M(Sh.g),[Ba.a.toString()]:new ie.M(Ba.e),[Fa.g.toString()]:new ie.M(Fa.R),[Ph.C.toString()]:new ie.M(ii)}}Ur=(0,h.gn)([(0,h.fM)(1,te.Qw),(0,h.fM)(2,R.TG),(0,h.fM)(3,z.sn),(0,h.fM)(4,G.Ui),(0,h.fM)(5,ce.ec),(0,h.fM)(6,$i.v),(0,h.fM)(7,le.es),(0,h.fM)(8,Kn.N2),(0,h.fM)(9,Do.$),(0,h.fM)(10,tn.X),(0,h.fM)(11,Gi.S)],Ur)}}]);