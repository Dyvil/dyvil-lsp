"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[216],{64216:(Ed,Gn,v)=>{v.r(Gn),v.d(Gn,{default:()=>dd}),v(87708);var me=v(21462),h=v(86390),b=v(58054),u=v(55885),Ze=v(33798),G=v(32243),de=v(13686),Q=v(26056),Ie=v(19409),fi=v(98179),Me=v(86810),R=v(13683),F=v(12997),we=v(94927),fe=v(69771),et=v(4699),Ve=v(54239),l=v(12829),ne=v(13141),Z=v(31719),A=v(76972),Qn=v(83929),bt=v(89295),U=v(17088),q=v(82344),Ne=v(51776),zt=v(79026),ke=v(18747),Te=v(39108),rr=v(35837),J=v(73059),De=v(16003),bi=v(49698),qn=v(36027),le=v(33562);let mi=class{constructor(e,t){this.breakpointContribution=e,this.contextKeyService=t,this.breakpointsWhen="string"==typeof e.when?A.Ao.deserialize(e.when):void 0}get language(){return this.breakpointContribution.language}get enabled(){return!this.breakpointsWhen||this.contextKeyService.contextMatchesRules(this.breakpointsWhen)}};mi=(0,u.gn)([(0,u.fM)(1,A.i6)],mi);var j=v(93358),Jn=v(49470),Xn=v(40411),ue=v(58535),ze=v(29175),se=v(23281),cr=v(55660),vi=v(9590);let Si=class{constructor(e,t,i,n,o,s,r,a,c){this.adapterManager=e,this.configurationService=n,this.resourcePropertiesService=o,this.configurationResolverService=s,this.environmentService=r,this.debugService=a,this.contextKeyService=c,this.mergedExtensionDescriptions=[],this.debuggerContribution={type:t.type},this.merge(t,i),this.debuggerWhen="string"==typeof this.debuggerContribution.when?A.Ao.deserialize(this.debuggerContribution.when):void 0}merge(e,t){this.mergedExtensionDescriptions.indexOf(t)<0&&(this.mergedExtensionDescriptions.push(t),function i(n,o,s,r=0){return(0,j.Kn)(n)?((0,j.Kn)(o)&&Object.keys(o).forEach(a=>{"__proto__"!==a&&((0,j.Kn)(n[a])&&(0,j.Kn)(o[a])?i(n[a],o[a],s,r+1):a in n?s&&(0===r&&"type"===a||(n[a]=o[a])):n[a]=o[a])}),n):o}(this.debuggerContribution,e,t.isBuiltin),(0,se.b3)(e)&&(this.mainExtensionDescription=t))}startDebugging(e,t){var i=this;return(0,b.Z)(function*(){const n=i.debugService.getModel().getSession(t);return yield i.debugService.startDebugging(void 0,e,{parentSession:n},void 0)})()}createDebugAdapter(e){var t=this;return(0,b.Z)(function*(){yield t.adapterManager.activateDebuggers("onDebugAdapterProtocolTracker",t.type);const i=t.adapterManager.createDebugAdapter(e);if(i)return Promise.resolve(i);throw new Error(l.NC("cannot.find.da","Cannot find debug adapter for type '{0}'.",t.type))})()}substituteVariables(e,t){var i=this;return(0,b.Z)(function*(){const n=yield i.adapterManager.substituteVariables(i.type,e,t);return yield i.configurationResolverService.resolveWithInteractionReplace(e,n,"launch",i.variables,n.__configurationTarget)})()}runInTerminal(e,t){return this.adapterManager.runInTerminal(this.type,e,t)}get label(){return this.debuggerContribution.label||this.debuggerContribution.type}get type(){return this.debuggerContribution.type}get variables(){return this.debuggerContribution.variables}get configurationSnippets(){return this.debuggerContribution.configurationSnippets}get languages(){return this.debuggerContribution.languages}get when(){return this.debuggerWhen}get enabled(){return!this.debuggerWhen||this.contextKeyService.contextMatchesRules(this.debuggerWhen)}get strings(){return this.debuggerContribution.strings??this.debuggerContribution.uiMessages}interestedInLanguage(e){return!!(this.languages&&this.languages.indexOf(e)>=0)}hasInitialConfiguration(){return!!this.debuggerContribution.initialConfigurations}hasConfigurationProvider(){return this.debugService.getConfigurationManager().hasDebugConfigurationProvider(this.type)}getInitialConfigurationContent(e){let t=this.debuggerContribution.initialConfigurations||[];e&&(t=t.concat(e));const i="\r\n"===this.resourcePropertiesService.getEOL(ue.ov.from({scheme:ze.lg.untitled,path:"1"}))?"\r\n":"\n",n=JSON.stringify(t,null,"\t").split("\n").map(g=>"\t"+g).join(i).trim();let a=["{",`\t// ${l.NC("launch.config.comment1","Use IntelliSense to learn about possible attributes.")}`,`\t// ${l.NC("launch.config.comment2","Hover to view descriptions of existing attributes.")}`,`\t// ${l.NC("launch.config.comment3","For more information, visit: {0}","https://go.microsoft.com/fwlink/?linkid=830387")}`,'\t"version": "0.2.0",',`\t"configurations": ${n}`,"}"].join(i);const c=this.configurationService.getValue();return c.editor&&c.editor.insertSpaces&&(a=a.replace(new RegExp("\t","g")," ".repeat(c.editor.tabSize))),Promise.resolve(a)}getMainExtensionDescriptor(){return this.mainExtensionDescription||this.mergedExtensionDescriptions[0]}getCustomTelemetryEndpoint(){const e=this.debuggerContribution.aiKey;if(!e)return;const t="other"!==(0,cr.x0)(this.environmentService.remoteAuthority);return{id:`${this.getMainExtensionDescriptor().publisher}.${this.type}`,aiKey:e,sendErrorTelemetry:t}}getSchemaAttributes(e){return this.debuggerContribution.configurationAttributes?Object.keys(this.debuggerContribution.configurationAttributes).map(t=>{const i=`${this.type}:${t}`,n=`${this.type}:${t}:platform`,o=this.debuggerContribution.configurationAttributes[t],s=["name","type","request"];o.required=o.required&&o.required.length?s.concat(o.required):s,o.additionalProperties=!1,o.type="object",o.properties||(o.properties={});const r=o.properties;r.type={enum:[this.type],enumDescriptions:[this.label],description:l.NC("debugType","Type of configuration."),pattern:"^(?!node2)",deprecationMessage:this.debuggerContribution.deprecated||(this.enabled?void 0:(0,h.RB)(this.type)),doNotSuggest:!!this.debuggerContribution.deprecated,errorMessage:l.NC("debugTypeNotRecognised","The debug type is not recognized. Make sure that you have a corresponding debug extension installed and that it is enabled."),patternErrorMessage:l.NC("node2NotSupported",'"node2" is no longer supported, use "node" instead and set the "protocol" attribute to "inspector".')},r.request={enum:[t],description:l.NC("debugRequest",'Request type of configuration. Can be "launch" or "attach".')};for(const c in e.common.properties)r[c]={$ref:`#/definitions/common/properties/${c}`};Object.keys(r).forEach(c=>{!function ar(d){d.pattern=d.pattern||"^(?!.*\\$\\{(env|config|command)\\.)",d.patternErrorMessage=d.patternErrorMessage||l.NC("deprecatedVariables","'env.', 'config.' and 'command.' are deprecated, use 'env:', 'config:' and 'command:' instead.")}(r[c])}),e[i]={...o},e[n]={type:"object",additionalProperties:!1,properties:(0,we.hX)(r,c=>"type"!==c&&"request"!==c&&"name"!==c)};const a={...o};return a.properties={...r,windows:{$ref:`#/definitions/${n}`,description:l.NC("debugWindowsConfiguration","Windows specific launch configuration attributes.")},osx:{$ref:`#/definitions/${n}`,description:l.NC("debugOSXConfiguration","OS X specific launch configuration attributes.")},linux:{$ref:`#/definitions/${n}`,description:l.NC("debugLinuxConfiguration","Linux specific launch configuration attributes.")}},a}):null}};Si=(0,u.gn)([(0,u.fM)(3,Z.Ui),(0,u.fM)(4,Xn.y),(0,u.fM)(5,Jn.qb),(0,u.fM)(6,vi.n),(0,u.fM)(7,h.tn),(0,u.fM)(8,A.i6)],Si);var Ci=v(8155),mt=v(80564);const yi=l.NC("JsonSchema.input.id","The input's id is used to associate an input with a variable of the form ${input:id}."),wi=l.NC("JsonSchema.input.type","The type of user input prompt to use."),Yn=l.NC("JsonSchema.input.description","The description is shown when the user is prompted for input."),eo=l.NC("JsonSchema.input.default","The default value for the input."),dr={definitions:{inputs:{type:"array",description:l.NC("JsonSchema.inputs","User inputs. Used for defining user input prompts, such as free string input or a choice from several options."),items:{oneOf:[{type:"object",required:["id","type","description"],additionalProperties:!1,properties:{id:{type:"string",description:yi},type:{type:"string",description:wi,enum:["promptString"],enumDescriptions:[l.NC("JsonSchema.input.type.promptString","The 'promptString' type opens an input box to ask the user for input.")]},description:{type:"string",description:Yn},default:{type:"string",description:eo},password:{type:"boolean",description:l.NC("JsonSchema.input.password","Controls if a password input is shown. Password input hides the typed text.")}}},{type:"object",required:["id","type","description","options"],additionalProperties:!1,properties:{id:{type:"string",description:yi},type:{type:"string",description:wi,enum:["pickString"],enumDescriptions:[l.NC("JsonSchema.input.type.pickString","The 'pickString' type shows a selection list.")]},description:{type:"string",description:Yn},default:{type:"string",description:eo},options:{type:"array",description:l.NC("JsonSchema.input.options","An array of strings that defines the options for a quick pick."),items:{oneOf:[{type:"string"},{type:"object",required:["value"],additionalProperties:!1,properties:{label:{type:"string",description:l.NC("JsonSchema.input.pickString.optionLabel","Label for the option.")},value:{type:"string",description:l.NC("JsonSchema.input.pickString.optionValue","Value for the option.")}}}]}}}},{type:"object",required:["id","type","command"],additionalProperties:!1,properties:{id:{type:"string",description:yi},type:{type:"string",description:wi,enum:["command"],enumDescriptions:[l.NC("JsonSchema.input.type.command","The 'command' type executes a command.")]},command:{type:"string",description:l.NC("JsonSchema.input.command.command","The command to execute for this input variable.")},args:{oneOf:[{type:"object",description:l.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"array",description:l.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"string",description:l.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")}]}}}]}}}},lr=Ci.ut.registerExtensionPoint({extensionPoint:"debuggers",defaultExtensionKind:["workspace"],jsonSchema:{description:l.NC("vscode.extension.contributes.debuggers","Contributes debug adapters."),type:"array",defaultSnippets:[{body:[{type:""}]}],items:{additionalProperties:!1,type:"object",defaultSnippets:[{body:{type:"",program:"",runtime:""}}],properties:{type:{description:l.NC("vscode.extension.contributes.debuggers.type","Unique identifier for this debug adapter."),type:"string"},label:{description:l.NC("vscode.extension.contributes.debuggers.label","Display name for this debug adapter."),type:"string"},program:{description:l.NC("vscode.extension.contributes.debuggers.program","Path to the debug adapter program. Path is either absolute or relative to the extension folder."),type:"string"},args:{description:l.NC("vscode.extension.contributes.debuggers.args","Optional arguments to pass to the adapter."),type:"array"},runtime:{description:l.NC("vscode.extension.contributes.debuggers.runtime","Optional runtime in case the program attribute is not an executable but requires a runtime."),type:"string"},runtimeArgs:{description:l.NC("vscode.extension.contributes.debuggers.runtimeArgs","Optional runtime arguments."),type:"array"},variables:{description:l.NC("vscode.extension.contributes.debuggers.variables","Mapping from interactive variables (e.g. ${action.pickProcess}) in `launch.json` to a command."),type:"object"},initialConfigurations:{description:l.NC("vscode.extension.contributes.debuggers.initialConfigurations","Configurations for generating the initial 'launch.json'."),type:["array","string"]},languages:{description:l.NC("vscode.extension.contributes.debuggers.languages",'List of languages for which the debug extension could be considered the "default debugger".'),type:"array"},configurationSnippets:{description:l.NC("vscode.extension.contributes.debuggers.configurationSnippets","Snippets for adding new configurations in 'launch.json'."),type:"array"},configurationAttributes:{description:l.NC("vscode.extension.contributes.debuggers.configurationAttributes","JSON schema configurations for validating 'launch.json'."),type:"object"},when:{description:l.NC("vscode.extension.contributes.debuggers.when","Condition which must be true to enable this type of debugger. Consider using 'shellExecutionSupported', 'virtualWorkspace', 'resourceScheme' or an extension-defined context key as appropriate for this."),type:"string",default:""},deprecated:{description:l.NC("vscode.extension.contributes.debuggers.deprecated","Optional message to mark this debug type as being deprecated."),type:"string",default:""},windows:{description:l.NC("vscode.extension.contributes.debuggers.windows","Windows specific settings."),type:"object",properties:{runtime:{description:l.NC("vscode.extension.contributes.debuggers.windows.runtime","Runtime used for Windows."),type:"string"}}},osx:{description:l.NC("vscode.extension.contributes.debuggers.osx","macOS specific settings."),type:"object",properties:{runtime:{description:l.NC("vscode.extension.contributes.debuggers.osx.runtime","Runtime used for macOS."),type:"string"}}},linux:{description:l.NC("vscode.extension.contributes.debuggers.linux","Linux specific settings."),type:"object",properties:{runtime:{description:l.NC("vscode.extension.contributes.debuggers.linux.runtime","Runtime used for Linux."),type:"string"}}},strings:{description:l.NC("vscode.extension.contributes.debuggers.strings","UI strings contributed by this debug adapter."),type:"object",properties:{unverifiedBreakpoints:{description:l.NC("vscode.extension.contributes.debuggers.strings.unverifiedBreakpoints","When there are unverified breakpoints in a language supported by this debug adapter, this message will appear on the breakpoint hover and in the breakpoints view. Markdown and command links are supported."),type:"string"}}}}}}}),ur=Ci.ut.registerExtensionPoint({extensionPoint:"breakpoints",jsonSchema:{description:l.NC("vscode.extension.contributes.breakpoints","Contributes breakpoints."),type:"array",defaultSnippets:[{body:[{language:""}]}],items:{type:"object",additionalProperties:!1,defaultSnippets:[{body:{language:""}}],properties:{language:{description:l.NC("vscode.extension.contributes.breakpoints.language","Allow breakpoints for this language."),type:"string"},when:{description:l.NC("vscode.extension.contributes.breakpoints.when","Condition which must be true to enable breakpoints in this language. Consider matching this to the debugger when clause as appropriate."),type:"string",default:""}}}}}),to={type:"object",description:l.NC("presentation","Presentation options on how to show this configuration in the debug configuration dropdown and the command palette."),properties:{hidden:{type:"boolean",default:!1,description:l.NC("presentation.hidden","Controls if this configuration should be shown in the configuration dropdown and the command palette.")},group:{type:"string",default:"",description:l.NC("presentation.group","Group that this configuration belongs to. Used for grouping and sorting in the configuration dropdown and the command palette.")},order:{type:"number",default:1,description:l.NC("presentation.order","Order of this configuration within a group. Used for grouping and sorting in the configuration dropdown and the command palette.")}},default:{hidden:!1,group:"",order:1}},io={name:"Compound",configurations:[]},tt={id:mt.yY,type:"object",title:l.NC("app.launch.json.title","Launch"),allowTrailingCommas:!0,allowComments:!0,required:[],default:{version:"0.2.0",configurations:[],compounds:[]},properties:{version:{type:"string",description:l.NC("app.launch.json.version","Version of this file format."),default:"0.2.0"},configurations:{type:"array",description:l.NC("app.launch.json.configurations","List of configurations. Add new configurations or edit existing ones by using IntelliSense."),items:{defaultSnippets:[],type:"object",oneOf:[]}},compounds:{type:"array",description:l.NC("app.launch.json.compounds","List of compounds. Each compound references multiple configurations which will get launched together."),items:{type:"object",required:["name","configurations"],properties:{name:{type:"string",description:l.NC("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},presentation:to,configurations:{type:"array",default:[],items:{oneOf:[{enum:[],description:l.NC("useUniqueNames","Please use unique configuration names.")},{type:"object",required:["name"],properties:{name:{enum:[],description:l.NC("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},folder:{enum:[],description:l.NC("app.launch.json.compound.folder","Name of folder in which the compound is located.")}}}]},description:l.NC("app.launch.json.compounds.configurations","Names of configurations that will be started as part of this compound.")},stopAll:{type:"boolean",default:!1,description:l.NC("app.launch.json.compound.stopAll","Controls whether manually terminating one session will stop all of the compound sessions.")},preLaunchTask:{type:"string",default:"",description:l.NC("compoundPrelaunchTask","Task to run before any of the compound configurations start.")}},default:io},default:[io]},inputs:dr.definitions.inputs}},hr={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:l.NC("TaskDefinition.description","The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:l.NC("TaskDefinition.properties","Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:l.NC("TaskDefinition.when","Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var ki;(ki||(ki={})).from=function e(t,i,n){if(!t)return;const o=j.HD(t.type)?t.type:void 0;if(!o||0===o.length)return void n.error(l.NC("TaskTypeConfiguration.noType","The task type configuration is missing the required 'taskType' property"));const s=[];if(Array.isArray(t.required))for(const r of t.required)j.HD(r)&&s.push(r);return{extensionId:i.value,taskType:o,required:s,properties:t.properties?we.I8(t.properties):{},when:t.when?A.Ao.deserialize(t.when):void 0}};const gr=Ci.ut.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(d,e)=>{for(const t of d)t.type&&e.push(`onTaskType:${t.type}`)},jsonSchema:{description:l.NC("TaskDefinitionExtPoint","Contributes task kinds"),type:"array",items:hr}}),fr=new class pr{constructor(){this._onDefinitionsChanged=new R.Q5,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{gr.setHandler((i,n)=>{this._schema=void 0;try{for(const o of n.removed){const s=o.value;for(const r of s)this.taskTypes&&r.type&&this.taskTypes[r.type]&&delete this.taskTypes[r.type]}for(const o of n.added){const s=o.value;for(const r of s){const a=ki.from(r,o.description.identifier,o.collector);a&&(this.taskTypes[a.taskType]=a)}}(n.removed.length>0||n.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(void 0===this._schema){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),i.properties=void 0!==t.properties?we.I8(t.properties):Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this._schema={oneOf:e}}return this._schema}};var oe=v(49311),it=v(69486),Di=v(89488);const br=le.B.as(qn.I.JSONContribution);let xi=class extends F.JT{constructor(e,t,i,n,o,s,r,a,c,g,p){super(),this.editorService=t,this.configurationService=i,this.quickInputService=n,this.instantiationService=o,this.commandService=s,this.extensionService=r,this.contextKeyService=a,this.languageService=c,this.dialogService=g,this.lifecycleService=p,this.debugAdapterFactories=new Map,this._onDidRegisterDebugger=new R.Q5,this._onDidDebuggersExtPointRead=new R.Q5,this.breakpointContributions=[],this.debuggerWhenKeys=new Set,this.usedDebugTypes=new Set,this.adapterDescriptorFactories=[],this.debuggers=[],this.registerListeners(),this.contextKeyService.bufferChangeEvents(()=>{this.debuggersAvailable=h.Qe.bindTo(a),this.debugExtensionsAvailable=h.Ju.bindTo(a)}),this._register(this.contextKeyService.onDidChangeContext(f=>{f.affectsSome(this.debuggerWhenKeys)&&(this.debuggersAvailable.set(this.hasEnabledDebuggers()),this.updateDebugAdapterSchema())})),this._register(this.onDidDebuggersExtPointRead(()=>{this.debugExtensionsAvailable.set(this.debuggers.length>0)})),this.lifecycleService.when(4).then(()=>this.debugExtensionsAvailable.set(this.debuggers.length>0)),this._register(e.onDidNewSession(f=>{this.usedDebugTypes.add(f.configuration.type)}))}registerListeners(){lr.setHandler((e,t)=>{t.added.forEach(i=>{i.value.forEach(n=>{if((!n.type||"string"!=typeof n.type)&&i.collector.error(l.NC("debugNoType","Debugger 'type' can not be omitted and must be of type 'string'.")),"*"!==n.type){const o=this.getDebugger(n.type);if(o)o.merge(n,i.description);else{const s=this.instantiationService.createInstance(Si,this,n,i.description);s.when?.keys().forEach(r=>this.debuggerWhenKeys.add(r)),this.debuggers.push(s)}}})}),e.forEach(i=>{i.value.forEach(n=>{"*"===n.type&&this.debuggers.forEach(o=>o.merge(n,i.description))})}),t.removed.forEach(i=>{const n=i.value.map(o=>o.type);this.debuggers=this.debuggers.filter(o=>-1===n.indexOf(o.type))}),this.updateDebugAdapterSchema(),this._onDidDebuggersExtPointRead.fire()}),ur.setHandler(e=>{this.breakpointContributions=e.flatMap(t=>t.value.map(i=>this.instantiationService.createInstance(mi,i)))})}updateDebugAdapterSchema(){const e=tt.properties.configurations.items,t=fr.getJsonSchema(),i={common:{properties:{name:{type:"string",description:l.NC("debugName","Name of configuration; appears in the launch configuration dropdown menu."),default:"Launch"},debugServer:{type:"number",description:l.NC("debugServer","For debug extension development only: if a port is specified VS Code tries to connect to a debug adapter running in server mode"),default:4711},preLaunchTask:{anyOf:[t,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:l.NC("debugPrelaunchTask","Task to run before debug session starts.")},postDebugTask:{anyOf:[t,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:l.NC("debugPostDebugTask","Task to run after debug session ends.")},presentation:to,internalConsoleOptions:h._u,suppressMultipleSessionWarning:{type:"boolean",description:l.NC("suppressMultipleSessionWarning","Disable the warning when trying to start the same debug configuration more than once."),default:!0}}}};tt.definitions=i,e.oneOf=[],e.defaultSnippets=[],this.debuggers.forEach(n=>{const o=n.getSchemaAttributes(i);o&&e.oneOf&&e.oneOf.push(...o);const s=n.configurationSnippets;s&&e.defaultSnippets&&e.defaultSnippets.push(...s)}),br.registerSchema(mt.yY,tt)}registerDebugAdapterFactory(e,t){return e.forEach(i=>this.debugAdapterFactories.set(i,t)),this.debuggersAvailable.set(this.hasEnabledDebuggers()),this._onDidRegisterDebugger.fire(),{dispose:()=>{e.forEach(i=>this.debugAdapterFactories.delete(i))}}}hasEnabledDebuggers(){for(const[e]of this.debugAdapterFactories){const t=this.getDebugger(e);if(t&&t.enabled)return!0}return!1}createDebugAdapter(e){const t=this.debugAdapterFactories.get(e.configuration.type);if(t)return t.createDebugAdapter(e)}substituteVariables(e,t,i){const n=this.debugAdapterFactories.get(e);return n?n.substituteVariables(t,i):Promise.resolve(i)}runInTerminal(e,t,i){const n=this.debugAdapterFactories.get(e);return n?n.runInTerminal(t,i):Promise.resolve(void 0)}registerDebugAdapterDescriptorFactory(e){return this.adapterDescriptorFactories.push(e),{dispose:()=>{this.unregisterDebugAdapterDescriptorFactory(e)}}}unregisterDebugAdapterDescriptorFactory(e){const t=this.adapterDescriptorFactories.indexOf(e);t>=0&&this.adapterDescriptorFactories.splice(t,1)}getDebugAdapterDescriptor(e){const t=e.configuration,i=this.adapterDescriptorFactories.filter(n=>n.type===t.type&&n.createDebugAdapterDescriptor);return 1===i.length?i[0].createDebugAdapterDescriptor(e):Promise.resolve(void 0)}getDebuggerLabel(e){const t=this.getDebugger(e);if(t)return t.label}get onDidRegisterDebugger(){return this._onDidRegisterDebugger.event}get onDidDebuggersExtPointRead(){return this._onDidDebuggersExtPointRead.event}canSetBreakpointsIn(e){const t=e.getLanguageId();return!(!t||"jsonc"===t||"log"===t)&&(!!this.configurationService.getValue("debug").allowBreakpointsEverywhere||this.breakpointContributions.some(i=>i.language===t&&i.enabled))}getDebugger(e){return this.debuggers.find(t=>De.qq(t.type,e))}getEnabledDebugger(e){const t=this.getDebugger(e);return t&&t.enabled?t:void 0}someDebuggerInterestedInLanguage(e){return!!this.debuggers.filter(t=>t.enabled).find(t=>t.interestedInLanguage(e))}guessDebugger(e){var t=this;return(0,b.Z)(function*(){const i=t.editorService.activeTextEditorControl;let n=[],o=null,s=null;if((0,Ve.CL)(i)){s=i.getModel();const p=s?s.getLanguageId():void 0;p&&(o=t.languageService.getLanguageName(p));const f=t.debuggers.filter(m=>m.enabled).filter(m=>p&&m.interestedInLanguage(p));if(1===f.length)return f[0];f.length>1&&(n=f)}if((!o||e||s&&t.canSetBreakpointsIn(s))&&0===n.length&&(yield t.activateDebuggers("onDebugInitialConfigurations"),n=t.debuggers.filter(p=>p.enabled).filter(p=>p.hasInitialConfiguration()||p.hasConfigurationProvider())),0===n.length&&o){o.indexOf(" ")>=0&&(o=`'${o}'`);const{confirmed:p}=yield t.dialogService.confirm({type:fe.Z.Warning,message:l.NC("CouldNotFindLanguage","You don't have an extension for debugging {0}. Should we find a {0} extension in the Marketplace?",o),primaryButton:l.NC({key:"findExtension",comment:["&& denotes a mnemonic"]},"&&Find {0} extension",o)});return void(p&&(yield t.commandService.executeCommand("debug.installAdditionalDebuggers",o)))}t.initExtensionActivationsIfNeeded(),n.sort((p,f)=>p.label.localeCompare(f.label));const r=[],a=[];n.forEach(p=>{const f=p.getMainExtensionDescriptor();f.id&&t.earlyActivatedExtensions?.has(f.id)||t.usedDebugTypes.has(p.type)?r.push(p):a.push(p)});const c=[];r.length>0&&c.push({type:"separator",label:l.NC("suggestedDebuggers","Suggested")},...r.map(p=>({label:p.label,debugger:p}))),a.length>0&&(c.length>0&&c.push({type:"separator",label:""}),c.push(...a.map(p=>({label:p.label,debugger:p})))),c.push({type:"separator",label:""},{label:o?l.NC("installLanguage","Install an extension for {0}...",o):l.NC("installExt","Install extension...")});const g=l.NC("selectDebug","Select debugger");return t.quickInputService.pick(c,{activeItem:c[0],placeHolder:g}).then(p=>{if(p&&p.debugger)return p.debugger;p&&t.commandService.executeCommand("debug.installAdditionalDebuggers",o)})})()}initExtensionActivationsIfNeeded(){if(!this.earlyActivatedExtensions){this.earlyActivatedExtensions=new Set;const e=this.extensionService.getExtensionsStatus();for(const t in e)e[t].activationTimes&&this.earlyActivatedExtensions.add(t)}}activateDebuggers(e,t){var i=this;return(0,b.Z)(function*(){i.initExtensionActivationsIfNeeded();const n=[i.extensionService.activateByEvent(e),i.extensionService.activateByEvent("onDebug")];t&&n.push(i.extensionService.activateByEvent(`${e}:${t}`)),yield Promise.all(n)})()}};xi=(0,u.gn)([(0,u.fM)(1,oe.AR),(0,u.fM)(2,Z.Ui),(0,u.fM)(3,zt.eJ),(0,u.fM)(4,q.TG),(0,u.fM)(5,ne.H),(0,u.fM)(6,it.QS),(0,u.fM)(7,A.i6),(0,u.fM)(8,bi.O),(0,u.fM)(9,bt.Ss),(0,u.fM)(10,Di.g)],xi);var C=v(91243),no=v(44102),oo=v(70473),Pe=v(58571),V=v(52786),E=v(23811),mr=v(95126),vr=v(17360),so=v(4866);const ro=le.B.as(qn.I.JSONContribution);ro.registerSchema(mt.yY,tt);const Ei="debug.selectedconfigname",Ii="debug.selectedroot",ao="debug.selectedtype",Mi="debug.recentdynamicconfigurations";let Ni=class{constructor(e,t,i,n,o,s,r,a,c,g){this.adapterManager=e,this.contextService=t,this.configurationService=i,this.quickInputService=n,this.instantiationService=o,this.storageService=s,this.extensionService=r,this.historyService=a,this.uriIdentityService=c,this.getSelectedConfig=()=>Promise.resolve(void 0),this.selectedDynamic=!1,this._onDidSelectConfigurationName=new R.Q5,this.configProviders=[],this.toDispose=[],this.initLaunches(),this.registerListeners();const p=this.storageService.get(Ii,1),f=this.storageService.get(ao,1),m=this.launches.find(M=>M.uri.toString()===p),S=this.storageService.get(Ei,1);this.debugConfigurationTypeContext=h.MO.bindTo(g);const w=f?{type:f}:void 0;m&&m.getConfigurationNames().length?this.selectConfiguration(m,S,void 0,w):this.launches.length>0&&this.selectConfiguration(void 0,S,void 0,w)}registerDebugConfigurationProvider(e){return this.configProviders.push(e),{dispose:()=>{this.unregisterDebugConfigurationProvider(e)}}}unregisterDebugConfigurationProvider(e){const t=this.configProviders.indexOf(e);t>=0&&this.configProviders.splice(t,1)}hasDebugConfigurationProvider(e,t){return void 0===t&&(t=h.j4.Initial),!!this.configProviders.find(n=>n.provideDebugConfigurations&&n.type===e&&n.triggerKind===t)}resolveConfigurationByProviders(e,t,i,n){var o=this;return(0,b.Z)(function*(){const s=function(){var c=(0,b.Z)(function*(g,p){"*"!==g&&(yield o.adapterManager.activateDebuggers("onDebugResolve",g));for(const f of o.configProviders)f.type===g&&f.resolveDebugConfiguration&&p&&(p=yield f.resolveDebugConfiguration(e,p,n));return p});return function(p,f){return c.apply(this,arguments)}}();let r=i.type??t,a=i;for(let c=new Set;a&&!c.has(r);)c.add(r),a=yield s(r,a),a=yield s("*",a),r=a?.type??t;return a})()}resolveDebugConfigurationWithSubstitutedVariables(e,t,i,n){var o=this;return(0,b.Z)(function*(){const s=o.configProviders.filter(a=>a.type===t&&a.resolveDebugConfigurationWithSubstitutedVariables).concat(o.configProviders.filter(a=>"*"===a.type&&a.resolveDebugConfigurationWithSubstitutedVariables));let r=i;return yield(0,Q.vP)(s.map(a=>(0,b.Z)(function*(){r&&(r=yield a.resolveDebugConfigurationWithSubstitutedVariables(e,r,n))}))),r})()}provideDebugConfigurations(e,t,i){var n=this;return(0,b.Z)(function*(){return yield n.adapterManager.activateDebuggers("onDebugInitialConfigurations"),(yield Promise.all(n.configProviders.filter(s=>s.type===t&&s.triggerKind===h.j4.Initial&&s.provideDebugConfigurations).map(s=>s.provideDebugConfigurations(e,i)))).reduce((s,r)=>s.concat(r),[])})()}getDynamicProviders(){var e=this;return(0,b.Z)(function*(){yield e.extensionService.whenInstalledExtensionsRegistered();const t="onDebugDynamicConfigurations";return e.extensionService.extensions.reduce((n,o)=>{if(!o.activationEvents)return n;const s=[];let r=!1;for(const a of o.activationEvents)a===t?r=!0:a.startsWith(`${t}:`)&&s.push(a.slice(29));if(s.length)return n.concat(s);if(r){const a=o.contributes?.debuggers?.[0].type;return a?n.concat(a):n}return n},[]).map(n=>{return{label:e.adapterManager.getDebuggerLabel(n),getProvider:(o=(0,b.Z)(function*(){return yield e.adapterManager.activateDebuggers(t,n),e.configProviders.find(s=>s.type===n&&s.triggerKind===h.j4.Dynamic&&s.provideDebugConfigurations)}),function(){return o.apply(this,arguments)}),type:n,pick:function(){var o=(0,b.Z)(function*(){yield e.adapterManager.activateDebuggers(t,n);const s=new Ie.A,r=[],a=e.configProviders.find(w=>w.type===n&&w.triggerKind===h.j4.Dynamic&&w.provideDebugConfigurations);e.getLaunches().forEach(w=>{w.workspace&&a&&r.push(a.provideDebugConfigurations(w.workspace.uri,s.token).then(M=>M.map(I=>({label:I.name,description:w.name,config:I,buttons:[{iconClass:V.kS.asClassName(E.us),tooltip:l.NC("editLaunchConfig","Edit Debug Configuration in launch.json")}],launch:w}))))});const c=new F.SL,g=c.add(e.quickInputService.createQuickPick());g.busy=!0,g.placeholder=l.NC("selectConfiguration","Select Launch Configuration");const p=new Promise(w=>{c.add(g.onDidAccept(()=>w(g.activeItems[0]))),c.add(g.onDidTriggerItemButton(function(){var M=(0,b.Z)(function*(I){w(void 0);const{launch:L,config:N}=I.item;yield L.openConfigFile({preserveFocus:!1,type:N.type,suppressInitialConfigs:!0}),yield L.writeConfiguration(N),yield e.selectConfiguration(L,N.name),e.removeRecentDynamicConfigurations(N.name,N.type)});return function(I){return M.apply(this,arguments)}}()))}),f=yield Promise.all(r),m=(0,de.xH)(f);g.items=m,g.busy=!1,g.show();const S=yield p;if(c.dispose(),S)return S;s.cancel()});return function(){return o.apply(this,arguments)}}()};var o})})()}getAllConfigurations(){const e=[];for(const t of this.launches)for(const i of t.getConfigurationNames()){const n=t.getConfiguration(i)||t.getCompound(i);n&&e.push({launch:t,name:i,presentation:n.presentation})}return(0,se.u8)(e)}removeRecentDynamicConfigurations(e,t){const i=this.getRecentDynamicConfigurations().filter(n=>n.name!==e||n.type!==t);this.storageService.store(Mi,JSON.stringify(i),1,1),this.selectedConfiguration.name===e&&this.selectedType===t&&this.selectedDynamic?this.selectConfiguration(void 0,void 0):this._onDidSelectConfigurationName.fire()}getRecentDynamicConfigurations(){return JSON.parse(this.storageService.get(Mi,1,"[]"))}registerListeners(){var e=this;this.toDispose.push(R.ju.any(this.contextService.onDidChangeWorkspaceFolders,this.contextService.onDidChangeWorkbenchState)(()=>{this.initLaunches(),this.selectConfiguration(void 0),this.setCompoundSchemaValues()})),this.toDispose.push(this.configurationService.onDidChangeConfiguration(function(){var t=(0,b.Z)(function*(i){i.affectsConfiguration("launch")&&(yield e.selectConfiguration(void 0),e.setCompoundSchemaValues())});return function(i){return t.apply(this,arguments)}}())),this.toDispose.push(this.adapterManager.onDidDebuggersExtPointRead(()=>{this.setCompoundSchemaValues()}))}initLaunches(){this.launches=this.contextService.getWorkspace().folders.map(e=>this.instantiationService.createInstance(Ai,this,this.adapterManager,e)),3===this.contextService.getWorkbenchState()&&this.launches.push(this.instantiationService.createInstance(jt,this,this.adapterManager)),this.launches.push(this.instantiationService.createInstance(Kt,this,this.adapterManager)),this.selectedLaunch&&-1===this.launches.indexOf(this.selectedLaunch)&&this.selectConfiguration(void 0)}setCompoundSchemaValues(){const e=tt.properties.compounds.items.properties.configurations,t=this.launches.map(n=>n.getConfigurationNames(!0)).reduce((n,o)=>n.concat(o),[]);e.items.oneOf[0].enum=t,e.items.oneOf[1].properties.name.enum=t;const i=this.contextService.getWorkspace().folders.map(n=>n.name);e.items.oneOf[1].properties.folder.enum=i,ro.registerSchema(mt.yY,tt)}getLaunches(){return this.launches}getLaunch(e){if(ue.ov.isUri(e))return this.launches.find(t=>t.workspace&&this.uriIdentityService.extUri.isEqual(t.workspace.uri,e))}get selectedConfiguration(){return{launch:this.selectedLaunch,name:this.selectedName,getConfig:this.getSelectedConfig,type:this.selectedType}}get onDidSelectConfiguration(){return this._onDidSelectConfigurationName.event}getWorkspaceLaunch(){if(3===this.contextService.getWorkbenchState())return this.launches[this.launches.length-1]}selectConfiguration(e,t,i,n){var o=this;return(0,b.Z)(function*(){if(typeof e>"u"){const p=o.historyService.getLastActiveWorkspaceRoot();(!(e=o.getLaunch(p))||0===e.getConfigurationNames().length)&&(e=o.launches.find(f=>!(!f||!f.getConfigurationNames().length))||e||o.launches[0])}const s=o.selectedLaunch,r=o.selectedName,a=o.selectedDynamic;o.selectedLaunch=e,o.selectedLaunch?o.storageService.store(Ii,o.selectedLaunch.uri.toString(),1,1):o.storageService.remove(Ii,1);const c=e?e.getConfigurationNames():[];o.getSelectedConfig=()=>{const p=o.selectedName?e?.getConfiguration(o.selectedName):void 0;return Promise.resolve(p||i)};let g=i?.type;if(t&&c.indexOf(t)>=0)o.setSelectedLaunchName(t);else if(n&&n.type){if(g=n.type,!i){const f=(yield o.getDynamicProviders()).filter(m=>m.type===g);o.getSelectedConfig=(0,b.Z)(function*(){const m=yield Promise.all(f.map(w=>w.getProvider())),S=m.length>0?m[0]:void 0;if(S&&e&&e.workspace){const w=new Ie.A,I=(yield S.provideDebugConfigurations(e.workspace.uri,w.token)).find(L=>L.name===t);if(I)return I}})}o.setSelectedLaunchName(t);let p=o.getRecentDynamicConfigurations();t&&n.type&&(p.unshift({name:t,type:n.type}),p=(0,de.EB)(p,f=>`${f.name} : ${f.type}`),o.storageService.store(Mi,JSON.stringify(p),1,1))}else o.selectedName&&-1!==c.indexOf(o.selectedName)||o.setSelectedLaunchName(c.length?c[0]:void 0);!i&&e&&o.selectedName&&(i=e.getConfiguration(o.selectedName),g=i?.type),o.selectedType=n?.type||i?.type,o.selectedDynamic=!!n,o.storageService.store(ao,n?o.selectedType:void 0,1,1),g?o.debugConfigurationTypeContext.set(g):o.debugConfigurationTypeContext.reset(),(o.selectedLaunch!==s||o.selectedName!==r||a!==o.selectedDynamic)&&o._onDidSelectConfigurationName.fire()})()}setSelectedLaunchName(e){this.selectedName=e,this.selectedName?this.storageService.store(Ei,this.selectedName,1,1):this.storageService.remove(Ei,1)}dispose(){this.toDispose=(0,F.B9)(this.toDispose)}};Ni=(0,u.gn)([(0,u.fM)(1,Te.ec),(0,u.fM)(2,Z.Ui),(0,u.fM)(3,zt.eJ),(0,u.fM)(4,q.TG),(0,u.fM)(5,Pe.Uy),(0,u.fM)(6,it.QS),(0,u.fM)(7,mr.C),(0,u.fM)(8,ke.v),(0,u.fM)(9,A.i6)],Ni);class Ti{constructor(e,t){this.configurationManager=e,this.adapterManager=t}getCompound(e){const t=this.getConfig();if(t&&t.compounds)return t.compounds.find(i=>i.name===e)}getConfigurationNames(e=!1){const t=this.getConfig();if(!t||!Array.isArray(t.configurations)&&!Array.isArray(t.compounds))return[];{const i=[];return t.configurations&&i.push(...t.configurations.filter(n=>n&&"string"==typeof n.name)),e?i.map(n=>n.name):(t.compounds&&i.push(...t.compounds.filter(n=>"string"==typeof n.name&&n.configurations&&n.configurations.length)),(0,se.u8)(i).map(n=>n.name))}}getConfiguration(e){const t=we.I8(this.getConfig());if(!t||!t.configurations)return;const i=t.configurations.find(n=>n&&n.name===e);return i&&(i.__configurationTarget=this instanceof Kt?2:this instanceof jt?5:6),i}getInitialConfigurationContent(e,t,i,n){var o=this;return(0,b.Z)(function*(){let s="";const r=t?o.adapterManager.getEnabledDebugger(t):yield o.adapterManager.guessDebugger(!0);if(r){const a=i?yield o.configurationManager.provideDebugConfigurations(e,r.type,n||Ie.T.None):[];s=yield r.getInitialConfigurationContent(a)}return s})()}get hidden(){return!1}}let Ai=class extends Ti{constructor(e,t,i,n,o,s,r){super(e,t),this.workspace=i,this.fileService=n,this.textFileService=o,this.editorService=s,this.configurationService=r}get uri(){return oo.Vo(this.workspace.uri,"/.vscode/launch.json")}get name(){return this.workspace.name}getConfig(){return this.configurationService.inspect("launch",{resource:this.workspace.uri}).workspaceFolderValue}openConfigFile({preserveFocus:e,type:t,suppressInitialConfigs:i},n){var o=this;return(0,b.Z)(function*(){const s=o.uri;let r=!1,a="";try{a=(yield o.fileService.readFile(s)).value.toString()}catch{if(a=yield o.getInitialConfigurationContent(o.workspace.uri,t,!i,n),!a)return{editor:null,created:!1};r=!0;try{yield o.textFileService.write(s,a)}catch(m){throw new Error(l.NC("DebugConfig.failed","Unable to create 'launch.json' file inside the '.vscode' folder ({0}).",m.message))}}const c=a.indexOf(`"${o.configurationManager.selectedConfiguration.name}"`);let g=1;for(let m=0;m<c;m++)"\n"===a.charAt(m)&&g++;const p=g>1?{startLineNumber:g,startColumn:4}:void 0,f=yield o.editorService.openEditor({resource:s,options:{selection:p,preserveFocus:e,pinned:r,revealIfVisible:!0}},oe.LP);return{editor:(0,j.M2)(f),created:r}})()}writeConfiguration(e){var t=this;return(0,b.Z)(function*(){const i=we.I8(t.getConfig());i.configurations||(i.configurations=[]),i.configurations.push(e),yield t.configurationService.updateValue("launch",i,{resource:t.workspace.uri},6)})()}};Ai=(0,u.gn)([(0,u.fM)(3,U.sn),(0,u.fM)(4,so.MM),(0,u.fM)(5,oe.AR),(0,u.fM)(6,Z.Ui)],Ai);let jt=class extends Ti{constructor(e,t,i,n,o){super(e,t),this.editorService=i,this.configurationService=n,this.contextService=o}get workspace(){}get uri(){return this.contextService.getWorkspace().configuration}get name(){return l.NC("workspace","workspace")}getConfig(){return this.configurationService.inspect("launch").workspaceValue}openConfigFile({preserveFocus:e,type:t,useInitialConfigs:i},n){var o=this;return(0,b.Z)(function*(){if(!o.getConfig()){const a=yield o.getInitialConfigurationContent(void 0,t,i,n);if(!a)return{editor:null,created:!1};yield o.configurationService.updateValue("launch",no.Qc(a),5)}const r=yield o.editorService.openEditor({resource:o.contextService.getWorkspace().configuration,options:{preserveFocus:e}},oe.LP);return{editor:(0,j.M2)(r),created:!1}})()}};jt=(0,u.gn)([(0,u.fM)(2,oe.AR),(0,u.fM)(3,Z.Ui),(0,u.fM)(4,Te.ec)],jt);let Kt=class extends Ti{constructor(e,t,i,n){super(e,t),this.configurationService=i,this.preferencesService=n}get workspace(){}get uri(){return this.preferencesService.userSettingsResource}get name(){return l.NC("user settings","user settings")}get hidden(){return!0}getConfig(){return this.configurationService.inspect("launch").userValue}openConfigFile({preserveFocus:e}){var n=this;return(0,b.Z)(function*(){const o=yield n.preferencesService.openUserSettings({jsonEditor:!0,preserveFocus:e,revealSetting:{key:"launch"}});return{editor:(0,j.M2)(o),created:!1}})()}};Kt=(0,u.gn)([(0,u.fM)(2,Z.Ui),(0,u.fM)(3,vr.UP)],Kt);var Sr=v(71871),Li=v(32536),Cr=v(6620);const yr=/range=([0-9]+):([0-9]+)/;class wr{constructor(e){this.debugService=e,this.memoryFdCounter=0,this.fdMemory=new Map,this.changeEmitter=new R.Q5,this.onDidChangeCapabilities=R.ju.None,this.onDidChangeFile=this.changeEmitter.event,this.capabilities=1028,e.onDidEndSession(t=>{for(const[i,n]of this.fdMemory)n.session===t&&this.close(i)})}watch(e,t){if(t.recursive)return(0,F.OF)(()=>{});const{session:i,memoryReference:n,offset:o}=this.parseUri(e),s=new F.SL;return s.add(i.onDidChangeState(()=>{(3===i.state||0===i.state)&&this.changeEmitter.fire([{type:2,resource:e}])})),s.add(i.onDidInvalidateMemory(r=>{r.body.memoryReference===n&&(o&&(r.body.offset>=o.toOffset||r.body.offset+r.body.count<o.fromOffset)||this.changeEmitter.fire([{resource:e,type:0}]))})),s}stat(e){const{readOnly:t}=this.parseUri(e);return Promise.resolve({type:U.Tv.File,mtime:0,ctime:0,size:0,permissions:t?U.rM.Readonly:void 0})}mkdir(){throw(0,U.BU)("Not allowed",U.bH.NoPermissions)}readdir(){throw(0,U.BU)("Not allowed",U.bH.NoPermissions)}delete(){throw(0,U.BU)("Not allowed",U.bH.NoPermissions)}rename(){throw(0,U.BU)("Not allowed",U.bH.NoPermissions)}open(e,t){const{session:i,memoryReference:n,offset:o}=this.parseUri(e),s=this.memoryFdCounter++;let r=i.getMemory(n);return o&&(r=new kr(r,o)),this.fdMemory.set(s,{session:i,region:r}),Promise.resolve(s)}close(e){return this.fdMemory.get(e)?.region.dispose(),this.fdMemory.delete(e),Promise.resolve()}writeFile(e,t){var i=this;return(0,b.Z)(function*(){const{offset:n}=i.parseUri(e);if(!n)throw(0,U.BU)("Range must be present to read a file",U.bH.FileNotFound);const o=yield i.open(e,{create:!1});try{yield i.write(o,n.fromOffset,t,0,t.length)}finally{i.close(o)}})()}readFile(e){var t=this;return(0,b.Z)(function*(){const{offset:i}=t.parseUri(e);if(!i)throw(0,U.BU)("Range must be present to read a file",U.bH.FileNotFound);const n=new Uint8Array(i.toOffset-i.fromOffset),o=yield t.open(e,{create:!1});try{return yield t.read(o,i.fromOffset,n,0,n.length),n}finally{t.close(o)}})()}read(e,t,i,n,o){var s=this;return(0,b.Z)(function*(){const r=s.fdMemory.get(e);if(!r)throw(0,U.BU)("No file with that descriptor open",U.bH.Unavailable);const a=yield r.region.read(t,o);let c=0;for(const g of a)switch(g.type){case 1:return c;case 2:if(c>0)return c;throw(0,U.BU)(g.error,U.bH.Unknown);case 0:{const p=Math.max(0,t-g.offset),f=g.data.slice(p,Math.min(g.data.byteLength,p+(o-c)));i.set(f.buffer,n+c),c+=f.byteLength;break}default:(0,Cr.vE)(g)}return c})()}write(e,t,i,n,o){const s=this.fdMemory.get(e);if(!s)throw(0,U.BU)("No file with that descriptor open",U.bH.Unavailable);return s.region.write(t,Sr.KN.wrap(i).slice(n,n+o))}parseUri(e){if(e.scheme!==h.Sb)throw(0,U.BU)(`Cannot open file with scheme ${e.scheme}`,U.bH.FileNotFound);const t=this.debugService.getModel().getSession(e.authority);if(!t)throw(0,U.BU)("Debug session not found",U.bH.FileNotFound);let i;const n=yr.exec(e.query);n&&(i={fromOffset:Number(n[1]),toOffset:Number(n[2])});const[,o]=e.path.split("/");return{session:t,offset:i,readOnly:!t.capabilities.supportsWriteMemoryRequest,sessionId:e.authority,memoryReference:decodeURIComponent(o)}}}class kr extends F.JT{constructor(e,t){super(),this.parent=e,this.range=t,this.invalidateEmitter=new R.Q5,this.onDidInvalidate=this.invalidateEmitter.event,this.width=this.range.toOffset-this.range.fromOffset,this.writable=e.writable,this._register(e),this._register(e.onDidInvalidate(i=>{const n=(0,Li.uZ)(i.fromOffset-t.fromOffset,0,this.width),o=(0,Li.uZ)(i.toOffset-t.fromOffset,0,this.width);o>n&&this.invalidateEmitter.fire({fromOffset:n,toOffset:o})}))}read(e,t){if(e<0)throw new RangeError(`Invalid fromOffset: ${e}`);return this.parent.read(this.range.fromOffset+e,this.range.fromOffset+Math.min(t,this.width))}write(e,t){return this.parent.write(this.range.fromOffset+e,t)}}var Bi=v(74486),re=v(84621),nt=v(99740),Dr=v(81532),be=v(17324),Fe=v(12292);let Ri=class{constructor(e,t,i,n,o,s,r,a){this.dbgr=t,this.sessionId=i,this.name=n,this.extensionHostDebugService=o,this.openerService=s,this.notificationService=r,this.dialogSerivce=a,this.allThreadsContinued=!0,this._readyForBreakpoints=!1,this.debugAdapterStopped=!1,this.inShutdown=!1,this.terminated=!1,this.firedAdapterExitEvent=!1,this.startTime=0,this.didReceiveStoppedEvent=!1,this._onDidInitialize=new R.Q5,this._onDidStop=new R.Q5,this._onDidContinued=new R.Q5,this._onDidTerminateDebugee=new R.Q5,this._onDidExitDebugee=new R.Q5,this._onDidThread=new R.Q5,this._onDidOutput=new R.Q5,this._onDidBreakpoint=new R.Q5,this._onDidLoadedSource=new R.Q5,this._onDidProgressStart=new R.Q5,this._onDidProgressUpdate=new R.Q5,this._onDidProgressEnd=new R.Q5,this._onDidInvalidated=new R.Q5,this._onDidInvalidateMemory=new R.Q5,this._onDidCustomEvent=new R.Q5,this._onDidEvent=new R.Q5,this._onDidExitAdapter=new R.Q5,this.toDispose=[],this.debugAdapter=e,this._capabilities=Object.create(null),this.toDispose.push(this.debugAdapter.onError(c=>{this.shutdown(c)})),this.toDispose.push(this.debugAdapter.onExit(c=>{0!==c?this.shutdown(new Error(`exit code: ${c}`)):this.shutdown()})),this.debugAdapter.onEvent(c=>{switch(c.event){case"initialized":this._readyForBreakpoints=!0,this._onDidInitialize.fire(c);break;case"loadedSource":this._onDidLoadedSource.fire(c);break;case"capabilities":c.body&&this.mergeCapabilities(c.body.capabilities);break;case"stopped":this.didReceiveStoppedEvent=!0,this._onDidStop.fire(c);break;case"continued":this.allThreadsContinued=!1!==c.body.allThreadsContinued,this._onDidContinued.fire(c);break;case"thread":this._onDidThread.fire(c);break;case"output":this._onDidOutput.fire(c);break;case"breakpoint":this._onDidBreakpoint.fire(c);break;case"terminated":this._onDidTerminateDebugee.fire(c);break;case"exit":this._onDidExitDebugee.fire(c);break;case"progressStart":this._onDidProgressStart.fire(c);break;case"progressUpdate":this._onDidProgressUpdate.fire(c);break;case"progressEnd":this._onDidProgressEnd.fire(c);break;case"invalidated":this._onDidInvalidated.fire(c);break;case"memory":this._onDidInvalidateMemory.fire(c);break;case"process":case"module":break;default:this._onDidCustomEvent.fire(c)}this._onDidEvent.fire(c)}),this.debugAdapter.onRequest(c=>this.dispatchRequest(c))}get isInShutdown(){return this.inShutdown}get onDidExitAdapter(){return this._onDidExitAdapter.event}get capabilities(){return this._capabilities}get readyForBreakpoints(){return this._readyForBreakpoints}get onDidInitialize(){return this._onDidInitialize.event}get onDidStop(){return this._onDidStop.event}get onDidContinued(){return this._onDidContinued.event}get onDidTerminateDebugee(){return this._onDidTerminateDebugee.event}get onDidExitDebugee(){return this._onDidExitDebugee.event}get onDidThread(){return this._onDidThread.event}get onDidOutput(){return this._onDidOutput.event}get onDidBreakpoint(){return this._onDidBreakpoint.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidated(){return this._onDidInvalidated.event}get onDidInvalidateMemory(){return this._onDidInvalidateMemory.event}get onDidEvent(){return this._onDidEvent.event}start(){var e=this;return(0,b.Z)(function*(){if(!e.debugAdapter)return Promise.reject(new Error(l.NC("noDebugAdapterStart","No debug adapter, can not start debug session.")));yield e.debugAdapter.startSession(),e.startTime=(new Date).getTime()})()}initialize(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send("initialize",e,void 0,void 0,!1);return i&&t.mergeCapabilities(i.body),i})()}disconnect(e){return this.shutdown(void 0,e.restart,this.capabilities.supportTerminateDebuggee?e.terminateDebuggee:void 0,this.capabilities.supportTerminateDebuggee&&this.capabilities.supportSuspendDebuggee?e.suspendDebuggee:void 0)}launchOrAttach(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send(e.request,e,void 0,void 0,!1);return i&&t.mergeCapabilities(i.body),i})()}terminate(e=!1){return this.capabilities.supportsTerminateRequest?this.terminated?this.disconnect({terminateDebuggee:!0,restart:e}):(this.terminated=!0,this.send("terminate",{restart:e},void 0)):Promise.reject(new Error("terminated not supported"))}restart(e){return this.capabilities.supportsRestartRequest?this.send("restart",e):Promise.reject(new Error("restart not supported"))}next(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send("next",e);return t.fireSimulatedContinuedEvent(e.threadId),i})()}stepIn(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send("stepIn",e);return t.fireSimulatedContinuedEvent(e.threadId),i})()}stepOut(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send("stepOut",e);return t.fireSimulatedContinuedEvent(e.threadId),i})()}continue(e){var t=this;return(0,b.Z)(function*(){const i=yield t.send("continue",e);return i&&i.body&&void 0!==i.body.allThreadsContinued&&(t.allThreadsContinued=i.body.allThreadsContinued),t.fireSimulatedContinuedEvent(e.threadId,t.allThreadsContinued),i})()}pause(e){return this.send("pause",e)}terminateThreads(e){return this.capabilities.supportsTerminateThreadsRequest?this.send("terminateThreads",e):Promise.reject(new Error("terminateThreads not supported"))}setVariable(e){return this.capabilities.supportsSetVariable?this.send("setVariable",e):Promise.reject(new Error("setVariable not supported"))}setExpression(e){return this.capabilities.supportsSetExpression?this.send("setExpression",e):Promise.reject(new Error("setExpression not supported"))}restartFrame(e,t){var i=this;return(0,b.Z)(function*(){if(i.capabilities.supportsRestartFrame){const n=yield i.send("restartFrame",e);return i.fireSimulatedContinuedEvent(t),n}return Promise.reject(new Error("restartFrame not supported"))})()}stepInTargets(e){return this.capabilities.supportsStepInTargetsRequest?this.send("stepInTargets",e):Promise.reject(new Error("stepInTargets not supported"))}completions(e,t){return this.capabilities.supportsCompletionsRequest?this.send("completions",e,t):Promise.reject(new Error("completions not supported"))}setBreakpoints(e){return this.send("setBreakpoints",e)}setFunctionBreakpoints(e){return this.capabilities.supportsFunctionBreakpoints?this.send("setFunctionBreakpoints",e):Promise.reject(new Error("setFunctionBreakpoints not supported"))}dataBreakpointInfo(e){return this.capabilities.supportsDataBreakpoints?this.send("dataBreakpointInfo",e):Promise.reject(new Error("dataBreakpointInfo not supported"))}setDataBreakpoints(e){return this.capabilities.supportsDataBreakpoints?this.send("setDataBreakpoints",e):Promise.reject(new Error("setDataBreakpoints not supported"))}setExceptionBreakpoints(e){return this.send("setExceptionBreakpoints",e)}breakpointLocations(e){return this.capabilities.supportsBreakpointLocationsRequest?this.send("breakpointLocations",e):Promise.reject(new Error("breakpointLocations is not supported"))}configurationDone(){return this.capabilities.supportsConfigurationDoneRequest?this.send("configurationDone",null):Promise.reject(new Error("configurationDone not supported"))}stackTrace(e,t){return this.send("stackTrace",e,t)}exceptionInfo(e){return this.capabilities.supportsExceptionInfoRequest?this.send("exceptionInfo",e):Promise.reject(new Error("exceptionInfo not supported"))}scopes(e,t){return this.send("scopes",e,t)}variables(e,t){return this.send("variables",e,t)}source(e){return this.send("source",e)}loadedSources(e){return this.capabilities.supportsLoadedSourcesRequest?this.send("loadedSources",e):Promise.reject(new Error("loadedSources not supported"))}threads(){return this.send("threads",null)}evaluate(e){return this.send("evaluate",e)}stepBack(e){var t=this;return(0,b.Z)(function*(){if(t.capabilities.supportsStepBack){const i=yield t.send("stepBack",e);return t.fireSimulatedContinuedEvent(e.threadId),i}return Promise.reject(new Error("stepBack not supported"))})()}reverseContinue(e){var t=this;return(0,b.Z)(function*(){if(t.capabilities.supportsStepBack){const i=yield t.send("reverseContinue",e);return t.fireSimulatedContinuedEvent(e.threadId),i}return Promise.reject(new Error("reverseContinue not supported"))})()}gotoTargets(e){return this.capabilities.supportsGotoTargetsRequest?this.send("gotoTargets",e):Promise.reject(new Error("gotoTargets is not supported"))}goto(e){var t=this;return(0,b.Z)(function*(){if(t.capabilities.supportsGotoTargetsRequest){const i=yield t.send("goto",e);return t.fireSimulatedContinuedEvent(e.threadId),i}return Promise.reject(new Error("goto is not supported"))})()}setInstructionBreakpoints(e){var t=this;return(0,b.Z)(function*(){return t.capabilities.supportsInstructionBreakpoints?yield t.send("setInstructionBreakpoints",e):Promise.reject(new Error("setInstructionBreakpoints is not supported"))})()}disassemble(e){var t=this;return(0,b.Z)(function*(){return t.capabilities.supportsDisassembleRequest?yield t.send("disassemble",e):Promise.reject(new Error("disassemble is not supported"))})()}readMemory(e){var t=this;return(0,b.Z)(function*(){return t.capabilities.supportsReadMemoryRequest?yield t.send("readMemory",e):Promise.reject(new Error("readMemory is not supported"))})()}writeMemory(e){var t=this;return(0,b.Z)(function*(){return t.capabilities.supportsWriteMemoryRequest?yield t.send("writeMemory",e):Promise.reject(new Error("writeMemory is not supported"))})()}cancel(e){return this.send("cancel",e)}custom(e,t){return this.send(e,t)}shutdown(e,t=!1,i=void 0,n=void 0){var o=this;return(0,b.Z)(function*(){if(!o.inShutdown){if(o.inShutdown=!0,!o.debugAdapter)return o.stopAdapter(e);try{const s={restart:t};"boolean"==typeof i&&(s.terminateDebuggee=i),"boolean"==typeof n&&(s.suspendDebuggee=n),yield o.send("disconnect",s,void 0,2e3)}catch{}finally{yield o.stopAdapter(e)}}})()}stopAdapter(e){var t=this;return(0,b.Z)(function*(){try{if(t.debugAdapter){const i=t.debugAdapter;t.debugAdapter=null,yield i.stopSession(),t.debugAdapterStopped=!0}}finally{t.fireAdapterExitEvent(e)}})()}fireAdapterExitEvent(e){if(!this.firedAdapterExitEvent){this.firedAdapterExitEvent=!0;const t={emittedStopped:this.didReceiveStoppedEvent,sessionLengthInSeconds:((new Date).getTime()-this.startTime)/1e3};e&&!this.debugAdapterStopped&&(t.error=e),this._onDidExitAdapter.fire(t)}}dispatchRequest(e){var t=this;return(0,b.Z)(function*(){const i={type:"response",seq:0,command:e.command,request_seq:e.seq,success:!0},n=o=>t.debugAdapter&&t.debugAdapter.sendResponse(o);if("launchVSCode"===e.command)try{let o=yield t.launchVsCode(e.arguments);if(!o.success){const{confirmed:s}=yield t.dialogSerivce.confirm({type:Ne.zb.Warning,message:l.NC("canNotStart","The debugger needs to open a new tab or window for the debuggee but the browser prevented this. You must give permission to continue."),primaryButton:l.NC({key:"continue",comment:["&& denotes a mnemonic"]},"&&Continue")});s?o=yield t.launchVsCode(e.arguments):(i.success=!1,n(i),yield t.shutdown())}i.body={rendererDebugPort:o.rendererDebugPort},n(i)}catch(o){i.success=!1,i.message=o.message,n(i)}else if("runInTerminal"===e.command)try{const o=yield t.dbgr.runInTerminal(e.arguments,t.sessionId),s=i;s.body={},"number"==typeof o&&(s.body.shellProcessId=o),n(s)}catch(o){i.success=!1,i.message=o.message,n(i)}else if("startDebugging"===e.command)try{const o=e.arguments,s={...o.configuration,request:o.request,type:t.dbgr.type,name:o.configuration.name||t.name};(yield t.dbgr.startDebugging(s,t.sessionId))||(i.success=!1,i.message="Failed to start debugging"),n(i)}catch(o){i.success=!1,i.message=o.message,n(i)}else i.success=!1,i.message=`unknown request '${e.command}'`,n(i)})()}launchVsCode(e){const t=[];for(const i of e.args){const n=(i.prefix||"")+(i.path||""),o=/^--(.+)=(.+)$/.exec(n);if(o&&3===o.length){const s=o[1];let r=o[2];("file-uri"===s||"folder-uri"===s)&&!(0,se.p3)(i.path)&&(r=(0,se.p3)(r)?r:ue.ov.file(r).toString()),t.push(`--${s}=${r}`)}else t.push(n)}return e.env&&t.push(`--extensionEnvironment=${JSON.stringify(e.env)}`),this.extensionHostDebugService.openExtensionDevelopmentHostWindow(t,!!e.debugRenderer)}send(e,t,i,n,o=!0){return new Promise((s,r)=>{if(!this.debugAdapter)return void(this.inShutdown?s(void 0):r(new Error(l.NC("noDebugAdapter","No debugger available found. Can not send '{0}'.",e))));let a;const c=this.debugAdapter.sendRequest(e,t,g=>{a?.dispose(),g.success?s(g):r(g)},n);i&&(a=i.onCancellationRequested(()=>{a.dispose(),this.capabilities.supportsCancelRequest&&this.cancel({requestId:c})}))}).then(void 0,s=>Promise.reject(this.handleErrorResponse(s,o)))}handleErrorResponse(e,t){if("canceled"===e.command&&"canceled"===e.message)return new Me.FU;const i=e?.body?.error,n=e?.message||"",o=i?(0,se.PW)(i.format,!1,i.variables):n,s=i?.url;if(i&&s){const a=i.urlLabel?i.urlLabel:l.NC("moreInfo","More Info"),c=ue.ov.parse(s);return(0,fi.JO)(o,[(0,G.xw)({id:c.scheme===ze.lg.command?"debug.moreInfo.command":"debug.moreInfo",label:a,run:()=>this.openerService.open(c,{allowCommands:!0})})])}t&&i&&i.format&&i.showUser&&this.notificationService.error(o);const r=new Me.QD(o);return r.showUser=i?.showUser,r}mergeCapabilities(e){e&&(this._capabilities=we.jB(this._capabilities,e))}fireSimulatedContinuedEvent(e,t=!1){this._onDidContinued.fire({type:"event",event:"continued",body:{threadId:e,allThreadsContinued:t},seq:void 0})}dispose(){(0,F.B9)(this.toDispose)}};Ri=(0,u.gn)([(0,u.fM)(4,Qn.Q),(0,u.fM)(5,Fe.v4),(0,u.fM)(6,Ne.lT),(0,u.fM)(7,bt.Ss)],Ri);var T=v(33491),vt=v(7428);let xr=0;const Vi=()=>"topReplElement:"+xr++;class Oe{constructor(e,t,i,n,o,s){this.session=e,this.id=t,this.value=i,this.severity=n,this.sourceData=o,this.expression=s,this._count=1,this._onDidChangeCount=new R.Q5}toString(e=!1){let t=this.value;for(let n=1;n<this.count;n++)t+=(t.endsWith("\n")?"":"\n")+this.value;return t+(this.sourceData&&e?` ${this.sourceData.source.name}`:"")}getId(){return this.id}getChildren(){return this.expression?.getChildren()||Promise.resolve([])}set count(e){this._count=e,this._onDidChangeCount.fire()}get count(){return this._count}get onDidChangeCount(){return this._onDidChangeCount.event}get hasChildren(){return!!this.expression?.hasChildren}}class Gt{constructor(e,t,i){this.expr=e,this.severity=t,this.sourceData=i,this.id=(0,et.R)(),this.hasChildren=e.hasChildren}getChildren(){return this.expr.getChildren()}toString(){return this.expr.toString()}getId(){return this.id}}let Er=(()=>{class d{constructor(t,i,n,o,s){this.id=t,this.name=i,this.valueObj=n,this.sourceData=o,this.annotation=s}getId(){return this.id}get value(){return null===this.valueObj?"null":Array.isArray(this.valueObj)?`Array[${this.valueObj.length}]`:(0,j.Kn)(this.valueObj)?"Object":(0,j.HD)(this.valueObj)?`"${this.valueObj}"`:String(this.valueObj)||""}get hasChildren(){return Array.isArray(this.valueObj)&&this.valueObj.length>0||(0,j.Kn)(this.valueObj)&&Object.getOwnPropertyNames(this.valueObj).length>0}evaluateLazy(){throw new Error("Method not implemented.")}getChildren(){let t=[];return Array.isArray(this.valueObj)?t=this.valueObj.slice(0,d.MAX_CHILDREN).map((i,n)=>new d(`${this.id}:${n}`,String(n),i)):(0,j.Kn)(this.valueObj)&&(t=Object.getOwnPropertyNames(this.valueObj).slice(0,d.MAX_CHILDREN).map((i,n)=>new d(`${this.id}:${n}`,i,this.valueObj[i]))),Promise.resolve(t)}toString(){return`${this.name}\n${this.value}`}}return d.MAX_CHILDREN=1e3,d})();class Qt{constructor(e){this.value=e,this.id=(0,et.R)()}toString(){return this.value}getId(){return this.id}}class ot extends T.Ly{get available(){return this._available}constructor(){super(void 0,void 0,0,(0,et.R)()),this._available=!0}evaluateExpression(e,t,i,n){var o=()=>super.evaluateExpression,s=this;return(0,b.Z)(function*(){const r=yield o().call(s,e,t,i,n);return s._available=r,r})()}toString(){return`${this.value}`}}let st=(()=>{class d{constructor(t,i,n){this.name=t,this.autoExpand=i,this.sourceData=n,this.children=[],this.ended=!1,this.id="replGroup:"+d.COUNTER++}get hasChildren(){return!0}getId(){return this.id}toString(t=!1){return this.name+(t&&this.sourceData?` ${this.sourceData.source.name}`:"")}addChild(t){const i=this.children.length?this.children[this.children.length-1]:void 0;i instanceof d&&!i.hasEnded?i.addChild(t):this.children.push(t)}getChildren(){return this.children}end(){const t=this.children.length?this.children[this.children.length-1]:void 0;t instanceof d&&!t.hasEnded?t.end():this.ended=!0}get hasEnded(){return this.ended}}return d.COUNTER=0,d})();class Pi{constructor(e){this.configurationService=e,this.replElements=[],this._onDidChangeElements=new R.Q5,this.onDidChangeElements=this._onDidChangeElements.event}getReplElements(){return this.replElements}addReplExpression(e,t,i){var n=this;return(0,b.Z)(function*(){n.addReplElement(new Qt(i));const o=new ot;yield o.evaluateExpression(i,e,t,"repl"),n.addReplElement(o)})()}appendToRepl(e,{output:t,expression:i,sev:n,source:o}){const r=t.lastIndexOf("\x1b[2J");if(-1!==r&&(this.removeReplExpressions(),this.appendToRepl(e,{output:l.NC("consoleCleared","Console was cleared"),sev:fe.Z.Ignore}),t=t.substring(r+4)),i)return void this.addReplElement(t?new Oe(e,Vi(),t,n,o,i):new Gt(i,n,o));const a=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;if(a instanceof Oe&&a.severity===n){const g=this.configurationService.getValue("debug");if(a.value===t&&function Ir(d,e){return!d&&!e||!(!d||!e)&&d.column===e.column&&d.lineNumber===e.lineNumber&&d.source.uri.toString()===e.source.uri.toString()}(a.sourceData,o)&&g.console.collapseIdenticalLines)return void a.count++;if(!a.value.endsWith("\n")&&!a.value.endsWith("\r\n")&&1===a.count)return this.replElements[this.replElements.length-1]=new Oe(e,Vi(),a.value+t,n,o),void this._onDidChangeElements.fire()}const c=new Oe(e,Vi(),t,n,o);this.addReplElement(c)}startGroup(e,t,i){const n=new st(e,t,i);this.addReplElement(n)}endGroup(){const e=this.replElements[this.replElements.length-1];e instanceof st&&e.end()}addReplElement(e){const t=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;t instanceof st&&!t.hasEnded?t.addChild(e):(this.replElements.push(e),this.replElements.length>1e4&&this.replElements.splice(0,this.replElements.length-1e4)),this._onDidChangeElements.fire()}removeReplExpressions(){this.replElements.length>0&&(this.replElements=[],this._onDidChangeElements.fire())}clone(){const e=new Pi(this.configurationService);return e.replElements=this.replElements.slice(),e}}var lo=v(76148),uo=v(73794);let Fi=class{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m,S,w,M,I,L,N){this.id=e,this._configuration=t,this.root=i,this.model=n,this.debugService=s,this.telemetryService=r,this.hostService=a,this.configurationService=c,this.paneCompositeService=g,this.workspaceContextService=p,this.productService=f,this.notificationService=m,this.uriIdentityService=w,this.instantiationService=M,this.customEndpointTelemetryService=I,this.workbenchEnvironmentService=L,this.logService=N,this.initialized=!1,this.sources=new Map,this.threads=new Map,this.threadIds=[],this.cancellationMap=new Map,this.rawListeners=[],this.stoppedDetails=[],this._onDidChangeState=new R.Q5,this._onDidEndAdapter=new R.Q5,this._onDidLoadedSource=new R.Q5,this._onDidCustomEvent=new R.Q5,this._onDidProgressStart=new R.Q5,this._onDidProgressUpdate=new R.Q5,this._onDidProgressEnd=new R.Q5,this._onDidInvalidMemory=new R.Q5,this._onDidChangeREPLElements=new R.Q5,this._onDidChangeName=new R.Q5,this._options=o||{},this.parentSession=this._options.parentSession,this.repl=this.hasSeparateRepl()?new Pi(this.configurationService):this.parentSession.repl;const B=new F.SL,k=B.add(new F.XK);k.value=this.repl.onDidChangeElements(()=>this._onDidChangeREPLElements.fire()),S&&B.add(S.onWillShutdown(()=>{this.shutdown(),(0,F.B9)(B)}));const P=this._options.compoundRoot;P&&B.add(P.onDidSessionStop(()=>this.terminate())),this.passFocusScheduler=new Q.pY(()=>{if(this.debugService.getModel().getSessions().some(W=>2===W.state)||this.getAllThreads().some(W=>W.stopped))if("number"==typeof this.lastContinuedThreadId){const W=this.debugService.getViewModel().focusedThread;if(W&&W.threadId===this.lastContinuedThreadId&&!W.stopped){const O=this.getStoppedDetails()?.threadId,ie="number"==typeof O?this.getThread(O):void 0;this.debugService.focusStackFrame(void 0,ie)}}else{const W=this.debugService.getViewModel().focusedSession;W&&W.getId()===this.getId()&&2!==W.state&&this.debugService.focusStackFrame(void 0)}},800);const _=this._options.parentSession;_&&B.add(_.onDidEndAdapter(()=>{!this.hasSeparateRepl()&&!1===this.raw?.isInShutdown&&(this.repl=this.repl.clone(),k.value=this.repl.onDidChangeElements(()=>this._onDidChangeREPLElements.fire()),this.parentSession=void 0)}))}getId(){return this.id}setSubId(e){this._subId=e}getMemory(e){return new T.Br(e,this)}get subId(){return this._subId}get configuration(){return this._configuration.resolved}get unresolvedConfiguration(){return this._configuration.unresolved}get lifecycleManagedByParent(){return!!this._options.lifecycleManagedByParent}get compact(){return!!this._options.compact}get saveBeforeRestart(){return this._options.saveBeforeRestart??!this._options?.parentSession}get compoundRoot(){return this._options.compoundRoot}get suppressDebugStatusbar(){return this._options.suppressDebugStatusbar??!1}get suppressDebugToolbar(){return this._options.suppressDebugToolbar??!1}get suppressDebugView(){return this._options.suppressDebugView??!1}get autoExpandLazyVariables(){return this.configurationService.getValue("debug").autoExpandLazyVariables}setConfiguration(e){this._configuration=e}getLabel(){return this.workspaceContextService.getWorkspace().folders.length>1&&this.root?`${this.name} (${oo.Hx(this.root.uri)})`:this.name}setName(e){this._name=e,this._onDidChangeName.fire(e)}get name(){return this._name||this.configuration.name}get state(){if(!this.initialized)return 1;if(!this.raw)return 0;const e=this.debugService.getViewModel().focusedThread;return e&&e.session===this?e.stopped?2:3:this.getAllThreads().some(t=>t.stopped)?2:3}get capabilities(){return this.raw?this.raw.capabilities:Object.create(null)}get onDidChangeState(){return this._onDidChangeState.event}get onDidEndAdapter(){return this._onDidEndAdapter.event}get onDidChangeReplElements(){return this._onDidChangeREPLElements.event}get onDidChangeName(){return this._onDidChangeName.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidateMemory(){return this._onDidInvalidMemory.event}initialize(e){var t=this;return(0,b.Z)(function*(){t.raw&&(yield t.shutdown());try{const i=yield e.createDebugAdapter(t);t.raw=t.instantiationService.createInstance(Ri,i,e,t.id,t.configuration.name),yield t.raw.start(),t.registerListeners(),yield t.raw.initialize({clientID:"vscode",clientName:t.productService.nameLong,adapterID:t.configuration.type,pathFormat:"path",linesStartAt1:!0,columnsStartAt1:!0,supportsVariableType:!0,supportsVariablePaging:!0,supportsRunInTerminalRequest:!0,locale:re.dK,supportsProgressReporting:!0,supportsInvalidatedEvent:!0,supportsMemoryReferences:!0,supportsArgsCanBeInterpretedByShell:!0,supportsMemoryEvent:!0,supportsStartDebuggingRequest:!0}),t.initialized=!0,t._onDidChangeState.fire(),t.debugService.setExceptionBreakpointsForSession(t,t.raw&&t.raw.capabilities.exceptionBreakpointFilters||[])}catch(i){throw t.initialized=!0,t._onDidChangeState.fire(),yield t.shutdown(),i}})()}launchOrAttach(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","launch or attach"));if(t.parentSession&&0===t.parentSession.state)throw(0,Me.F0)();e.__sessionId=t.getId();try{yield t.raw.launchOrAttach(e)}catch(i){throw t.shutdown(),i}})()}terminate(e=!1){var t=this;return(0,b.Z)(function*(){t.raw||t.onDidExitAdapter(),t.cancelAllRequests(),t._options.lifecycleManagedByParent&&t.parentSession?yield t.parentSession.terminate(e):t.raw&&(t.raw.capabilities.supportsTerminateRequest&&"launch"===t._configuration.resolved.request?yield t.raw.terminate(e):yield t.raw.disconnect({restart:e,terminateDebuggee:!0})),e||t._options.compoundRoot?.sessionStopped()})()}disconnect(e=!1,t=!1){var i=this;return(0,b.Z)(function*(){i.raw||i.onDidExitAdapter(),i.cancelAllRequests(),i._options.lifecycleManagedByParent&&i.parentSession?yield i.parentSession.disconnect(e,t):i.raw&&(yield i.raw.disconnect({restart:e,terminateDebuggee:!1,suspendDebuggee:t})),e||i._options.compoundRoot?.sessionStopped()})()}restart(){var e=this;return(0,b.Z)(function*(){if(!e.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","restart"));e.cancelAllRequests(),e._options.lifecycleManagedByParent&&e.parentSession?yield e.parentSession.restart():yield e.raw.restart({arguments:e.configuration})})()}sendBreakpoints(e,t,i){var n=this;return(0,b.Z)(function*(){if(!n.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints"));if(!n.raw.readyForBreakpoints)return Promise.resolve(void 0);const o=n.getRawSource(e);t.length&&!o.adapterData&&(o.adapterData=t[0].adapterData),o.path&&(o.path=(0,Bi.DT)(o.path));const s=yield n.raw.setBreakpoints({source:o,lines:t.map(r=>r.sessionAgnosticData.lineNumber),breakpoints:t.map(r=>({line:r.sessionAgnosticData.lineNumber,column:r.sessionAgnosticData.column,condition:r.condition,hitCondition:r.hitCondition,logMessage:r.logMessage})),sourceModified:i});if(s&&s.body){const r=new Map;for(let a=0;a<t.length;a++)r.set(t[a].getId(),s.body.breakpoints[a]);n.model.setBreakpointSessionData(n.getId(),n.capabilities,r)}})()}sendFunctionBreakpoints(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","function breakpoints"));if(t.raw.readyForBreakpoints){const i=yield t.raw.setFunctionBreakpoints({breakpoints:e});if(i&&i.body){const n=new Map;for(let o=0;o<e.length;o++)n.set(e[o].getId(),i.body.breakpoints[o]);t.model.setBreakpointSessionData(t.getId(),t.capabilities,n)}}})()}sendExceptionBreakpoints(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","exception breakpoints"));if(t.raw.readyForBreakpoints){const i=t.capabilities.supportsExceptionFilterOptions?{filters:[],filterOptions:e.map(o=>o.condition?{filterId:o.filter,condition:o.condition}:{filterId:o.filter})}:{filters:e.map(o=>o.filter)},n=yield t.raw.setExceptionBreakpoints(i);if(n&&n.body&&n.body.breakpoints){const o=new Map;for(let s=0;s<e.length;s++)o.set(e[s].getId(),n.body.breakpoints[s]);t.model.setBreakpointSessionData(t.getId(),t.capabilities,o)}}})()}dataBreakpointInfo(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints info"));if(!i.raw.readyForBreakpoints)throw new Error((0,l.NC)("sessionNotReadyForBreakpoints","Session is not ready for breakpoints"));return(yield i.raw.dataBreakpointInfo({name:e,variablesReference:t}))?.body})()}sendDataBreakpoints(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints"));if(t.raw.readyForBreakpoints){const i=yield t.raw.setDataBreakpoints({breakpoints:e});if(i&&i.body){const n=new Map;for(let o=0;o<e.length;o++)n.set(e[o].getId(),i.body.breakpoints[o]);t.model.setBreakpointSessionData(t.getId(),t.capabilities,n)}}})()}sendInstructionBreakpoints(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","instruction breakpoints"));if(t.raw.readyForBreakpoints){const i=yield t.raw.setInstructionBreakpoints({breakpoints:e});if(i&&i.body){const n=new Map;for(let o=0;o<e.length;o++)n.set(e[o].getId(),i.body.breakpoints[o]);t.model.setBreakpointSessionData(t.getId(),t.capabilities,n)}}})()}breakpointsLocations(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints locations"));const n=i.getRawSource(e),o=yield i.raw.breakpointLocations({source:n,line:t});if(!o||!o.body||!o.body.breakpoints)return[];const s=o.body.breakpoints.map(r=>({lineNumber:r.line,column:r.column||1}));return(0,de.EB)(s,r=>`${r.lineNumber}:${r.column}`)})()}getDebugProtocolBreakpoint(e){return this.model.getDebugProtocolBreakpoint(e,this.getId())}customRequest(e,t){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'",e));return this.raw.custom(e,t)}stackTrace(e,t,i,n){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stackTrace"));const o=this.getNewCancellationToken(e,n);return this.raw.stackTrace({threadId:e,startFrame:t,levels:i},o)}exceptionInfo(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","exceptionInfo"));const i=yield t.raw.exceptionInfo({threadId:e});if(i)return{id:i.body.exceptionId,description:i.body.description,breakMode:i.body.breakMode,details:i.body.details}})()}scopes(e,t){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","scopes"));const i=this.getNewCancellationToken(t);return this.raw.scopes({frameId:e},i)}variables(e,t,i,n,o){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","variables"));const s=t?this.getNewCancellationToken(t):void 0;return this.raw.variables({variablesReference:e,filter:i,start:n,count:o},s)}evaluate(e,t,i){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","evaluate"));return this.raw.evaluate({expression:e,frameId:t,context:i})}restartFrame(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","restartFrame"));yield i.raw.restartFrame({frameId:e},t)})()}setLastSteppingGranularity(e,t){const i=this.getThread(e);i&&(i.lastSteppingGranularity=t)}next(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","next"));i.setLastSteppingGranularity(e,t),yield i.raw.next({threadId:e,granularity:t})})()}stepIn(e,t,i){var n=this;return(0,b.Z)(function*(){if(!n.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepIn"));n.setLastSteppingGranularity(e,i),yield n.raw.stepIn({threadId:e,targetId:t,granularity:i})})()}stepOut(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepOut"));i.setLastSteppingGranularity(e,t),yield i.raw.stepOut({threadId:e,granularity:t})})()}stepBack(e,t){var i=this;return(0,b.Z)(function*(){if(!i.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepBack"));i.setLastSteppingGranularity(e,t),yield i.raw.stepBack({threadId:e,granularity:t})})()}continue(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","continue"));yield t.raw.continue({threadId:e})})()}reverseContinue(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","reverse continue"));yield t.raw.reverseContinue({threadId:e})})()}pause(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","pause"));yield t.raw.pause({threadId:e})})()}terminateThreads(e){var t=this;return(0,b.Z)(function*(){if(!t.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","terminateThreads"));yield t.raw.terminateThreads({threadIds:e})})()}setVariable(e,t,i){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","setVariable"));return this.raw.setVariable({variablesReference:e,name:t,value:i})}setExpression(e,t,i){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","setExpression"));return this.raw.setExpression({expression:t,value:i,frameId:e})}gotoTargets(e,t,i){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","gotoTargets"));return this.raw.gotoTargets({source:e,line:t,column:i})}goto(e,t){if(!this.raw)throw new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","goto"));return this.raw.goto({threadId:e,targetId:t})}loadSource(e){if(!this.raw)return Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","loadSource")));const t=this.getSourceForUri(e);let i;if(t)i=t.raw;else{const n=vt.Hw.getEncodedDebugData(e);i={path:n.path,sourceReference:n.sourceReference}}return this.raw.source({sourceReference:i.sourceReference||0,source:i})}getLoadedSources(){var e=this;return(0,b.Z)(function*(){if(!e.raw)return Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","getLoadedSources")));const t=yield e.raw.loadedSources({});return t&&t.body&&t.body.sources?t.body.sources.map(i=>e.getSource(i)):[]})()}completions(e,t,i,n,o,s){var r=this;return(0,b.Z)(function*(){if(!r.raw)return Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","completions")));const a=r.getNewCancellationToken(t,s);return r.raw.completions({frameId:e,text:i,column:n.column,line:n.lineNumber},a)})()}stepInTargets(e){var t=this;return(0,b.Z)(function*(){return t.raw?(yield t.raw.stepInTargets({frameId:e}))?.body.targets:Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepInTargets")))})()}cancel(e){var t=this;return(0,b.Z)(function*(){return t.raw?t.raw.cancel({progressId:e}):Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","cancel")))})()}disassemble(e,t,i,n){var o=this;return(0,b.Z)(function*(){return o.raw?(yield o.raw.disassemble({memoryReference:e,offset:t,instructionOffset:i,instructionCount:n,resolveSymbols:!0}))?.body?.instructions:Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")))})()}readMemory(e,t,i){return this.raw?this.raw.readMemory({count:i,memoryReference:e,offset:t}):Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","readMemory")))}writeMemory(e,t,i,n){return this.raw?this.raw.writeMemory({memoryReference:e,offset:t,allowPartial:n,data:i}):Promise.reject(new Error((0,l.NC)("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")))}getThread(e){return this.threads.get(e)}getAllThreads(){const e=[];return this.threadIds.forEach(t=>{const i=this.threads.get(t);i&&e.push(i)}),e}clearThreads(e,t=void 0){if(null!=t){const i=this.threads.get(t);i&&(i.clearCallStack(),i.stoppedDetails=void 0,i.stopped=!1,e&&this.threads.delete(t))}else this.threads.forEach(i=>{i.clearCallStack(),i.stoppedDetails=void 0,i.stopped=!1}),e&&(this.threads.clear(),this.threadIds=[],T.Ly.allValues.clear())}getStoppedDetails(){return this.stoppedDetails.length>=1?this.stoppedDetails[0]:void 0}rawUpdate(e){this.threadIds=[],e.threads.forEach(i=>{if(this.threadIds.push(i.id),this.threads.has(i.id)){if(i.name){const n=this.threads.get(i.id);n&&(n.name=i.name)}}else this.threads.set(i.id,new T.jz(this,i.name,i.id))}),this.threads.forEach(i=>{-1===this.threadIds.indexOf(i.threadId)&&this.threads.delete(i.threadId)});const t=e.stoppedDetails;if(t)if(t.allThreadsStopped)this.threads.forEach(i=>{i.stoppedDetails=i.threadId===t.threadId?t:{reason:i.stoppedDetails?.reason},i.stopped=!0,i.clearCallStack()});else{const i="number"==typeof t.threadId?this.threads.get(t.threadId):void 0;i&&(i.stoppedDetails=t,i.clearCallStack(),i.stopped=!0)}}fetchThreads(e){var t=this;return(0,b.Z)(function*(){if(t.raw){const i=yield t.raw.threads();i&&i.body&&i.body.threads&&t.model.rawUpdate({sessionId:t.getId(),threads:i.body.threads,stoppedDetails:e})}})()}initializeForTest(e){this.raw=e,this.registerListeners()}registerListeners(){var e=this;if(!this.raw)return;this.rawListeners.push(this.raw.onDidInitialize((0,b.Z)(function*(){Ze.i7((0,l.NC)("debuggingStarted","Debugging started."));const n=function(){var o=(0,b.Z)(function*(){if(e.raw&&e.raw.capabilities.supportsConfigurationDoneRequest)try{yield e.raw.configurationDone()}catch(s){e.notificationService.error(s),e.raw?.disconnect({})}});return function(){return o.apply(this,arguments)}}();try{yield e.debugService.sendAllBreakpoints(e)}finally{yield n(),yield e.fetchThreads()}})));const t=new Q.ci;this.rawListeners.push(this.raw.onDidStop(function(){var n=(0,b.Z)(function*(o){t.queue((0,b.Z)(function*(){e.passFocusScheduler.cancel(),e.stoppedDetails.push(o.body),yield e.fetchThreads(o.body);const s=e.debugService.getViewModel().focusedThread,r=void 0!==s&&s.session===e&&!e.threads.has(s.threadId);r&&e.debugService.focusStackFrame(void 0,void 0);const a="number"==typeof o.body.threadId?e.getThread(o.body.threadId):void 0;if(a){const c=e.model.refreshTopOfCallstack(a),g=function(){var f=(0,b.Z)(function*(){if(r||!o.body.preserveFocusHint&&a.getCallStack().length){const m=e.debugService.getViewModel().focusedStackFrame;if(!m||m.thread.session===e){const S=!e.configurationService.getValue("debug").focusEditorOnBreak;yield e.debugService.focusStackFrame(void 0,a,void 0,{preserveFocus:S})}a.stoppedDetails&&("breakpoint"===a.stoppedDetails.reason&&"openOnDebugBreak"===e.configurationService.getValue("debug").openDebug&&!e.suppressDebugView&&(yield e.paneCompositeService.openPaneComposite(h.f3,0)),e.configurationService.getValue("debug").focusWindowOnBreak&&!e.workbenchEnvironmentService.extensionTestsLocationURI&&(yield e.hostService.focus({force:!0})))}});return function(){return f.apply(this,arguments)}}();yield c.topCallStack,g(),yield c.wholeCallStack;const p=e.debugService.getViewModel().focusedStackFrame;(!p||!p.source||"deemphasize"===p.source.presentationHint||"deemphasize"===p.presentationHint)&&g()}e._onDidChangeState.fire()}))});return function(o){return n.apply(this,arguments)}}())),this.rawListeners.push(this.raw.onDidThread(n=>{t.queue((0,b.Z)(function*(){if("started"===n.body.reason)e.fetchThreadsScheduler||(e.fetchThreadsScheduler=new Q.pY(()=>{e.fetchThreads()},100),e.rawListeners.push(e.fetchThreadsScheduler)),e.fetchThreadsScheduler.isScheduled()||e.fetchThreadsScheduler.schedule();else if("exited"===n.body.reason){e.model.clearThreads(e.getId(),!0,n.body.threadId);const o=e.debugService.getViewModel(),s=o.focusedThread;e.passFocusScheduler.cancel(),s&&n.body.threadId===s.threadId&&e.debugService.focusStackFrame(void 0,void 0,o.focusedSession,{explicit:!1})}}))})),this.rawListeners.push(this.raw.onDidTerminateDebugee(function(){var n=(0,b.Z)(function*(o){Ze.i7((0,l.NC)("debuggingStopped","Debugging stopped.")),o.body&&o.body.restart?yield e.debugService.restartSession(e,o.body.restart):e.raw&&(yield e.raw.disconnect({terminateDebuggee:!1}))});return function(o){return n.apply(this,arguments)}}())),this.rawListeners.push(this.raw.onDidContinued(n=>{t.queue((0,b.Z)(function*(){const o=!1!==n.body.allThreadsContinued?void 0:n.body.threadId;if("number"==typeof o){e.stoppedDetails=e.stoppedDetails.filter(r=>r.threadId!==o);const s=e.cancellationMap.get(o);e.cancellationMap.delete(o),s?.forEach(r=>r.cancel())}else e.stoppedDetails=[],e.cancelAllRequests();e.lastContinuedThreadId=o,e.passFocusScheduler.schedule(),e.model.clearThreads(e.getId(),!1,o),e._onDidChangeState.fire()}))}));const i=new Q.ci;this.rawListeners.push(this.raw.onDidOutput(function(){var n=(0,b.Z)(function*(o){const s="stderr"===o.body.category?fe.Z.Error:"console"===o.body.category?fe.Z.Warning:fe.Z.Info;if(o.body.variablesReference){const r=o.body.source&&o.body.line?{lineNumber:o.body.line,column:o.body.column?o.body.column:1,source:e.getSource(o.body.source)}:void 0,c=new T.Ly(e,void 0,o.body.variablesReference,(0,et.R)()).getChildren();i.queue((0,b.Z)(function*(){const g=yield c;1!==g.length?g.forEach(p=>{p.name=null,e.appendToRepl({output:"",expression:p,sev:s,source:r},"important"===o.body.category)}):e.appendToRepl({output:o.body.output,expression:g[0],sev:s,source:r},"important"===o.body.category)}))}else i.queue((0,b.Z)(function*(){if(!o.body||!e.raw)return;if("telemetry"===o.body.category){const a=e.raw.dbgr.getCustomTelemetryEndpoint();if(a&&0!==e.telemetryService.telemetryLevel){let c=o.body.data;!a.sendErrorTelemetry&&o.body.data&&(c=(0,se.Xc)(o.body.data)),e.customEndpointTelemetryService.publicLog(a,o.body.output,c)}return}const r=o.body.source&&o.body.line?{lineNumber:o.body.line,column:o.body.column?o.body.column:1,source:e.getSource(o.body.source)}:void 0;"start"!==o.body.group&&"startCollapsed"!==o.body.group?"end"===o.body.group&&(e.repl.endGroup(),!o.body.output)||"string"==typeof o.body.output&&e.appendToRepl({output:o.body.output,sev:s,source:r},"important"===o.body.category):e.repl.startGroup(o.body.output||"","start"===o.body.group,r)}))});return function(o){return n.apply(this,arguments)}}())),this.rawListeners.push(this.raw.onDidBreakpoint(n=>{const o=n.body&&n.body.breakpoint?n.body.breakpoint.id:void 0,s=this.model.getBreakpoints().find(g=>g.getIdFromAdapter(this.getId())===o),r=this.model.getFunctionBreakpoints().find(g=>g.getIdFromAdapter(this.getId())===o),a=this.model.getDataBreakpoints().find(g=>g.getIdFromAdapter(this.getId())===o),c=this.model.getExceptionBreakpoints().find(g=>g.getIdFromAdapter(this.getId())===o);if("new"===n.body.reason&&n.body.breakpoint.source&&n.body.breakpoint.line){const g=this.getSource(n.body.breakpoint.source),p=this.model.addBreakpoints(g.uri,[{column:n.body.breakpoint.column,enabled:!0,lineNumber:n.body.breakpoint.line}],!1);if(1===p.length){const f=new Map([[p[0].getId(),n.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,f)}}if("removed"===n.body.reason&&(s&&this.model.removeBreakpoints([s]),r&&this.model.removeFunctionBreakpoints(r.getId()),a&&this.model.removeDataBreakpoints(a.getId())),"changed"===n.body.reason){if(s){s.column||(n.body.breakpoint.column=void 0);const g=new Map([[s.getId(),n.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,g)}if(r){const g=new Map([[r.getId(),n.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,g)}if(a){const g=new Map([[a.getId(),n.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,g)}if(c){const g=new Map([[c.getId(),n.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,g)}}})),this.rawListeners.push(this.raw.onDidLoadedSource(n=>{this._onDidLoadedSource.fire({reason:n.body.reason,source:this.getSource(n.body.source)})})),this.rawListeners.push(this.raw.onDidCustomEvent(n=>{this._onDidCustomEvent.fire(n)})),this.rawListeners.push(this.raw.onDidProgressStart(n=>{this._onDidProgressStart.fire(n)})),this.rawListeners.push(this.raw.onDidProgressUpdate(n=>{this._onDidProgressUpdate.fire(n)})),this.rawListeners.push(this.raw.onDidProgressEnd(n=>{this._onDidProgressEnd.fire(n)})),this.rawListeners.push(this.raw.onDidInvalidateMemory(n=>{this._onDidInvalidMemory.fire(n)})),this.rawListeners.push(this.raw.onDidInvalidated(function(){var n=(0,b.Z)(function*(o){o.body.areas&&1===o.body.areas.length&&("variables"===o.body.areas[0]||"watch"===o.body.areas[0])||(e.cancelAllRequests(),e.model.clearThreads(e.getId(),!0),yield e.fetchThreads(e.getStoppedDetails()));const s=e.debugService.getViewModel();s.focusedSession===e&&s.updateViews()});return function(o){return n.apply(this,arguments)}}())),this.rawListeners.push(this.raw.onDidExitAdapter(n=>this.onDidExitAdapter(n)))}onDidExitAdapter(e){this.initialized=!0,this.model.setBreakpointSessionData(this.getId(),this.capabilities,void 0),this.shutdown(),this._onDidEndAdapter.fire(e)}shutdown(){(0,F.B9)(this.rawListeners),this.raw&&(this.raw.disconnect({}),this.raw.dispose(),this.raw=void 0),this.fetchThreadsScheduler?.dispose(),this.fetchThreadsScheduler=void 0,this.passFocusScheduler.cancel(),this.passFocusScheduler.dispose(),this.model.clearThreads(this.getId(),!0),this._onDidChangeState.fire()}getSourceForUri(e){return this.sources.get(this.uriIdentityService.asCanonicalUri(e).toString())}getSource(e){let t=new vt.Hw(e,this.getId(),this.uriIdentityService,this.logService);const i=t.uri.toString(),n=this.sources.get(i);return n?(t=n,t.raw=(0,we.jB)(t.raw,e),t.raw&&e&&(t.raw.presentationHint=e.presentationHint)):this.sources.set(i,t),t}getRawSource(e){const t=this.getSourceForUri(e);if(t)return t.raw;{const i=vt.Hw.getEncodedDebugData(e);return{name:i.name,path:i.path,sourceReference:i.sourceReference}}}getNewCancellationToken(e,t){const i=new Ie.A(t),n=this.cancellationMap.get(e)||[];return n.push(i),this.cancellationMap.set(e,n),i.token}cancelAllRequests(){this.cancellationMap.forEach(e=>e.forEach(t=>t.cancel())),this.cancellationMap.clear()}getReplElements(){return this.repl.getReplElements()}hasSeparateRepl(){return!this.parentSession||"mergeWithParent"!==this._options.repl}removeReplExpressions(){this.repl.removeReplExpressions()}addReplExpression(e,t){var i=this;return(0,b.Z)(function*(){yield i.repl.addReplExpression(i,e,t),i.debugService.getViewModel().updateViews()})()}appendToRepl(e,t){this.repl.appendToRepl(this,e),t&&this.notificationService.notify({message:e.output.toString(),severity:e.sev,source:this.name})}};Fi=(0,u.gn)([(0,u.fM)(5,h.tn),(0,u.fM)(6,be.bU),(0,u.fM)(7,lo.$),(0,u.fM)(8,Z.Ui),(0,u.fM)(9,uo.c),(0,u.fM)(10,Te.ec),(0,u.fM)(11,Dr.a),(0,u.fM)(12,Ne.lT),(0,u.fM)(13,Di.g),(0,u.fM)(14,ke.v),(0,u.fM)(15,q.TG),(0,u.fM)(16,be.$h),(0,u.fM)(17,vi.n),(0,u.fM)(18,nt.VZ)],Fi);var ho=v(97868),Mr=v(16170),go=v(81026);function Oi(d,e){return(t,i=null,n)=>{const o=e(s=>{if(d(s))return o.dispose(),t.call(i,s)},null,n);return o}}const po="debug.taskerrorchoice";let Hi=class{constructor(e,t,i,n,o,s,r){this.taskService=e,this.markerService=t,this.configurationService=i,this.viewsService=n,this.dialogService=o,this.storageService=s,this.commandService=r,this.canceled=!1}cancel(){this.canceled=!0}runTaskAndCheckErrors(e,t){var i=this;return(0,b.Z)(function*(){try{i.canceled=!1;const n=yield i.runTask(e,t);if(i.canceled||n&&void 0===n.exitCode)return 0;const o=t?i.markerService.read({severities:go.ZL.Error,take:2}).length:0,s=n&&0===n.exitCode,r=n&&0!==n.exitCode,a=i.configurationService.getValue("debug").onTaskErrors;if(s||"debugAnyway"===a||0===o&&!r)return 1;if("showErrors"===a)return yield i.viewsService.openView(ho.s.MARKERS_VIEW_ID,!0),Promise.resolve(0);if("abort"===a)return Promise.resolve(0);const c="string"==typeof t?t:t?t.name:"",g=o>1?l.NC("preLaunchTaskErrors","Errors exist after running preLaunchTask '{0}'.",c):1===o?l.NC("preLaunchTaskError","Error exists after running preLaunchTask '{0}'.",c):n&&"number"==typeof n.exitCode?l.NC("preLaunchTaskExitCode","The preLaunchTask '{0}' terminated with exit code {1}.",c,n.exitCode):l.NC("preLaunchTaskTerminated","The preLaunchTask '{0}' terminated.",c);let p;(M=p||(p={}))[M.DebugAnyway=1]="DebugAnyway",M[M.ShowErrors=2]="ShowErrors",M[M.Cancel=0]="Cancel";const{result:f,checkboxChecked:m}=yield i.dialogService.prompt({type:fe.Z.Warning,message:g,buttons:[{label:l.NC({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),run:()=>p.DebugAnyway},{label:l.NC({key:"showErrors",comment:["&& denotes a mnemonic"]},"&&Show Errors"),run:()=>p.ShowErrors}],cancelButton:{label:l.NC("abort","Abort"),run:()=>p.Cancel},checkbox:{label:l.NC("remember","Remember my choice in user settings")}}),S=f===p.DebugAnyway,w=f===p.Cancel;return m&&i.configurationService.updateValue("debug.onTaskErrors",f===p.DebugAnyway?"debugAnyway":w?"abort":"showErrors"),w?Promise.resolve(0):S?1:(yield i.viewsService.openView(ho.s.MARKERS_VIEW_ID,!0),Promise.resolve(0))}catch(n){const o=i.taskService.configureAction(),s=JSON.parse(i.storageService.get(po,1,"{}"));let a,r=-1;if((c=a||(a={}))[c.DebugAnyway=0]="DebugAnyway",c[c.ConfigureTask=1]="ConfigureTask",c[c.Cancel=2]="Cancel",void 0!==s[n.message])r=s[n.message];else{const{result:c,checkboxChecked:g}=yield i.dialogService.prompt({type:fe.Z.Error,message:n.message,buttons:[{label:l.NC({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),run:()=>a.DebugAnyway},{label:o.label,run:()=>a.ConfigureTask}],cancelButton:{run:()=>a.Cancel},checkbox:{label:l.NC("rememberTask","Remember my choice for this task")}});r=c,g&&(s[n.message]=r,i.storageService.store(po,JSON.stringify(s),1,1))}return r===a.ConfigureTask&&(yield o.run()),r===a.DebugAnyway?1:0}var c,M})()}runTask(e,t){var i=this;return(0,b.Z)(function*(){if(!t)return Promise.resolve(null);if(!e)return Promise.reject(new Error(l.NC("invalidTaskReference","Task '{0}' can not be referenced from a launch configuration that is in a different workspace folder.","string"==typeof t?t:t.type)));const n=yield i.taskService.getTask(e,t);if(!n){const a="string"==typeof t?l.NC("DebugTaskNotFoundWithTaskId","Could not find the task '{0}'.",t):l.NC("DebugTaskNotFound","Could not find the specified task.");return Promise.reject((0,fi.JO)(a,[new G.aU(C.TP,C.cG,void 0,!0,()=>i.commandService.executeCommand(C.TP))]))}let o=!1;const s=new Promise((a,c)=>Oi(g=>("inactive"===g.kind||"processEnded"===g.kind&&void 0===g.exitCode)&&g.taskId===n._id,i.taskService.onDidStateChange)(g=>{o=!0,a("processEnded"===g.kind?{exitCode:g.exitCode}:null)})),r=i.taskService.getActiveTasks().then(function(){var a=(0,b.Z)(function*(c){if(c.find(p=>p._id===n._id))return(yield i.taskService.getBusyTasks()).find(f=>f._id===n._id)?(o=!0,s):Promise.resolve(null);Oi(p=>("active"===p.kind||"dependsOnStarted"===p.kind)&&p.taskId===n._id,i.taskService.onDidStateChange)(()=>{o=!0});const g=i.taskService.run(n);return n.configurationProperties.isBackground?s:g.then(j.M2)});return function(c){return a.apply(this,arguments)}}());return new Promise((a,c)=>{const g=new Promise(p=>Oi(f=>"acquiredInput"===f.kind&&f.taskId===n._id,i.taskService.onDidStateChange)(()=>{p()}));r.then(p=>{o=!0,a(p)},p=>c(p)),g.then(()=>{setTimeout(()=>{if(!o){const f="string"==typeof t?l.NC("taskNotTrackedWithTaskId","The task '{0}' cannot be tracked. Make sure to have a problem matcher defined.",t):l.NC("taskNotTracked","The task '{0}' cannot be tracked. Make sure to have a problem matcher defined.",JSON.stringify(t));c({severity:fe.Z.Error,message:f})}},n.configurationProperties.isBackground?5e3:1e4)})})})()}};Hi=(0,u.gn)([(0,u.fM)(0,Mr.mh),(0,u.fM)(1,go.lT),(0,u.fM)(2,Z.Ui),(0,u.fM)(3,J.qC),(0,u.fM)(4,bt.Ss),(0,u.fM)(5,Pe.Uy),(0,u.fM)(6,ne.H)],Hi);class Nr{constructor(){this.stopped=!1,this.stopEmitter=new R.Q5,this.onDidSessionStop=this.stopEmitter.event}sessionStopped(){this.stopped||(this.stopped=!0,this.stopEmitter.fire())}}const Wi="debug.breakpoint",_i="debug.functionbreakpoint",Ui="debug.databreakpoint",$i="debug.exceptionbreakpoint",Zi="debug.watchexpressions",fo="debug.chosenenvironment",bo="debug.uxstate";let zi=class{constructor(e,t,i,n){this.storageService=e,this.textFileService=t,this.uriIdentityService=i,this.logService=n}loadDebugUxState(){return this.storageService.get(bo,1,"default")}storeDebugUxState(e){this.storageService.store(bo,e,1,1)}loadBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(Wi,1,"[]")).map(t=>new T.Uo(ue.ov.parse(t.uri.external||t.source.uri.external),t.lineNumber,t.column,t.enabled,t.condition,t.hitCondition,t.logMessage,t.adapterData,this.textFileService,this.uriIdentityService,this.logService,t.id))}catch{}return e||[]}loadFunctionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(_i,1,"[]")).map(t=>new T.Tp(t.name,t.enabled,t.hitCondition,t.condition,t.logMessage,t.id))}catch{}return e||[]}loadExceptionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get($i,1,"[]")).map(t=>new T.hO(t.filter,t.label,t.enabled,t.supportsCondition,t.condition,t.description,t.conditionDescription,!!t.fallback))}catch{}return e||[]}loadDataBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(Ui,1,"[]")).map(t=>new T.K1(t.description,t.dataId,!0,t.enabled,t.hitCondition,t.condition,t.logMessage,t.accessTypes,t.accessType,t.id))}catch{}return e||[]}loadWatchExpressions(){let e;try{e=JSON.parse(this.storageService.get(Zi,1,"[]")).map(t=>new T.A2(t.name,t.id))}catch{}return e||[]}loadChosenEnvironments(){return JSON.parse(this.storageService.get(fo,1,"{}"))}storeChosenEnvironments(e){this.storageService.store(fo,JSON.stringify(e),1,1)}storeWatchExpressions(e){e.length?this.storageService.store(Zi,JSON.stringify(e.map(t=>({name:t.name,id:t.getId()}))),1,1):this.storageService.remove(Zi,1)}storeBreakpoints(e){const t=e.getBreakpoints();t.length?this.storageService.store(Wi,JSON.stringify(t),1,1):this.storageService.remove(Wi,1);const i=e.getFunctionBreakpoints();i.length?this.storageService.store(_i,JSON.stringify(i),1,1):this.storageService.remove(_i,1);const n=e.getDataBreakpoints().filter(s=>s.canPersist);n.length?this.storageService.store(Ui,JSON.stringify(n),1,1):this.storageService.remove(Ui,1);const o=e.getExceptionBreakpoints();o.length?this.storageService.store($i,JSON.stringify(o),1,1):this.storageService.remove($i,1)}};zi=(0,u.gn)([(0,u.fM)(0,Pe.Uy),(0,u.fM)(1,so.MM),(0,u.fM)(2,ke.v),(0,u.fM)(3,nt.VZ)],zi);let ji=class{constructor(e,t){this.model=e,this.telemetryService=t}logDebugSessionStart(e,t){const i=e.getMainExtensionDescriptor();this.telemetryService.publicLog("debugSessionStart",{type:e.type,breakpointCount:this.model.getBreakpoints().length,exceptionBreakpoints:this.model.getExceptionBreakpoints(),watchExpressionsCount:this.model.getWatchExpressions().length,extensionName:i.identifier.value,isBuiltin:i.isBuiltin,launchJsonExists:t})}logDebugSessionStop(e,t){const i=this.model.getBreakpoints();this.telemetryService.publicLog("debugSessionStop",{type:e&&e.configuration.type,success:t.emittedStopped||0===i.length,sessionLengthInSeconds:t.sessionLengthInSeconds,breakpointCount:i.length,watchExpressionsCount:this.model.getWatchExpressions().length})}};ji=(0,u.gn)([(0,u.fM)(1,be.bU)],ji);class Tr{constructor(e){this.contextKeyService=e,this.firstSessionStart=!0,this._onDidFocusSession=new R.Q5,this._onDidFocusThread=new R.Q5,this._onDidFocusStackFrame=new R.Q5,this._onDidSelectExpression=new R.Q5,this._onDidEvaluateLazyExpression=new R.Q5,this._onWillUpdateViews=new R.Q5,e.bufferChangeEvents(()=>{this.expressionSelectedContextKey=h.xT.bindTo(e),this.loadedScriptsSupportedContextKey=h.NJ.bindTo(e),this.stepBackSupportedContextKey=h.RX.bindTo(e),this.focusedSessionIsAttach=h.dU.bindTo(e),this.restartFrameSupportedContextKey=h.wx.bindTo(e),this.stepIntoTargetsSupported=h.o8.bindTo(e),this.jumpToCursorSupported=h.dr.bindTo(e),this.setVariableSupported=h.jA.bindTo(e),this.setExpressionSupported=h.Wx.bindTo(e),this.multiSessionDebug=h.d5.bindTo(e),this.terminateDebuggeeSupported=h.rv.bindTo(e),this.suspendDebuggeeSupported=h.uz.bindTo(e),this.disassembleRequestSupported=h.Pt.bindTo(e),this.focusedStackFrameHasInstructionPointerReference=h.pL.bindTo(e)})}getId(){return"root"}get focusedSession(){return this._focusedSession}get focusedThread(){return this._focusedThread}get focusedStackFrame(){return this._focusedStackFrame}setFocus(e,t,i,n){const o=this._focusedStackFrame!==e,s=this._focusedSession!==i,r=this._focusedThread!==t;this._focusedStackFrame=e,this._focusedThread=t,this._focusedSession=i,this.contextKeyService.bufferChangeEvents(()=>{this.loadedScriptsSupportedContextKey.set(!!i&&!!i.capabilities.supportsLoadedSourcesRequest),this.stepBackSupportedContextKey.set(!!i&&!!i.capabilities.supportsStepBack),this.restartFrameSupportedContextKey.set(!!i&&!!i.capabilities.supportsRestartFrame),this.stepIntoTargetsSupported.set(!!i&&!!i.capabilities.supportsStepInTargetsRequest),this.jumpToCursorSupported.set(!!i&&!!i.capabilities.supportsGotoTargetsRequest),this.setVariableSupported.set(!!i&&!!i.capabilities.supportsSetVariable),this.setExpressionSupported.set(!!i&&!!i.capabilities.supportsSetExpression),this.terminateDebuggeeSupported.set(!!i&&!!i.capabilities.supportTerminateDebuggee),this.suspendDebuggeeSupported.set(!!i&&!!i.capabilities.supportSuspendDebuggee),this.disassembleRequestSupported.set(!!i?.capabilities.supportsDisassembleRequest),this.focusedStackFrameHasInstructionPointerReference.set(!!e?.instructionPointerReference);const a=!!i&&(0,se.Q5)(i);this.focusedSessionIsAttach.set(a)}),s&&this._onDidFocusSession.fire(i),o?this._onDidFocusStackFrame.fire({stackFrame:e,explicit:n,session:i}):r&&this._onDidFocusThread.fire({thread:t,explicit:n,session:i})}get onDidFocusSession(){return this._onDidFocusSession.event}get onDidFocusThread(){return this._onDidFocusThread.event}get onDidFocusStackFrame(){return this._onDidFocusStackFrame.event}getSelectedExpression(){return this.selectedExpression}setSelectedExpression(e,t){this.selectedExpression=e?{expression:e,settingWatch:t}:void 0,this.expressionSelectedContextKey.set(!!e),this._onDidSelectExpression.fire(this.selectedExpression)}get onDidSelectExpression(){return this._onDidSelectExpression.event}get onDidEvaluateLazyExpression(){return this._onDidEvaluateLazyExpression.event}updateViews(){this._onWillUpdateViews.fire()}get onWillUpdateViews(){return this._onWillUpdateViews.event}isMultiSessionView(){return!!this.multiSessionDebug.get()}setMultiSessionView(e){this.multiSessionDebug.set(e)}evaluateLazyExpression(e){var t=this;return(0,b.Z)(function*(){yield e.evaluateLazy(),t._onDidEvaluateLazyExpression.fire(e)})()}}var qt=v(89440),Ar=v(96617),mo=v(57229),Ki=v(94401);let St=class{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m,S,w,M,I,L,N,B){this.editorService=e,this.paneCompositeService=t,this.viewsService=i,this.viewDescriptorService=n,this.notificationService=o,this.dialogService=s,this.layoutService=r,this.contextService=a,this.contextKeyService=c,this.lifecycleService=g,this.instantiationService=p,this.extensionService=f,this.fileService=m,this.configurationService=S,this.extensionHostDebugService=w,this.activityService=M,this.commandService=I,this.quickInputService=L,this.workspaceTrustRequestService=N,this.uriIdentityService=B,this.disposables=new F.SL,this.initializing=!1,this.sessionCancellationTokens=new Map,this.haveDoneLazySetup=!1,this.breakpointsToSendOnResourceSaved=new Set,this._onDidChangeState=new R.Q5,this._onDidNewSession=new R.Q5,this._onWillNewSession=new R.Q5,this._onDidEndSession=new R.Q5,this.adapterManager=this.instantiationService.createInstance(xi,{onDidNewSession:this.onDidNewSession}),this.disposables.add(this.adapterManager),this.configurationManager=this.instantiationService.createInstance(Ni,this.adapterManager),this.disposables.add(this.configurationManager),this.debugStorage=this.instantiationService.createInstance(zi),this.chosenEnvironments=this.debugStorage.loadChosenEnvironments(),this.model=this.instantiationService.createInstance(T.nR,this.debugStorage),this.telemetry=this.instantiationService.createInstance(ji,this.model),this.viewModel=new Tr(c),this.taskRunner=this.instantiationService.createInstance(Hi),this.disposables.add(this.fileService.onDidFilesChange(k=>this.onFileChanges(k))),this.disposables.add(this.lifecycleService.onWillShutdown(this.dispose,this)),this.disposables.add(this.extensionHostDebugService.onAttachSession(k=>{const P=this.model.getSession(k.sessionId,!0);P&&(P.configuration.request="attach",P.configuration.port=k.port,P.setSubId(k.subId),this.launchOrAttachToSession(P))})),this.disposables.add(this.extensionHostDebugService.onTerminateSession(k=>{const P=this.model.getSession(k.sessionId);P&&P.subId===k.subId&&P.disconnect()})),this.disposables.add(this.viewModel.onDidFocusStackFrame(()=>{this.onStateChange()})),this.disposables.add(this.viewModel.onDidFocusSession(k=>{this.onStateChange(),k&&this.setExceptionBreakpointFallbackSession(k.getId())})),this.disposables.add(R.ju.any(this.adapterManager.onDidRegisterDebugger,this.configurationManager.onDidSelectConfiguration)(()=>{const k=0!==this.state||this.configurationManager.getAllConfigurations().length>0&&this.adapterManager.hasEnabledDebuggers()?"default":"simple";this.debugUx.set(k),this.debugStorage.storeDebugUxState(k)})),this.disposables.add(this.model.onDidChangeCallStack(()=>{const k=this.model.getSessions().filter(P=>!P.parentSession).length;if(this.activity?.dispose(),k>0){const P=this.viewDescriptorService.getViewContainerByViewId(h.Vw);P&&(this.activity=this.activityService.showViewContainerActivity(P.id,{badge:new mo.mA(k,_=>1===_?l.NC("1activeSession","1 active session"):l.NC("nActiveSessions","{0} active sessions",_))}))}})),this.disposables.add(e.onDidActiveEditorChange(()=>{this.contextKeyService.bufferChangeEvents(()=>{e.activeEditor===qt.n.instance?this.disassemblyViewFocus.set(!0):this.disassemblyViewFocus?.reset()})})),this.disposables.add(this.lifecycleService.onBeforeShutdown(()=>{for(const k of e.editors)k.resource?.scheme===h.Sb&&k.dispose()})),this.initContextKeys(c)}initContextKeys(e){queueMicrotask(()=>{e.bufferChangeEvents(()=>{this.debugType=h.Lx.bindTo(e),this.debugState=h.KA.bindTo(e),this.hasDebugged=h.$N.bindTo(e),this.inDebugMode=h.hO.bindTo(e),this.debugUx=h.Kw.bindTo(e),this.debugUx.set(this.debugStorage.loadDebugUxState()),this.breakpointsExist=h.LK.bindTo(e),this.disassemblyViewFocus=h.oN.bindTo(e)});const t=()=>this.breakpointsExist.set(!!(this.model.getBreakpoints().length||this.model.getDataBreakpoints().length||this.model.getFunctionBreakpoints().length));t(),this.disposables.add(this.model.onDidChangeBreakpoints(()=>t()))})}getModel(){return this.model}getViewModel(){return this.viewModel}getConfigurationManager(){return this.configurationManager}getAdapterManager(){return this.adapterManager}sourceIsNotAvailable(e){this.model.sourceIsNotAvailable(e)}dispose(){this.disposables.dispose()}get state(){const e=this.viewModel.focusedSession;return e?e.state:this.initializing?1:0}get initializingOptions(){return this._initializingOptions}startInitializingState(e){this.initializing||(this.initializing=!0,this._initializingOptions=e,this.onStateChange())}endInitializingState(){this.initializing&&(this.initializing=!1,this._initializingOptions=void 0,this.onStateChange())}cancelTokens(e){if(e){const t=this.sessionCancellationTokens.get(e);t&&(t.cancel(),this.sessionCancellationTokens.delete(e))}else this.sessionCancellationTokens.forEach(t=>t.cancel()),this.sessionCancellationTokens.clear()}onStateChange(){const e=this.state;this.previousState!==e&&(this.contextKeyService.bufferChangeEvents(()=>{this.debugState.set((0,h.wD)(e)),this.inDebugMode.set(0!==e);const t=0!==e&&1!==e||this.adapterManager.hasEnabledDebuggers()&&this.configurationManager.selectedConfiguration.name?"default":"simple";this.debugUx.set(t),this.debugStorage.storeDebugUxState(t)}),this.previousState=e,this._onDidChangeState.fire(e))}get onDidChangeState(){return this._onDidChangeState.event}get onDidNewSession(){return this._onDidNewSession.event}get onWillNewSession(){return this._onWillNewSession.event}get onDidEndSession(){return this._onDidEndSession.event}lazySetup(){this.haveDoneLazySetup||(this.disposables.add(this.fileService.registerProvider(h.Sb,new wr(this))),this.haveDoneLazySetup=!0)}startDebugging(e,t,i,n=!i?.parentSession){var o=this;return(0,b.Z)(function*(){const s=i&&i.noDebug?l.NC("runTrust","Running executes build tasks and program code from your workspace."):l.NC("debugTrust","Debugging executes build tasks and program code from your workspace.");if(!(yield o.workspaceTrustRequestService.requestWorkspaceTrust({message:s})))return!1;o.lazySetup(),o.startInitializingState(i),o.hasDebugged.set(!0);try{let a,c;if(yield o.extensionService.activateByEvent("onDebug"),n&&(yield(0,se.RZ)(o.configurationService,o.editorService)),yield o.extensionService.whenInstalledExtensionsRegistered(),t||(t=o.configurationManager.selectedConfiguration.name),"string"==typeof t&&e?(a=e.getConfiguration(t),c=e.getCompound(t)):"string"!=typeof t&&(a=t),c){if(!c.configurations)throw new Error(l.NC({key:"compoundMustHaveConfigurations",comment:['compound indicates a "compounds" configuration item','"configurations" is an attribute and should not be localized']},'Compound must have "configurations" attribute set in order to start multiple configurations.'));if(c.preLaunchTask&&0===(yield o.taskRunner.runTaskAndCheckErrors(e?.workspace||o.contextService.getWorkspace(),c.preLaunchTask)))return o.endInitializingState(),!1;c.stopAll&&(i={...i,compoundRoot:new Nr});const f=(yield Promise.all(c.configurations.map(m=>{const S="string"==typeof m?m:m.name;if(S===c.name)return Promise.resolve(!1);let w;if("string"==typeof m){const M=o.configurationManager.getLaunches().filter(I=>!!I.getConfiguration(S));if(1===M.length)w=M[0];else{if(!(e&&M.length>1&&M.indexOf(e)>=0))throw new Error(0===M.length?l.NC("noConfigurationNameInWorkspace","Could not find launch configuration '{0}' in the workspace.",S):l.NC("multipleConfigurationNamesInWorkspace","There are multiple launch configurations '{0}' in the workspace. Use folder name to qualify the configuration.",S));w=e}}else if(m.folder){const M=o.configurationManager.getLaunches().filter(I=>I.workspace&&I.workspace.name===m.folder&&!!I.getConfiguration(m.name));if(1!==M.length)throw new Error(l.NC("noFolderWithName","Can not find folder with name '{0}' for configuration '{1}' in compound '{2}'.",m.folder,m.name,c.name));w=M[0]}return o.createSession(w,w.getConfiguration(S),i)}))).every(m=>!!m);return o.endInitializingState(),f}if(t&&!a){const p=e?l.NC("configMissing","Configuration '{0}' is missing in 'launch.json'.","string"==typeof t?t:t.name):l.NC("launchJsonDoesNotExist","'launch.json' does not exist for passed workspace folder.");throw new Error(p)}const g=yield o.createSession(e,a,i);return o.endInitializingState(),g}catch(a){return o.notificationService.error(a),o.endInitializingState(),Promise.reject(a)}})()}createSession(e,t,i){var n=this;return(0,b.Z)(function*(){let o;t?o=t.type:t=Object.create(null),(i&&i.noDebug||i&&typeof i.noDebug>"u"&&i.parentSession&&i.parentSession.configuration.noDebug)&&(t.noDebug=!0);const s=(0,we.I8)(t);let r,a;o||(a=n.editorService.activeEditor,a&&a.resource&&(o=n.chosenEnvironments[a.resource.toString()]),o||(r=yield n.adapterManager.guessDebugger(!1),r&&(o=r.type)));const c=new Ie.A,g=(0,et.R)();n.sessionCancellationTokens.set(g,c);const p=yield n.configurationManager.resolveConfigurationByProviders(e&&e.workspace?e.workspace.uri:void 0,o,t,c.token);if(p&&p.type)try{let f=yield n.substituteVariables(e,p);if(!f||c.token.isCancellationRequested)return!1;const m=e?.workspace||n.contextService.getWorkspace();if(0===(yield n.taskRunner.runTaskAndCheckErrors(m,f.preLaunchTask)))return!1;const w=yield n.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(e&&e.workspace?e.workspace.uri:void 0,o,f,c.token);if(!w)return e&&o&&null===w&&!c.token.isCancellationRequested&&(yield e.openConfigFile({preserveFocus:!0,type:o},c.token)),!1;f=w;const M=n.adapterManager.getDebugger(f.type);if(!M||"attach"!==p.request&&"launch"!==p.request){let L;L="attach"!==p.request&&"launch"!==p.request?p.request?l.NC("debugRequestNotSupported","Attribute '{0}' has an unsupported value '{1}' in the chosen debug configuration.","request",p.request):l.NC("debugRequesMissing","Attribute '{0}' is missing from the chosen debug configuration.","request"):f.type?l.NC("debugTypeNotSupported","Configured debug type '{0}' is not supported.",f.type):l.NC("debugTypeMissing","Missing property 'type' for the chosen launch configuration.");const N=[];return N.push(new G.aU("installAdditionalDebuggers",l.NC({key:"installAdditionalDebuggers",comment:['Placeholder is the debug type, so for example "node", "python"']},"Install {0} Extension",f.type),void 0,!0,(0,b.Z)(function*(){return n.commandService.executeCommand("debug.installAdditionalDebuggers",f?.type)}))),yield n.showError(L,N),!1}if(!M.enabled)return yield n.showError((0,h.RB)(M.type),[]),!1;const I=yield n.doCreateSession(g,e?.workspace,{resolved:f,unresolved:s},i);return I&&r&&a&&a.resource&&(n.chosenEnvironments[a.resource.toString()]=r.type,n.debugStorage.storeChosenEnvironments(n.chosenEnvironments)),I}catch(f){return f&&f.message?yield n.showError(f.message):1===n.contextService.getWorkbenchState()&&(yield n.showError(l.NC("noFolderWorkspaceDebugError","The active file can not be debugged. Make sure it is saved and that you have a debug extension installed for that file type."))),e&&!c.token.isCancellationRequested&&(yield e.openConfigFile({preserveFocus:!0},c.token)),!1}return e&&o&&null===p&&!c.token.isCancellationRequested&&(yield e.openConfigFile({preserveFocus:!0,type:o},c.token)),!1})()}doCreateSession(e,t,i,n){var o=this;return(0,b.Z)(function*(){const s=o.instantiationService.createInstance(Fi,e,i,t,o.model,n);if(n?.startedByUser&&o.model.getSessions().some(a=>a.getLabel()===s.getLabel())&&!0!==i.resolved.suppressMultipleSessionWarning&&!(yield o.dialogService.confirm({message:l.NC("multipleSession","'{0}' is already running. Do you want to start another instance?",s.getLabel())})).confirmed)return!1;o.model.addSession(s),o.registerSessionListeners(s),o._onWillNewSession.fire(s);const r=o.configurationService.getValue("debug").openDebug;!i.resolved.noDebug&&("openOnSessionStart"===r||"neverOpen"!==r&&o.viewModel.firstSessionStart)&&!s.suppressDebugView&&(yield o.paneCompositeService.openPaneComposite(h.f3,0));try{yield o.launchOrAttachToSession(s);const a=s.configuration.internalConsoleOptions||o.configurationService.getValue("debug").internalConsoleOptions;("openOnSessionStart"===a||o.viewModel.firstSessionStart&&"openOnFirstSessionStart"===a)&&o.viewsService.openView(h.FT,!1),o.viewModel.firstSessionStart=!1;const c=o.configurationService.getValue("debug").showSubSessionsInToolBar,g=o.model.getSessions();return(c?g:g.filter(f=>!f.parentSession)).length>1&&o.viewModel.setMultiSessionView(!0),o._onDidNewSession.fire(s),!0}catch(a){if(Me.n2(a)||(s&&s.getReplElements().length>0&&o.viewsService.openView(h.FT,!1),s.configuration&&"attach"===s.configuration.request&&s.configuration.__autoAttach))return!1;const c=a instanceof Error?a.message:a;return!1!==a.showUser&&(yield o.showError(c,(0,fi.TF)(a)?a.actions:[])),!1}})()}launchOrAttachToSession(e,t=!1){var i=this;return(0,b.Z)(function*(){const n=i.adapterManager.getDebugger(e.configuration.type);try{yield e.initialize(n),yield e.launchOrAttach(e.configuration);const o=!!e.root&&!!i.configurationService.getValue("launch",{resource:e.root.uri});yield i.telemetry.logDebugSessionStart(n,o),(t||!i.viewModel.focusedSession||e.parentSession===i.viewModel.focusedSession&&e.compact)&&(yield i.focusStackFrame(void 0,void 0,e))}catch(o){return i.viewModel.focusedSession===e&&(yield i.focusStackFrame(void 0)),Promise.reject(o)}})()}registerSessionListeners(e){var t=this;const i=new Q.pY(()=>{3===e.state&&this.viewModel.focusedSession===e&&this.viewModel.setFocus(void 0,this.viewModel.focusedThread,e,!1)},200);this.disposables.add(e.onDidChangeState(()=>{3===e.state&&this.viewModel.focusedSession===e&&i.schedule(),e===this.viewModel.focusedSession&&this.onStateChange()})),this.disposables.add(e.onDidEndAdapter(function(){var n=(0,b.Z)(function*(o){o&&(o.error&&t.notificationService.error(l.NC("debugAdapterCrash","Debug adapter process has terminated unexpectedly ({0})",o.error.message||o.error.toString())),t.telemetry.logDebugSessionStop(e,o));const s=(0,se.Zf)(e);if(s&&3===s.state&&s.configuration.noDebug&&t.extensionHostDebugService.close(s.getId()),e.configuration.postDebugTask){const a=e.root??t.contextService.getWorkspace();try{yield t.taskRunner.runTask(a,e.configuration.postDebugTask)}catch(c){t.notificationService.error(c)}}t.endInitializingState(),t.cancelTokens(e.getId()),t._onDidEndSession.fire(e);const r=t.viewModel.focusedSession;if(r&&r.getId()===e.getId()){const{session:a,thread:c,stackFrame:g}=vo(t.model,void 0,void 0,void 0,r);t.viewModel.setFocus(g,c,a,!1)}if(0===t.model.getSessions().length&&(t.viewModel.setMultiSessionView(!1),t.layoutService.isVisible("workbench.parts.sidebar")&&t.configurationService.getValue("debug").openExplorerOnEnd&&t.paneCompositeService.openPaneComposite(Ar.f3,0),t.model.getDataBreakpoints().filter(c=>!c.canPersist).forEach(c=>t.model.removeDataBreakpoints(c.getId())),t.configurationService.getValue("debug").console.closeOnEnd)){const c=t.viewDescriptorService.getViewContainerByViewId(h.FT);c&&t.viewsService.isViewContainerVisible(c.id)&&t.viewsService.closeViewContainer(c.id)}t.model.removeExceptionBreakpointsForSession(e.getId())});return function(o){return n.apply(this,arguments)}}()))}restartSession(e,t){var i=this;return(0,b.Z)(function*(){e.saveBeforeRestart&&(yield(0,se.RZ)(i.configurationService,i.editorService));const n=!!t,o=function(){var f=(0,b.Z)(function*(){if(n)return Promise.resolve(1);const m=e.root||i.contextService.getWorkspace();yield i.taskRunner.runTask(m,e.configuration.preRestartTask),yield i.taskRunner.runTask(m,e.configuration.postDebugTask);const S=yield i.taskRunner.runTaskAndCheckErrors(m,e.configuration.preLaunchTask);return 1!==S?S:i.taskRunner.runTaskAndCheckErrors(m,e.configuration.postRestartTask)});return function(){return f.apply(this,arguments)}}(),s=(0,se.Zf)(e);if(s)return void(1===(yield o())&&i.extensionHostDebugService.reload(s.getId()));let a,r=!1;const c=e.root?i.configurationManager.getLaunch(e.root.uri):void 0;c&&(a=c.getConfiguration(e.configuration.name),a&&!(0,we.fS)(a,e.unresolvedConfiguration)&&(a.type=e.configuration.type,a.noDebug=e.configuration.noDebug,r=!0));let g=e.configuration;if(c&&r&&a){const f=new Ie.A;i.sessionCancellationTokens.set(e.getId(),f);const m=yield i.configurationManager.resolveConfigurationByProviders(c.workspace?c.workspace.uri:void 0,a.type,a,f.token);m?(g=yield i.substituteVariables(c,m),g&&!f.token.isCancellationRequested&&(g=yield i.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(c&&c.workspace?c.workspace.uri:void 0,a.type,g,f.token))):g=m}if(g&&e.setConfiguration({resolved:g,unresolved:a}),e.configuration.__restart=t,e.capabilities.supportsRestartRequest)return void(1===(yield o())&&(yield e.restart()));const p=!!i.viewModel.focusedSession&&e.getId()===i.viewModel.focusedSession.getId();return n?yield e.disconnect(!0):yield e.terminate(!0),new Promise((f,m)=>{setTimeout((0,b.Z)(function*(){if(1===(yield o())){if(!g)return f(void 0);try{yield i.launchOrAttachToSession(e,p),i._onDidNewSession.fire(e),f(void 0)}catch(w){m(w)}}}),300)})})()}stopSession(e,t=!1,i=!1){var n=this;return(0,b.Z)(function*(){if(e)return t?e.disconnect(void 0,i):e.terminate();const o=n.model.getSessions();return 0===o.length&&(n.taskRunner.cancel(),yield n.quickInputService.cancel(),n.endInitializingState(),n.cancelTokens(void 0)),Promise.all(o.map(s=>t?s.disconnect(void 0,i):s.terminate()))})()}substituteVariables(e,t){var i=this;return(0,b.Z)(function*(){const n=i.adapterManager.getDebugger(t.type);if(n){let o;if(e&&e.workspace)o=e.workspace;else{const s=i.contextService.getWorkspace().folders;1===s.length&&(o=s[0])}try{return yield n.substituteVariables(o,t)}catch(s){return void i.showError(s.message,void 0,!!e?.getConfiguration(t.name))}}return Promise.resolve(t)})()}showError(e,t=[],i=!0){var n=this;return(0,b.Z)(function*(){const o=new G.aU(C.TP,C.cG,void 0,!0,()=>n.commandService.executeCommand(C.TP)),s=t.filter(r=>r.id.endsWith(".command")).length>0?t:[...t,...i?[o]:[]];yield n.dialogService.prompt({type:fe.Z.Error,message:e,buttons:s.map(r=>({label:r.label,run:()=>r.run()})),cancelButton:!0})})()}focusStackFrame(e,t,i,n){var o=this;return(0,b.Z)(function*(){const{stackFrame:s,thread:r,session:a}=vo(o.model,e,t,i);if(s){const c=yield s.openInEditor(o.editorService,n?.preserveFocus??!0,n?.sideBySide,n?.pinned);if(c&&c.input!==qt.n.instance){const g=c.getControl();if(s&&(0,Ve.CL)(g)&&g.hasModel()){const p=g.getModel(),f=s.range.startLineNumber;if(f>=1&&f<=p.getLineCount()){const m=g.getModel().getLineContent(f);Ze.Z9(l.NC({key:"debuggingPaused",comment:['First placeholder is the file line content, second placeholder is the reason why debugging is stopped, for example "breakpoint", third is the stack frame name, and last is the line number.']},"{0}, debugging paused {1}, {2}:{3}",m,r&&r.stoppedDetails?`, reason ${r.stoppedDetails.reason}`:"",s.source?s.source.name:"",s.range.startLineNumber))}}}}a?o.debugType.set(a.configuration.type):o.debugType.reset(),o.viewModel.setFocus(s,r,a,!!n?.explicit)})()}addWatchExpression(e){const t=this.model.addWatchExpression(e);e||this.viewModel.setSelectedExpression(t,!1),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}renameWatchExpression(e,t){this.model.renameWatchExpression(e,t),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}moveWatchExpression(e,t){this.model.moveWatchExpression(e,t),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}removeWatchExpressions(e){this.model.removeWatchExpressions(e),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}canSetBreakpointsIn(e){return this.adapterManager.canSetBreakpointsIn(e)}enableOrDisableBreakpoints(e,t){var i=this;return(0,b.Z)(function*(){t?(i.model.setEnablement(t,e),i.debugStorage.storeBreakpoints(i.model),t instanceof T.Uo?yield i.sendBreakpoints(t.originalUri):t instanceof T.Tp?yield i.sendFunctionBreakpoints():t instanceof T.K1?yield i.sendDataBreakpoints():t instanceof T.k9?yield i.sendInstructionBreakpoints():yield i.sendExceptionBreakpoints()):(i.model.enableOrDisableAllBreakpoints(e),i.debugStorage.storeBreakpoints(i.model),yield i.sendAllBreakpoints()),i.debugStorage.storeBreakpoints(i.model)})()}addBreakpoints(e,t,i=!0){var n=this;return(0,b.Z)(function*(){const o=n.model.addBreakpoints(e,t);return i&&o.forEach(s=>Ze.i7(l.NC("breakpointAdded","Added breakpoint, line {0}, file {1}",s.lineNumber,e.fsPath))),n.debugStorage.storeBreakpoints(n.model),yield n.sendBreakpoints(e),n.debugStorage.storeBreakpoints(n.model),o})()}updateBreakpoints(e,t,i){var n=this;return(0,b.Z)(function*(){n.model.updateBreakpoints(t),n.debugStorage.storeBreakpoints(n.model),i?n.breakpointsToSendOnResourceSaved.add(e):(yield n.sendBreakpoints(e),n.debugStorage.storeBreakpoints(n.model))})()}removeBreakpoints(e){var t=this;return(0,b.Z)(function*(){const i=t.model.getBreakpoints().filter(o=>!e||o.getId()===e);i.forEach(o=>Ze.i7(l.NC("breakpointRemoved","Removed breakpoint, line {0}, file {1}",o.lineNumber,o.uri.fsPath)));const n=(0,de.EB)(i,o=>o.originalUri.toString()).map(o=>o.originalUri);t.model.removeBreakpoints(i),t.debugStorage.storeBreakpoints(t.model),yield Promise.all(n.map(o=>t.sendBreakpoints(o)))})()}setBreakpointsActivated(e){return this.model.setBreakpointsActivated(e),this.sendAllBreakpoints()}addFunctionBreakpoint(e,t){this.model.addFunctionBreakpoint(e||"",t)}updateFunctionBreakpoint(e,t){var i=this;return(0,b.Z)(function*(){i.model.updateFunctionBreakpoint(e,t),i.debugStorage.storeBreakpoints(i.model),yield i.sendFunctionBreakpoints()})()}removeFunctionBreakpoints(e){var t=this;return(0,b.Z)(function*(){t.model.removeFunctionBreakpoints(e),t.debugStorage.storeBreakpoints(t.model),yield t.sendFunctionBreakpoints()})()}addDataBreakpoint(e,t,i,n,o){var s=this;return(0,b.Z)(function*(){s.model.addDataBreakpoint(e,t,i,n,o),s.debugStorage.storeBreakpoints(s.model),yield s.sendDataBreakpoints(),s.debugStorage.storeBreakpoints(s.model)})()}removeDataBreakpoints(e){var t=this;return(0,b.Z)(function*(){t.model.removeDataBreakpoints(e),t.debugStorage.storeBreakpoints(t.model),yield t.sendDataBreakpoints()})()}addInstructionBreakpoint(e,t,i,n){var o=this;return(0,b.Z)(function*(){o.model.addInstructionBreakpoint(e,t,i,n),o.debugStorage.storeBreakpoints(o.model),yield o.sendInstructionBreakpoints(),o.debugStorage.storeBreakpoints(o.model)})()}removeInstructionBreakpoints(e){var t=this;return(0,b.Z)(function*(){t.model.removeInstructionBreakpoints(e),t.debugStorage.storeBreakpoints(t.model),yield t.sendInstructionBreakpoints()})()}setExceptionBreakpointFallbackSession(e){this.model.setExceptionBreakpointFallbackSession(e),this.debugStorage.storeBreakpoints(this.model)}setExceptionBreakpointsForSession(e,t){this.model.setExceptionBreakpointsForSession(e.getId(),t),this.debugStorage.storeBreakpoints(this.model)}setExceptionBreakpointCondition(e,t){var i=this;return(0,b.Z)(function*(){i.model.setExceptionBreakpointCondition(e,t),i.debugStorage.storeBreakpoints(i.model),yield i.sendExceptionBreakpoints()})()}sendAllBreakpoints(e){var t=this;return(0,b.Z)(function*(){const i=(0,de.EB)(t.model.getBreakpoints(),n=>n.originalUri.toString()).map(n=>t.sendBreakpoints(n.originalUri,!1,e));e?.capabilities.supportsConfigurationDoneRequest?yield Promise.all([...i,t.sendFunctionBreakpoints(e),t.sendDataBreakpoints(e),t.sendInstructionBreakpoints(e),t.sendExceptionBreakpoints(e)]):(yield Promise.all(i),yield t.sendFunctionBreakpoints(e),yield t.sendDataBreakpoints(e),yield t.sendInstructionBreakpoints(e),yield t.sendExceptionBreakpoints(e))})()}sendBreakpoints(e,t=!1,i){var n=this;return(0,b.Z)(function*(){const o=n.model.getBreakpoints({originalUri:e,enabledOnly:!0});yield Ct(n.model,i,function(){var s=(0,b.Z)(function*(r){r.configuration.noDebug||(yield r.sendBreakpoints(e,o,t))});return function(r){return s.apply(this,arguments)}}())})()}sendFunctionBreakpoints(e){var t=this;return(0,b.Z)(function*(){const i=t.model.getFunctionBreakpoints().filter(n=>n.enabled&&t.model.areBreakpointsActivated());yield Ct(t.model,e,function(){var n=(0,b.Z)(function*(o){o.capabilities.supportsFunctionBreakpoints&&!o.configuration.noDebug&&(yield o.sendFunctionBreakpoints(i))});return function(o){return n.apply(this,arguments)}}())})()}sendDataBreakpoints(e){var t=this;return(0,b.Z)(function*(){const i=t.model.getDataBreakpoints().filter(n=>n.enabled&&t.model.areBreakpointsActivated());yield Ct(t.model,e,function(){var n=(0,b.Z)(function*(o){o.capabilities.supportsDataBreakpoints&&!o.configuration.noDebug&&(yield o.sendDataBreakpoints(i))});return function(o){return n.apply(this,arguments)}}())})()}sendInstructionBreakpoints(e){var t=this;return(0,b.Z)(function*(){const i=t.model.getInstructionBreakpoints().filter(n=>n.enabled&&t.model.areBreakpointsActivated());yield Ct(t.model,e,function(){var n=(0,b.Z)(function*(o){o.capabilities.supportsInstructionBreakpoints&&!o.configuration.noDebug&&(yield o.sendInstructionBreakpoints(i))});return function(o){return n.apply(this,arguments)}}())})()}sendExceptionBreakpoints(e){var t=this;return Ct(this.model,e,function(){var i=(0,b.Z)(function*(n){const o=t.model.getExceptionBreakpointsForSession(n.getId()).filter(s=>s.enabled);n.capabilities.supportsConfigurationDoneRequest&&(!n.capabilities.exceptionBreakpointFilters||0===n.capabilities.exceptionBreakpointFilters.length)||n.configuration.noDebug||(yield n.sendExceptionBreakpoints(o))});return function(n){return i.apply(this,arguments)}}())}onFileChanges(e){const t=this.model.getBreakpoints().filter(n=>e.contains(n.originalUri,2));t.length&&this.model.removeBreakpoints(t);const i=[];for(const n of this.breakpointsToSendOnResourceSaved)e.contains(n,0)&&i.push(n);for(const n of i)this.breakpointsToSendOnResourceSaved.delete(n),this.sendBreakpoints(n,!0)}runTo(e,t,i){var n=this;return(0,b.Z)(function*(){let o,s=n.getViewModel().focusedThread;const r=function(){var c=(0,b.Z)(function*(){if(!n.getModel().getBreakpoints({column:i,lineNumber:t,uri:e}).length){const p=yield n.addAndValidateBreakpoints(e,t,i);p.thread&&(s=p.thread),p.breakpoint&&(o=p.breakpoint)}return{threadToContinue:s,breakpointToRemove:o}});return function(){return c.apply(this,arguments)}}(),a=c=>(2===c||0===c)&&(o&&n.removeBreakpoints(o.getId()),!0);if(yield r(),0===n.state){const{launch:c,name:g,getConfig:p}=n.getConfigurationManager().selectedConfiguration,f=yield p(),m=f?Object.assign((0,we.I8)(f),{}):g,S=n.onDidChangeState(w=>{a(w)&&S.dispose()});yield n.startDebugging(c,m,void 0,!0)}if(2===n.state){const c=n.getViewModel().focusedSession;if(!c||!s)return;const g=s.session.onDidChangeState(()=>{a(c.state)&&g.dispose()});yield s.continue()}})()}addAndValidateBreakpoints(e,t,i){var n=this;return(0,b.Z)(function*(){const o=n.getModel(),s=n.getViewModel(),a=(yield n.addBreakpoints(e,[{lineNumber:t,column:i}],!1))?.[0];if(!a)return{breakpoint:void 0,thread:s.focusedThread};if(!a.verified){let p;yield(0,Q.ek)(new Promise(f=>{p=o.onDidChangeBreakpoints(()=>{a.verified&&f()})}),2e3),p.dispose()}let c=s.focusedThread,g=0;for(const p of a.sessionsThatVerified){const f=o.getSession(p);if(!f)continue;const m=f.getAllThreads().filter(S=>S.stopped);if(g<3&&s.focusedThread&&m.includes(s.focusedThread)&&(c=s.focusedThread,g=3),g<2){const S=m.find(w=>{const M=w.getTopStackFrame();return M&&n.uriIdentityService.extUri.isEqual(M.source.uri,e)});S&&(c=S,g=2)}g<1&&(c=m[0],g=2)}return{thread:c,breakpoint:a}})()}};function vo(d,e,t,i,n){if(!i)if(e||t)i=e?e.thread.session:t.session;else{const o=d.getSessions();i=o.find(r=>2===r.state)||o.find(r=>r!==n&&r!==n?.parentSession)||(o.length?o[0]:void 0)}if(!t)if(e)t=e.thread;else{const o=i?i.getAllThreads():void 0;t=o&&o.find(r=>r.stopped)||(o&&o.length?o[0]:void 0)}return!e&&t&&(e=t.getTopStackFrame()),{session:i,thread:t,stackFrame:e}}function Ct(d,e,t){return Gi.apply(this,arguments)}function Gi(){return Gi=(0,b.Z)(function*(d,e,t){e?yield t(e):yield Promise.all(d.getSessions().map(i=>t(i)))}),Gi.apply(this,arguments)}St=(0,u.gn)([(0,u.fM)(0,oe.AR),(0,u.fM)(1,uo.c),(0,u.fM)(2,J.qC),(0,u.fM)(3,J.XH),(0,u.fM)(4,Ne.lT),(0,u.fM)(5,bt.Ss),(0,u.fM)(6,Ki.z),(0,u.fM)(7,Te.ec),(0,u.fM)(8,A.i6),(0,u.fM)(9,Di.g),(0,u.fM)(10,q.TG),(0,u.fM)(11,it.QS),(0,u.fM)(12,U.sn),(0,u.fM)(13,Z.Ui),(0,u.fM)(14,Qn.Q),(0,u.fM)(15,mo.By),(0,u.fM)(16,ne.H),(0,u.fM)(17,zt.eJ),(0,u.fM)(18,rr.N2),(0,u.fM)(19,ke.v)],St);var $=v(66588);class Lr{constructor(){this.referenceProvider=new $.c(this._score.bind(this)),this.renameProvider=new $.c(this._score.bind(this)),this.codeActionProvider=new $.c(this._score.bind(this)),this.definitionProvider=new $.c(this._score.bind(this)),this.typeDefinitionProvider=new $.c(this._score.bind(this)),this.declarationProvider=new $.c(this._score.bind(this)),this.implementationProvider=new $.c(this._score.bind(this)),this.documentSymbolProvider=new $.c(this._score.bind(this)),this.inlayHintsProvider=new $.c(this._score.bind(this)),this.colorProvider=new $.c(this._score.bind(this)),this.codeLensProvider=new $.c(this._score.bind(this)),this.documentFormattingEditProvider=new $.c(this._score.bind(this)),this.documentRangeFormattingEditProvider=new $.c(this._score.bind(this)),this.onTypeFormattingEditProvider=new $.c(this._score.bind(this)),this.signatureHelpProvider=new $.c(this._score.bind(this)),this.hoverProvider=new $.c(this._score.bind(this)),this.documentHighlightProvider=new $.c(this._score.bind(this)),this.selectionRangeProvider=new $.c(this._score.bind(this)),this.foldingRangeProvider=new $.c(this._score.bind(this)),this.linkProvider=new $.c(this._score.bind(this)),this.inlineCompletionsProvider=new $.c(this._score.bind(this)),this.completionProvider=new $.c(this._score.bind(this)),this.linkedEditingRangeProvider=new $.c(this._score.bind(this)),this.inlineValuesProvider=new $.c(this._score.bind(this)),this.evaluatableExpressionProvider=new $.c(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new $.c(this._score.bind(this)),this.documentSemanticTokensProvider=new $.c(this._score.bind(this)),this.documentOnDropEditProvider=new $.c(this._score.bind(this)),this.documentPasteEditProvider=new $.c(this._score.bind(this))}setNotebookTypeResolver(e){this._notebookTypeResolver=e}_score(e){return this._notebookTypeResolver?.(e)}}var rt=v(42217),yt=v(82927),wt=v(48982),Br=v(29689);let Rr=(()=>{class d extends Br.N{constructor(t,i,n,o,s,r,a,c,g,p){super({getFolderUri:f=>{const m=r.getWorkspace().folders.filter(S=>S.name===f).pop();return m?m.uri:void 0},getWorkspaceFolderCount:()=>r.getWorkspace().folders.length,getConfigurationValue:(f,m)=>o.getValue(m,f?{resource:f}:{}),getAppRoot:()=>t.getAppRoot(),getExecPath:()=>t.getExecPath(),getFilePath:()=>{const f=wt.zK.getOriginalUri(n.activeEditor,{supportSideBySide:wt.YX.PRIMARY,filterByScheme:[ze.lg.file,ze.lg.vscodeUserData,this.pathService.defaultUriScheme]});if(f)return this.labelService.getUriLabel(f,{noPrefix:!0})},getWorkspaceFolderPathForFile:()=>{const f=wt.zK.getOriginalUri(n.activeEditor,{supportSideBySide:wt.YX.PRIMARY,filterByScheme:[ze.lg.file,ze.lg.vscodeUserData,this.pathService.defaultUriScheme]});if(!f)return;const m=r.getWorkspaceFolder(f);return m?this.labelService.getUriLabel(m.uri,{noPrefix:!0}):void 0},getSelectedText:()=>{const f=n.activeTextEditorControl;let m=null;if((0,Ve.CL)(f))m=f;else if((0,Ve.QI)(f)){const M=f.getOriginalEditor(),I=f.getModifiedEditor();m=M.hasWidgetFocus()?M:I}const S=m?.getModel(),w=m?.getSelection();if(S&&w)return S.getValueInRange(w)},getLineNumber:()=>{const f=n.activeTextEditorControl;if((0,Ve.CL)(f)){const m=f.getSelection();if(m)return String(m.positionLineNumber)}},getExtension:f=>p.getExtension(f)},c,g.userHome().then(f=>f.path),i),this.configurationService=o,this.commandService=s,this.workspaceContextService=r,this.quickInputService=a,this.labelService=c,this.pathService=g,this.userInputAccessQueue=new Q.ci}resolveWithInteractionReplace(t,i,n,o,s){var r=this;return(0,b.Z)(function*(){return i=yield r.resolveAnyAsync(t,i),r.resolveWithInteraction(t,i,n,o,s).then(a=>a?a.size>0?r.resolveAnyAsync(t,i,Object.fromEntries(a)):i:null)})()}resolveWithInteraction(t,i,n,o,s){var r=this;return(0,b.Z)(function*(){const a=yield r.resolveAnyMap(t,i),c=a.resolvedVariables;return r.resolveWithInputAndCommands(t,i=a.newConfig,o,n,s).then(g=>{if(r.updateMapping(g,c))return c})})()}updateMapping(t,i){if(!t)return!1;for(const[n,o]of Object.entries(t))i.set(n,o);return!0}resolveWithInputAndCommands(t,i,n,o,s){var r=this;return(0,b.Z)(function*(){if(!i)return Promise.resolve(void 0);let a=[];if(1!==r.workspaceContextService.getWorkbenchState()&&o){const p=t?{resource:t.uri}:{},f=r.configurationService.inspect(o,p);if(f&&(f.userValue||f.workspaceValue||f.workspaceFolderValue))switch(s){case 2:a=f.userValue?.inputs;break;case 5:a=f.workspaceValue?.inputs;break;default:a=f.workspaceFolderValue?.inputs}else{const m=r.configurationService.getValue(o,p);m&&(a=m.inputs)}}const c=[];r.findVariables(i,c);const g=Object.create(null);for(const p of c){const[f,m]=p.split(":",2);let S;switch(f){case"input":S=yield r.showUserInput(m,a);break;case"command":{const w=(n?n[m]:void 0)||m;if(S=yield r.commandService.executeCommand(w,i),"string"!=typeof S&&!j.Jp(S))throw new Error(l.NC("commandVariable.noStringType","Cannot substitute command variable '{0}' because command did not return a result of type string.",w));break}default:r._contributedVariables.has(p)&&(S=yield r._contributedVariables.get(p)())}if("string"!=typeof S)return;g[p]=S}return g})()}findVariables(t,i){if("string"==typeof t){let n;for(;null!==(n=d.INPUT_OR_COMMAND_VARIABLES_PATTERN.exec(t));)if(4===n.length){const o=n[1];i.indexOf(o)<0&&i.push(o)}for(const o of this._contributedVariables.keys())i.indexOf(o)<0&&t.indexOf("${"+o+"}")>=0&&i.push(o)}else if(Array.isArray(t))for(const n of t)this.findVariables(n,i);else if(t)for(const n of Object.values(t))this.findVariables(n,i)}showUserInput(t,i){if(!i)return Promise.reject(new Error(l.NC("inputVariable.noInputSection","Variable '{0}' must be defined in an '{1}' section of the debug or task configuration.",t,"input")));const n=i.filter(o=>o.id===t).pop();if(n){const o=s=>{throw new Error(l.NC("inputVariable.missingAttribute","Input variable '{0}' is of type '{1}' and must include '{2}'.",t,n.type,s))};switch(n.type){case"promptString":{j.HD(n.description)||o("description");const s={prompt:n.description,ignoreFocusLost:!0};return n.default&&(s.value=n.default),n.password&&(s.password=n.password),this.userInputAccessQueue.queue(()=>this.quickInputService.input(s)).then(r=>r)}case"pickString":{if(j.HD(n.description)||o("description"),Array.isArray(n.options))for(const a of n.options)!j.HD(a)&&!j.HD(a.value)&&o("value");else o("options");const s=new Array;for(const a of n.options){const c=j.HD(a)?a:a.value,g=j.HD(a)?void 0:a.label,p={label:g?`${g}: ${c}`:c,value:c};c===n.default?(p.description=l.NC("inputVariable.defaultInputValue","(Default)"),s.unshift(p)):s.push(p)}const r={placeHolder:n.description,matchOnDetail:!0,ignoreFocusLost:!0};return this.userInputAccessQueue.queue(()=>this.quickInputService.pick(s,r,void 0)).then(a=>{if(a)return a.value})}case"command":return j.HD(n.command)||o("command"),this.userInputAccessQueue.queue(()=>this.commandService.executeCommand(n.command,n.args)).then(s=>{if("string"==typeof s||j.Jp(s))return s;throw new Error(l.NC("inputVariable.command.noStringType","Cannot substitute input variable '{0}' because command '{1}' did not return a result of type string.",t,n.command))});default:throw new Error(l.NC("inputVariable.unknownType","Input variable '{0}' can only be of type 'promptString', 'pickString', or 'command'.",t))}}return Promise.reject(new Error(l.NC("inputVariable.undefinedVariable","Undefined input variable '{0}' encountered. Remove or define '{0}' to continue.",t)))}}return d.INPUT_OR_COMMAND_VARIABLES_PATTERN=/\${((input|command):(.*?))}/g,d})();var Qi=v(31096);let qi=class extends Rr{constructor(e,t,i,n,o,s,r,a){super({getAppRoot:()=>{},getExecPath:()=>{}},Promise.resolve(Object.create(null)),e,t,i,n,o,s,r,a)}};qi=(0,u.gn)([(0,u.fM)(0,oe.AR),(0,u.fM)(1,Z.Ui),(0,u.fM)(2,ne.H),(0,u.fM)(3,Te.ec),(0,u.fM)(4,zt.eJ),(0,u.fM)(5,yt.e),(0,u.fM)(6,Qi.a),(0,u.fM)(7,it.QS)],qi);var Vr=v(38050),He=v(96970);(0,He.Z)('.codicon-debug-hint{cursor:pointer}.codicon-debug-hint:not([class*=codicon-debug-breakpoint]):not([class*=codicon-debug-stackframe]){opacity:.4!important}.inline-breakpoint-widget.codicon{align-items:center;display:flex!important}.inline-breakpoint-widget.codicon-debug-breakpoint-disabled{opacity:.7}.monaco-editor .inline-breakpoint-widget.line-start{left:-8px!important}.monaco-editor .debug-breakpoint-placeholder{display:inline-flex;margin-top:-1px;vertical-align:middle;width:.9em}.codicon-debug-breakpoint.codicon-debug-stackframe-focused:after,.codicon-debug-breakpoint.codicon-debug-stackframe:after{content:"\\eb8a";position:absolute}.monaco-editor .debug-top-stack-frame-column{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;align-items:center;display:inline-flex;font:normal normal normal 16px/1 codicon;margin-left:0;margin-right:4px;margin-top:-1px;text-rendering:auto;vertical-align:middle;width:.9em}.monaco-editor .debug-top-stack-frame-column.start-of-line{margin-top:0;position:absolute;top:50%;transform:translate(-17px,-50%)}.monaco-editor .inline-breakpoint-widget{cursor:pointer}.monaco-workbench .debug-view-content .monaco-list-row .monaco-tl-contents{overflow:hidden;text-overflow:ellipsis}.monaco-workbench .monaco-list-row .expression{display:flex}.monaco-workbench .debug-hover-widget .monaco-list-row .expression,.monaco-workbench .debug-pane .monaco-list-row .expression{font-family:var(--monaco-monospace-font);font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:pre}.monaco-workbench.mac .debug-hover-widget .monaco-list-row .expression,.monaco-workbench.mac .debug-pane .monaco-list-row .expression{font-size:11px}.monaco-workbench .monaco-list-row .expression .value{margin-left:6px}.monaco-workbench .monaco-list-row .expression .lazy-button{align-self:center;border-radius:5px;display:none;margin-left:3px}.monaco-workbench .monaco-list-row .expression.lazy .lazy-button{display:inline}.monaco-workbench .monaco-list-row .expression .value a.link:hover{text-decoration:underline}.monaco-workbench .monaco-list-row .expression .value a.link.pointer{cursor:pointer}.monaco-workbench .monaco-list:focus .monaco-list-row.selected .expression .name,.monaco-workbench .monaco-list:focus .monaco-list-row.selected .expression .value{color:inherit}.monaco-workbench .monaco-list-row .expression .name.internal,.monaco-workbench .monaco-list-row .expression .name.virtual{opacity:.5}.monaco-workbench .monaco-list-row .expression .unavailable{font-style:italic}.monaco-workbench .debug-inline-value{background-color:var(--vscode-editor-inlineValuesBackground);color:var(--vscode-editor-inlineValuesForeground)}',{}),(0,He.Z)(".monaco-editor .debug-hover-widget{animation-duration:.15s;animation-name:fadeIn;position:absolute;user-select:text;-webkit-user-select:text;white-space:pre;word-break:break-all;z-index:50}.monaco-editor .debug-hover-widget .complex-value{max-width:550px}.monaco-editor .debug-hover-widget .complex-value .tip,.monaco-editor .debug-hover-widget .complex-value .title{font-size:11px;height:18px;line-height:18px;overflow:hidden;padding-left:15px;padding-right:2px;text-overflow:ellipsis;white-space:pre;word-break:normal}.monaco-editor .debug-hover-widget .complex-value .title{border-bottom:1px solid hsla(0,0%,50%,.35)}.monaco-editor .debug-hover-widget .complex-value .tip{border-top:1px solid hsla(0,0%,50%,.35);opacity:.5}.monaco-editor .debug-hover-widget .debug-hover-tree{cursor:pointer;line-height:18px}.monaco-editor .debug-hover-widget .debug-hover-tree .monaco-list-row .monaco-tl-contents{user-select:text;-webkit-user-select:text;white-space:pre}.monaco-editor .debug-hover-widget .debug-hover-tree .monaco-list-rows .monaco-list-row:hover:not(.highlighted):not(.selected):not(.focused){background-color:inherit}.monaco-editor .debug-hover-widget pre{margin-bottom:0;margin-top:0}.monaco-editor .debugHoverHighlight{background-color:rgba(173,214,255,.15)}.monaco-editor .debug-hover-widget>.monaco-scrollable-element>.value{color:hsla(0,0%,42%,.8);font-family:var(--monaco-monospace-font);max-height:500px;overflow:auto;padding:4px 5px;white-space:pre-wrap}.monaco-editor.hc-theme .debugHoverHighlight,.monaco-editor.vs-dark .debugHoverHighlight{background-color:rgba(38,79,120,.25)}",{});var H=v(38356),D=v(73317),Or=v(84776),So=v(70958),Hr=v(73533),Ji=v(48780),Co=v(94014),Jt=v(37781),Wr=v(26278),y=v(6418),Xi=v(48671),at=v(41312),yo=v(49851),ae=v(84761),Ae=v(96237),Y=v(54922),x=v(66179),X=v(32064);le.B.add("gutterActionsRegistry",new class _r{constructor(){this._registeredGutterActionsGenerators=new Set}registerGutterActionsGenerator(e){return this._registeredGutterActionsGenerators.add(e),{dispose:()=>{this._registeredGutterActionsGenerators.delete(e)}}}getGutterActionsGenerators(){return Array.from(this._registeredGutterActionsGenerators.values())}});const wo=le.B.as("gutterActionsRegistry");let kt=class extends F.JT{constructor(e,t,i,n,o){super(),this.editor=e,this.contextMenuService=t,this.menuService=i,this.contextKeyService=n,this.instantiationService=o,this._register(this.editor.onMouseDown(s=>this.doShow(s,!1)))}show(e){this.doShow(e,!0)}doShow(e,t){const i=this.editor.getModel();if(!e.event.rightButton&&!(re.dz&&e.event.leftButton&&e.event.ctrlKey)&&!t||3!==e.target.type&&2!==e.target.type||!e.target.position||!i)return;const n={x:e.event.posx,y:e.event.posy},o=e.target.position.lineNumber,s=this.contextKeyService.createOverlay([["editorLineNumber",o]]),r=this.menuService.createMenu(D.eH.EditorLineNumberContext,s),a=[];this.instantiationService.invokeFunction(c=>{for(const p of wo.getGutterActionsGenerators()){const f=new Map;p({lineNumber:o,editor:this.editor,accessor:c},{push:(m,S="navigation")=>{const w=f.get(S)??[];w.push(m),f.set(S,w)}});for(const[m,S]of f.entries())a.push([m,S])}a.sort((p,f)=>p[0].localeCompare(f[0]));const g=r.getActions({arg:{lineNumber:o,uri:i.uri},shouldForwardArgs:!0});if(a.push(...g),3===e.target.type){const p=this.editor.getSelections(),f={startLineNumber:o,endLineNumber:o,startColumn:1,endColumn:i.getLineLength(o)+1};p?.some(S=>!S.isEmpty()&&null!==S.intersectRanges(f))||this.editor.setSelection(f,"api")}this.contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>G.Z0.join(...a.map(p=>p[1])),onHide:()=>r.dispose()})})}};kt.ID="workbench.contrib.editorLineNumberContextMenu",kt=(0,u.gn)([(0,u.fM)(1,Y.i),(0,u.fM)(2,D.co),(0,u.fM)(3,A.i6),(0,u.fM)(4,q.TG)],kt),(0,H._K)(kt.ID,kt,1);var Xt=v(9595);(0,He.Z)(".monaco-editor .zone-widget .zone-widget-container.breakpoint-widget{border-color:#007acc;display:flex}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container{display:flex;flex-direction:column;flex-shrink:0;justify-content:center;padding:0 10px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container .monaco-select-box{min-height:18px;min-width:100px;padding:2px 20px 2px 8px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container:after{right:14px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .inputContainer{flex:1}",{});var ko=v(88002),Dt=v(46740),Do=v(77544),xe=v(39459),Yi=v(90290),xo=v(20390),Eo=v(69046),Io=v(49052),Mo=v(90524),Yt=v(37644),No=v(64822),xt=v(470);const To=y.$,en=(0,q.yh)("privateBreakpointWidgetService"),Ao="breakpointwidgetdecoration";let tn=class extends Do.I{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m){super(e,{showFrame:!0,showArrow:!1,frameWidth:1,isAccessible:!0}),this.lineNumber=t,this.column=i,this.contextViewService=o,this.debugService=s,this.themeService=r,this.contextKeyService=a,this.instantiationService=c,this.modelService=g,this.codeEditorService=p,this._configurationService=f,this.languageFeaturesService=m,this.conditionInput="",this.hitCountInput="",this.logMessageInput="",this.toDispose=[];const S=this.editor.getModel();if(S){const w=S.uri,M=this.debugService.getModel().getBreakpoints({lineNumber:this.lineNumber,column:this.column,uri:w});this.breakpoint=M.length?M[0]:void 0}this.context=void 0===n?this.breakpoint&&!this.breakpoint.condition&&!this.breakpoint.hitCondition&&this.breakpoint.logMessage?2:this.breakpoint&&!this.breakpoint.condition&&this.breakpoint.hitCondition?1:0:n,this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints(w=>{this.breakpoint&&w&&w.removed&&w.removed.indexOf(this.breakpoint)>=0&&this.dispose()})),this.codeEditorService.registerDecorationType("breakpoint-widget",Ao,{}),this.create()}get placeholder(){switch(this.context){case 2:return l.NC("breakpointWidgetLogMessagePlaceholder","Message to log when breakpoint is hit. Expressions within {} are interpolated. 'Enter' to accept, 'esc' to cancel.");case 1:return l.NC("breakpointWidgetHitCountPlaceholder","Break when hit count condition is met. 'Enter' to accept, 'esc' to cancel.");default:return l.NC("breakpointWidgetExpressionPlaceholder","Break when expression evaluates to true. 'Enter' to accept, 'esc' to cancel.")}}getInputValue(e){switch(this.context){case 2:return e&&e.logMessage?e.logMessage:this.logMessageInput;case 1:return e&&e.hitCondition?e.hitCondition:this.hitCountInput;default:return e&&e.condition?e.condition:this.conditionInput}}rememberInput(){const e=this.input.getModel().getValue();switch(this.context){case 2:this.logMessageInput=e;break;case 1:this.hitCountInput=e;break;default:this.conditionInput=e}}setInputMode(){if(this.editor.hasModel()){const e=2===this.context?No.bd:this.editor.getModel().getLanguageId();this.input.getModel().setLanguage(e)}}show(e){const t=this.input.getModel().getLineCount();super.show(e,t+1)}fitHeightToContent(){const e=this.input.getModel().getLineCount();this._relayout(e+1)}_fillContainer(e){this.setCssClass("breakpoint-widget");const t=new ko.j([{text:l.NC("expression","Expression")},{text:l.NC("hitCount","Hit Count")},{text:l.NC("logMessage","Log Message")}],this.context,this.contextViewService,xt.BM,{ariaLabel:l.NC("breakpointType","Breakpoint Type")});this.selectContainer=To(".breakpoint-select-container"),t.render(y.R3(e,this.selectContainer)),t.onDidSelect(i=>{this.rememberInput(),this.context=i.index,this.setInputMode();const n=this.getInputValue(this.breakpoint);this.input.getModel().setValue(n),this.input.focus()}),this.inputContainer=To(".inputContainer"),this.createBreakpointInput(y.R3(e,this.inputContainer)),this.input.getModel().setValue(this.getInputValue(this.breakpoint)),this.toDispose.push(this.input.getModel().onDidChangeContent(()=>{this.fitHeightToContent()})),this.input.setPosition({lineNumber:1,column:this.input.getModel().getLineMaxColumn(1)}),setTimeout(()=>this.input.focus(),150)}_doLayout(e,t){this.heightInPx=e,this.input.layout({height:e,width:t-113}),this.centerInputVertically()}_onWidth(e){"number"==typeof this.heightInPx&&this._doLayout(this.heightInPx,e)}createBreakpointInput(e){const t=this.contextKeyService.createScoped(e);this.toDispose.push(t);const i=this.instantiationService.createChild(new Io.y([A.i6,t],[en,this])),n=this.createEditorOptions(),o=(0,Yt.q)();this.input=i.createInstance(Mo.Gm,e,n,o),h.BG.bindTo(t).set(!0);const s=this.modelService.createModel("",null,ue.ov.parse(`${h.lR}:${this.editor.getId()}:breakpointinput`),!0);this.editor.hasModel()&&s.setLanguage(this.editor.getModel().getLanguageId()),this.input.setModel(s),this.setInputMode(),this.toDispose.push(s);const r=()=>{const c=this.input.getModel().getValue()?[]:function Zr(d,e){const t=d.getColor(x.NOs)?.transparent(.4);return[{range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:e,color:t?t.toString():void 0}}}]}(this.themeService.getColorTheme(),this.placeholder);this.input.setDecorationsByType("breakpoint-widget",Ao,c)};this.input.getModel().onDidChangeContent(()=>r()),this.themeService.onDidColorThemeChange(()=>r()),this.toDispose.push(this.languageFeaturesService.completionProvider.register({scheme:h.lR,hasAccessToAllModels:!0},{provideCompletionItems:(a,c,g,p)=>{let f;const m=this.editor.getModel();return f=m&&(0===this.context||2===this.context&&function $r(d){return d.getModel().bracketPairs.getBracketPairsInRange(ae.e.fromPositions(d.getPosition())).some(i=>"{"===i.openingBracketInfo.bracketText)}(this.input))?(0,xo.kL)(this.languageFeaturesService.completionProvider,m,new Dt.L(this.lineNumber,1),new xo.A9(void 0,(new Set).add(27)),g,p).then(S=>{let w=0;if(0===this.context)w=c.column-1;else{const M=this.input.getModel().getValue();for(;c.column-2-w>=0&&"{"!==M[c.column-2-w]&&" "!==M[c.column-2-w];)w++}return{suggestions:S.items.map(M=>(M.completion.range=ae.e.fromPositions(c.delta(0,-w),c),M.completion))}}):Promise.resolve({suggestions:[]}),f}})),this.toDispose.push(this._configurationService.onDidChangeConfiguration(a=>{(a.affectsConfiguration("editor.fontSize")||a.affectsConfiguration("editor.lineHeight"))&&(this.input.updateOptions(this.createEditorOptions()),this.centerInputVertically())}))}createEditorOptions(){const e=this._configurationService.getValue("editor"),t=(0,Yt.e)();return t.fontSize=e.fontSize,t.fontFamily=e.fontFamily,t.lineHeight=e.lineHeight,t.fontLigatures=e.fontLigatures,t.ariaLabel=this.placeholder,t}centerInputVertically(){if(this.container&&"number"==typeof this.heightInPx){const e=this.input.getOption(64),t=this.input.getModel().getLineCount();this.inputContainer.style.marginTop=(this.heightInPx-t*e)/2+"px"}}close(e){if(e){let t=this.breakpoint&&this.breakpoint.condition,i=this.breakpoint&&this.breakpoint.hitCondition,n=this.breakpoint&&this.breakpoint.logMessage;if(this.rememberInput(),(this.conditionInput||0===this.context)&&(t=this.conditionInput),(this.hitCountInput||1===this.context)&&(i=this.hitCountInput),(this.logMessageInput||2===this.context)&&(n=this.logMessageInput),this.breakpoint){const o=new Map;o.set(this.breakpoint.getId(),{condition:t,hitCondition:i,logMessage:n}),this.debugService.updateBreakpoints(this.breakpoint.originalUri,o,!1).then(void 0,Me.dL)}else{const o=this.editor.getModel();o&&this.debugService.addBreakpoints(o.uri,[{lineNumber:this.lineNumber,column:this.column,enabled:!0,condition:t,hitCondition:i,logMessage:n}])}}this.dispose()}dispose(){super.dispose(),this.input.dispose(),F.B9(this.toDispose),setTimeout(()=>this.editor.focus(),0)}};tn=(0,u.gn)([(0,u.fM)(4,Y.u),(0,u.fM)(5,h.tn),(0,u.fM)(6,X.XE),(0,u.fM)(7,A.i6),(0,u.fM)(8,q.TG),(0,u.fM)(9,Yi.q),(0,u.fM)(10,Eo.$),(0,u.fM)(11,Z.Ui),(0,u.fM)(12,rt.p)],tn),(0,H.fK)(new class zr extends H._l{constructor(){super({id:"breakpointWidget.action.acceptInput",precondition:h.pR,kbOpts:{kbExpr:h.BG,primary:3,weight:100}})}runEditorCommand(e,t){e.get(en).close(!0)}}),(0,H.fK)(new class jr extends H._l{constructor(){super({id:"closeBreakpointWidget",precondition:h.pR,kbOpts:{kbExpr:xe.u.textInputFocus,primary:9,secondary:[1033],weight:100}})}runEditorCommand(e,t,i){const n=t.getContribution(h.KI);if(n)return n.closeBreakpointWidget();e.get(en).close(!1)}});const Kr=y.$,Gr={description:"breakpoint-helper-decoration",glyphMarginClassName:V.kS.asClassName(E.os),glyphMargin:{position:Ae.U.Right},stickiness:1};function qr(d,e,t,i,n,o,s){const r=d.get(h.tn),a=d.get(bi.O),{icon:c,message:g,showAdapterUnverifiedMessage:p}=(0,Xt.CK)(i,n,t,void 0);let f,m;if(p){let M;m=r.getModel().getSessions().map(I=>{const L=r.getAdapterManager().getDebugger(I.configuration.type),N=L?.strings?.[h.hN.UnverifiedBreakpoints];if(N)return M||(M=(0,j.f6)(a.guessLanguageIdByFilepathOrFirstLine(t.uri))),M&&L.interestedInLanguage(M)?N:void 0}).find(I=>!!I)}if(g)if(f=new yo.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}),t.condition||t.hitCondition){const M=e.getLanguageId();f.appendCodeblock(M,g),m&&f.appendMarkdown("$(warning) "+m)}else f.appendText(g),m&&f.appendMarkdown("\n\n$(warning) "+m);else m&&(f=new yo.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(m));let S=null;o&&(S={color:(0,X.EN)(Lo),position:Ae.sh.Left});const w=t.column&&(s||t.column>e.getLineFirstNonWhitespaceColumn(t.lineNumber));return{description:"breakpoint-decoration",glyphMargin:{position:Ae.U.Right},glyphMarginClassName:V.kS.asClassName(c),glyphMarginHoverMessage:f,stickiness:1,before:w?{content:De.B4,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}:void 0,overviewRuler:S,zIndex:9999}}function nn(){return nn=(0,b.Z)(function*(d,e,t){return t.capabilities.supportsBreakpointLocationsRequest?yield Promise.all((0,de.EB)(e,i=>i).map(function(){var i=(0,b.Z)(function*(n){try{return{lineNumber:n,positions:yield t.breakpointsLocations(d.uri,n)}}catch{return{lineNumber:n,positions:[]}}});return function(n){return i.apply(this,arguments)}}())):[]}),nn.apply(this,arguments)}let on=class{constructor(e,t,i,n,o,s,r,a){this.editor=e,this.debugService=t,this.contextMenuService=i,this.instantiationService=n,this.dialogService=s,this.configurationService=r,this.labelService=a,this.breakpointHintDecoration=null,this.toDispose=[],this.ignoreDecorationsChangedEvent=!1,this.ignoreBreakpointsChangeEvent=!1,this.breakpointDecorations=[],this.candidateDecorations=[],this.breakpointWidgetVisible=h.pR.bindTo(o),this.setDecorationsScheduler=new Q.pY(()=>this.setDecorations(),30),this.setDecorationsScheduler.schedule(),this.registerListeners()}getContextMenuActionsAtPosition(e,t){if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return[];if(!this.debugService.canSetBreakpointsIn(t))return[];const i=this.debugService.getModel().getBreakpoints({lineNumber:e,uri:t.uri});return this.getContextMenuActions(i,t.uri,e)}registerListeners(){var e=this;this.toDispose.push(this.editor.onMouseDown(function(){var t=(0,b.Z)(function*(i){if(!e.debugService.getAdapterManager().hasEnabledDebuggers())return;const n=e.editor.getModel();if(!i.target.position||!n||2!==i.target.type||i.target.detail.isAfterLines||!e.marginFreeFromNonDebugDecorations(i.target.position.lineNumber)&&!i.target.element?.className.includes("breakpoint"))return;const o=e.debugService.canSetBreakpointsIn(n),s=i.target.position.lineNumber,r=n.uri;if(!(i.event.rightButton||re.dz&&i.event.leftButton&&i.event.ctrlKey)){const a=e.debugService.getModel().getBreakpoints({uri:r,lineNumber:s});if(a.length){const c=i.event.shiftKey,g=a.some(p=>p.enabled);if(c)a.forEach(p=>e.debugService.enableOrDisableBreakpoints(!g,p));else if(!re.IJ&&a.some(p=>!!p.condition||!!p.logMessage||!!p.hitCondition)){const p=a.every(w=>!!w.logMessage),f=p?l.NC("logPoint","Logpoint"):l.NC("breakpoint","Breakpoint"),m=l.NC("breakpointHasConditionDisabled","This {0} has a {1} that will get lost on remove. Consider enabling the {0} instead.",f.toLowerCase(),p?l.NC("message","message"):l.NC("condition","condition")),S=l.NC("breakpointHasConditionEnabled","This {0} has a {1} that will get lost on remove. Consider disabling the {0} instead.",f.toLowerCase(),p?l.NC("message","message"):l.NC("condition","condition"));yield e.dialogService.prompt({type:fe.Z.Info,message:g?S:m,buttons:[{label:l.NC({key:"removeLogPoint",comment:["&& denotes a mnemonic"]},"&&Remove {0}",f),run:()=>a.forEach(w=>e.debugService.removeBreakpoints(w.getId()))},{label:l.NC("disableLogPoint","{0} {1}",g?l.NC({key:"disable",comment:["&& denotes a mnemonic"]},"&&Disable"):l.NC({key:"enable",comment:["&& denotes a mnemonic"]},"&&Enable"),f),run:()=>a.forEach(w=>e.debugService.enableOrDisableBreakpoints(!g,w))}],cancelButton:!0})}else a.forEach(g?p=>e.debugService.removeBreakpoints(p.getId()):p=>e.debugService.enableOrDisableBreakpoints(!g,p))}else o&&e.debugService.addBreakpoints(r,[{lineNumber:s}])}});return function(i){return t.apply(this,arguments)}}())),Wr.D.pointerEvents&&Jt.isSafari||(this.toDispose.push(this.editor.onMouseMove(t=>{if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return;let i=-1;const n=this.editor.getModel();n&&t.target.position&&(2===t.target.type||3===t.target.type)&&this.debugService.canSetBreakpointsIn(n)&&this.marginFreeFromNonDebugDecorations(t.target.position.lineNumber)&&(t.target.detail.isAfterLines||(i=t.target.position.lineNumber)),this.ensureBreakpointHintDecoration(i)})),this.toDispose.push(this.editor.onMouseLeave(()=>{this.ensureBreakpointHintDecoration(-1)}))),this.toDispose.push(this.editor.onDidChangeModel((0,b.Z)(function*(){e.closeBreakpointWidget(),yield e.setDecorations()}))),this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints(()=>{!this.ignoreBreakpointsChangeEvent&&!this.setDecorationsScheduler.isScheduled()&&this.setDecorationsScheduler.schedule()})),this.toDispose.push(this.debugService.onDidChangeState(()=>{this.setDecorationsScheduler.isScheduled()||this.setDecorationsScheduler.schedule()})),this.toDispose.push(this.editor.onDidChangeModelDecorations(()=>this.onModelDecorationsChanged())),this.toDispose.push(this.configurationService.onDidChangeConfiguration(function(){var t=(0,b.Z)(function*(i){(i.affectsConfiguration("debug.showBreakpointsInOverviewRuler")||i.affectsConfiguration("debug.showInlineBreakpointCandidates"))&&(yield e.setDecorations())});return function(i){return t.apply(this,arguments)}}()))}getContextMenuActions(e,t,i,n){var o=this;const s=[];if(1===e.length){const r=e[0].logMessage?l.NC("logPoint","Logpoint"):l.NC("breakpoint","Breakpoint");s.push(new G.aU("debug.removeBreakpoint",l.NC("removeBreakpoint","Remove {0}",r),void 0,!0,(0,b.Z)(function*(){yield o.debugService.removeBreakpoints(e[0].getId())}))),s.push(new G.aU("workbench.debug.action.editBreakpointAction",l.NC("editBreakpoint","Edit {0}...",r),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(e[0].lineNumber,e[0].column)))),s.push(new G.aU("workbench.debug.viewlet.action.toggleBreakpoint",e[0].enabled?l.NC("disableBreakpoint","Disable {0}",r):l.NC("enableBreakpoint","Enable {0}",r),void 0,!0,()=>this.debugService.enableOrDisableBreakpoints(!e[0].enabled,e[0])))}else if(e.length>1){const r=e.slice().sort((a,c)=>a.column&&c.column?a.column-c.column:1);s.push(new G.wY("debug.removeBreakpoints",l.NC("removeBreakpoints","Remove Breakpoints"),r.map(a=>new G.aU("removeInlineBreakpoint",a.column?l.NC("removeInlineBreakpointOnColumn","Remove Inline Breakpoint on Column {0}",a.column):l.NC("removeLineBreakpoint","Remove Line Breakpoint"),void 0,!0,()=>this.debugService.removeBreakpoints(a.getId()))))),s.push(new G.wY("debug.editBreakpoints",l.NC("editBreakpoints","Edit Breakpoints"),r.map(a=>new G.aU("editBreakpoint",a.column?l.NC("editInlineBreakpointOnColumn","Edit Inline Breakpoint on Column {0}",a.column):l.NC("editLineBreakpoint","Edit Line Breakpoint"),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(a.lineNumber,a.column)))))),s.push(new G.wY("debug.enableDisableBreakpoints",l.NC("enableDisableBreakpoints","Enable/Disable Breakpoints"),r.map(a=>new G.aU(a.enabled?"disableColumnBreakpoint":"enableColumnBreakpoint",a.enabled?a.column?l.NC("disableInlineColumnBreakpoint","Disable Inline Breakpoint on Column {0}",a.column):l.NC("disableBreakpointOnLine","Disable Line Breakpoint"):a.column?l.NC("enableBreakpoints","Enable Inline Breakpoint on Column {0}",a.column):l.NC("enableBreakpointOnLine","Enable Line Breakpoint"),void 0,!0,()=>this.debugService.enableOrDisableBreakpoints(!a.enabled,a)))))}else s.push(new G.aU("addBreakpoint",l.NC("addBreakpoint","Add Breakpoint"),void 0,!0,()=>this.debugService.addBreakpoints(t,[{lineNumber:i,column:n}]))),s.push(new G.aU("addConditionalBreakpoint",l.NC("addConditionalBreakpoint","Add Conditional Breakpoint..."),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(i,n,0)))),s.push(new G.aU("addLogPoint",l.NC("addLogPoint","Add Logpoint..."),void 0,!0,()=>Promise.resolve(this.showBreakpointWidget(i,n,2))));return 2===this.debugService.state&&(s.push(new G.Z0),s.push(new G.aU("runToLine",l.NC("runToLine","Run to Line"),void 0,!0,()=>this.debugService.runTo(t,i).catch(Me.dL)))),s}marginFreeFromNonDebugDecorations(e){const t=this.editor.getLineDecorations(e);if(t)for(const{options:i}of t){const n=i.glyphMarginClassName;if(n&&(!n.includes("codicon-")||n.includes("codicon-testing-")||n.includes("codicon-merge-")||n.includes("codicon-arrow-")||n.includes("codicon-loading")))return!1}return!0}ensureBreakpointHintDecoration(e){this.editor.changeDecorations(t=>{this.breakpointHintDecoration&&(t.removeDecoration(this.breakpointHintDecoration),this.breakpointHintDecoration=null),-1!==e&&(this.breakpointHintDecoration=t.addDecoration({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1},Gr))})}setDecorations(){var e=this;return(0,b.Z)(function*(){if(!e.editor.hasModel())return;const t=(p,f)=>{const m=function Xr(d,e,t){const i=[];for(const{positions:n,lineNumber:o}of t){if(0===n.length)continue;const s=d.getLineFirstNonWhitespaceColumn(o),r=d.getLineLastNonWhitespaceColumn(o);n.forEach(a=>{const c=new ae.e(a.lineNumber,a.column,a.lineNumber,a.column+1);if(a.column<=s&&!e.some(p=>p.range.startColumn>s&&p.range.startLineNumber===a.lineNumber)||a.column>r)return;const g=e.find(p=>p.range.equalsRange(c));g&&g.inlineWidget||i.push({range:c,options:{description:"breakpoint-placeholder-decoration",stickiness:1,before:g?void 0:{content:De.B4,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}},breakpoint:g?g.breakpoint:void 0})})}return i}(n,e.breakpointDecorations,f),S=p.deltaDecorations(e.candidateDecorations.map(w=>w.decorationId),m);e.candidateDecorations.forEach(w=>{w.inlineWidget.dispose()}),e.candidateDecorations=S.map((w,M)=>{const I=m[M],L=I.breakpoint?(0,Xt.CK)(e.debugService.state,e.debugService.getModel().areBreakpointsActivated(),I.breakpoint,e.labelService).icon:E.eq.disabled;return{decorationId:w,inlineWidget:new ei(i,w,V.kS.asClassName(L),I.breakpoint,e.debugService,e.contextMenuService,()=>e.getContextMenuActions(I.breakpoint?[I.breakpoint]:[],i.getModel().uri,I.range.startLineNumber,I.range.startColumn))}})},i=e.editor,n=i.getModel(),o=e.debugService.getModel().getBreakpoints({uri:n.uri}),s=e.configurationService.getValue("debug"),r=e.instantiationService.invokeFunction(p=>function Qr(d,e,t,i,n,o){const s=[];return t.forEach(r=>{if(r.lineNumber>e.getLineCount())return;const a=t.some(p=>p!==r&&p.lineNumber===r.lineNumber),c=e.getLineFirstNonWhitespaceColumn(r.lineNumber),g=e.validateRange(r.column?new ae.e(r.lineNumber,r.column,r.lineNumber,r.column+1):new ae.e(r.lineNumber,c,r.lineNumber,c+1));s.push({options:qr(d,e,r,i,n,o,a),range:g})}),s}(p,n,o,e.debugService.state,e.debugService.getModel().areBreakpointsActivated(),s.showBreakpointsInOverviewRuler)),a=e.debugService.getViewModel().focusedSession,c=s.showInlineBreakpointCandidates&&a?function Jr(d,e,t){return nn.apply(this,arguments)}(e.editor.getModel(),r.map(p=>p.range.startLineNumber),a):Promise.resolve([]),g=yield Promise.race([c,(0,Q.Vs)(500).then(()=>{})]);void 0===g&&c.then(p=>i.changeDecorations(f=>t(f,p)));try{e.ignoreDecorationsChangedEvent=!0,i.changeDecorations(p=>{const f=p.deltaDecorations(e.breakpointDecorations.map(m=>m.decorationId),r);e.breakpointDecorations.forEach(m=>{m.inlineWidget?.dispose()}),e.breakpointDecorations=f.map((m,S)=>{let w;const M=o[S];if(r[S].options.before){const I=()=>e.getContextMenuActions([M],i.getModel().uri,M.lineNumber,M.column);w=new ei(i,m,r[S].options.glyphMarginClassName,M,e.debugService,e.contextMenuService,I)}return{decorationId:m,breakpoint:M,range:r[S].range,inlineWidget:w}}),g&&t(p,g)})}finally{e.ignoreDecorationsChangedEvent=!1}for(const p of e.breakpointDecorations)p.inlineWidget&&e.editor.layoutContentWidget(p.inlineWidget)})()}onModelDecorationsChanged(){var e=this;return(0,b.Z)(function*(){if(0===e.breakpointDecorations.length||e.ignoreDecorationsChangedEvent||!e.editor.hasModel())return;let t=!1;const i=e.editor.getModel();if(e.breakpointDecorations.forEach(o=>{if(t)return;const s=i.getDecorationRange(o.decorationId);s&&!o.range.equalsRange(s)&&(t=!0,o.range=s)}),!t)return;const n=new Map;for(let o=0,s=e.breakpointDecorations.length;o<s;o++){const r=e.breakpointDecorations[o],a=i.getDecorationRange(r.decorationId);a&&r.breakpoint&&n.set(r.breakpoint.getId(),{lineNumber:a.startLineNumber,column:r.breakpoint.column?a.startColumn:void 0})}try{e.ignoreBreakpointsChangeEvent=!0,yield e.debugService.updateBreakpoints(i.uri,n,!0)}finally{e.ignoreBreakpointsChangeEvent=!1}})()}showBreakpointWidget(e,t,i){this.breakpointWidget?.dispose(),this.breakpointWidget=this.instantiationService.createInstance(tn,this.editor,e,t,i),this.breakpointWidget.show({lineNumber:e,column:1}),this.breakpointWidgetVisible.set(!0)}closeBreakpointWidget(){this.breakpointWidget&&(this.breakpointWidget.dispose(),this.breakpointWidget=void 0,this.breakpointWidgetVisible.reset(),this.editor.focus())}dispose(){this.breakpointWidget?.dispose(),this.editor.removeDecorations(this.breakpointDecorations.map(e=>e.decorationId)),(0,F.B9)(this.toDispose)}};on=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,Y.i),(0,u.fM)(3,q.TG),(0,u.fM)(4,A.i6),(0,u.fM)(5,bt.Ss),(0,u.fM)(6,Z.Ui),(0,u.fM)(7,yt.e)],on),wo.registerGutterActionsGenerator(({lineNumber:d,editor:e,accessor:t},i)=>{const n=e.getModel(),o=t.get(h.tn);if(!n||!o.getAdapterManager().hasEnabledDebuggers()||!o.canSetBreakpointsIn(n))return;const s=e.getContribution(h.KI);if(!s)return;const r=s.getContextMenuActionsAtPosition(d,n);for(const a of r)i.push(a,"2_debug")});class ei{constructor(e,t,i,n,o,s,r){this.editor=e,this.decorationId=t,this.breakpoint=n,this.debugService=o,this.contextMenuService=s,this.getContextMenuActions=r,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.toDispose=[],this.range=this.editor.getModel().getDecorationRange(t),this.toDispose.push(this.editor.onDidChangeModelDecorations(()=>{const c=this.editor.getModel().getDecorationRange(this.decorationId);this.range&&!this.range.equalsRange(c)&&(this.range=c,this.editor.layoutContentWidget(this))})),this.create(i),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){var t=this;this.domNode=Kr(".inline-breakpoint-widget"),e&&this.domNode.classList.add(...e.split(" ")),this.toDispose.push(y.nm(this.domNode,y.tw.CLICK,function(){var n=(0,b.Z)(function*(o){switch(t.breakpoint?.enabled){case void 0:yield t.debugService.addBreakpoints(t.editor.getModel().uri,[{lineNumber:t.range.startLineNumber,column:t.range.startColumn}]);break;case!0:yield t.debugService.removeBreakpoints(t.breakpoint.getId());break;case!1:t.debugService.enableOrDisableBreakpoints(!0,t.breakpoint)}});return function(o){return n.apply(this,arguments)}}())),this.toDispose.push(y.nm(this.domNode,y.tw.CONTEXT_MENU,n=>{const o=new Xi.nV(n),s={x:o.posx,y:o.posy},r=this.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>s,getActions:()=>r,getActionsContext:()=>this.breakpoint,onHide:()=>(0,F.ex)(r)})}));const i=()=>{const n=this.editor.getOption(64);this.domNode.style.height=`${n}px`,this.domNode.style.width=`${Math.ceil(.8*n)}px`,this.domNode.style.marginLeft="4px"};i(),this.toDispose.push(this.editor.onDidChangeConfiguration(n=>{(n.hasChanged(50)||n.hasChanged(64))&&i()}))}getId(){return(0,et.R)()}getDomNode(){return this.domNode}getPosition(){return this.range?(this.domNode.classList.toggle("line-start",1===this.range.startColumn),{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn-1},preference:[0]}):null}dispose(){this.editor.removeContentWidget(this),(0,F.B9)(this.toDispose)}}ei.__decorator=(0,u.gn)([at.HP],ei.prototype,"getId",null),(0,X.Ic)((d,e)=>{const t=d.getColor(Lo);t&&e.addRule(`\n\t\t${E._i.map(r=>`.monaco-workbench ${V.kS.asCSSSelector(r.regular)}`).join(",\n\t\t")},\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.CI)},\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.os)}:not([class*='codicon-debug-breakpoint']):not([class*='codicon-debug-stackframe']),\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.eq.regular)}${V.kS.asCSSSelector(E.Ws)}::after,\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.eq.regular)}${V.kS.asCSSSelector(E.Qx)}::after {\n\t\t\tcolor: ${t} !important;\n\t\t}\n\t\t`);const i=d.getColor(Yr);i&&e.addRule(`\n\t\t${E._i.map(r=>`.monaco-workbench ${V.kS.asCSSSelector(r.disabled)}`).join(",\n\t\t")} {\n\t\t\tcolor: ${i};\n\t\t}\n\t\t`);const n=d.getColor(ea);n&&e.addRule(`\n\t\t${E._i.map(r=>`.monaco-workbench ${V.kS.asCSSSelector(r.unverified)}`).join(",\n\t\t")} {\n\t\t\tcolor: ${n};\n\t\t}\n\t\t`);const o=d.getColor(ta);o&&e.addRule(`\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.Qx)},\n\t\t.monaco-editor .debug-top-stack-frame-column {\n\t\t\tcolor: ${o} !important;\n\t\t}\n\t\t`);const s=d.getColor(ia);s&&e.addRule(`\n\t\t.monaco-workbench ${V.kS.asCSSSelector(E.Ws)} {\n\t\t\tcolor: ${s} !important;\n\t\t}\n\t\t`)});const Lo=(0,x.P6G)("debugIcon.breakpointForeground",{dark:"#E51400",light:"#E51400",hcDark:"#E51400",hcLight:"#E51400"},l.NC("debugIcon.breakpointForeground","Icon color for breakpoints.")),Yr=(0,x.P6G)("debugIcon.breakpointDisabledForeground",{dark:"#848484",light:"#848484",hcDark:"#848484",hcLight:"#848484"},l.NC("debugIcon.breakpointDisabledForeground","Icon color for disabled breakpoints.")),ea=(0,x.P6G)("debugIcon.breakpointUnverifiedForeground",{dark:"#848484",light:"#848484",hcDark:"#848484",hcLight:"#848484"},l.NC("debugIcon.breakpointUnverifiedForeground","Icon color for unverified breakpoints.")),ta=(0,x.P6G)("debugIcon.breakpointCurrentStackframeForeground",{dark:"#FFCC00",light:"#BE8700",hcDark:"#FFCC00",hcLight:"#BE8700"},l.NC("debugIcon.breakpointCurrentStackframeForeground","Icon color for the current breakpoint stack frame.")),ia=(0,x.P6G)("debugIcon.breakpointStackframeForeground",{dark:"#89D185",light:"#89D185",hcDark:"#89D185",hcLight:"#89D185"},l.NC("debugIcon.breakpointStackframeForeground","Icon color for all breakpoint stack frames."));(0,He.Z)(".monaco-editor .view-overlays .debug-top-stack-frame-line{background-color:var(--vscode-editor-stackFrameHighlightBackground)}.monaco-editor .view-overlays .debug-focused-stack-frame-line{background-color:var(--vscode-editor-focusedStackFrameHighlightBackground)}",{});const sn=(0,x.P6G)("editor.stackFrameHighlightBackground",{dark:"#ffff0033",light:"#ffff6673",hcDark:"#ffff0033",hcLight:"#ffff6673"},(0,l.NC)("topStackFrameLineHighlight","Background color for the highlight of line at the top stack frame position.")),rn=(0,x.P6G)("editor.focusedStackFrameHighlightBackground",{dark:"#7abd7a4d",light:"#cee7ce73",hcDark:"#7abd7a4d",hcLight:"#cee7ce73"},(0,l.NC)("focusedStackFrameLineHighlight","Background color for the highlight of line at focused stack frame position.")),oa={description:"top-stack-frame-margin",glyphMarginClassName:V.kS.asClassName(E.Qx),glyphMargin:{position:Ae.U.Right},zIndex:9999,stickiness:1,overviewRuler:{position:Ae.sh.Full,color:(0,X.EN)(sn)}},sa={description:"focused-stack-frame-margin",glyphMarginClassName:V.kS.asClassName(E.Ws),glyphMargin:{position:Ae.U.Right},zIndex:9999,stickiness:1,overviewRuler:{position:Ae.sh.Full,color:(0,X.EN)(rn)}},ra={description:"top-stack-frame-decoration",isWholeLine:!0,className:"debug-top-stack-frame-line",stickiness:1},aa={description:"focused-stack-frame-decoration",isWholeLine:!0,className:"debug-focused-stack-frame-line",stickiness:1};let an=class extends F.JT{constructor(e,t,i,n){super(),this.editor=e,this.debugService=t,this.uriIdentityService=i,this.logService=n,this.decorations=this.editor.createDecorationsCollection();const o=()=>this.decorations.set(this.createCallStackDecorations());this._register(R.ju.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getModel().onDidChangeCallStack)(()=>{o()})),this._register(this.editor.onDidChangeModel(s=>{s.newModelUrl&&o()})),o()}createCallStackDecorations(){const e=this.editor;if(!e.hasModel())return[];const t=this.debugService.getViewModel().focusedStackFrame,i=[];return this.debugService.getModel().getSessions().forEach(n=>{const o=n===t?.thread.session;n.getAllThreads().forEach(s=>{if(s.stopped){const r=s.getCallStack(),a=[];r.length>0&&(t&&!t.equals(r[0])&&a.push(t),a.push(r[0])),a.forEach(c=>{if(c&&this.uriIdentityService.extUri.isEqual(c.source.uri,e.getModel()?.uri)){if(c.range.startLineNumber>e.getModel()?.getLineCount()||c.range.startLineNumber<1)return void this.logService.warn(`CallStackEditorContribution: invalid stack frame line number: ${c.range.startLineNumber}`);const g=e.getModel().getLineFirstNonWhitespaceColumn(c.range.startLineNumber)>=c.range.startColumn;i.push(...function ca(d,e,t){const i=[],n=new ae.e(d.range.startLineNumber,d.range.startColumn,d.range.startLineNumber,1073741824),o=new ae.e(d.range.startLineNumber,d.range.startColumn,d.range.startLineNumber,d.range.startColumn+1),s=d.thread.getTopStackFrame();return d.getId()===s?.getId()?(e&&i.push({options:oa,range:o}),i.push({options:ra,range:n}),d.range.startColumn>1&&i.push({options:{description:"top-stack-frame-inline-decoration",before:{content:"\ueb8b",inlineClassName:t?"debug-top-stack-frame-column start-of-line":"debug-top-stack-frame-column",inlineClassNameAffectsLetterSpacing:!0}},range:n})):(e&&i.push({options:sa,range:o}),i.push({options:aa,range:n})),i}(c,o,g))}})}})}),(0,de.EB)(i,n=>`${n.options.className} ${n.options.glyphMarginClassName} ${n.range.startLineNumber} ${n.range.startColumn}`)}dispose(){super.dispose(),this.decorations.clear()}};an=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,ke.v),(0,u.fM)(3,nt.VZ)],an);var ct=v(9110),je=v(57688),ii=v(62981),he=v(53083),ce=v(48601),ge=v(36774),Ke=v(53091),Ge=v(45414),pe=v(11113),da=v(27331),la=v(383);const ha=/^(true|false)$/i,ga=/^(['"]).*\1$/,Qe=y.$;function ni(d){const e=Qe(".");return e.classList.add("debug-view-content"),d.appendChild(e),e}function dt(d,e,t){let i="string"==typeof d?d:d.value;if(e.className="value",null===i||(d instanceof T.A2||d instanceof T._w||d instanceof ot)&&!d.available?(e.classList.add("unavailable"),i!==T.A2.DEFAULT_VALUE&&e.classList.add("error")):(d instanceof T.Ly&&t.showChanged&&d.valueChanged&&i!==T.A2.DEFAULT_VALUE&&(e.className="value changed",d.valueChanged=!1),t.colorize&&"string"!=typeof d&&("number"===d.type||"boolean"===d.type||"string"===d.type?e.classList.add(d.type):isNaN(+i)?ha.test(i)?e.classList.add("boolean"):ga.test(i)&&e.classList.add("string"):e.classList.add("number"))),t.maxValueLength&&i&&i.length>t.maxValueLength&&(i=i.substring(0,t.maxValueLength)+"..."),i||(i=""),t.linkDetector){e.textContent="";const n=d instanceof T.Ly?d.getSession():void 0;e.appendChild(t.linkDetector.linkify(i,!1,n?n.root:void 0,!0))}else e.textContent=i;t.showHover&&(e.title=i||"")}function Bo(d,e,t,i,n){if(d.available){let o=d.name;d.value&&"string"==typeof d.name&&(o+=":"),e.label.set(o,i,d.type?d.type:d.name),e.name.classList.toggle("virtual","virtual"===d.presentationHint?.kind),e.name.classList.toggle("internal","internal"===d.presentationHint?.visibility)}else d.value&&"string"==typeof d.name&&d.name&&e.label.set(":");e.expression.classList.toggle("lazy",!!d.presentationHint?.lazy),dt(d,e.value,{showChanged:t,maxValueLength:1024,showHover:!0,colorize:!0,linkDetector:n})}let Et=class{constructor(e,t){this.debugService=e,this.contextViewService=t}renderTemplate(e){const t=y.R3(e,Qe(".expression")),i=y.R3(t,Qe("span.name")),n=y.R3(t,Qe("span.lazy-button"));n.classList.add(...V.kS.asClassNameArray(ii.lA.eye)),n.title=(0,l.NC)("debug.lazyButton.tooltip","Click to expand");const o=y.R3(t,Qe("span.value")),s=new je.q(i),r=y.R3(t,Qe(".inputBoxContainer")),a=new F.SL;let c;this.renderActionBar&&(y.R3(t,Qe(".span.actionbar-spacer")),c=a.add(new ct.o(t)));const g={expression:t,name:i,value:o,label:s,inputBoxContainer:r,actionBar:c,elementDisposable:[],templateDisposable:a,lazyButton:n,currentElement:void 0};return a.add(y.nm(n,y.tw.CLICK,()=>{g.currentElement&&this.debugService.getViewModel().evaluateLazyExpression(g.currentElement)})),g}renderExpressionElement(e,t,i){i.currentElement=e,this.renderExpression(t.element,i,(0,he.mB)(t.filterData)),i.actionBar&&this.renderActionBar(i.actionBar,e,i);const n=this.debugService.getViewModel().getSelectedExpression();if(e===n?.expression||e instanceof T._w&&e.errorMessage){const o=this.getInputBoxOptions(e,!!n?.settingWatch);o&&i.elementDisposable.push(this.renderInputBox(i.name,i.value,i.inputBoxContainer,o))}}renderInputBox(e,t,i,n){e.style.display="none",t.style.display="none",i.style.display="initial",y.PO(i);const o=new da.Wz(i,this.contextViewService,{...n,inputBoxStyles:xt.Hc});o.value=n.initialValue,o.focus(),o.select();const s=(0,la.I)((a,c)=>{e.style.display="",t.style.display="",i.style.display="none";const g=o.value;(0,F.B9)(r),c&&(this.debugService.getViewModel().setSelectedExpression(void 0,!1),n.onFinish(g,a))}),r=[o,y.mu(o.inputElement,y.tw.KEY_DOWN,a=>{const c=a.equals(9),g=a.equals(3);(c||g)&&(a.preventDefault(),a.stopPropagation(),s(g,!0))}),y.nm(o.inputElement,y.tw.BLUR,()=>{s(!0,!0)}),y.nm(o.inputElement,y.tw.CLICK,a=>{a.preventDefault(),a.stopPropagation()})];return(0,F.OF)(()=>{s(!1,!1)})}disposeElement(e,t,i){(0,F.B9)(i.elementDisposable),i.elementDisposable=[]}disposeTemplate(e){(0,F.B9)(e.elementDisposable),e.templateDisposable.dispose()}};Et=(0,u.gn)([(0,u.fM)(0,h.tn),(0,u.fM)(1,Y.u)],Et),(0,He.Z)(".monaco-workbench .debug-toolbar{border-radius:4px;display:flex;height:32px;padding-left:7px;position:absolute;z-index:39}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item{margin-right:4px}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item.select-container{margin-right:7px}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item.select-container .monaco-select-box,.monaco-workbench .start-debug-action-item .select-container .monaco-select-box{padding:0 22px 0 6px}.monaco-workbench .debug-toolbar .drag-area{align-items:center;cursor:grab;display:flex;justify-content:center;opacity:.5;width:16px}.monaco-workbench .debug-toolbar .drag-area.dragged{cursor:grabbing}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item .action-label{align-items:center;background-position:50%;background-repeat:no-repeat;background-size:16px;display:flex;justify-content:center;margin-right:0}",{});var fa=v(51762),It=v(6262),Ro=v(94485);const Vo=y.$;let oi=class zn extends Ro.YH{constructor(e,t,i,n,o,s,r,a){super(e,t),this.context=e,this.debugService=i,this.configurationService=n,this.commandService=o,this.contextService=s,this.keybindingService=a,this.debugOptions=[],this.selected=0,this.providers=[],this.toDispose=[],this.selectBox=new ko.j([],-1,r,xt.BM,{ariaLabel:l.NC("debugLaunchConfigurations","Debug Launch Configurations")}),this.selectBox.setFocusable(!1),this.toDispose.push(this.selectBox),this.registerListeners()}registerListeners(){this.toDispose.push(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("launch")&&this.updateOptions()})),this.toDispose.push(this.debugService.getConfigurationManager().onDidSelectConfiguration(()=>{this.updateOptions()}))}render(e){var t=this;this.container=e,e.classList.add("start-debug-action-item"),this.start=y.R3(e,Vo(V.kS.asCSSSelector(E.NA)));const i=this.keybindingService.lookupKeybinding(this.action.id)?.getLabel();this.start.title=this.action.label+(i?` (${i})`:""),this.start.setAttribute("role","button"),this.start.ariaLabel=this.start.title,this.toDispose.push(y.nm(this.start,y.tw.CLICK,()=>{this.start.blur(),1!==this.debugService.state&&this.actionRunner.run(this.action,this.context)})),this.toDispose.push(y.nm(this.start,y.tw.MOUSE_DOWN,s=>{this.action.enabled&&0===s.button&&this.start.classList.add("active")})),this.toDispose.push(y.nm(this.start,y.tw.MOUSE_UP,()=>{this.start.classList.remove("active")})),this.toDispose.push(y.nm(this.start,y.tw.MOUSE_OUT,()=>{this.start.classList.remove("active")})),this.toDispose.push(y.nm(this.start,y.tw.KEY_DOWN,s=>{const r=new It.y1(s);r.equals(17)&&(this.start.tabIndex=-1,this.selectBox.focus(),r.stopPropagation())})),this.toDispose.push(this.selectBox.onDidSelect(function(){var s=(0,b.Z)(function*(r){const a=t.debugOptions[r.index];a.handler&&(yield a.handler())?t.selected=r.index:t.selectBox.select(t.selected)});return function(r){return s.apply(this,arguments)}}()));const o=Vo(".configuration");this.selectBox.render(y.R3(e,o)),this.toDispose.push(y.nm(o,y.tw.KEY_DOWN,s=>{const r=new It.y1(s);r.equals(15)&&(this.selectBox.setFocusable(!1),this.start.tabIndex=0,this.start.focus(),r.stopPropagation())})),this.container.style.border=`1px solid ${(0,x.n_1)(x.a9O)}`,o.style.borderLeft=`1px solid ${(0,x.n_1)(x.a9O)}`,this.container.style.backgroundColor=(0,x.n_1)(x.XV0),this.debugService.getConfigurationManager().getDynamicProviders().then(s=>{this.providers=s,this.providers.length>0&&this.updateOptions()}),this.updateOptions()}setActionContext(e){this.context=e}isEnabled(){return!0}focus(e){e?this.selectBox.focus():(this.start.tabIndex=0,this.start.focus())}blur(){this.start.tabIndex=-1,this.selectBox.blur(),this.container.blur()}setFocusable(e){e?this.start.tabIndex=0:(this.start.tabIndex=-1,this.selectBox.setFocusable(!1))}dispose(){this.toDispose=(0,F.B9)(this.toDispose)}updateOptions(){var e=this;this.selected=0,this.debugOptions=[];const t=this.debugService.getConfigurationManager(),i=3===this.contextService.getWorkbenchState();let n;const o=[];var s;t.getAllConfigurations().forEach(({launch:s,name:r,presentation:a})=>{var g;n!==a?.group&&(n=a?.group,this.debugOptions.length&&(this.debugOptions.push({label:zn.SEPARATOR,handler:()=>Promise.resolve(!1)}),o.push(this.debugOptions.length-1))),r===t.selectedConfiguration.name&&s===t.selectedConfiguration.launch&&(this.selected=this.debugOptions.length),this.debugOptions.push({label:i?`${r} (${s.name})`:r,handler:(g=(0,b.Z)(function*(){return yield t.selectConfiguration(s,r),!0}),function(){return g.apply(this,arguments)})})}),t.getRecentDynamicConfigurations().slice(0,3).forEach(({name:s,type:r})=>{var a;r===t.selectedConfiguration.type&&t.selectedConfiguration.name===s&&(this.selected=this.debugOptions.length),this.debugOptions.push({label:s,handler:(a=(0,b.Z)(function*(){return yield t.selectConfiguration(void 0,s,void 0,{type:r}),!0}),function(){return a.apply(this,arguments)})})}),0===this.debugOptions.length&&this.debugOptions.push({label:l.NC("noConfigurations","No Configurations"),handler:(s=(0,b.Z)(function*(){return!1}),function(){return s.apply(this,arguments)})}),this.debugOptions.push({label:zn.SEPARATOR,handler:()=>Promise.resolve(!1)}),o.push(this.debugOptions.length-1),this.providers.forEach(s=>{var r;this.debugOptions.push({label:`${s.label}...`,handler:(r=(0,b.Z)(function*(){const a=yield s.pick();return!!a&&(yield t.selectConfiguration(a.launch,a.config.name,a.config,{type:s.type}),!0)}),function(){return r.apply(this,arguments)})})}),t.getLaunches().filter(s=>!s.hidden).forEach(s=>{const r=i?l.NC("addConfigTo","Add Config ({0})...",s.name):l.NC("addConfiguration","Add Configuration...");var a;this.debugOptions.push({label:r,handler:(a=(0,b.Z)(function*(){return yield e.commandService.executeCommand(C.Ee,s.uri.toString()),!1}),function(){return a.apply(this,arguments)})})}),this.selectBox.setOptions(this.debugOptions.map((s,r)=>({text:s.label,isDisabled:-1!==o.indexOf(r)})),this.selected)}};oi.SEPARATOR="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",oi=(0,u.gn)([(0,u.fM)(2,h.tn),(0,u.fM)(3,Z.Ui),(0,u.fM)(4,ne.H),(0,u.fM)(5,Te.ec),(0,u.fM)(6,Y.u),(0,u.fM)(7,Ke.d)],oi);let Mt=class extends Ro.Lc{constructor(e,t,i,n,o){super(null,e,[],-1,n,xt.BM,{ariaLabel:l.NC("debugSession","Debug Session")}),this.debugService=i,this.configurationService=o,this._register(this.debugService.getViewModel().onDidFocusSession(()=>{const r=this.getSelectedSession();if(r){const a=this.getSessions().indexOf(r);this.select(a)}})),this._register(this.debugService.onDidNewSession(r=>{const a=[];a.push(r.onDidChangeName(()=>this.update())),a.push(r.onDidEndAdapter(()=>(0,F.B9)(a))),this.update()})),this.getSessions().forEach(r=>{this._register(r.onDidChangeName(()=>this.update()))}),this._register(this.debugService.onDidEndSession(()=>this.update()));const s=t?this.mapFocusedSessionToSelected(t):void 0;this.update(s)}getActionContext(e,t){return this.getSessions()[t]}update(e){e||(e=this.getSelectedSession());const t=this.getSessions(),i=t.map(n=>{const o=n.getLabel();return n.parentSession?`\xa0\xa0${o}`:o});this.setOptions(i.map(n=>({text:n})),e?t.indexOf(e):void 0)}getSelectedSession(){const e=this.debugService.getViewModel().focusedSession;return e?this.mapFocusedSessionToSelected(e):void 0}getSessions(){const e=this.configurationService.getValue("debug").showSubSessionsInToolBar,t=this.debugService.getModel().getSessions();return e?t:t.filter(i=>!i.parentSession)}mapFocusedSessionToSelected(e){const t=this.configurationService.getValue("debug").showSubSessionsInToolBar;for(;e.parentSession&&!t;)e=e.parentSession;return e}};Mt=(0,u.gn)([(0,u.fM)(2,h.tn),(0,u.fM)(3,Y.u),(0,u.fM)(4,Z.Ui)],Mt);var Ee=v(88632),ba=v(81225);const ma=(0,x.P6G)("debugToolBar.background",{dark:"#333333",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},(0,l.NC)("debugToolBarBackground","Debug toolbar background color.")),va=(0,x.P6G)("debugToolBar.border",{dark:null,light:null,hcDark:null,hcLight:null},(0,l.NC)("debugToolBarBorder","Debug toolbar border color.")),Sa=(0,x.P6G)("debugIcon.startForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},(0,l.NC)("debugIcon.startForeground","Debug toolbar icon for start debugging.")),Po="debug.actionswidgetposition",Fo="debug.actionswidgety";let cn=class extends X.bB{constructor(e,t,i,n,o,s,r,a,c,g){super(r),this.notificationService=e,this.telemetryService=t,this.debugService=i,this.layoutService=n,this.storageService=o,this.configurationService=s,this.instantiationService=a,this.yCoordinate=0,this.isVisible=!1,this.isBuilt=!1,this.stopActionViewItemDisposables=this._register(new F.SL),this.$el=y.$("div.debug-toolbar"),this.$el.style.top=`${n.offset.top}px`,this.dragArea=y.R3(this.$el,y.$("div.drag-area"+V.kS.asCSSSelector(E.kc)));const p=y.R3(this.$el,y.$("div.action-bar-container"));this.debugToolBarMenu=c.createMenu(D.eH.DebugToolBar,g),this._register(this.debugToolBarMenu),this.activeActions=[],this.actionBar=this._register(new ct.o(p,{orientation:0,actionViewItemProvider:f=>{if(f.id===C.or)return this.instantiationService.createInstance(Mt,f,void 0);if(f.id===C.De||f.id===C.Sb){this.stopActionViewItemDisposables.clear();const m=this.instantiationService.invokeFunction(S=>dn(f,this.stopActionViewItemDisposables,S));if(m)return m}return(0,ge.Id)(this.instantiationService,f)}})),this.updateScheduler=this._register(new Q.pY(()=>{const f=this.debugService.state,m=this.configurationService.getValue("debug").toolBarLocation;if(0===f||"docked"===m||"hidden"===m||this.debugService.getModel().getSessions().every(w=>w.suppressDebugToolbar)||1===f&&this.debugService.initializingOptions?.suppressDebugToolbar)return this.hide();const S=[];(0,ge.vr)(this.debugToolBarMenu,{shouldForwardArgs:!0},S),de.fS(S,this.activeActions,(w,M)=>w.id===M.id&&w.enabled===M.enabled)||(this.actionBar.clear(),this.actionBar.push(S,{icon:!0,label:!1}),this.activeActions=S),this.show()},20)),this.updateStyles(),this.registerListeners(),this.hide()}registerListeners(){this._register(this.debugService.onDidChangeState(()=>this.updateScheduler.schedule())),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("debug.toolBarLocation")&&this.updateScheduler.schedule()})),this._register(this.debugToolBarMenu.onDidChange(()=>this.updateScheduler.schedule())),this._register(this.actionBar.actionRunner.onDidRun(e=>{e.error&&!Me.n2(e.error)&&this.notificationService.error(e.error),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"debugActionsWidget"})})),this._register(y.nm(window,y.tw.RESIZE,()=>this.setCoordinates())),this._register(y.q6(this.dragArea,e=>{2===new Xi.nV(e).detail&&(this.setCoordinates(.5*window.innerWidth-.5*this.$el.clientWidth,0),this.storePosition())})),this._register(y.u0(this.dragArea,e=>{this.dragArea.classList.add("dragged");const t=y.lB(window,n=>{const o=new Xi.nV(n);o.preventDefault(),this.setCoordinates(o.posx-14,o.posy-this.layoutService.offset.top)}),i=y.q6(window,n=>{this.storePosition(),this.dragArea.classList.remove("dragged"),t.dispose(),i.dispose()})})),this._register(this.layoutService.onDidChangePartVisibility(()=>this.setYCoordinate())),this._register(Jt.PixelRatio.onDidChange(()=>this.setYCoordinate()))}storePosition(){const e=y.Dx(this.$el).left;if(e){const t=parseFloat(e)/window.innerWidth;this.storageService.store(Po,t,0,1)}}updateStyles(){if(super.updateStyles(),this.$el){this.$el.style.backgroundColor=this.getColor(ma)||"";const e=this.getColor(x.rh);this.$el.style.boxShadow=e?`0 0 8px 2px ${e}`:"";const t=this.getColor(x.A42),i=this.getColor(va);t?this.$el.style.border=`1px solid ${t}`:(this.$el.style.border=i?`solid ${i}`:"none",this.$el.style.border="1px 0")}}setYCoordinate(e=this.yCoordinate){this.$el.style.top=`${this.layoutService.offset.top+e}px`,this.yCoordinate=e}setCoordinates(e,t){if(!this.isVisible)return;const i=this.$el.clientWidth;if(void 0===e){const o=this.storageService.get(Po,0);e=void 0!==o?parseFloat(o)*window.innerWidth:.5*window.innerWidth-.5*i}e=Math.max(0,Math.min(e,window.innerWidth-i)),this.$el.style.left=`${e}px`,void 0===t&&(t=this.storageService.getNumber(Fo,0,0));if(t<17.5||t>52.5){const o=t<35;this.setYCoordinate(o?0:35),this.storageService.store(Fo,o?0:70,0,1)}}show(){this.isVisible||(this.isBuilt||(this.isBuilt=!0,this.layoutService.container.appendChild(this.$el)),this.isVisible=!0,y.$Z(this.$el)),this.setCoordinates()}hide(){this.isVisible=!1,y.Cp(this.$el)}dispose(){super.dispose(),this.$el?.remove()}};function dn(d,e,t){const i=t.get(D.co),n=t.get(A.i6),o=t.get(q.TG),s=t.get(Y.i),r=i.createMenu(D.eH.DebugToolBarStop,n),a=[];if((0,ge.vr)(r,{shouldForwardArgs:!0},a),!a.length)return;const c=e.add(new G.aU("notebook.moreRunActions",(0,l.NC)("notebook.moreRunActionsLabel","More..."),"codicon-chevron-down",!0));return o.createInstance(fa.C,d,c,a,"debug-stop-actions",s,{})}cn=(0,u.gn)([(0,u.fM)(0,Ne.lT),(0,u.fM)(1,be.bU),(0,u.fM)(2,h.tn),(0,u.fM)(3,Ki.z),(0,u.fM)(4,Pe.Uy),(0,u.fM)(5,Z.Ui),(0,u.fM)(6,X.XE),(0,u.fM)(7,q.TG),(0,u.fM)(8,D.co),(0,u.fM)(9,A.i6)],cn);const ln=[],Se=(d,e,t,i,n,o,s)=>{D.BH.appendMenuItem(D.eH.DebugToolBar,{group:"navigation",when:n,order:t,command:{id:d,title:e,icon:i,precondition:o},alt:s}),ln.push(D.BH.appendMenuItem(D.eH.ViewContainerTitle,{group:"navigation",when:A.Ao.and(n,A.Ao.equals("viewContainer",h.f3),h.KA.notEqualsTo("inactive"),A.Ao.equals("config.debug.toolBarLocation","docked")),order:t,command:{id:d,title:e,icon:i,precondition:o}}))};D.BH.onDidChangeMenu(d=>{if(d.has(D.eH.DebugToolBar)){(0,F.B9)(ln);const e=D.BH.getMenuItems(D.eH.DebugToolBar);for(const t of e)ln.push(D.BH.appendMenuItem(D.eH.ViewContainerTitle,{...t,when:A.Ao.and(t.when,A.Ao.equals("viewContainer",h.f3),h.KA.notEqualsTo("inactive"),A.Ao.equals("config.debug.toolBarLocation","docked"))}))}}),Se(C.ZI,C.pl,10,E.Tl,h.KA.isEqualTo("stopped")),Se(C.rd,C.eW,10,E.cJ,h.KA.notEqualsTo("stopped"),h.KA.isEqualTo("running")),Se(C.De,C.yk,70,E.fR,h.dU.toNegated(),void 0,{id:C.Sb,title:C.XV,icon:E.DI,precondition:A.Ao.and(h.dU.toNegated(),h.rv)}),Se(C.Sb,C.XV,70,E.DI,h.dU,void 0,{id:C.De,title:C.yk,icon:E.fR,precondition:A.Ao.and(h.dU,h.rv)}),Se(C.xw,C.kj,20,E.xv,void 0,h.KA.isEqualTo("stopped")),Se(C.Xs,C.DP,30,E.Z5,void 0,h.KA.isEqualTo("stopped")),Se(C.GL,C.lG,40,E.Hp,void 0,h.KA.isEqualTo("stopped")),Se(C._M,C.Yl,60,E.gv),Se(C.rY,(0,l.NC)("stepBackDebug","Step Back"),50,E.oF,h.RX,h.KA.isEqualTo("stopped")),Se(C.YD,(0,l.NC)("reverseContinue","Reverse"),55,E.IO,h.RX,h.KA.isEqualTo("stopped")),Se(C.or,C.M2,100,void 0,h.d5),D.BH.appendMenuItem(D.eH.DebugToolBarStop,{group:"navigation",when:A.Ao.and(h.dU.toNegated(),h.rv),order:0,command:{id:C.Sb,title:C.XV,icon:E.DI}}),D.BH.appendMenuItem(D.eH.DebugToolBarStop,{group:"navigation",when:A.Ao.and(h.dU,h.rv),order:0,command:{id:C.De,title:C.yk,icon:E.fR}}),D.BH.appendMenuItem(D.eH.DebugToolBarStop,{group:"navigation",when:A.Ao.or(A.Ao.and(h.dU.toNegated(),h.uz,h.rv),A.Ao.and(h.dU,h.uz)),order:0,command:{id:C.O0,title:C.SI,icon:E.DI}});const ee=y.$;function Oo(d,e){return e.sessionId=d.getId(),e}function Ho(d,e){return e.threadId=d.getId(),Oo(d.session,e),e}function un(d){return d instanceof T.Di?function ya(d,e){return e.frameId=d.getId(),e.frameName=d.name,e.frameLocation={range:d.range,source:d.source.raw},Ho(d.thread,e),e}(d,{}):d instanceof T.jz?Ho(d,{}):Ce(d)?Oo(d,{}):void 0}function hn(d){return d instanceof T.Di?d.source.inMemory?d.source.raw.path||d.source.reference||d.source.name:d.source.uri.toString():d instanceof T.jz?d.threadId:Ce(d)?d.getId():""}function Wo(d){let e=d.thread.getStaleCallStack();e=e.length>0?e:d.thread.getCallStack();const t=e.map(o=>o.source).filter(o=>o!==d.source);let i=0;if(t.forEach(o=>{o.name===d.source.name&&(i=Math.max(i,(0,De.P1)(d.source.uri.path,o.uri.path)))}),0===i)return d.source.name;const n=Math.max(0,d.source.uri.path.lastIndexOf(ce.KR.sep,d.source.uri.path.length-i-1));return(n>0?"...":"")+d.source.uri.path.substring(n)}function gn(d,e){return pn.apply(this,arguments)}function pn(){return pn=(0,b.Z)(function*(d,e){d.parentSession&&(yield gn(d.parentSession,e)),yield e.expand(d)}),pn.apply(this,arguments)}let fn=class extends pe.qV{constructor(e,t,i,n,o,s,r,a,c,g,p,f){var m;super(e,n,t,r,a,s,o,c,g,p),m=this,this.options=e,this.debugService=i,this.menuService=f,this.needsRefresh=!1,this.ignoreSelectionChangedEvent=!1,this.ignoreFocusStackFrameEvent=!1,this.autoExpandedSessions=new Set,this.selectionNeedsUpdate=!1,this.onCallStackChangeScheduler=this._register(new Q.pY((0,b.Z)(function*(){const S=m.debugService.getModel().getSessions();0===S.length&&m.autoExpandedSessions.clear();const w=1===S.length&&1===S[0].getAllThreads().length?S[0].getAllThreads()[0]:void 0,M=1===S.length?S[0].getStoppedDetails():void 0;M&&(w||"number"!=typeof M.threadId)?(m.stateMessageLabel.textContent=si(M),m.stateMessageLabel.title=bn(M),m.stateMessageLabel.classList.toggle("exception","exception"===M.reason),m.stateMessage.hidden=!1):1===S.length&&3===S[0].state?(m.stateMessageLabel.textContent=(0,l.NC)({key:"running",comment:["indicates state"]},"Running"),m.stateMessageLabel.title=S[0].getLabel(),m.stateMessageLabel.classList.remove("exception"),m.stateMessage.hidden=!1):m.stateMessage.hidden=!0,m.updateActions(),m.needsRefresh=!1,m.dataSource.deemphasizedStackFramesToShow=[],yield m.tree.updateChildren();try{const I=new Set;S.forEach(L=>{L.parentSession&&!m.autoExpandedSessions.has(L.parentSession)&&I.add(L.parentSession)});for(const L of I)yield gn(L,m.tree),m.autoExpandedSessions.add(L)}catch{}m.selectionNeedsUpdate&&(m.selectionNeedsUpdate=!1,yield m.updateTreeSelection())}),50))}renderHeaderTitle(e){super.renderHeaderTitle(e,this.options.title),this.stateMessage=y.R3(e,ee("span.call-stack-state-message")),this.stateMessage.hidden=!0,this.stateMessageLabel=y.R3(this.stateMessage,ee("span.label"))}renderBody(e){var t=this;super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-call-stack");const i=ni(e);this.dataSource=new Da(this.debugService),this.tree=this.instantiationService.createInstance(Ge.ZI,"CallStackView",i,new ka,new Ea(this.debugService),[this.instantiationService.createInstance(Nt),this.instantiationService.createInstance(Tt),this.instantiationService.createInstance(At),new $o,new Le,new Zo],this.dataSource,{accessibilityProvider:new xa,compressionEnabled:!0,autoExpandSingleChildren:!0,identityProvider:{getId:o=>"string"==typeof o?o:o instanceof Array?`showMore ${o[0].getId()}`:o.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:o=>Ce(o)?o.getLabel():o instanceof T.jz?`${o.name} ${o.stateLabel}`:o instanceof T.Di||"string"==typeof o?o:o instanceof T.l_?Le.LABEL:(0,l.NC)("showMoreStackFrames2","Show More Stack Frames"),getCompressedNodeKeyboardNavigationLabel:o=>{const s=o[0];return Ce(s)?s.getLabel():""}},expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput(this.debugService.getModel()),this._register(this.tree.onDidOpen(function(){var o=(0,b.Z)(function*(s){if(t.ignoreSelectionChangedEvent)return;const r=(c,g,p,f={})=>{t.ignoreFocusStackFrameEvent=!0;try{t.debugService.focusStackFrame(c,g,p,{...f,explicit:!0})}finally{t.ignoreFocusStackFrameEvent=!1}},a=s.element;if(a instanceof T.Di&&r(a,a.thread,a.thread.session,{preserveFocus:s.editorOptions.preserveFocus,sideBySide:s.sideBySide,pinned:s.editorOptions.pinned}),a instanceof T.jz&&r(void 0,a,a.session),Ce(a)&&r(void 0,void 0,a),a instanceof T.l_){const c=t.debugService.getModel().getSession(a.sessionId),g=c&&c.getThread(a.threadId);if(g){const p=g.stoppedDetails?.totalFrames,f="number"==typeof p?p-g.getCallStack().length:void 0;yield g.fetchCallStack(f),yield t.tree.updateChildren()}}a instanceof Array&&(t.dataSource.deemphasizedStackFramesToShow.push(...a),t.tree.updateChildren())});return function(s){return o.apply(this,arguments)}}())),this._register(this.debugService.getModel().onDidChangeCallStack(()=>{this.isBodyVisible()?this.onCallStackChangeScheduler.isScheduled()||this.onCallStackChangeScheduler.schedule():this.needsRefresh=!0}));const n=R.ju.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getViewModel().onDidFocusSession);this._register(n((0,b.Z)(function*(){if(!t.ignoreFocusStackFrameEvent){if(!t.isBodyVisible())return void(t.needsRefresh=!0);if(t.onCallStackChangeScheduler.isScheduled())return void(t.selectionNeedsUpdate=!0);yield t.updateTreeSelection()}}))),this._register(this.tree.onContextMenu(o=>this.onContextMenu(o))),2===this.debugService.state&&this.onCallStackChangeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility(o=>{o&&this.needsRefresh&&this.onCallStackChangeScheduler.schedule()})),this._register(this.debugService.onDidNewSession(o=>{const s=[];s.push(o.onDidChangeName(()=>{this.tree.hasNode(o)&&this.tree.rerender(o)})),s.push(o.onDidEndAdapter(()=>(0,F.B9)(s))),o.parentSession&&this.autoExpandedSessions.delete(o.parentSession)}))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}updateTreeSelection(){var e=this;return(0,b.Z)(function*(){if(!e.tree||!e.tree.getInput())return;const t=s=>{e.ignoreSelectionChangedEvent=!0;try{e.tree.setSelection([s]),null===e.tree.getRelativeTop(s)?e.tree.reveal(s,.5):e.tree.reveal(s)}catch{}finally{e.ignoreSelectionChangedEvent=!1}},i=e.debugService.getViewModel().focusedThread,n=e.debugService.getViewModel().focusedSession,o=e.debugService.getViewModel().focusedStackFrame;if(i){try{yield gn(i.session,e.tree)}catch{}try{yield e.tree.expand(i)}catch{}const s=o||n;s&&t(s)}else n?t(n):e.tree.setSelection([])})()}onContextMenu(e){const t=e.element;let i=[];Ce(t)?i=_o(t):t instanceof T.jz?i=Uo(t):t instanceof T.Di&&(i=function wa(d){return[[h.fj.key,"stackFrame"],[h.ou.key,d.canRestart]]}(t));const s={primary:[],secondary:[]},r=this.contextKeyService.createOverlay(i),a=this.menuService.createMenu(D.eH.DebugCallStackContext,r);(0,ge.LJ)(a,{arg:hn(t),shouldForwardArgs:!0},s,"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>s.secondary,getActionsContext:()=>un(t)})}};function _o(d){return[[h.fj.key,"session"],[h.Xx.key,(0,se.Q5)(d)],[h.je.key,2===d.state],[h.xW.key,1===d.getAllThreads().length]]}fn=(0,u.gn)([(0,u.fM)(1,Y.i),(0,u.fM)(2,h.tn),(0,u.fM)(3,Ke.d),(0,u.fM)(4,q.TG),(0,u.fM)(5,J.XH),(0,u.fM)(6,Z.Ui),(0,u.fM)(7,A.i6),(0,u.fM)(8,Fe.v4),(0,u.fM)(9,X.XE),(0,u.fM)(10,be.bU),(0,u.fM)(11,D.co)],fn);let Nt=class Js{constructor(e,t,i){this.instantiationService=e,this.contextKeyService=t,this.menuService=i}get templateId(){return Js.ID}renderTemplate(e){const t=y.R3(e,ee(".session"));y.R3(t,ee(V.kS.asCSSSelector(E.K$)));const i=y.R3(t,ee(".name")),n=y.R3(t,ee("span.state.label.monaco-count-badge.long")),o=new je.q(i),s=new F.SL,r=s.add(new F.SL);return{session:t,name:i,stateLabel:n,label:o,actionBar:s.add(new ct.o(t,{actionViewItemProvider:g=>{if((g.id===C.De||g.id===C.Sb)&&g instanceof D.U8){r.clear();const p=this.instantiationService.invokeFunction(f=>dn(g,r,f));if(p)return p}return g instanceof D.U8?this.instantiationService.createInstance(ge.Mm,g,void 0):g instanceof D.NZ?this.instantiationService.createInstance(ge.bi,g,void 0):void 0}})),elementDisposable:s.add(new F.SL),templateDisposable:s}}renderElement(e,t,i){this.doRenderElement(e.element,(0,he.mB)(e.filterData),i)}renderCompressedElements(e,t,i){const n=e.element.elements[e.element.elements.length-1],o=(0,he.mB)(e.filterData);this.doRenderElement(n,o,i)}doRenderElement(e,t,i){i.session.title=(0,l.NC)({key:"session",comment:["Session is a noun"]},"Session"),i.label.set(e.getLabel(),t);const n=e.getStoppedDetails(),o=e.getAllThreads().find(c=>c.stopped),s=this.contextKeyService.createOverlay(_o(e)),r=i.elementDisposable.add(this.menuService.createMenu(D.eH.DebugCallStackContext,s)),a=()=>{i.actionBar.clear();const c=[],p={primary:c,secondary:[]};(0,ge.vr)(r,{arg:hn(e),shouldForwardArgs:!0},p,"inline"),i.actionBar.push(c,{icon:!0,label:!1}),i.actionBar.context=un(e)};i.elementDisposable.add(r.onDidChange(()=>a())),a(),i.stateLabel.style.display="",n?(i.stateLabel.textContent=si(n),i.session.title=`${e.getLabel()}: ${bn(n)}`,i.stateLabel.classList.toggle("exception","exception"===n.reason)):o&&o.stoppedDetails?(i.stateLabel.textContent=si(o.stoppedDetails),i.session.title=`${e.getLabel()}: ${bn(o.stoppedDetails)}`,i.stateLabel.classList.toggle("exception","exception"===o.stoppedDetails.reason)):(i.stateLabel.textContent=(0,l.NC)({key:"running",comment:["indicates state"]},"Running"),i.stateLabel.classList.remove("exception"))}disposeTemplate(e){e.templateDisposable.dispose()}disposeElement(e,t,i){i.elementDisposable.clear()}disposeCompressedElements(e,t,i,n){i.elementDisposable.clear()}};function Uo(d){return[[h.fj.key,"thread"],[h.je.key,d.stopped]]}Nt.ID="session",Nt=(0,u.gn)([(0,u.fM)(0,q.TG),(0,u.fM)(1,A.i6),(0,u.fM)(2,D.co)],Nt);let Tt=class Xs{constructor(e,t){this.contextKeyService=e,this.menuService=t}get templateId(){return Xs.ID}renderTemplate(e){const t=y.R3(e,ee(".thread")),i=y.R3(t,ee(".name")),n=y.R3(t,ee("span.state.label.monaco-count-badge.long")),o=new je.q(i),s=new F.SL;return{thread:t,name:i,stateLabel:n,label:o,actionBar:s.add(new ct.o(t)),elementDisposable:s.add(new F.SL),templateDisposable:s}}renderElement(e,t,i){const n=e.element;i.thread.title=n.name,i.label.set(n.name,(0,he.mB)(e.filterData)),i.stateLabel.textContent=n.stateLabel,i.stateLabel.classList.toggle("exception","exception"===n.stoppedDetails?.reason);const o=this.contextKeyService.createOverlay(Uo(n)),s=i.elementDisposable.add(this.menuService.createMenu(D.eH.DebugCallStackContext,o)),r=()=>{i.actionBar.clear();const a=[],g={primary:a,secondary:[]};(0,ge.vr)(s,{arg:hn(n),shouldForwardArgs:!0},g,"inline"),i.actionBar.push(a,{icon:!0,label:!1}),i.actionBar.context=un(n)};i.elementDisposable.add(s.onDidChange(()=>r())),r()}renderCompressedElements(e,t,i,n){throw new Error("Method not implemented.")}disposeElement(e,t,i){i.elementDisposable.clear()}disposeTemplate(e){e.templateDisposable.dispose()}};Tt.ID="thread",Tt=(0,u.gn)([(0,u.fM)(0,A.i6),(0,u.fM)(1,D.co)],Tt);let At=class Ys{constructor(e,t){this.labelService=e,this.notificationService=t}get templateId(){return Ys.ID}renderTemplate(e){const t=y.R3(e,ee(".stack-frame")),i=y.R3(t,ee("span.label.expression")),n=y.R3(t,ee(".file")),o=y.R3(n,ee("span.file-name")),s=y.R3(n,ee("span.line-number-wrapper")),r=y.R3(s,ee("span.line-number.monaco-count-badge")),a=new je.q(i),c=new F.SL;return{file:n,fileName:o,label:a,lineNumber:r,stackFrame:t,actionBar:c.add(new ct.o(t)),templateDisposable:c}}renderElement(e,t,i){var n=this;const o=e.element;i.stackFrame.classList.toggle("disabled",!o.source||!o.source.available||mn(o)),i.stackFrame.classList.toggle("label","label"===o.presentationHint),i.stackFrame.classList.toggle("subtle","subtle"===o.presentationHint);const s=!!o.thread.session.capabilities.supportsRestartFrame&&"label"!==o.presentationHint&&"subtle"!==o.presentationHint&&o.canRestart;if(i.stackFrame.classList.toggle("has-actions",s),i.file.title=o.source.inMemory?o.source.uri.path:this.labelService.getUriLabel(o.source.uri),o.source.raw.origin&&(i.file.title+=`\n${o.source.raw.origin}`),i.label.set(o.name,(0,he.mB)(e.filterData),o.name),i.fileName.textContent=Wo(o),void 0!==o.range.startLineNumber?(i.lineNumber.textContent=`${o.range.startLineNumber}`,o.range.startColumn&&(i.lineNumber.textContent+=`:${o.range.startColumn}`),i.lineNumber.classList.remove("unavailable")):i.lineNumber.classList.add("unavailable"),i.actionBar.clear(),s){const r=new G.aU("debug.callStack.restartFrame",(0,l.NC)("restartFrame","Restart Frame"),V.kS.asClassName(E._d),!0,(0,b.Z)(function*(){try{yield o.restart()}catch(a){n.notificationService.error(a)}}));i.actionBar.push(r,{icon:!0,label:!1})}}renderCompressedElements(e,t,i,n){throw new Error("Method not implemented.")}disposeTemplate(e){e.actionBar.dispose()}};At.ID="stackFrame",At=(0,u.gn)([(0,u.fM)(0,yt.e),(0,u.fM)(1,Ne.lT)],At);let $o=(()=>{class d{get templateId(){return d.ID}renderTemplate(t){return{label:y.R3(t,ee(".error"))}}renderElement(t,i,n){const o=t.element;n.label.textContent=o,n.label.title=o}renderCompressedElements(t,i,n,o){throw new Error("Method not implemented.")}disposeTemplate(t){}}return d.ID="error",d})();class Le{constructor(){}get templateId(){return Le.ID}renderTemplate(e){const t=y.R3(e,ee(".load-all"));return t.style.color=(0,x.n_1)(x.url),{label:t}}renderElement(e,t,i){i.label.textContent=Le.LABEL}renderCompressedElements(e,t,i,n){throw new Error("Method not implemented.")}disposeTemplate(e){}}Le.ID="loadMore",Le.LABEL=(0,l.NC)("loadAllStackFrames","Load More Stack Frames");let Zo=(()=>{class d{constructor(){}get templateId(){return d.ID}renderTemplate(t){const i=y.R3(t,ee(".show-more"));return i.style.color=(0,x.n_1)(x.url),{label:i}}renderElement(t,i,n){const o=t.element;n.label.textContent=o.every(s=>!(!s.source||!s.source.origin||s.source.origin!==o[0].source.origin))?(0,l.NC)("showMoreAndOrigin","Show {0} More: {1}",o.length,o[0].source.origin):(0,l.NC)("showMoreStackFrames","Show {0} More Stack Frames",o.length)}renderCompressedElements(t,i,n,o){throw new Error("Method not implemented.")}disposeTemplate(t){}}return d.ID="showMore",d})();class ka{getHeight(e){return e instanceof T.Di&&"label"===e.presentationHint||e instanceof T.l_||e instanceof Array?16:22}getTemplateId(e){return Ce(e)?Nt.ID:e instanceof T.jz?Tt.ID:e instanceof T.Di?At.ID:"string"==typeof e?$o.ID:e instanceof T.l_?Le.ID:Zo.ID}}function bn(d){return d.text??si(d)}function si(d){return d.description||(d.reason?(0,l.NC)({key:"pausedOn",comment:["indicates reason for program being paused"]},"Paused on {0}",d.reason):(0,l.NC)("paused","Paused"))}function zo(d){return"function"==typeof d.getSessions}function Ce(d){return d&&"function"==typeof d.getAllThreads}function mn(d){return"deemphasize"===d.source.presentationHint||"deemphasize"===d.presentationHint}class Da{constructor(e){this.debugService=e,this.deemphasizedStackFramesToShow=[]}hasChildren(e){if(Ce(e)){const t=e.getAllThreads();return t.length>1||1===t.length&&t[0].stopped||!!this.debugService.getModel().getSessions().find(i=>i.parentSession===e)}return zo(e)||e instanceof T.jz&&e.stopped}getChildren(e){var t=this;return(0,b.Z)(function*(){if(zo(e)){const i=e.getSessions();if(0===i.length)return Promise.resolve([]);if(i.length>1||t.debugService.getViewModel().isMultiSessionView())return Promise.resolve(i.filter(o=>!o.parentSession));const n=i[0].getAllThreads();return 1===n.length?t.getThreadChildren(n[0]):Promise.resolve(n)}if(Ce(e)){const i=t.debugService.getModel().getSessions().filter(o=>o.parentSession===e),n=e.getAllThreads();return 1===n.length?(yield t.getThreadChildren(n[0])).concat(i):Promise.resolve(n.concat(i))}return t.getThreadChildren(e)})()}getThreadChildren(e){return this.getThreadCallstack(e).then(t=>{const i=[];return t.forEach((n,o)=>{if(n instanceof T.Di&&n.source&&mn(n)&&-1===this.deemphasizedStackFramesToShow.indexOf(n)){if(i.length){const r=i[i.length-1];if(r instanceof Array)return void r.push(n)}const s=o<t.length-1?t[o+1]:void 0;if(s instanceof T.Di&&s.source&&mn(s))return void i.push([n])}i.push(n)}),i})}getThreadCallstack(e){return(0,b.Z)(function*(){let t=e.getCallStack();return(!t||!t.length)&&(yield e.fetchCallStack(),t=e.getCallStack()),1===t.length&&e.session.capabilities.supportsDelayedStackTraceLoading&&e.stoppedDetails&&e.stoppedDetails.totalFrames&&e.stoppedDetails.totalFrames>1&&(t=t.concat(e.getStaleCallStack().slice(1))),e.stoppedDetails&&e.stoppedDetails.framesErrorMessage&&(t=t.concat([e.stoppedDetails.framesErrorMessage])),!e.reachedEndOfCallStack&&e.stoppedDetails&&(t=t.concat([new T.l_(e.session.getId(),e.threadId)])),t})()}}class xa{getWidgetAriaLabel(){return(0,l.NC)({comment:["Debug is a noun in this context, not a verb."],key:"callStackAriaLabel"},"Debug Call Stack")}getWidgetRole(){return"treegrid"}getRole(e){return"row"}getAriaLabel(e){if(e instanceof T.jz)return(0,l.NC)({key:"threadAriaLabel",comment:['Placeholders stand for the thread name and the thread state.For example "Thread 1" and "Stopped']},"Thread {0} {1}",e.name,e.stateLabel);if(e instanceof T.Di)return(0,l.NC)("stackFrameAriaLabel","Stack Frame {0}, line {1}, {2}",e.name,e.range.startLineNumber,Wo(e));if(Ce(e)){const t=e.getAllThreads().find(n=>n.stopped),i=t?t.stateLabel:(0,l.NC)({key:"running",comment:["indicates state"]},"Running");return(0,l.NC)({key:"sessionLabel",comment:['Placeholders stand for the session name and the session state. For example "Launch Program" and "Running"']},"Session {0} {1}",e.getLabel(),i)}return"string"==typeof e?e:e instanceof Array?(0,l.NC)("showMoreStackFrames","Show {0} More Stack Frames",e.length):Le.LABEL}}class Ea{constructor(e){this.debugService=e}isIncompressible(e){return!Ce(e)||!(e.compact||this.debugService.getModel().getSessions().some(i=>i.parentSession===e&&i.compact))}}function We(d,e,t,i,n,o){D.BH.appendMenuItem(D.eH.DebugCallStackContext,{group:"inline",order:n,when:i,command:{id:d,title:e,icon:t,precondition:o}})}(0,D.r1)(class extends pe.Nx{constructor(){super({id:"callStack.collapse",viewId:h.Vw,title:(0,l.NC)("collapse","Collapse All"),f1:!1,icon:ii.lA.collapseAll,precondition:h.KA.isEqualTo((0,h.wD)(2)),menu:{id:D.eH.ViewTitle,order:10,group:"navigation",when:A.Ao.equals("view",h.Vw)}})}runInView(e,t){t.collapseAll()}});const Lt=A.Ao.or(h.fj.isEqualTo("thread"),A.Ao.and(h.fj.isEqualTo("session"),h.xW));We(C.rd,C.eW,E.cJ,A.Ao.and(Lt,h.je.toNegated()),10),We(C.ZI,C.pl,E.Tl,A.Ao.and(Lt,h.je),10),We(C.xw,C.kj,E.xv,Lt,20,h.je),We(C.Xs,C.DP,E.Z5,Lt,30,h.je),We(C.GL,C.lG,E.Hp,Lt,40,h.je),We(C._M,C.Yl,E.gv,h.fj.isEqualTo("session"),50),We(C.De,C.yk,E.fR,A.Ao.and(h.Xx.toNegated(),h.fj.isEqualTo("session")),60),We(C.Sb,C.XV,E.DI,A.Ao.and(h.Xx,h.fj.isEqualTo("session")),60);var ri=v(10434);let vn=class extends ri.${constructor(e,t,i){super(C.OD,{canAcceptInBackground:!0}),this._debugService=e,this._viewsService=t,this._commandService=i}_getPicks(e,t,i){const n=[];this._debugService.getModel().getSessions(!0).filter(s=>s.hasSeparateRepl()).forEach((s,r)=>{const a=this._createPick(s,r,e);a&&n.push(a)}),n.length>0&&n.push({type:"separator"});const o=(0,l.NC)("workbench.action.debug.startDebug","Start a New Debug Session");return n.push({label:`$(plus) ${o}`,ariaLabel:o,accept:()=>this._commandService.executeCommand(C.w8)}),n}_createPick(e,t,i){const n=e.name,o=(0,he.Oh)(i,n,!0);if(o)return{label:n,highlights:{label:o},accept:(s,r)=>{this._debugService.focusStackFrame(void 0,void 0,e,{explicit:!0}),this._viewsService.isViewVisible(h.FT)||this._viewsService.openView(h.FT,!0)}}}};vn=(0,u.gn)([(0,u.fM)(0,h.tn),(0,u.fM)(1,J.qC),(0,u.fM)(2,ne.H)],vn);var Ia=v(19980),jo=v(48928),Ko=v(86682);let La=(()=>{class d extends H.x1{constructor(){super({id:d.ID,title:{value:l.NC("openDisassemblyView","Open Disassembly View"),original:"Open Disassembly View",mnemonicTitle:l.NC({key:"miDisassemblyView",comment:["&& denotes a mnemonic"]},"&&DisassemblyView")},precondition:h.pL,menu:[{id:D.eH.EditorContext,group:"debug",order:5,when:A.Ao.and(h.hO,Ko.dX.toNegated(),h.KA.isEqualTo("stopped"),xe.u.editorTextFocus,h.Pt,h.gM)},{id:D.eH.DebugCallStackContext,group:"z_commands",order:50,when:A.Ao.and(h.hO,h.KA.isEqualTo("stopped"),h.fj.isEqualTo("stackFrame"),h.Pt)},{id:D.eH.CommandPalette,when:A.Ao.and(h.hO,h.KA.isEqualTo("stopped"),h.Pt)}]})}runEditorCommand(t,i,...n){i.hasModel()&&t.get(oe.AR).openEditor(qt.n.instance,{pinned:!0})}}return d.ID="editor.debug.action.openDisassemblyView",d})(),Ba=(()=>{class d extends D.Ke{constructor(){super({id:d.ID,title:{value:l.NC("toggleDisassemblyViewSourceCode","Toggle Source Code in Disassembly View"),original:"Toggle Source Code in Disassembly View",mnemonicTitle:l.NC({key:"mitogglesource",comment:["&& denotes a mnemonic"]},"&&ToggleSource")},f1:!0})}run(t,i,...n){const o=t.get(Z.Ui);if(o){const s=o.getValue("debug").disassemblyView.showSourceCode;o.updateValue(d.configID,!s)}}}return d.ID="debug.action.toggleDisassemblyViewSourceCode",d.configID="debug.disassemblyView.showSourceCode",d})();class _e extends H.R6{constructor(){super({id:_e.ID,label:_e.LABEL,alias:"Debug: Run to Cursor",precondition:A.Ao.and(h.hO,Ko.dX.toNegated(),h.KA.isEqualTo("stopped"),xe.u.editorTextFocus),contextMenuOpts:{group:"debug",order:2}})}run(e,t){return(0,b.Z)(function*(){const i=t.getPosition();if(!t.hasModel()||!i)return;const n=t.getModel().uri,o=e.get(h.tn),s=o.getViewModel(),r=e.get(ke.v);let a;const c=s.focusedStackFrame;c&&r.extUri.isEqual(c.source.uri,n)&&c.range.startLineNumber===i.lineNumber&&(a=i.column),yield o.runTo(n,i.lineNumber,a)})()}}_e.ID="editor.debug.action.runToCursor",_e.LABEL=l.NC("runToCursor","Run to Cursor");class Ue extends H.R6{constructor(){super({id:Ue.ID,label:Ue.LABEL,alias:"Debug: Evaluate in Console",precondition:A.Ao.and(h.hO,xe.u.editorTextFocus),contextMenuOpts:{group:"debug",order:0}})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=e.get(J.qC),o=i.getViewModel(),s=o.focusedSession;if(!t.hasModel()||!s)return;const r=t.getSelection();let a;a=r.isEmpty()?t.getModel().getLineContent(r.selectionStartLineNumber).trim():t.getModel().getValueInRange(r),yield s.addReplExpression(o.focusedStackFrame,a),yield n.openView(h.FT,!1)})()}}Ue.ID="editor.debug.action.selectionToRepl",Ue.LABEL=l.NC("evaluateInDebugConsole","Evaluate in Debug Console");class $e extends H.R6{constructor(){super({id:$e.ID,label:$e.LABEL,alias:"Debug: Add to Watch",precondition:A.Ao.and(h.hO,xe.u.editorTextFocus),contextMenuOpts:{group:"debug",order:1}})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=e.get(J.qC),o=e.get(rt.p);if(!t.hasModel())return;let s;const r=t.getModel(),a=t.getSelection();if(a.isEmpty()){const c=t.getPosition(),g=yield(0,se.Cc)(o,r,c);if(!g)return;s=g.matchingExpression}else s=r.getValueInRange(a);s&&(yield n.openView(h.Vn),i.addWatchExpression(s))})()}}$e.ID="editor.debug.action.selectionToWatch",$e.LABEL=l.NC("addToWatch","Add to Watch");const Go=l.NC("editor.debug.action.stepIntoTargets.notAvailable","Step targets are not available here");class lt extends H.R6{constructor(){super({id:lt.ID,label:lt.LABEL,alias:"Debug: Step Into Target",precondition:A.Ao.and(h.o8,h.hO,h.KA.isEqualTo("stopped"),xe.u.editorTextFocus),contextMenuOpts:{group:"debug",order:1.5}})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=e.get(Y.i),o=e.get(ke.v),s=i.getViewModel().focusedSession,r=i.getViewModel().focusedStackFrame,a=t.getSelection(),c=a?.getPosition()||r&&{lineNumber:r.range.startLineNumber,column:r.range.startColumn};if(!(s&&r&&t.hasModel()&&o.extUri.isEqual(t.getModel().uri,r.source.uri)))return void(c&&jo.O.get(t)?.showMessage(Go,c));const g=yield s.stepInTargets(r.frameId);if(!g?.length)return void jo.O.get(t)?.showMessage(Go,c);if(a){const w=[];for(const L of g)L.line&&w.push({start:new Dt.L(L.line,L.column||1),end:L.endLine?new Dt.L(L.endLine,L.endColumn||1):void 0,target:L});w.sort((L,N)=>N.start.lineNumber-L.start.lineNumber||N.start.column-L.start.column);const M=a.getPosition(),I=w.find(L=>L.end&&M.isBefore(L.end)&&L.start.isBeforeOrEqual(M))||w.find(L=>void 0===L.end&&L.start.isBeforeOrEqual(M));if(I)return void s.stepIn(r.thread.threadId,I.target.id)}t.revealLineInCenterIfOutsideViewport(r.range.startLineNumber);const p=t.getScrolledVisiblePosition(c),f=(0,y.i)(t.getDomNode()),m=f.left+p.left,S=f.top+p.top+p.height;n.showContextMenu({getAnchor:()=>({x:m,y:S}),getActions:()=>g.map(w=>new G.aU(`stepIntoTarget:${w.id}`,w.label,void 0,!0,()=>s.stepIn(r.thread.threadId,w.id)))})})()}}lt.ID="editor.debug.action.stepIntoTargets",lt.LABEL=l.NC({key:"stepIntoTargets",comment:["Step Into Targets lets the user step into an exact function he or she is interested in."]},"Step Into Target");class Qo extends H.R6{constructor(e,t){super(t),this.isNext=e}run(e,t){var i=this;return(0,b.Z)(function*(){const n=e.get(h.tn),o=e.get(oe.AR),s=e.get(ke.v);if(t.hasModel()){const r=t.getModel().uri,a=t.getPosition().lineNumber,c=n.getModel().getBreakpoints({enabledOnly:!0});let g=i.isNext?c.filter(p=>s.extUri.isEqual(p.uri,r)&&p.lineNumber>a).shift():c.filter(p=>s.extUri.isEqual(p.uri,r)&&p.lineNumber<a).pop();if(g||(g=i.isNext?c.filter(p=>p.uri.toString()>r.toString()).shift():c.filter(p=>p.uri.toString()<r.toString()).pop()),!g&&c.length&&(g=i.isNext?c[0]:c[c.length-1]),g)return(0,Xt.u6)(g,!1,!0,!1,n,o)}})()}}(0,D.r1)(La),(0,D.r1)(Ba),(0,H.Qr)(class Ma extends H.R6{constructor(){super({id:"editor.debug.action.toggleBreakpoint",label:l.NC("toggleBreakpointAction","Debug: Toggle Breakpoint"),alias:"Debug: Toggle Breakpoint",precondition:h.Qe,kbOpts:{kbExpr:xe.u.editorTextFocus,primary:67,weight:100},menuOpts:{when:h.Qe,title:l.NC({key:"miToggleBreakpoint",comment:["&& denotes a mnemonic"]},"Toggle &&Breakpoint"),menuId:D.eH.MenubarDebugMenu,group:"4_new_breakpoint",order:1}})}run(e,t){return(0,b.Z)(function*(){if(t.hasModel()){const i=e.get(h.tn),n=t.getModel().uri,o=i.canSetBreakpointsIn(t.getModel()),s=[...new Set(t.getSelections().map(r=>r.getPosition().lineNumber))];yield Promise.all(s.map(function(){var r=(0,b.Z)(function*(a){const c=i.getModel().getBreakpoints({lineNumber:a,uri:n});c.length?yield Promise.all(c.map(g=>i.removeBreakpoints(g.getId()))):o&&(yield i.addBreakpoints(n,[{lineNumber:a}]))});return function(a){return r.apply(this,arguments)}}()))}})()}}),(0,H.Qr)(class Na extends H.R6{constructor(){super({id:"editor.debug.action.conditionalBreakpoint",label:l.NC("conditionalBreakpointEditorAction","Debug: Add Conditional Breakpoint..."),alias:"Debug: Add Conditional Breakpoint...",precondition:h.Qe,menuOpts:{menuId:D.eH.MenubarNewBreakpointMenu,title:l.NC({key:"miConditionalBreakpoint",comment:["&& denotes a mnemonic"]},"&&Conditional Breakpoint..."),group:"1_breakpoints",order:1,when:h.Qe}})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=t.getPosition();n&&t.hasModel()&&i.canSetBreakpointsIn(t.getModel())&&t.getContribution(h.KI)?.showBreakpointWidget(n.lineNumber,void 0,0)})()}}),(0,H.Qr)(class Ta extends H.R6{constructor(){super({id:"editor.debug.action.addLogPoint",label:l.NC("logPointEditorAction","Debug: Add Logpoint..."),precondition:h.Qe,alias:"Debug: Add Logpoint...",menuOpts:[{menuId:D.eH.MenubarNewBreakpointMenu,title:l.NC({key:"miLogPoint",comment:["&& denotes a mnemonic"]},"&&Logpoint..."),group:"1_breakpoints",order:4,when:h.Qe}]})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=t.getPosition();n&&t.hasModel()&&i.canSetBreakpointsIn(t.getModel())&&t.getContribution(h.KI)?.showBreakpointWidget(n.lineNumber,n.column,2)})()}}),(0,H.Qr)(class Aa extends H.R6{constructor(){super({id:"editor.debug.action.editBreakpoint",label:l.NC("EditBreakpointEditorAction","Debug: Edit Breakpoint"),alias:"Debug: Edit Existing Breakpoint",precondition:h.Qe,menuOpts:{menuId:D.eH.MenubarNewBreakpointMenu,title:l.NC({key:"miEditBreakpoint",comment:["&& denotes a mnemonic"]},"&&Edit Breakpoint"),group:"1_breakpoints",order:1,when:h.Qe}})}run(e,t){return(0,b.Z)(function*(){const i=e.get(h.tn),n=t.getPosition(),o=i.getModel();if(!t.hasModel()||!n)return;const s=o.getBreakpoints({lineNumber:n.lineNumber});if(0===s.length)return;const r=s.map(g=>g.column?Math.abs(g.column-n.column):n.column),c=s[r.indexOf(Math.min(...r))];t.getContribution(h.KI)?.showBreakpointWidget(c.lineNumber,c.column)})()}}),(0,H.Qr)(_e),(0,H.Qr)(lt),(0,H.Qr)(Ue),(0,H.Qr)($e),(0,H.Qr)(class Ra extends H.R6{constructor(){super({id:"editor.debug.action.showDebugHover",label:l.NC("showDebugHover","Debug: Show Hover"),alias:"Debug: Show Hover",precondition:h.hO,kbOpts:{kbExpr:xe.u.editorTextFocus,primary:(0,Ia.gx)(2089,2087),weight:100}})}run(e,t){return(0,b.Z)(function*(){const i=t.getPosition();if(i&&t.hasModel())return t.getContribution(h.X)?.showHover(i,!0)})()}}),(0,H.Qr)(class Va extends Qo{constructor(){super(!0,{id:"editor.debug.action.goToNextBreakpoint",label:l.NC("goToNextBreakpoint","Debug: Go to Next Breakpoint"),alias:"Debug: Go to Next Breakpoint",precondition:h.Qe})}}),(0,H.Qr)(class Pa extends Qo{constructor(){super(!1,{id:"editor.debug.action.goToPreviousBreakpoint",label:l.NC("goToPreviousBreakpoint","Debug: Go to Previous Breakpoint"),alias:"Debug: Go to Previous Breakpoint",precondition:h.Qe})}}),(0,H.Qr)(class Fa extends H.R6{constructor(){super({id:"editor.debug.action.closeExceptionWidget",label:l.NC("closeExceptionWidget","Close Exception Widget"),alias:"Close Exception Widget",precondition:h.rh,kbOpts:{primary:9,weight:100}})}run(e,t){return(0,b.Z)(function*(){t.getContribution(h.X)?.closeExceptionWidget()})()}});var Oa=v(20565),qo=v(71057),Ha=v(87064),Jo=v(542),Xo=v(96946),Wa=v(74458),_a=v(54912),Ua=v(53683),$a=v(16342),Za=v(23448);const Yo="\\u0000-\\u0020\\u007f-\\u009f",za=new RegExp("(?:[a-zA-Z][a-zA-Z0-9+.-]{2,}:\\/\\/|data:|www\\.)[^\\s"+Yo+'"]{2,}[^\\s'+Yo+"\"')}\\],:;.!?]","ug"),Ga=new RegExp(`(${/(?:[a-zA-Z]:(?:(?:\\|\/)[\w\.-]*)+)/.source}|${/(?:(?:\~|\.)(?:(?:\\|\/)[\w\.-]*)+)/.source})`),Ja=new RegExp(`${re.ED?Ga.source:/((?:\~|\.)?(?:\/[\w\.-]*)+)/.source}${/(?:\:([\d]+))?(?:\:([\d]+))?/.source}`,"g"),Xa=/:([\d]+)(?::([\d]+))?$/;let qe=class{constructor(e,t,i,n,o,s,r){this.editorService=e,this.fileService=t,this.openerService=i,this.pathService=n,this.tunnelService=o,this.environmentService=s,this.configurationService=r}linkify(e,t,i,n){if(t){const s=e.split("\n");for(let c=0;c<s.length-1;c++)s[c]=s[c]+"\n";s[s.length-1]||s.pop();const r=s.map(c=>this.linkify(c,!1,i,n));if(1===r.length)return r[0];const a=document.createElement("span");return r.forEach(c=>a.appendChild(c)),a}const o=document.createElement("span");for(const s of this.detectLinks(e))try{switch(s.kind){case"text":o.appendChild(document.createTextNode(s.value));break;case"web":o.appendChild(this.createWebLink(n?e:void 0,s.value));break;case"path":{const r=s.captures[0],a=s.captures[1]?Number(s.captures[1]):0,c=s.captures[2]?Number(s.captures[2]):0;o.appendChild(this.createPathLink(n?e:void 0,s.value,r,a,c,i));break}}}catch{o.appendChild(document.createTextNode(s.value))}return o}createWebLink(e,t){var i=this;const n=this.createLink(t);let o=ue.ov.parse(t);const s=Xa.exec(o.path);return s&&(o=o.with({path:o.path.slice(0,s.index),fragment:`L${s[0].slice(1)}`})),this.decorateLink(n,o,e,(0,b.Z)(function*(){if(o.scheme!==ze.lg.file)i.openerService.open(t,{allowTunneling:!!i.environmentService.remoteAuthority&&i.configurationService.getValue("remote.forwardOnOpen")});else{const r=o.fsPath,a=yield i.pathService.path,c=ce.Fv(a.sep===ce.KR.sep&&re.ED?r.replace(/\\/g,ce.KR.sep):r),g=ue.ov.parse(c);if(!(yield i.fileService.exists(g)))return;yield i.editorService.openEditor({resource:g,options:{pinned:!0,selection:s?{startLineNumber:+s[1],startColumn:+s[2]}:void 0}})}})),n}createPathLink(e,t,i,n,o,s){if("/"===i[0]&&"/"===i[1])return document.createTextNode(t);const r={selection:{startLineNumber:n,startColumn:o}};if("."===i[0]){if(!s)return document.createTextNode(t);const g=s.toResource(i),p=this.createLink(t);return this.decorateLink(p,g,e,f=>this.editorService.openEditor({resource:g,options:{...r,preserveFocus:f}})),p}if("~"===i[0]){const g=this.pathService.resolvedUserHome;g&&(i=ce.v_(g.fsPath,i.substring(1)))}const a=this.createLink(t);a.tabIndex=0;const c=ue.ov.file(ce.Fv(i));return this.fileService.stat(c).then(g=>{g.isDirectory||this.decorateLink(a,c,e,p=>this.editorService.openEditor({resource:c,options:{...r,preserveFocus:p}}))}).catch(()=>{}),a}createLink(e){const t=document.createElement("a");return t.textContent=e,t}decorateLink(e,t,i,n){e.classList.add("link");const o=this.tunnelService.canTunnel(t)?(0,l.NC)("followForwardedLink","follow link using forwarded port"):(0,l.NC)("followLink","follow link");e.title=i?re.dz?(0,l.NC)("fileLinkWithPathMac","Cmd + click to {0}\n{1}",o,i):(0,l.NC)("fileLinkWithPath","Ctrl + click to {0}\n{1}",o,i):re.dz?(0,l.NC)("fileLinkMac","Cmd + click to {0}",o):(0,l.NC)("fileLink","Ctrl + click to {0}",o),e.onmousemove=s=>{e.classList.toggle("pointer",re.dz?s.metaKey:s.ctrlKey)},e.onmouseleave=()=>e.classList.remove("pointer"),e.onclick=s=>{const r=window.getSelection();!r||"Range"===r.type||(re.dz?s.metaKey:s.ctrlKey)&&(s.preventDefault(),s.stopImmediatePropagation(),n(!1))},e.onkeydown=s=>{const r=new It.y1(s);(3===r.keyCode||10===r.keyCode)&&(r.preventDefault(),r.stopPropagation(),n(10===r.keyCode))}}detectLinks(e){if(e.length>2e3)return[{kind:"text",value:e,captures:[]}];const t=[za,Ja],i=["web","path"],n=[],o=(s,r)=>{if(r>=t.length)return void n.push({value:s,kind:"text",captures:[]});const a=t[r];let g,c=0;for(a.lastIndex=0;null!==(g=a.exec(s));){const f=s.substring(c,g.index);f&&o(f,r+1);const m=g[0];n.push({value:m,kind:i[r],captures:g.slice(1)}),c=g.index+m.length}const p=s.substring(c);p&&o(p,r+1)};return o(e,0),n}};qe=(0,u.gn)([(0,u.fM)(0,oe.AR),(0,u.fM)(1,U.sn),(0,u.fM)(2,Fe.v4),(0,u.fM)(3,Qi.a),(0,u.fM)(4,Za.XN),(0,u.fM)(5,vi.n),(0,u.fM)(6,Z.Ui)],qe);var ut=v(42965),es=v(7003);const Sn=y.$;let ai,te,Cn=!0,yn=class extends pe.qV{constructor(e,t,i,n,o,s,r,a,c,g,p,f){var m;super(e,n,t,o,a,r,s,c,g,p),m=this,this.debugService=i,this.menuService=f,this.needsRefresh=!1,this.savedViewState=new Map,this.autoExpandedScopes=new Set,this.updateTreeScheduler=new Q.pY((0,b.Z)(function*(){const S=m.debugService.getViewModel().focusedStackFrame;m.needsRefresh=!1;const w=m.tree.getInput();if(w&&m.savedViewState.set(w.getId(),m.tree.getViewState()),!S)return void(yield m.tree.setInput(null));const M=m.savedViewState.get(S.getId());yield m.tree.setInput(S,M);const L=(yield S.getScopes()).find(N=>!N.expensive);L&&m.tree.hasNode(L)&&(m.autoExpandedScopes.add(L.getId()),yield m.tree.expand(L))}),400)}renderBody(e){var t=this;super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-variables");const i=ni(e),n=this.instantiationService.createInstance(qe);let o;this.tree=this.instantiationService.createInstance(Ge.ls,"VariablesView",i,new ic,[this.instantiationService.createInstance(Be,n),new ns,new os],new tc,{accessibilityProvider:new nc,identityProvider:{getId:s=>s.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:s=>s.name},overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput((0,j.M2)(this.debugService.getViewModel().focusedStackFrame)),h.$l.bindTo(this.tree.contextKeyService),this._register(this.debugService.getViewModel().onDidFocusStackFrame(s=>{this.isBodyVisible()?this.updateTreeScheduler.schedule(s.explicit?0:void 0):this.needsRefresh=!0})),this._register(this.debugService.getViewModel().onWillUpdateViews(()=>{const s=this.debugService.getViewModel().focusedStackFrame;s&&Cn&&s.forgetScopes(),Cn=!0,this.tree.updateChildren()})),this._register(this.tree.onMouseDblClick(s=>this.onMouseDblClick(s))),this._register(this.tree.onContextMenu(function(){var s=(0,b.Z)(function*(r){return yield t.onContextMenu(r)});return function(r){return s.apply(this,arguments)}}())),this._register(this.onDidChangeBodyVisibility(s=>{s&&this.needsRefresh&&this.updateTreeScheduler.schedule()})),this._register(this.debugService.getViewModel().onDidSelectExpression(s=>{const r=s?.expression;r instanceof T._w&&!s?.settingWatch?(o=this.tree.options.horizontalScrolling,o&&this.tree.updateOptions({horizontalScrolling:!1}),this.tree.rerender(r)):!s&&void 0!==o&&(this.tree.updateOptions({horizontalScrolling:o}),o=void 0)})),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(function(){var s=(0,b.Z)(function*(r){r instanceof T._w&&t.tree.hasNode(r)&&(yield t.tree.updateChildren(r,!1,!0),yield t.tree.expand(r))});return function(r){return s.apply(this,arguments)}}())),this._register(this.debugService.onDidEndSession(()=>{this.savedViewState.clear(),this.autoExpandedScopes.clear()}))}layoutBody(e,t){super.layoutBody(t,e),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){const t=this.debugService.getViewModel().focusedSession;t&&e.element instanceof T._w&&t.capabilities.supportsSetVariable&&!e.element.presentationHint?.attributes?.includes("readOnly")&&!e.element.presentationHint?.lazy&&this.debugService.getViewModel().setSelectedExpression(e.element,!1)}onContextMenu(e){var t=this;return(0,b.Z)(function*(){const i=e.element;if(!(i instanceof T._w&&i.value))return;const n=new F.SL;try{const o=yield function ec(d,e){return wn.apply(this,arguments)}(t.contextKeyService,i),s=n.add(t.menuService.createMenu(D.eH.DebugVariablesContext,o)),r=ts(i),a=[];(0,ge.LJ)(s,{arg:r,shouldForwardArgs:!1},{primary:[],secondary:a},"inline"),t.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>a})}finally{n.dispose()}})()}};yn=(0,u.gn)([(0,u.fM)(1,Y.i),(0,u.fM)(2,h.tn),(0,u.fM)(3,Ke.d),(0,u.fM)(4,Z.Ui),(0,u.fM)(5,q.TG),(0,u.fM)(6,J.XH),(0,u.fM)(7,A.i6),(0,u.fM)(8,Fe.v4),(0,u.fM)(9,X.XE),(0,u.fM)(10,be.bU),(0,u.fM)(11,D.co)],yn);const ts=d=>({sessionId:d.getSession()?.getId(),container:d.parent instanceof T.A2?{expression:d.parent.name}:d.parent.toDebugProtocolObject(),variable:d.toDebugProtocolObject()});function wn(){return wn=(0,b.Z)(function*(d,e){const t=e.getSession();if(!t||!t.capabilities.supportsDataBreakpoints)return kn(d,e);const i=[];te=yield t.dataBreakpointInfo(e.name,e.parent.reference);const n=te?.dataId,o=te?.accessTypes;if(o)for(const s of o)switch(s){case"read":i.push([h.pP.key,!!n]);break;case"write":i.push([h.IA.key,!!n]);break;case"readWrite":i.push([h.DD.key,!!n])}else i.push([h.IA.key,!!n]);return kn(d,e,i)}),wn.apply(this,arguments)}function kn(d,e,t=[]){const i=e.getSession(),n=[[h.uD.key,e.variableMenuContext||""],[h.D7.key,!!e.evaluateName],[h.SC.key,!!i?.capabilities.supportsReadMemoryRequest&&void 0!==e.memoryReference],[h.hs.key,!!e.presentationHint?.attributes?.includes("readOnly")||e.presentationHint?.lazy],...t];return ai=e,d.createOverlay(n)}function is(d){return d instanceof T.Di}class tc{hasChildren(e){return!!e&&(!!is(e)||e.hasChildren)}getChildren(e){return is(e)?e.getScopes():e.getChildren()}}class ic{getHeight(e){return 22}getTemplateId(e){return e instanceof T.FP?os.ID:e instanceof T.sX?ns.ID:Be.ID}}let ns=(()=>{class d{get templateId(){return d.ID}renderTemplate(t){const i=y.R3(t,Sn(".scope"));return{name:i,label:new je.q(i)}}renderElement(t,i,n){n.label.set(t.element.name,(0,he.mB)(t.filterData))}disposeTemplate(t){}}return d.ID="scope",d})(),os=(()=>{class d{get templateId(){return d.ID}renderTemplate(t){const i=y.R3(t,Sn(".scope"));return{error:y.R3(i,Sn(".error"))}}renderElement(t,i,n){n.error.innerText=t.element.name}disposeTemplate(){}}return d.ID="scopeError",d})(),Be=class er extends Et{constructor(e,t,i,n,o){super(n,o),this.linkDetector=e,this.menuService=t,this.contextKeyService=i}get templateId(){return er.ID}renderExpression(e,t,i){Bo(e,t,!0,i,this.linkDetector)}renderElement(e,t,i){super.renderExpressionElement(e.element,e,i)}getInputBoxOptions(e){const t=e;return{initialValue:e.value,ariaLabel:(0,l.NC)("variableValueAriaLabel","Type new variable value"),validationOptions:{validation:()=>t.errorMessage?{content:t.errorMessage}:null},onFinish:(i,n)=>{t.errorMessage=void 0;const o=this.debugService.getViewModel().focusedStackFrame;n&&t.value!==i&&o&&t.setVariable(i,o).then(()=>{Cn=!1,this.debugService.getViewModel().updateViews()})}}}renderActionBar(e,t){const i=t,n=kn(this.contextKeyService,i),o=this.menuService.createMenu(D.eH.DebugVariablesContext,n),s=[],r=ts(i);(0,ge.LJ)(o,{arg:r,shouldForwardArgs:!1},{primary:s,secondary:[]},"inline"),e.clear(),e.context=r,e.push(s,{icon:!0,label:!1})}};Be.ID="variable",Be=(0,u.gn)([(0,u.fM)(1,D.co),(0,u.fM)(2,A.i6),(0,u.fM)(3,h.tn),(0,u.fM)(4,Y.u)],Be);class nc{getWidgetAriaLabel(){return(0,l.NC)("variablesAriaTreeLabel","Debug Variables")}getAriaLabel(e){return e instanceof T.sX?(0,l.NC)("variableScopeAriaLabel","Scope {0}",e.name):e instanceof T._w?(0,l.NC)({key:"variableAriaLabel",comment:["Placeholders are variable name and variable value respectivly. They should not be translated."]},"{0}, value {1}",e.name,e.value):null}}const ss="debug.setVariable";ne.P.registerCommand({id:ss,handler:d=>{d.get(h.tn).getViewModel().setSelectedExpression(ai,!1)}});const Dn="workbench.debug.viewlet.action.copyValue";var d;ne.P.registerCommand({id:Dn,handler:(d=(0,b.Z)(function*(e,t,i){const n=e.get(h.tn),o=e.get(ut.p);let r,s="";t instanceof T._w||t instanceof T.A2?(s="watch",r=i||[]):(s="variables",r=ai?[ai]:[]);const a=n.getViewModel().focusedStackFrame,c=n.getViewModel().focusedSession;if(!a||!c||0===r.length)return;const g=c.capabilities.supportsClipboardContext?"clipboard":s,p=r.map(f=>f instanceof T._w?f.evaluateName||f.value:f.name);try{const f=yield Promise.all(p.map(S=>c.evaluate(S,a.frameId,g))),m=(0,de.kX)(f).map(S=>S.body.result);m.length&&o.writeText(m.join("\n"))}catch{const m=r.map(S=>S.value);o.writeText(m.join("\n"))}}),function(t,i,n){return d.apply(this,arguments)})});const xn="workbench.debug.viewlet.action.viewMemory",En="ms-vscode.hexeditor";ne.P.registerCommand({id:xn,handler:function(){var d=(0,b.Z)(function*(e,t,i){const n=e.get(h.tn);let o,s;if("sessionId"in t){if(!t.sessionId||!t.variable.memoryReference)return;o=t.sessionId,s=t.variable.memoryReference}else{if(!t.memoryReference)return;const S=n.getViewModel().focusedSession;if(!S)return;o=S.getId(),s=t.memoryReference}const r=e.get(ne.H),a=e.get(oe.AR),c=e.get(Ne.lT),g=e.get(es.R9),p=e.get(it.QS),f=e.get(be.bU);((yield p.getExtension(En))||(yield function sc(d,e,t,i){return new Promise(n=>{let o=!1;d.prompt(Ne.zb.Info,(0,l.NC)("viewMemory.prompt","Inspecting binary data requires the Hex Editor extension. Would you like to install it now?"),[{label:(0,l.NC)("cancel","Cancel"),run:()=>n(!1)},{label:(0,l.NC)("install","Install"),run:function(){var r=(0,b.Z)(function*(){o=!0;try{yield e.withProgress({location:15,title:(0,l.NC)("viewMemory.install.progress","Installing the Hex Editor...")},(0,b.Z)(function*(){for(yield i.executeCommand("workbench.extensions.installExtension",En);!(yield t.getExtension(En));)yield(0,Q.Vs)(30)})),n(!0)}catch(a){d.error(a),n(!1)}});return function(){return r.apply(this,arguments)}}()}],{sticky:!0}).onDidClose(r=>{o||n(!1)})})}(c,g,p,r)))&&(f.publicLog("debug/didViewMemory",{debugType:n.getModel().getSession(o)?.configuration.type}),yield a.openEditor({resource:(0,T.ko)(o,s),options:{revealIfOpened:!0,override:"hexEditor.hexedit"}},oe.O3))});return function(t,i,n){return d.apply(this,arguments)}}()});const rs="debug.breakWhenValueChanges";ne.P.registerCommand({id:rs,handler:function(){var d=(0,b.Z)(function*(e){const t=e.get(h.tn);te&&(yield t.addDataBreakpoint(te.description,te.dataId,!!te.canPersist,te.accessTypes,"write"))});return function(t){return d.apply(this,arguments)}}()});const as="debug.breakWhenValueIsAccessed";ne.P.registerCommand({id:as,handler:function(){var d=(0,b.Z)(function*(e){const t=e.get(h.tn);te&&(yield t.addDataBreakpoint(te.description,te.dataId,!!te.canPersist,te.accessTypes,"readWrite"))});return function(t){return d.apply(this,arguments)}}()});const cs="debug.breakWhenValueIsRead";ne.P.registerCommand({id:cs,handler:function(){var d=(0,b.Z)(function*(e){const t=e.get(h.tn);te&&(yield t.addDataBreakpoint(te.description,te.dataId,!!te.canPersist,te.accessTypes,"read"))});return function(t){return d.apply(this,arguments)}}()});const ds="debug.copyEvaluatePath";ne.P.registerCommand({id:ds,handler:function(){var d=(0,b.Z)(function*(e,t){yield e.get(ut.p).writeText(t.variable.evaluateName)});return function(t,i){return d.apply(this,arguments)}}()});const ls="debug.addToWatchExpressions";ne.P.registerCommand({id:ls,handler:function(){var d=(0,b.Z)(function*(e,t){e.get(h.tn).addWatchExpression(t.variable.evaluateName)});return function(t,i){return d.apply(this,arguments)}}()}),(0,D.r1)(class extends pe.Nx{constructor(){super({id:"variables.collapse",viewId:h.sk,title:(0,l.NC)("collapse","Collapse All"),f1:!1,icon:ii.lA.collapseAll,menu:{id:D.eH.ViewTitle,group:"navigation",when:A.Ao.equals("view",h.sk)}})}runInView(d,e){e.collapseAll()}});const ht=y.$;function us(d,e){return In.apply(this,arguments)}function In(){return In=(0,b.Z)(function*(d,e){if(!d)return null;const i=(yield d.getChildren()).filter(n=>e[0]===n.name);return 1!==i.length?null:1===e.length?i[0]:us(i[0],e.slice(1))}),In.apply(this,arguments)}function Mn(){return Mn=(0,b.Z)(function*(d,e){const i=(yield d.getScopes()).filter(o=>!o.expensive),n=(0,de.kX)(yield Promise.all(i.map(o=>us(o,e))));return n.length>0&&n.every(o=>o.value===n[0].value)?n[0]:void 0}),Mn.apply(this,arguments)}let Je=class jn{constructor(e,t,i){this.editor=e,this.debugService=t,this.instantiationService=i,this.allowEditorOverflow=!0,this.highlightDecorations=this.editor.createDecorationsCollection(),this.isUpdatingTree=!1,this.toDispose=[],this._isVisible=!1,this.showAtPosition=null,this.positionPreference=[1,2],this.debugHoverComputer=this.instantiationService.createInstance(Nn,this.editor)}create(){this.domNode=ht(".debug-hover-widget"),this.complexValueContainer=y.R3(this.domNode,ht(".complex-value")),this.complexValueTitle=y.R3(this.complexValueContainer,ht(".title")),this.treeContainer=y.R3(this.complexValueContainer,ht(".debug-hover-tree")),this.treeContainer.setAttribute("role","tree"),y.R3(this.complexValueContainer,ht(".tip")).textContent=l.NC({key:"quickTip",comment:['"switch to editor language hover" means to show the programming language hover widget instead of the debug hover']},"Hold {0} key to switch to editor language hover",re.dz?"Option":"Alt");const t=new cc,i=this.instantiationService.createInstance(qe);this.tree=this.instantiationService.createInstance(Ge.ls,"DebugHover",this.treeContainer,new dc,[this.instantiationService.createInstance(Be,i)],t,{accessibilityProvider:new ac,mouseSupport:!1,horizontalScrolling:!0,useShadows:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:n=>n.name},overrideStyles:{listBackground:x.yJx}}),this.valueContainer=ht(".value"),this.valueContainer.tabIndex=0,this.valueContainer.setAttribute("role","tooltip"),this.scrollbar=new Ua.s$(this.valueContainer,{horizontal:2}),this.domNode.appendChild(this.scrollbar.getDomNode()),this.toDispose.push(this.scrollbar),this.editor.applyFontInfo(this.domNode),this.domNode.style.backgroundColor=(0,x.n_1)(x.yJx),this.domNode.style.border=`1px solid ${(0,x.n_1)(x.CNo)}`,this.domNode.style.color=(0,x.n_1)(x.Sbf),this.toDispose.push(this.tree.onDidChangeContentHeight(()=>{this.isUpdatingTree||this.layoutTreeAndContainer()})),this.toDispose.push(this.tree.onDidChangeContentWidth(()=>{this.isUpdatingTree||this.layoutTreeAndContainer()})),this.registerListeners(),this.editor.addContentWidget(this)}registerListeners(){var e=this;this.toDispose.push(y.mu(this.domNode,"keydown",t=>{t.equals(9)&&this.hide()})),this.toDispose.push(this.editor.onDidChangeConfiguration(t=>{t.hasChanged(48)&&this.editor.applyFontInfo(this.domNode)})),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression(function(){var t=(0,b.Z)(function*(i){i instanceof T._w&&e.tree.hasNode(i)&&(yield e.tree.updateChildren(i,!1,!0),yield e.tree.expand(i))});return function(i){return t.apply(this,arguments)}}()))}isHovered(){return!!this.domNode?.matches(":hover")}isVisible(){return this._isVisible}willBeVisible(){return!!this.showCancellationSource}getId(){return jn.ID}getDomNode(){return this.domNode}showAt(e,t){var i=this;return(0,b.Z)(function*(){i.showCancellationSource?.cancel();const n=i.showCancellationSource=new Ie.A,o=i.debugService.getViewModel().focusedSession;if(!o||!i.editor.hasModel())return i.hide(),1;const s=yield i.debugHoverComputer.compute(e,n.token);if(n.token.isCancellationRequested)return i.hide(),2;if(!s.range)return i.hide(),1;if(i.isVisible()&&!s.rangeChanged)return 0;const r=yield i.debugHoverComputer.evaluate(o);return n.token.isCancellationRequested?(i.hide(),2):!r||r instanceof T.A2&&!r.available?(i.hide(),1):(i.highlightDecorations.set([{range:s.range,options:jn._HOVER_HIGHLIGHT_DECORATION_OPTIONS}]),i.doShow(s.range.getStartPosition(),r,t))})()}doShow(e,t,i,n=!1){var o=this;return(0,b.Z)(function*(){if(o.domNode||o.create(),o.showAtPosition=e,o._isVisible=!0,!t.hasChildren||n)return o.complexValueContainer.hidden=!0,o.valueContainer.hidden=!1,dt(t,o.valueContainer,{showChanged:!1,colorize:!0}),o.valueContainer.title="",o.editor.layoutContentWidget(o),o.scrollbar.scanDomNode(),void(i&&(o.editor.render(),o.valueContainer.focus()));o.valueContainer.hidden=!0,o.expressionToRender=t,o.complexValueTitle.textContent=t.value,o.complexValueTitle.title=t.value,o.editor.layoutContentWidget(o),o.tree.scrollTop=0,o.tree.scrollLeft=0,o.complexValueContainer.hidden=!1,i&&(o.editor.render(),o.tree.domFocus())})()}layoutTreeAndContainer(){this.layoutTree(),this.editor.layoutContentWidget(this)}layoutTree(){const t=Math.min(Math.max(266,.55*this.editor.getLayoutInfo().height),this.tree.contentHeight+10),n=(0,Li.uZ)(this.tree.contentWidth,400,550);this.tree.layout(t,n),this.treeContainer.style.height=`${t}px`,this.scrollbar.scanDomNode()}beforeRender(){if(this.expressionToRender){const e=this.expressionToRender;this.expressionToRender=void 0,this.isUpdatingTree=!0,this.tree.setInput(e).finally(()=>{this.isUpdatingTree=!1})}return null}afterRender(e){e&&(this.positionPreference=[e])}hide(){this.showCancellationSource&&(this.showCancellationSource.cancel(),this.showCancellationSource=void 0),this._isVisible&&(y.jg(document.activeElement,this.domNode)&&this.editor.focus(),this._isVisible=!1,this.highlightDecorations.clear(),this.editor.layoutContentWidget(this),this.positionPreference=[1,2])}getPosition(){return this._isVisible?{position:this.showAtPosition,preference:this.positionPreference}:null}dispose(){this.toDispose=F.B9(this.toDispose)}};Je.ID="debug.hoverWidget",Je._HOVER_HIGHLIGHT_DECORATION_OPTIONS=$a.qx.register({description:"bdebug-hover-highlight",className:"hoverHighlight"}),Je=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,q.TG)],Je);class ac{getWidgetAriaLabel(){return l.NC("treeAriaLabel","Debug Hover")}getAriaLabel(e){return l.NC({key:"variableAriaLabel",comment:["Do not translate placeholders. Placeholders are name and value of a variable."]},"{0}, value {1}, variables, debug",e.name,e.value)}}class cc{hasChildren(e){return e.hasChildren}getChildren(e){return e.getChildren()}}class dc{getHeight(e){return 18}getTemplateId(e){return Be.ID}}let Nn=class{constructor(e,t,i,n){this.editor=e,this.debugService=t,this.languageFeaturesService=i,this.logService=n}compute(e,t){var i=this;return(0,b.Z)(function*(){if(!i.debugService.getViewModel().focusedSession||!i.editor.hasModel())return{rangeChanged:!1};const o=i.editor.getModel(),s=yield(0,se.Cc)(i.languageFeaturesService,o,e,t);if(!s)return{rangeChanged:!1};const{range:r,matchingExpression:a}=s,c=!i._currentRange||!i._currentRange.equalsRange(r);return i._currentExpression=a,i._currentRange=ae.e.lift(r),{rangeChanged:c,range:i._currentRange}})()}evaluate(e){var t=this;return(0,b.Z)(function*(){if(t._currentExpression){if(e.capabilities.supportsEvaluateForHovers){const i=new T.A2(t._currentExpression);return yield i.evaluate(e,t.debugService.getViewModel().focusedStackFrame,"hover"),i}{const i=t.debugService.getViewModel().focusedStackFrame;if(i)return yield function rc(d,e){return Mn.apply(this,arguments)}(i,(0,de.kX)(t._currentExpression.split(".").map(n=>n.trim())))}}else t.logService.error("No expression to evaluate")})()}};Nn=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,rt.p),(0,u.fM)(3,nt.VZ)],Nn),(0,He.Z)(".monaco-editor .zone-widget.exception-widget-container{overflow:hidden}.monaco-editor .zone-widget .zone-widget-container.exception-widget{padding:6px 10px;user-select:text;-webkit-user-select:text;white-space:pre-wrap}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title{display:flex}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title .label{align-items:center;display:flex;font-weight:700}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title .actions{flex:1}.monaco-editor .zone-widget .zone-widget-container.exception-widget .description,.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace{font-family:var(--monaco-monospace-font)}.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace{margin-top:.5em}.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace a{cursor:pointer;text-decoration:underline}.monaco-workbench.mac .zone-widget .zone-widget-container.exception-widget{font-size:11px}.monaco-workbench.linux .zone-widget .zone-widget-container.exception-widget,.monaco-workbench.windows .zone-widget .zone-widget-container.exception-widget{font-size:13px}",{});var uc=v(37202);const Bt=y.$,hc=(0,x.P6G)("debugExceptionWidget.border",{dark:"#a31515",light:"#a31515",hcDark:"#a31515",hcLight:"#a31515"},l.NC("debugExceptionWidgetBorder","Exception widget border color.")),gc=(0,x.P6G)("debugExceptionWidget.background",{dark:"#420b0d",light:"#f1dfde",hcDark:"#420b0d",hcLight:"#f1dfde"},l.NC("debugExceptionWidgetBackground","Exception widget background color."));let Tn=class extends Do.I{constructor(e,t,i,n,o){super(e,{showFrame:!0,showArrow:!0,isAccessible:!0,frameWidth:1,className:"exception-widget-container"}),this.exceptionInfo=t,this.debugSession=i,this.instantiationService=o,this.applyTheme(n.getColorTheme()),this._disposables.add(n.onDidColorThemeChange(this.applyTheme.bind(this))),this.create();const s=new Q.pY(()=>this._doLayout(void 0,void 0),50);this._disposables.add(this.editor.onDidLayoutChange(()=>s.schedule())),this._disposables.add(s)}applyTheme(e){this.backgroundColor=e.getColor(gc);const t=e.getColor(hc);this.style({arrowColor:t,frameColor:t})}_applyStyles(){this.container&&(this.container.style.backgroundColor=this.backgroundColor?this.backgroundColor.toString():""),super._applyStyles()}_fillContainer(e){var t=this;this.setCssClass("exception-widget");const i=this.editor.getOption(48);e.style.fontSize=`${i.fontSize}px`,e.style.lineHeight=`${i.lineHeight}px`,e.tabIndex=0;const n=Bt(".title"),o=Bt(".label");y.R3(n,o);const s=Bt(".actions");y.R3(n,s),o.textContent=this.exceptionInfo.id?l.NC("exceptionThrownWithId","Exception has occurred: {0}",this.exceptionInfo.id):l.NC("exceptionThrown","Exception has occurred.");let r=o.textContent;if(new ct.o(s).push(new G.aU("editor.closeExceptionWidget",l.NC("close","Close"),V.kS.asClassName(uc.s_),!0,(0,b.Z)(function*(){t.editor.getContribution(h.X)?.closeExceptionWidget()})),{label:!1,icon:!0}),y.R3(e,n),this.exceptionInfo.description){const c=Bt(".description");c.textContent=this.exceptionInfo.description,r+=", "+this.exceptionInfo.description,y.R3(e,c)}if(this.exceptionInfo.details&&this.exceptionInfo.details.stackTrace){const c=Bt(".stack-trace"),p=this.instantiationService.createInstance(qe).linkify(this.exceptionInfo.details.stackTrace,!0,this.debugSession?this.debugSession.root:void 0);c.appendChild(p),y.R3(e,c),r+=", "+this.exceptionInfo.details.stackTrace}e.setAttribute("aria-label",r)}_doLayout(e,t){this.container.style.height="initial";const i=this.editor.getOption(64),n=Math.round(i/3),o=Math.ceil((this.container.offsetHeight+n)/i);this._relayout(o)}focus(){this.container?.focus()}hasFocus(){return y.jg(document.activeElement,this.container)}};Tn=(0,u.gn)([(0,u.fM)(3,X.XE),(0,u.fM)(4,q.TG)],Tn);(0,x.P6G)("editor.inlineValuesForeground",{dark:"#ffffff80",light:"#00000080",hcDark:"#ffffff80",hcLight:"#00000080"},l.NC("editor.inlineValuesForeground","Color for the debug inline value text.")),(0,x.P6G)("editor.inlineValuesBackground",{dark:"#ffc80033",light:"#ffc80033",hcDark:"#ffc80033",hcLight:"#ffc80033"},l.NC("editor.inlineValuesBackground","Color for the debug inline value background."));class bc{constructor(e,t){this.column=e,this.text=t}}function ps(d,e,t=1073741824){return e.length>150&&(e=e.substring(0,150)+"..."),[{range:{startLineNumber:d,endLineNumber:d,startColumn:t,endColumn:t},options:{description:"debug-inline-value-decoration-spacer",after:{content:De.B4,cursorStops:Ae.RM.None},showIfCollapsed:!0}},{range:{startLineNumber:d,endLineNumber:d,startColumn:t,endColumn:t},options:{description:"debug-inline-value-decoration",after:{content:mc(e),inlineClassName:"debug-inline-value",inlineClassNameAffectsLetterSpacing:!0,cursorStops:Ae.RM.None},showIfCollapsed:!0}}]}function mc(d){return d.replace(/[ \t]/g,De.B4)}let ye=class{constructor(e,t,i,n,o,s,r,a,c,g){this.editor=e,this.debugService=t,this.instantiationService=i,this.commandService=n,this.configurationService=o,this.hostService=s,this.uriIdentityService=r,this.languageFeaturesService=c,this.hoverPosition=null,this.mouseDown=!1,this.gutterIsHovered=!1,this.altPressed=!1,this.oldDecorations=this.editor.createDecorationsCollection(),this._wordToLineNumbersMap=void 0,this.debounceInfo=g.for(c.inlineValuesProvider,"InlineValues",{min:200}),this.hoverWidget=this.instantiationService.createInstance(Je,this.editor),this.toDispose=[],this.registerListeners(),this.exceptionWidgetVisible=h.rh.bindTo(a),this.toggleExceptionWidget()}registerListeners(){var e=this;this.toDispose.push(this.debugService.getViewModel().onDidFocusStackFrame(t=>this.onFocusStackFrame(t.stackFrame))),this.toDispose.push(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.toDispose.push(this.editor.onMouseUp(()=>this.mouseDown=!1)),this.toDispose.push(this.editor.onMouseMove(t=>this.onEditorMouseMove(t))),this.toDispose.push(this.editor.onMouseLeave(t=>{const i=this.hoverWidget.getDomNode();if(!i)return;const n=i.getBoundingClientRect();(t.event.posx<n.left||t.event.posx>n.right||t.event.posy<n.top||t.event.posy>n.bottom)&&this.hideHoverWidget()})),this.toDispose.push(this.editor.onKeyDown(t=>this.onKeyDown(t))),this.toDispose.push(this.editor.onDidChangeModelContent(()=>{this._wordToLineNumbersMap=void 0,this.updateInlineValuesScheduler.schedule()})),this.toDispose.push(this.debugService.getViewModel().onWillUpdateViews(()=>this.updateInlineValuesScheduler.schedule())),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression(()=>this.updateInlineValuesScheduler.schedule())),this.toDispose.push(this.editor.onDidChangeModel((0,b.Z)(function*(){e.updateHoverConfiguration(),e.toggleExceptionWidget(),e.hideHoverWidget(),e._wordToLineNumbersMap=void 0;const t=e.debugService.getViewModel().focusedStackFrame;yield e.updateInlineValueDecorations(t)}))),this.toDispose.push(this.editor.onDidScrollChange(()=>{this.hideHoverWidget();const t=this.editor.getModel();t&&this.languageFeaturesService.inlineValuesProvider.has(t)&&this.updateInlineValuesScheduler.schedule()})),this.toDispose.push(this.debugService.onDidChangeState(t=>{2!==t&&this.toggleExceptionWidget()}))}get wordToLineNumbersMap(){return this._wordToLineNumbersMap||(this._wordToLineNumbersMap=function Sc(d){const e=new Map;if(!d)return e;for(let t=1,i=d.getLineCount();t<=i;++t){const n=d.getLineContent(t);if(n.length>500)continue;d.tokenization.forceTokenization(t);const o=d.tokenization.getLineTokens(t);for(let s=0,r=o.getCount();s<r;s++)if(0===o.getStandardTokenType(s)){Xo.Af.lastIndex=0;const c=o.getStartOffset(s),g=o.getEndOffset(s),p=n.substring(c,g),f=Xo.Af.exec(p);if(f){const m=f[0];e.has(m)||e.set(m,[]),e.get(m).push(t)}}}return e}(this.editor.getModel())),this._wordToLineNumbersMap}updateHoverConfiguration(){const e=this.debugService.getViewModel().focusedStackFrame,t=this.editor.getModel();t&&this.applyHoverConfiguration(t,e)}applyHoverConfiguration(e,t){t&&this.uriIdentityService.extUri.isEqual(e.uri,t.source.uri)?(this.altListener&&this.altListener.dispose(),this.altListener=(0,y.nm)(document,"keydown",i=>{if(6===new It.y1(i).keyCode){this.altPressed=!0;const o=this.hoverWidget.isVisible();this.hoverWidget.hide(),this.enableEditorHover(),o&&this.hoverPosition&&this.showEditorHover(this.hoverPosition,!1);const s=new Oa.Y(document,"keyup"),r=R.ju.any(this.hostService.onDidChangeFocus,s.event)(a=>{let c;a instanceof KeyboardEvent&&(c=new It.y1(a)),(!c||6===c.keyCode)&&(this.altPressed=!1,this.editor.updateOptions({hover:{enabled:!1}}),r.dispose(),s.dispose())})}}),this.editor.updateOptions({hover:{enabled:!1}})):(this.altListener?.dispose(),this.enableEditorHover())}enableEditorHover(){if(this.editor.hasModel()){const e=this.editor.getModel(),t={resource:e.uri,overrideIdentifier:e.getLanguageId()},i=this.configurationService.getValue("editor.hover",t);this.editor.updateOptions({hover:{enabled:i.enabled,delay:i.delay,sticky:i.sticky}})}}showHover(e,t){var i=this;return(0,b.Z)(function*(){const n=i.debugService.getViewModel().focusedStackFrame,o=i.editor.getModel();n&&o&&i.uriIdentityService.extUri.isEqual(n.source.uri,o.uri)?1===(yield i.hoverWidget.showAt(e,t))&&i.showEditorHover(e,t):i.showEditorHover(e,t)})()}showEditorHover(e,t){const i=this.editor.getContribution(_a.ModesHoverController.ID),n=new ae.e(e.lineNumber,e.column,e.lineNumber,e.column);i?.showContentHover(n,1,0,t)}onFocusStackFrame(e){var t=this;return(0,b.Z)(function*(){const i=t.editor.getModel();i&&(t.applyHoverConfiguration(i,e),e&&t.uriIdentityService.extUri.isEqual(e.source.uri,i.uri)?yield t.toggleExceptionWidget():t.hideHoverWidget()),yield t.updateInlineValueDecorations(e)})()}get showHoverScheduler(){const e=this.editor.getOption(58),t=new Q.pY(()=>{this.hoverPosition&&!this.altPressed&&this.showHover(this.hoverPosition,!1)},2*e.delay);return this.toDispose.push(t),t}get hideHoverScheduler(){const e=new Q.pY(()=>{this.hoverWidget.isHovered()||this.hoverWidget.hide()},0);return this.toDispose.push(e),e}hideHoverWidget(){!this.hideHoverScheduler.isScheduled()&&this.hoverWidget.willBeVisible()&&this.hideHoverScheduler.schedule(),this.showHoverScheduler.cancel()}onEditorMouseDown(e){this.mouseDown=!0,(9!==e.target.type||e.target.detail!==Je.ID)&&this.hideHoverWidget()}onEditorMouseMove(e){if(2!==this.debugService.state)return;const t=e.target,i=re.dz?"metaKey":"ctrlKey";this.altPressed||(2===t.type?(this.editor.updateOptions({hover:{enabled:!0}}),this.gutterIsHovered=!0):this.gutterIsHovered&&(this.gutterIsHovered=!1,this.updateHoverConfiguration())),(9!==t.type||t.detail!==Je.ID||e.event[i])&&(6===t.type?t.position&&!Dt.L.equals(t.position,this.hoverPosition)&&(this.hoverPosition=t.position,this.hideHoverScheduler.cancel(),this.showHoverScheduler.schedule()):this.mouseDown||this.hideHoverWidget())}onKeyDown(e){e.keyCode!==(re.dz?57:5)&&this.hideHoverWidget()}toggleExceptionWidget(){var e=this;return(0,b.Z)(function*(){const t=e.editor.getModel(),i=e.debugService.getViewModel().focusedStackFrame,n=i?i.thread.getCallStack():null;if(!t||!i||!n||0===n.length)return void e.closeExceptionWidget();const o=n.find(r=>!!(r&&r.source&&r.source.available&&"deemphasize"!==r.source.presentationHint));if(!o||o!==i)return void e.closeExceptionWidget();const s=e.uriIdentityService.extUri.isEqual(o.source.uri,t.uri);if(e.exceptionWidget&&!s)e.closeExceptionWidget();else if(s){const r=yield i.thread.exceptionInfo;r&&e.showExceptionWidget(r,e.debugService.getViewModel().focusedSession,o.range.startLineNumber,o.range.startColumn)}})()}showExceptionWidget(e,t,i,n){this.exceptionWidget&&this.exceptionWidget.dispose(),this.exceptionWidget=this.instantiationService.createInstance(Tn,this.editor,e,t),this.exceptionWidget.show({lineNumber:i,column:n},0),this.exceptionWidget.focus(),this.editor.revealRangeInCenter({startLineNumber:i,startColumn:n,endLineNumber:i,endColumn:n}),this.exceptionWidgetVisible.set(!0)}closeExceptionWidget(){if(this.exceptionWidget){const e=this.exceptionWidget.hasFocus();this.exceptionWidget.dispose(),this.exceptionWidget=void 0,this.exceptionWidgetVisible.set(!1),e&&this.editor.focus()}}addLaunchConfiguration(){var e=this;return(0,b.Z)(function*(){const t=e.editor.getModel();if(!t)return;let i,n;const o=()=>{let r=0;(0,no.Vn)(t.getValue(),{onObjectProperty:a=>{n=a},onArrayBegin:a=>{"configurations"===n&&0===r&&(i=t.getPositionAt(a+1)),r++},onArrayEnd:()=>{r--}})};if(o(),!i){const{tabSize:r,insertSpaces:a}=t.getOptions(),c=t.getEOL(),g="launch.json"===(0,ce.EZ)(t.uri.fsPath)?(0,qo.Hn)(t.getValue(),["configurations"],[],{tabSize:r,insertSpaces:a,eol:c})[0]:(0,qo.Hn)(t.getValue(),["launch"],{configurations:[]},{tabSize:r,insertSpaces:a,eol:c})[0],p=t.getPositionAt(g.offset),f=p.lineNumber,m=new ae.e(f,p.column,f,t.getLineMaxColumn(f));t.pushEditOperations(null,[Jo.h.replace(m,g.content)],()=>null),o()}var r;i&&(e.editor.focus(),yield(r=i,t.getLineLastNonWhitespaceColumn(r.lineNumber)>r.column&&(e.editor.setPosition(r),Ha.CoreEditingCommands.LineBreakInsert.runEditorCommand(null,e.editor,null)),e.editor.setPosition(r),e.commandService.executeCommand("editor.action.insertLineAfter")),yield e.commandService.executeCommand("editor.action.triggerSuggest"))})()}get removeInlineValuesScheduler(){return new Q.pY(()=>{this.oldDecorations.clear()},100)}get updateInlineValuesScheduler(){var e=this;const t=this.editor.getModel();return new Q.pY((0,b.Z)(function*(){return yield e.updateInlineValueDecorations(e.debugService.getViewModel().focusedStackFrame)}),t?this.debounceInfo.get(t):200)}updateInlineValueDecorations(e){var t=this;return(0,b.Z)(function*(){const i="{0} = {1}",o=t.editor.getModel(),s=t.configurationService.getValue("debug").inlineValues;if(!(!0===s||"on"===s||"auto"===s&&o&&t.languageFeaturesService.inlineValuesProvider.has(o))||!o||!e||o.uri.toString()!==e.source.uri.toString())return void(t.removeInlineValuesScheduler.isScheduled()||t.removeInlineValuesScheduler.schedule());let a;if(t.removeInlineValuesScheduler.cancel(),t.languageFeaturesService.inlineValuesProvider.has(o)){const c=function(){var I=(0,b.Z)(function*(L,N){const B=yield e.getMostSpecificScopes(e.range),k=N?L:L.toLowerCase();for(const P of B){const W=(yield P.getChildren()).find(O=>N?O.name===k:O.name.toLowerCase()===k);if(W)return W.value}});return function(N,B){return I.apply(this,arguments)}}(),g={frameId:e.frameId,stoppedLocation:new ae.e(e.range.startLineNumber,e.range.startColumn+1,e.range.endLineNumber,e.range.endColumn+1)},p=(new Ie.A).token,f=t.editor.getVisibleRangesPlusViewportAboveBelow(),m=t.languageFeaturesService.inlineValuesProvider.ordered(o).reverse();a=[];const S=new Map,w=(0,de.xH)(m.map(I=>f.map(L=>Promise.resolve(I.provideInlineValues(o,L,g,p)).then(function(){var N=(0,b.Z)(function*(B){if(B)for(const k of B){let P;switch(k.type){case"text":P=k.text;break;case"variable":{let _=k.variableName;_||(_=o.getLineContent(k.range.startLineNumber).substring(k.range.startColumn-1,k.range.endColumn-1));const W=yield c(_,k.caseSensitiveLookup);W&&(P=De.WU(i,_,W));break}case"expression":{let _=k.expression;if(_||(_=o.getLineContent(k.range.startLineNumber).substring(k.range.startColumn-1,k.range.endColumn-1)),_){const W=new T.A2(_);yield W.evaluate(e.thread.session,e,"watch",!0),W.available&&(P=De.WU(i,_,W.value))}break}}if(P){const _=k.range.startLineNumber;let W=S.get(_);W||(W=[],S.set(_,W)),W.some(O=>O.text===P)||W.push(new bc(k.range.startColumn,P))}}});return function(B){return N.apply(this,arguments)}}(),N=>{(0,Me.Cp)(N)})))),M=Date.now();yield Promise.all(w),t.updateInlineValuesScheduler.delay=t.debounceInfo.update(o,Date.now()-M),S.forEach((I,L)=>{if(I.length>0){const N=(I=I.sort((B,k)=>B.column-k.column)).map(B=>B.text).join(", ");a.push(...ps(L,N))}})}else{const c=yield e.getMostSpecificScopes(e.range),g=yield Promise.all(c.map(function(){var p=(0,b.Z)(function*(f){const m=yield f.getChildren();let S=new ae.e(0,0,e.range.startLineNumber,e.range.startColumn);return f.range&&(S=S.setStartPosition(f.range.startLineNumber,f.range.startColumn)),function vc(d,e,t,i){const n=new Map;for(const r of d)if(n.set(r.name,r.value),n.size>=100)break;const o=new Map;n.forEach((r,a)=>{const c=i.get(a);if(c)for(const g of c)e.containsPosition(new Dt.L(g,0))&&(o.has(g)||o.set(g,[]),-1===o.get(g).indexOf(a)&&o.get(g).push(a))});const s=[];return o.forEach((r,a)=>{const c=r.sort((g,p)=>{const f=t.getLineContent(a);return f.indexOf(g)-f.indexOf(p)}).map(g=>`${g} = ${n.get(g)}`).join(", ");s.push(...ps(a,c))}),s}(m,S,o,t.wordToLineNumbersMap)});return function(f){return p.apply(this,arguments)}}()));a=(0,de.EB)(g.reduce((p,f)=>p.concat(f),[]),p=>`${p.range.startLineNumber}:${p?.options.after?.content}`)}t.oldDecorations.set(a)})()}dispose(){this.hoverWidget&&this.hoverWidget.dispose(),this.configurationWidget&&this.configurationWidget.dispose(),this.toDispose=(0,F.B9)(this.toDispose),this.oldDecorations.clear()}};ye.__decorator=(0,u.gn)([at.HP],ye.prototype,"showHoverScheduler",null),ye.__decorator=(0,u.gn)([at.HP],ye.prototype,"hideHoverScheduler",null),ye.__decorator=(0,u.gn)([at.HP],ye.prototype,"removeInlineValuesScheduler",null),ye.__decorator=(0,u.gn)([at.HP],ye.prototype,"updateInlineValuesScheduler",null),ye=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,q.TG),(0,u.fM)(3,ne.H),(0,u.fM)(4,Z.Ui),(0,u.fM)(5,lo.$),(0,u.fM)(6,ke.v),(0,u.fM)(7,A.i6),(0,u.fM)(8,rt.p),(0,u.fM)(9,Wa.A)],ye);let An=class extends ri.${constructor(e,t,i,n){super(C.uT,{noResultsPick:{label:(0,l.NC)("noDebugResults","No matching launch configurations")}}),this.debugService=e,this.contextService=t,this.commandService=i,this.notificationService=n}_getPicks(e){var t=this;return(0,b.Z)(function*(){const i=[];if(!t.debugService.getAdapterManager().hasEnabledDebuggers())return[];i.push({type:"separator",label:"launch.json"});const n=t.debugService.getConfigurationManager();let o;for(const a of n.getAllConfigurations()){const c=(0,he.Oh)(e,a.name,!0);c&&(o!==a.presentation?.group&&(i.push({type:"separator"}),o=a.presentation?.group),i.push({label:a.name,description:3===t.contextService.getWorkbenchState()?a.launch.name:"",highlights:{label:c},buttons:[{iconClass:V.kS.asClassName(E.us),tooltip:(0,l.NC)("customizeLaunchConfig","Configure Launch Configuration")}],trigger:()=>(a.launch.openConfigFile({preserveFocus:!1}),ri.L.CLOSE_PICKER),accept:function(){var g=(0,b.Z)(function*(){yield n.selectConfiguration(a.launch,a.name);try{yield t.debugService.startDebugging(a.launch,void 0,{startedByUser:!0})}catch(p){t.notificationService.error(p)}});return function(){return g.apply(this,arguments)}}()}))}const s=yield n.getDynamicProviders();s.length>0&&i.push({type:"separator",label:(0,l.NC)({key:"contributed",comment:["contributed is lower case because it looks better like that in UI. Nothing preceeds it. It is a name of the grouping of debug configurations."]},"contributed")}),n.getRecentDynamicConfigurations().forEach(({name:a,type:c})=>{const g=(0,he.Oh)(e,a,!0);var p;g&&i.push({label:a,highlights:{label:g},buttons:[{iconClass:V.kS.asClassName(E.Lh),tooltip:(0,l.NC)("removeLaunchConfig","Remove Launch Configuration")}],trigger:()=>(n.removeRecentDynamicConfigurations(a,c),ri.L.CLOSE_PICKER),accept:(p=(0,b.Z)(function*(){yield n.selectConfiguration(void 0,a,void 0,{type:c});try{const{launch:f,getConfig:m}=n.selectedConfiguration,S=yield m();yield t.debugService.startDebugging(f,S,{startedByUser:!0})}catch(f){t.notificationService.error(f)}}),function(){return p.apply(this,arguments)})})}),s.forEach(a=>{var c;i.push({label:`$(folder) ${a.label}...`,ariaLabel:(0,l.NC)({key:"providerAriaLabel",comment:['Placeholder stands for the provider label. For example "NodeJS".']},"{0} contributed configurations",a.label),accept:(c=(0,b.Z)(function*(){const g=yield a.pick();g&&(yield n.selectConfiguration(g.launch,g.config.name,g.config,{type:a.type}),t.debugService.startDebugging(g.launch,g.config,{startedByUser:!0}))}),function(){return c.apply(this,arguments)})})});const r=n.getLaunches().filter(a=>!a.hidden);r.length>0&&i.push({type:"separator",label:(0,l.NC)("configure","configure")});for(const a of r){const c=3===t.contextService.getWorkbenchState()?(0,l.NC)("addConfigTo","Add Config ({0})...",a.name):(0,l.NC)("addConfiguration","Add Configuration...");i.push({label:c,description:3===t.contextService.getWorkbenchState()?a.name:"",highlights:{label:(0,j.f6)((0,he.Oh)(e,c,!0))},accept:()=>t.commandService.executeCommand(C.Ee,a.uri.toString())})}return i})()}};An=(0,u.gn)([(0,u.fM)(0,h.tn),(0,u.fM)(1,Te.ec),(0,u.fM)(2,ne.H),(0,u.fM)(3,Ne.lT)],An),(0,He.Z)('.debug-pane,.debug-view-content{height:100%}.monaco-workbench .debug-action.notification:after{background-color:#c63;border:1px solid #fff;border-radius:10px;content:"";height:6px;position:absolute;right:6px;top:10px;width:6px}.monaco-workbench .part>.title>.title-actions .start-debug-action-item{align-items:center;display:flex;flex-shrink:1;line-height:20px}.monaco-workbench.mac .part>.title>.title-actions .start-debug-action-item{border-radius:4px}.monaco-workbench .part>.title>.title-actions .start-debug-action-item .codicon{flex-shrink:0;line-height:inherit}.monaco-workbench .part>.title>.title-actions .start-debug-action-item .codicon-debug-start{height:21px;padding-left:2px;width:18px}.monaco-workbench .monaco-action-bar .start-debug-action-item .configuration .monaco-select-box{border:none;cursor:pointer;line-height:inherit;margin-top:0;min-width:90px;padding-bottom:0;padding-top:0}.monaco-workbench.safari .monaco-action-bar .start-debug-action-item .configuration .monaco-select-box{margin-bottom:0}.monaco-workbench .monaco-action-bar .start-debug-action-item .configuration.disabled .monaco-select-box{cursor:auto;font-style:italic;opacity:.7}.debug-pane .line-number{padding-left:4px;padding-right:4px}.debug-pane .disabled{cursor:auto;opacity:.65}.debug-pane .monaco-list:focus .monaco-list-row.selected .load-all,.debug-pane .monaco-list:focus .monaco-list-row.selected .state.label,.debug-pane .monaco-list:focus .monaco-list-row.selected.focused .state.label{color:inherit}.debug-pane .call-stack-state-message{flex:1;margin:0 10px;overflow:hidden;text-align:right;text-overflow:ellipsis;white-space:nowrap}.debug-pane .call-stack-state-message>.label{border-radius:3px;font-size:9px;padding:1px 2px}.debug-pane .debug-call-stack .session,.debug-pane .debug-call-stack .thread{align-items:center;display:flex}.debug-pane .debug-call-stack .session>.name,.debug-pane .debug-call-stack .thread>.name{flex:1;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-call-stack .session>.state.label,.debug-pane .debug-call-stack .thread>.state.label{align-self:center;font-size:.8em;margin:0 10px;overflow:hidden;text-overflow:ellipsis;text-transform:uppercase}.debug-pane .debug-call-stack .monaco-list-row:hover .stack-frame.has-actions .file .line-number,.debug-pane .debug-call-stack .monaco-list-row:hover .state.label{display:none}.debug-pane .monaco-list-row .monaco-action-bar{display:none;flex-shrink:0;margin-right:6px}.debug-pane .monaco-list-row.focused .monaco-action-bar,.debug-pane .monaco-list-row:hover .monaco-action-bar{display:initial}.debug-pane .monaco-list-row .monaco-action-bar .action-label{padding:2px}.debug-pane .session .codicon{line-height:22px;margin-right:2px}.debug-pane .debug-call-stack .stack-frame{display:flex;overflow:hidden;padding-right:.8em;text-overflow:ellipsis}.debug-pane .debug-call-stack .stack-frame.label{font-style:italic;text-align:center}.debug-pane .debug-call-stack .stack-frame .label{flex:1;flex-shrink:0;min-width:fit-content}.debug-pane .debug-call-stack .stack-frame.subtle{font-style:italic}.debug-pane .debug-call-stack .stack-frame.label>.file{display:none}.debug-pane .debug-call-stack .stack-frame>.file{display:flex;flex-wrap:wrap;justify-content:flex-end;overflow:hidden}.debug-pane .debug-call-stack .stack-frame>.file>.line-number.unavailable{display:none}.debug-pane .debug-call-stack .stack-frame>.file>.file-name{margin-right:.8em;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-call-stack .stack-frame>.file:not(:first-child){margin-left:.8em}.debug-pane .debug-call-stack .load-all{text-align:center}.debug-pane .debug-call-stack .show-more{opacity:.5;text-align:center}.debug-pane .debug-call-stack .error{font-style:italic;overflow:hidden;text-overflow:ellipsis}.debug-pane .scope{font-size:11px;font-weight:700}.debug-pane .monaco-list-row .expression .actionbar-spacer{flex-grow:1}.debug-pane .monaco-list-row .expression .value{overflow:hidden;text-overflow:ellipsis;white-space:pre}.debug-pane .monaco-list-row .expression .value.changed{border-radius:4px}.debug-pane .monaco-inputbox{line-height:normal;width:100%}.debug-pane .inputBoxContainer{box-sizing:border-box;flex-grow:1}.debug-pane .debug-watch .monaco-inputbox{font-family:var(--monaco-monospace-font)}.debug-pane .monaco-inputbox>.ibwrapper{height:19px}.debug-pane .monaco-inputbox>.ibwrapper>.input{color:initial;padding:0}.debug-pane .watch-expression{display:flex}.debug-pane .watch-expression .expression{flex:1}.debug-pane .debug-variables .scope .error{font-family:var(--monaco-monospace-font);font-style:italic;font-weight:400;overflow:hidden;text-overflow:ellipsis}.debug-pane .monaco-list-row{line-height:22px}.debug-pane .debug-breakpoints .monaco-list-row .breakpoint{padding-left:2px}.debug-pane .debug-breakpoints .breakpoint.exception{padding-left:21px}.debug-pane .debug-breakpoints .breakpoint{align-items:center;display:flex;flex:1;padding-right:.8em}.debug-pane .debug-breakpoints .breakpoint input{flex-shrink:0}.debug-pane .debug-breakpoints .breakpoint>.codicon{align-items:center;display:flex;height:19px;justify-content:center;min-width:19px;width:19px}.debug-pane .debug-breakpoints .breakpoint>.access-type,.debug-pane .debug-breakpoints .breakpoint>.condition,.debug-pane .debug-breakpoints .breakpoint>.file-path{flex:1;margin-left:.9em;opacity:.7;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-breakpoints .breakpoint .name{overflow:hidden;text-overflow:ellipsis}.debug-pane .pane-header .breakpoint-warning{margin-left:3px}.debug-pane .pane-header .breakpoint-warning .monaco-icon-label .codicon{align-items:center;display:flex}',{});const Ln="debugStartLanguage",yc=new A.uy(Ln,void 0),wc=new A.uy("debuggerInterestedInActiveEditor",!1);let Rt=class extends pe.qV{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m){super(e,i,n,o,s,g,c,p,t,m),this.debugService=r,this.editorService=a,this.debugStartLanguageContext=yc.bindTo(s),this.debuggerInterestedContext=wc.bindTo(s);const S=f.get(Ln,1);this.debugStartLanguageContext.set(S);const w=()=>{const L=this.editorService.activeTextEditorControl;if((0,Ve.CL)(L)){const N=L.getModel(),B=N?N.getLanguageId():void 0;if(B&&this.debugService.getAdapterManager().someDebuggerInterestedInLanguage(B))return this.debugStartLanguageContext.set(B),this.debuggerInterestedContext.set(!0),void f.store(Ln,B,1,1)}this.debuggerInterestedContext.set(!1)},M=new F.SL;this._register(M),this._register(a.onDidActiveEditorChange(()=>{M.clear();const L=this.editorService.activeTextEditorControl;(0,Ve.CL)(L)&&M.add(L.onDidChangeModelLanguage(w)),w()})),this._register(this.debugService.getAdapterManager().onDidRegisterDebugger(w)),this._register(this.onDidChangeBodyVisibility(L=>{L&&w()})),w();const I=this.keybindingService.lookupKeybinding(C.bj);I&&I.getLabel()}shouldShowWelcome(){return!0}};Rt.ID="workbench.debug.welcome",Rt.LABEL=(0,l.NC)("run","Run"),Rt=(0,u.gn)([(0,u.fM)(1,X.XE),(0,u.fM)(2,Ke.d),(0,u.fM)(3,Y.i),(0,u.fM)(4,Z.Ui),(0,u.fM)(5,A.i6),(0,u.fM)(6,h.tn),(0,u.fM)(7,oe.AR),(0,u.fM)(8,q.TG),(0,u.fM)(9,J.XH),(0,u.fM)(10,Fe.v4),(0,u.fM)(11,Pe.Uy),(0,u.fM)(12,be.bU)],Rt);let Bn=class extends Ji.XV{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m,S){super(h.f3,{mergeViewWithContainerWhenSingleView:!0},o,p,e,c,t,g,a,r,s,S),this.progressService=i,this.debugService=n,this.contextViewService=f,this.contextKeyService=m,this.paneListeners=new Map,this.stopActionViewItemDisposables=this._register(new F.SL),this._register(this.debugService.onDidChangeState(w=>this.onDebugServiceStateChange(w))),this._register(this.contextKeyService.onDidChangeContext(w=>{w.affectsSome(new Set([h.sd]))&&this.updateTitleArea()})),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateTitleArea())),this._register(this.configurationService.onDidChangeConfiguration(w=>{w.affectsConfiguration("debug.toolBarLocation")&&this.updateTitleArea()}))}create(e){super.create(e),e.classList.add("debug-viewlet")}focus(){super.focus(),this.startDebugActionViewItem?this.startDebugActionViewItem.focus():this.focusView(Rt.ID)}getActionViewItem(e){if(e.id===C.bj)return this.startDebugActionViewItem=this.instantiationService.createInstance(oi,null,e),this.startDebugActionViewItem;if(e.id===C.or)return new Mt(e,void 0,this.debugService,this.contextViewService,this.configurationService);if(e.id===C.De||e.id===C.Sb){this.stopActionViewItemDisposables.clear();const t=this.instantiationService.invokeFunction(i=>dn(e,this.stopActionViewItemDisposables,i));if(t)return t}return(0,ge.Id)(this.instantiationService,e)}focusView(e){const t=this.getView(e);t&&t.focus()}onDebugServiceStateChange(e){this.progressResolve&&(this.progressResolve(),this.progressResolve=void 0),1===e&&this.progressService.withProgress({location:h.f3},t=>new Promise(i=>this.progressResolve=i))}addPanes(e){super.addPanes(e);for(const{pane:t}of e)t.id===h.Ww?(this.breakpointView=t,this.updateBreakpointsMaxSize()):this.paneListeners.set(t.id,t.onDidChange(()=>this.updateBreakpointsMaxSize()))}removePanes(e){super.removePanes(e);for(const t of e)(0,F.B9)(this.paneListeners.get(t.id)),this.paneListeners.delete(t.id)}updateBreakpointsMaxSize(){if(this.breakpointView){const e=this.panes.every(t=>!t.isExpanded()||t===this.breakpointView);this.breakpointView.maximumBodySize=e?Number.POSITIVE_INFINITY:this.breakpointView.minimumBodySize}}};Bn=(0,u.gn)([(0,u.fM)(0,Ki.z),(0,u.fM)(1,be.bU),(0,u.fM)(2,es.R9),(0,u.fM)(3,h.tn),(0,u.fM)(4,q.TG),(0,u.fM)(5,Te.ec),(0,u.fM)(6,Pe.Uy),(0,u.fM)(7,X.XE),(0,u.fM)(8,Y.i),(0,u.fM)(9,it.QS),(0,u.fM)(10,Z.Ui),(0,u.fM)(11,Y.u),(0,u.fM)(12,A.i6),(0,u.fM)(13,J.XH)],Bn),(0,D.r1)(class extends D.Ke{constructor(){super({id:"debug.toggleReplIgnoreFocus",title:l.NC("debugPanel","Debug Console"),toggled:A.Ao.has(`view.${h.FT}.visible`),menu:[{id:Ji.jc,group:"3_toggleRepl",order:30,when:A.Ao.and(A.Ao.equals("viewContainer",h.f3))}]})}run(d){return(0,b.Z)(function*(){const e=d.get(J.qC);e.isViewVisible(h.FT)?e.closeView(h.FT):yield e.openView(h.FT)})()}});var fs=v(4540),kc=v(18323),bs=v(87261),ms=v(56980),Dc=v(91795);const vs={allowBreakpoint:!1,isBreakpointSet:!1,isBreakpointEnabled:!1,instruction:{address:"-1",instruction:(0,l.NC)("instructionNotAvailable","Disassembly not available.")},instructionAddress:BigInt(-1)};let ci=class pt extends kc.J{constructor(e,t,i,n,o,s){super(h.xG,e,t,i),this._configurationService=n,this._instantiationService=o,this._debugService=s,this._instructionBpList=[],this._enableSourceCodeRender=!0,this._loadingLock=!1,this._disassembledInstructions=void 0,this._onDidChangeStackFrame=new R.Q5,this._previousDebuggingState=s.state,this._fontInfo=fs.E4.createFromRawSettings(n.getValue("editor"),Jt.PixelRatio.value),this._register(n.onDidChangeConfiguration(r=>{if(r.affectsConfiguration("editor")&&(this._fontInfo=fs.E4.createFromRawSettings(n.getValue("editor"),Jt.PixelRatio.value)),r.affectsConfiguration("debug")){const a=this._configurationService.getValue("debug").disassemblyView.showSourceCode;this._enableSourceCodeRender!==a?(this._enableSourceCodeRender=a,this.reloadDisassembly(void 0)):this._disassembledInstructions?.rerender()}}))}get fontInfo(){return this._fontInfo}get currentInstructionAddresses(){return this._debugService.getModel().getSessions(!1).map(e=>e.getAllThreads()).reduce((e,t)=>e.concat(t),[]).map(e=>e.getTopStackFrame()).map(e=>e?.instructionPointerReference)}get focusedCurrentInstructionAddress(){return this._debugService.getViewModel().focusedStackFrame?.thread.getTopStackFrame()?.instructionPointerReference}get focusedInstructionAddress(){return this._debugService.getViewModel().focusedStackFrame?.instructionPointerReference}get isSourceCodeRender(){return this._enableSourceCodeRender}get debugSession(){return this._debugService.getViewModel().focusedSession}get onDidChangeStackFrame(){return this._onDidChangeStackFrame.event}createEditor(e){this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode;const t=this.fontInfo.lineHeight,i=this,n=new class{constructor(){this.headerRowHeight=0}getHeight(s){return i.isSourceCodeRender&&s.instruction.location?.path&&s.instruction.line?s.instruction.endLine?t*(s.instruction.endLine-s.instruction.line+2):2*t:t}},o=this._register(this._instantiationService.createInstance(Xe,this));this._disassembledInstructions=this._register(this._instantiationService.createInstance(Ge.On,"DisassemblyView",e,n,[{label:"",tooltip:"",weight:0,minimumWidth:this.fontInfo.lineHeight,maximumWidth:this.fontInfo.lineHeight,templateId:Vt.TEMPLATE_ID,project:s=>s},{label:(0,l.NC)("disassemblyTableColumnLabel","instructions"),tooltip:"",weight:.3,templateId:Xe.TEMPLATE_ID,project:s=>s}],[this._instantiationService.createInstance(Vt,this),o],{identityProvider:{getId:s=>s.instruction.address},horizontalScrolling:!1,overrideStyles:{listBackground:x.cvW},multipleSelectionSupport:!1,setRowLineHeight:!1,openOnSingleClick:!1,accessibilityProvider:new xc,mouseSupport:!1})),this.reloadDisassembly(),this._register(this._disassembledInstructions.onDidScroll(s=>{if(!this._loadingLock)if(s.oldScrollTop>s.scrollTop&&s.scrollTop<s.height){this._loadingLock=!0;const r=Math.floor(s.scrollTop/this.fontInfo.lineHeight)+pt.NUM_INSTRUCTIONS_TO_LOAD;this.scrollUp_LoadDisassembledInstructions(pt.NUM_INSTRUCTIONS_TO_LOAD).then(a=>{a&&this._disassembledInstructions.reveal(r,0),this._loadingLock=!1})}else s.oldScrollTop<s.scrollTop&&s.scrollTop+s.height>s.scrollHeight-s.height&&(this._loadingLock=!0,this.scrollDown_LoadDisassembledInstructions(pt.NUM_INSTRUCTIONS_TO_LOAD).then(()=>{this._loadingLock=!1}))})),this._register(this._debugService.getViewModel().onDidFocusStackFrame(s=>{this._disassembledInstructions&&(this.goToAddress(),this._onDidChangeStackFrame.fire())})),this._register(this._debugService.getModel().onDidChangeBreakpoints(s=>{if(s&&this._disassembledInstructions){let r=!1;s.added?.forEach(a=>{if(a instanceof T.k9){const c=this.getIndexFromAddress(a.instructionReference);c>=0&&(this._disassembledInstructions.row(c).isBreakpointSet=!0,this._disassembledInstructions.row(c).isBreakpointEnabled=a.enabled,r=!0)}}),s.removed?.forEach(a=>{if(a instanceof T.k9){const c=this.getIndexFromAddress(a.instructionReference);c>=0&&(this._disassembledInstructions.row(c).isBreakpointSet=!1,r=!0)}}),s.changed?.forEach(a=>{if(a instanceof T.k9){const c=this.getIndexFromAddress(a.instructionReference);c>=0&&this._disassembledInstructions.row(c).isBreakpointEnabled!==a.enabled&&(this._disassembledInstructions.row(c).isBreakpointEnabled=a.enabled,r=!0)}}),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints(),r&&this._onDidChangeStackFrame.fire()}})),this._register(this._debugService.onDidChangeState(s=>{(3===s||2===s)&&3!==this._previousDebuggingState&&2!==this._previousDebuggingState&&(this._disassembledInstructions?.splice(0,this._disassembledInstructions.length,[vs]),this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode),this._previousDebuggingState=s}))}layout(e){this._disassembledInstructions?.layout(e.height)}goToAddress(e,t){if(!this._disassembledInstructions||(e||(e=this.focusedInstructionAddress),!e))return;const i=this.getIndexFromAddress(e);i>=0?(this._disassembledInstructions.reveal(i),t&&(this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([i]))):2===this._debugService.state&&this.reloadDisassembly(e)}scrollUp_LoadDisassembledInstructions(e){var t=this;return(0,b.Z)(function*(){if(t._disassembledInstructions&&t._disassembledInstructions.length>0){const i=t._disassembledInstructions?.row(0).instruction.address;return t.loadDisassembledInstructions(i,-e,e)}return!1})()}scrollDown_LoadDisassembledInstructions(e){var t=this;return(0,b.Z)(function*(){if(t._disassembledInstructions&&t._disassembledInstructions.length>0){const i=t._disassembledInstructions?.row(t._disassembledInstructions?.length-1).instruction.address;return t.loadDisassembledInstructions(i,1,e)}return!1})()}loadDisassembledInstructions(e,t,i){var n=this;return(0,b.Z)(function*(){if((!e||"-1"===e)&&(e=n.focusedInstructionAddress),!e)return!1;const o=n.debugSession,s=yield o?.disassemble(e,0,t,i);if(o&&s&&n._disassembledInstructions){const r=[];let a,c;for(let p=0;p<s.length;p++){const f=n._instructionBpList.find(S=>S.instructionReference===s[p].address),m=s[p];if(m.location&&(a=m.location,c=void 0),m.line){const S={startLineNumber:m.line,startColumn:m.column??0,endLineNumber:m.endLine??m.line,endColumn:m.endColumn??0};ae.e.equalsRange(S,c??null)||(c=S,m.location=a)}r.push({allowBreakpoint:!0,isBreakpointSet:void 0!==f,isBreakpointEnabled:!!f?.enabled,instruction:m})}return n._disassembledInstructions.splice(t>=0?n._disassembledInstructions.length:0,1===n._disassembledInstructions.length?1:0,r),!0}return!1})()}getIndexFromAddress(e){const t=this._disassembledInstructions;if(t&&t.length>0){const i=BigInt(e);if(i)return(0,de.em)(t.length,n=>{const o=t.row(n);return this.ensureAddressParsed(o),o.instructionAddress>i?1:o.instructionAddress<i?-1:0})}return-1}ensureAddressParsed(e){void 0===e.instructionAddress&&(e.instructionAddress=BigInt(e.instruction.address))}reloadDisassembly(e){this._disassembledInstructions&&(this._loadingLock=!0,this._disassembledInstructions.splice(0,this._disassembledInstructions.length,[vs]),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints(),this.loadDisassembledInstructions(e,4*-pt.NUM_INSTRUCTIONS_TO_LOAD,8*pt.NUM_INSTRUCTIONS_TO_LOAD).then(()=>{if(this._disassembledInstructions.length>0){const t=Math.floor(this._disassembledInstructions.length/2);this._disassembledInstructions.reveal(t,.5),this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([t])}this._loadingLock=!1}))}};ci.NUM_INSTRUCTIONS_TO_LOAD=50,ci=(0,u.gn)([(0,u.fM)(0,be.bU),(0,u.fM)(1,X.XE),(0,u.fM)(2,Pe.Uy),(0,u.fM)(3,Z.Ui),(0,u.fM)(4,q.TG),(0,u.fM)(5,h.tn)],ci);let Vt=class tr{constructor(e,t){this._disassemblyView=e,this._debugService=t,this.templateId=tr.TEMPLATE_ID,this._breakpointIcon="codicon-"+E.eq.regular.id,this._breakpointDisabledIcon="codicon-"+E.eq.disabled.id,this._breakpointHintIcon="codicon-"+E.os.id,this._debugStackframe="codicon-"+E.Qx.id,this._debugStackframeFocused="codicon-"+E.Ws.id}renderTemplate(e){e.style.alignSelf="flex-end";const t=(0,y.R3)(e,(0,y.$)(".disassembly-view"));t.classList.add("codicon"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.height=this._disassemblyView.fontInfo.lineHeight+"px";const i={element:void 0},n=[this._disassemblyView.onDidChangeStackFrame(()=>this.rerenderDebugStackframe(t,i.element)),(0,y.mu)(e,"mouseover",()=>{i.element?.allowBreakpoint&&t.classList.add(this._breakpointHintIcon)}),(0,y.mu)(e,"mouseout",()=>{i.element?.allowBreakpoint&&t.classList.remove(this._breakpointHintIcon)}),(0,y.mu)(e,"click",()=>{i.element?.allowBreakpoint&&(t.classList.add(this._breakpointHintIcon),i.element.isBreakpointSet?this._debugService.removeInstructionBreakpoints(i.element.instruction.address):i.element.allowBreakpoint&&!i.element.isBreakpointSet&&this._debugService.addInstructionBreakpoint(i.element.instruction.address,0))})];return{currentElement:i,icon:t,disposables:n}}renderElement(e,t,i,n){i.currentElement.element=e,this.rerenderDebugStackframe(i.icon,e)}disposeTemplate(e){(0,F.B9)(e.disposables),e.disposables=[]}rerenderDebugStackframe(e,t){t?.instruction.address===this._disassemblyView.focusedCurrentInstructionAddress?e.classList.add(this._debugStackframe):t?.instruction.address===this._disassemblyView.focusedInstructionAddress?e.classList.add(this._debugStackframeFocused):(e.classList.remove(this._debugStackframe),e.classList.remove(this._debugStackframeFocused)),e.classList.remove(this._breakpointHintIcon),t?.isBreakpointSet?t.isBreakpointEnabled?(e.classList.add(this._breakpointIcon),e.classList.remove(this._breakpointDisabledIcon)):(e.classList.remove(this._breakpointIcon),e.classList.add(this._breakpointDisabledIcon)):(e.classList.remove(this._breakpointIcon),e.classList.remove(this._breakpointDisabledIcon))}};Vt.TEMPLATE_ID="breakpoint",Vt=(0,u.gn)([(0,u.fM)(1,h.tn)],Vt);let Xe=class ft extends F.JT{constructor(e,t,i,n,o,s){super(),this._disassemblyView=e,this.editorService=i,this.textModelService=n,this.uriService=o,this.logService=s,this.templateId=ft.TEMPLATE_ID,this._topStackFrameColor=t.getColorTheme().getColor(sn),this._focusedStackFrameColor=t.getColorTheme().getColor(rn),this._register(t.onDidColorThemeChange(r=>{this._topStackFrameColor=r.getColor(sn),this._focusedStackFrameColor=r.getColor(rn)}))}renderTemplate(e){const t=(0,y.R3)(e,(0,y.$)(".sourcecode")),i=(0,y.R3)(e,(0,y.$)(".instruction"));this.applyFontInfo(t),this.applyFontInfo(i);const n={element:void 0},s=[this._disassemblyView.onDidChangeStackFrame(()=>this.rerenderBackground(i,t,n.element)),(0,y.mu)(t,"dblclick",()=>this.openSourceCode(n.element?.instruction))];return{currentElement:n,instruction:i,sourcecode:t,cellDisposable:[],disposables:s}}renderElement(e,t,i,n){this.renderElementInner(e,t,i,n)}renderElementInner(e,t,i,n){var o=this;return(0,b.Z)(function*(){i.currentElement.element=e;const s=e.instruction;i.sourcecode.innerText="";const r=new bs.HT(1e3);if(o._disassemblyView.isSourceCodeRender&&s.location?.path&&s.line){const c=o.getUriFromSource(s);if(c){let g;const p=new bs.HT(1e4),f=yield o.textModelService.createModelReference(c);if(g=f.object.textEditorModel,i.cellDisposable.push(f),g&&i.currentElement.element===e){let m=s.line;for(;m&&m>=1&&m<=g.getLineCount();){const S=g.getLineContent(m);if(p.appendString(`  ${m}: `),p.appendString(S+"\n"),!(s.endLine&&m<s.endLine))break;m++}i.sourcecode.innerText=p.build()}}}let a=10;if("-1"!==s.address){r.appendString(s.address),s.address.length<ft.INSTRUCTION_ADDR_MIN_LENGTH&&(a=ft.INSTRUCTION_ADDR_MIN_LENGTH-s.address.length);for(let c=0;c<a;c++)r.appendString(" ")}if(s.instructionBytes){r.appendString(s.instructionBytes),a=10,s.instructionBytes.length<ft.INSTRUCTION_BYTES_MIN_LENGTH&&(a=ft.INSTRUCTION_BYTES_MIN_LENGTH-s.instructionBytes.length);for(let c=0;c<a;c++)r.appendString(" ")}r.appendString(s.instruction),i.instruction.innerText=r.build(),o.rerenderBackground(i.instruction,i.sourcecode,e)})()}disposeElement(e,t,i,n){(0,F.B9)(i.cellDisposable),i.cellDisposable=[]}disposeTemplate(e){(0,F.B9)(e.disposables),e.disposables=[]}rerenderBackground(e,t,i){e.style.background=i&&this._disassemblyView.currentInstructionAddresses.includes(i.instruction.address)?this._topStackFrameColor?.toString()||"transparent":i?.instruction.address===this._disassemblyView.focusedInstructionAddress&&this._focusedStackFrameColor?.toString()||"transparent"}openSourceCode(e){if(e){const t=this.getUriFromSource(e),i=e.endLine?{startLineNumber:e.line,endLineNumber:e.endLine,startColumn:e.column||1,endColumn:e.endColumn||1073741824}:{startLineNumber:e.line,endLineNumber:e.line,startColumn:e.column||1,endColumn:e.endColumn||1073741824};this.editorService.openEditor({resource:t,description:(0,l.NC)("editorOpenedFromDisassemblyDescription","from disassembly"),options:{preserveFocus:!1,selection:i,revealIfOpened:!0,selectionRevealType:1,pinned:!1}})}}getUriFromSource(e){const t=e.location.path;return t&&(0,se.p3)(t)?this.uriService.asCanonicalUri(ue.ov.parse(t)):t&&(0,ce.YP)(t)?this.uriService.asCanonicalUri(ue.ov.file(t)):(0,vt.UQ)(e.location,e.location.path,this._disassemblyView.debugSession.getId(),this.uriService,this.logService)}applyFontInfo(e){(0,Dc.N)(e,this._disassemblyView.fontInfo),e.style.whiteSpace="pre"}};Xe.TEMPLATE_ID="instruction",Xe.INSTRUCTION_ADDR_MIN_LENGTH=25,Xe.INSTRUCTION_BYTES_MIN_LENGTH=30,Xe=(0,u.gn)([(0,u.fM)(1,X.XE),(0,u.fM)(2,oe.AR),(0,u.fM)(3,ms.S),(0,u.fM)(4,ke.v),(0,u.fM)(5,nt.VZ)],Xe);class xc{getWidgetAriaLabel(){return(0,l.NC)("disassemblyView","Disassembly View")}getAriaLabel(e){let t="";const i=e.instruction;return"-1"!==i.address&&(t+=`${(0,l.NC)("instructionAddress","Address")}: ${i.address}`),i.instructionBytes&&(t+=`, ${(0,l.NC)("instructionBytes","Bytes")}: ${i.instructionBytes}`),t+=`, ${(0,l.NC)("instructionText","Instruction")}: ${i.instruction}`,t}}var Ec=v(32304),Ic=v(37089),Mc=v(58763);let di=class Kn{constructor(e,t,i,n,o){this.debugService=t,this.modelService=i,this.languageService=n,this.editorWorkerService=o,this.pendingUpdates=new Map,e.registerTextModelContentProvider(h.lR,this),Kn.INSTANCE=this}dispose(){this.pendingUpdates.forEach(e=>e.dispose())}provideTextContent(e){return this.createOrUpdateContentModel(e,!0)}static refreshDebugContent(e){Kn.INSTANCE?.createOrUpdateContentModel(e,!1)}createOrUpdateContentModel(e,t){const i=this.modelService.getModel(e);if(!i&&!t)return null;let n;if(e.query){const s=vt.Hw.getEncodedDebugData(e);n=this.debugService.getModel().getSession(s.sessionId)}if(n||(n=this.debugService.getViewModel().focusedSession),!n)return Promise.reject(new Me.QD((0,l.NC)("unable","Unable to resolve the resource without a debug session")));const o=s=>{this.debugService.sourceIsNotAvailable(e);const r=this.languageService.createById(No.bd),a=s?(0,l.NC)("canNotResolveSourceWithError","Could not load source '{0}': {1}.",e.path,s):(0,l.NC)("canNotResolveSource","Could not load source '{0}'.",e.path);return this.modelService.createModel(a,r,e)};return n.loadSource(e).then(s=>{if(s&&s.body){if(i){const r=s.body.content;this.pendingUpdates.get(i.id)?.cancel();const c=new Ie.A;return this.pendingUpdates.set(i.id,c),this.editorWorkerService.computeMoreMinimalEdits(i.uri,[{text:r,range:i.getFullModelRange()}]).then(g=>(this.pendingUpdates.delete(i.id),!c.token.isCancellationRequested&&g&&g.length>0&&i.applyEdits(g.map(p=>Jo.h.replace(ae.e.lift(p.range),p.text))),i))}{const r=s.body.mimeType||(0,Ic.hm)(e)[0],a=this.languageService.createByMimeType(r);return this.modelService.createModel(s.body.content,a,e)}}return o()},s=>o(s.message))}};di=(0,u.gn)([(0,u.fM)(0,ms.S),(0,u.fM)(1,h.tn),(0,u.fM)(2,Yi.q),(0,u.fM)(3,bi.O),(0,u.fM)(4,Mc.p)],di);var Nc=v(92635);const Ac=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;class Re{constructor(e,t,i=!1){this._parent=e,this._label=t,this.isIncompressible=i,this._children=new Map,this._showedMoreThanOne=!1}updateLabel(e){this._label=e}isLeaf(){return 0===this._children.size}getSession(){if(this._parent)return this._parent.getSession()}setSource(e,t){if(this._source=t,this._children.clear(),t.raw&&t.raw.sources)for(const i of t.raw.sources)if(i.name&&i.path){const n=new Re(this,i.name);this._children.set(i.path,n);const o=e.getSource(i);n.setSource(e,o)}}createIfNeeded(e,t){let i=this._children.get(e);return i||(i=t(this,e),this._children.set(e,i)),i}getChild(e){return this._children.get(e)}remove(e){this._children.delete(e)}removeFromParent(){this._parent&&(this._parent.remove(this._label),0===this._parent._children.size&&this._parent.removeFromParent())}getTemplateId(){return"id"}getId(){const e=this.getParent();return e?`${e.getId()}/${this.getInternalId()}`:this.getInternalId()}getInternalId(){return this._label}getParent(){if(this._parent)return this._parent.isSkipped()?this._parent.getParent():this._parent}isSkipped(){return!this._parent||!!this._parent.oneChild()}hasChildren(){const e=this.oneChild();return e?e.hasChildren():this._children.size>0}getChildren(){const e=this.oneChild();if(e)return e.getChildren();const t=[];for(const i of this._children.values())t.push(i);return t.sort((i,n)=>this.compare(i,n))}getLabel(e=!0){const t=this.oneChild();return t?`${this._label}${this instanceof Pt&&e?" \u2022 ":ce.KR.sep}${t.getLabel()}`:this._label}getHoverLabel(){if(this._source&&this._parent&&this._parent._source)return this._source.raw.path||this._source.raw.name;const e=this.getLabel(!1),t=this.getParent();if(t){const i=t.getHoverLabel();if(i)return`${i}/${e}`}return e}getSource(){const e=this.oneChild();return e?e.getSource():this._source}compare(e,t){return e._label&&t._label?e._label.localeCompare(t._label):0}oneChild(){if(!this._source&&!this._showedMoreThanOne&&this.skipOneChild()){if(1===this._children.size)return this._children.values().next().value;this._children.size>1&&(this._showedMoreThanOne=!0)}}skipOneChild(){return this instanceof Ss}}class Pt extends Re{constructor(e,t){super(e,t.name,!0),this.folder=t}}class Ss extends Re{constructor(e,t,i){super(void 0,"Root"),this._pathService=e,this._contextService=t,this._labelService=i}add(e){return this.createIfNeeded(e.getId(),()=>new Ft(this._labelService,this,e,this._pathService,this._contextService))}find(e){return this.getChild(e.getId())}}let Ft=(()=>{class d extends Re{constructor(t,i,n,o,s){super(i,n.getLabel(),!0),this._pathService=o,this.rootProvider=s,this._map=new Map,this._labelService=t,this._session=n}getInternalId(){return this._session.getId()}getSession(){return this._session}getHoverLabel(){}hasChildren(){return!0}compare(t,i){const n=this.category(t),o=this.category(i);return n!==o?n-o:super.compare(t,i)}category(t){if(t instanceof Pt)return t.folder.index;const i=t.getLabel();return i&&/^<.+>$/.test(i)?1e3:999}addPath(t){var i=this;return(0,b.Z)(function*(){let n,o,s=t.raw.path;if(!s)return;i._labelService&&Ac.test(s)&&(s=i._labelService.getUriLabel(ue.ov.parse(s)));const r=d.URL_REGEXP.exec(s);if(r&&3===r.length)o=r[1],s=decodeURI(r[2]);else if((0,ce.YP)(s)){const c=ue.ov.file(s);n=i.rootProvider?i.rootProvider.getWorkspaceFolder(c):null,n?(s=(0,ce.Fv)((0,De.j3)(c.path.substring(n.uri.path.length),ce.KR.sep)),i.rootProvider.getWorkspace().folders.length>1?s=ce.KR.sep+s:n=null):(s=(0,ce.Fv)(s),s=re.ED?(0,Bi.DT)(s):(0,Bi.Cn)(s,(yield i._pathService.userHome()).fsPath))}let a=i;s.split(/[\/\\]/).forEach((c,g)=>{if(0===g&&n){const p=n;a=a.createIfNeeded(n.name,f=>new Pt(f,p))}else a=0===g&&o?a.createIfNeeded(o,p=>new Re(p,o)):a.createIfNeeded(c,p=>new Re(p,c))}),a.setSource(i._session,t),t.raw.path&&i._map.set(t.raw.path,a)})()}removePath(t){if(t.raw.path){const i=this._map.get(t.raw.path);if(i)return i.removeFromParent(),!0}return!1}}return d.URL_REGEXP=/^(https?:\/\/[^/]+)(\/.*)$/,d})();function Cs(d,e){const t=d.getChildren(),i=e?!e.expanded.has(d.getId()):!(d instanceof Ft);return{element:d,collapsed:i,collapsible:d.hasChildren(),children:t.map(n=>Cs(n,e))}}let Rn=class extends pe.qV{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m,S,w){super(e,i,t,s,a,o,n,m,S,w),this.editorService=r,this.contextService=c,this.debugService=g,this.labelService=p,this.pathService=f,this.treeNeedsRefreshOnVisible=!1,this.loadedScriptsItemType=h.gd.bindTo(a)}renderBody(e){var t=this;super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-loaded-scripts"),e.classList.add("show-file-icons"),this.treeContainer=ni(e),this.filter=new Rc;const i=new Ss(this.pathService,this.contextService,this.labelService);this.treeLabels=this.instantiationService.createInstance(Ec.RX,{onDidChangeVisibility:this.onDidChangeBodyVisibility}),this._register(this.treeLabels),this.tree=this.instantiationService.createInstance(Ge.J6,"LoadedScriptsView",this.treeContainer,new Lc,[new ys(this.treeLabels)],{compressionEnabled:!0,collapseByDefault:!0,hideTwistiesOfChildlessElements:!0,identityProvider:{getId:c=>c.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:c=>c.getLabel(),getCompressedNodeKeyboardNavigationLabel:c=>c.map(g=>g.getLabel()).join("/")},filter:this.filter,accessibilityProvider:new Bc,overrideStyles:{listBackground:this.getBackgroundColor()}});const n=c=>this.tree.setChildren(null,Cs(i,c).children);n(),this.changeScheduler=new Q.pY(()=>{this.treeNeedsRefreshOnVisible=!1,this.tree&&n()},300),this._register(this.changeScheduler),this._register(this.tree.onDidOpen(c=>{if(c.element instanceof Re){const g=c.element.getSource();g&&g.available&&g.openInEditor(this.editorService,{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0},c.editorOptions.preserveFocus,c.sideBySide,c.editorOptions.pinned)}})),this._register(this.tree.onDidChangeFocus(()=>{this.tree.getFocus()instanceof Ft?this.loadedScriptsItemType.set("session"):this.loadedScriptsItemType.reset()}));const o=()=>{this.isBodyVisible()?this.changeScheduler.schedule():this.treeNeedsRefreshOnVisible=!0},s=function(){var c=(0,b.Z)(function*(g){if(g.capabilities.supportsLoadedSourcesRequest){const p=i.add(g),f=yield g.getLoadedSources();for(const m of f)yield p.addPath(m);o()}});return function(p){return c.apply(this,arguments)}}(),r=c=>{this._register(c.onDidChangeName((0,b.Z)(function*(){const g=i.find(c);g&&(g.updateLabel(c.getLabel()),o())}))),this._register(c.onDidLoadedSource(function(){var g=(0,b.Z)(function*(p){let f;switch(p.reason){case"new":case"changed":f=i.add(c),yield f.addPath(p.source),o(),"changed"===p.reason&&di.refreshDebugContent(p.source.uri);break;case"removed":f=i.find(c),f&&f.removePath(p.source)&&o();break;default:t.filter.setFilter(p.source.name),t.tree.refilter()}});return function(p){return g.apply(this,arguments)}}()))};let a;this._register(this.debugService.onDidNewSession(r)),this.debugService.getModel().getSessions().forEach(r),this._register(this.debugService.onDidEndSession(c=>{i.remove(c.getId()),this.changeScheduler.schedule()})),this.changeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility(c=>{c&&this.treeNeedsRefreshOnVisible&&this.changeScheduler.schedule()})),this._register(this.tree.onDidChangeFindPattern(c=>{if(this.tree.findMode!==Nc.sZ.Highlight)if(!a&&c){const g=new Set,p=f=>{f.element&&!f.collapsed&&g.add(f.element.getId());for(const m of f.children)p(m)};p(this.tree.getNode()),a={expanded:g},this.tree.expandAll()}else!c&&a&&(this.tree.setFocus([]),n(a),a=void 0)})),this.debugService.getModel().getSessions().forEach(c=>s(c))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}dispose(){(0,F.B9)(this.tree),(0,F.B9)(this.treeLabels),super.dispose()}};Rn=(0,u.gn)([(0,u.fM)(1,Y.i),(0,u.fM)(2,Ke.d),(0,u.fM)(3,q.TG),(0,u.fM)(4,J.XH),(0,u.fM)(5,Z.Ui),(0,u.fM)(6,oe.AR),(0,u.fM)(7,A.i6),(0,u.fM)(8,Te.ec),(0,u.fM)(9,h.tn),(0,u.fM)(10,yt.e),(0,u.fM)(11,Qi.a),(0,u.fM)(12,Fe.v4),(0,u.fM)(13,X.XE),(0,u.fM)(14,be.bU)],Rn);class Lc{getHeight(e){return 22}getTemplateId(e){return ys.ID}}let ys=(()=>{class d{constructor(t){this.labels=t}get templateId(){return d.ID}renderTemplate(t){return{label:this.labels.create(t,{supportHighlights:!0})}}renderElement(t,i,n){const o=t.element,s=o.getLabel();this.render(o,s,n,t.filterData)}renderCompressedElements(t,i,n,o){const s=t.element.elements[t.element.elements.length-1],r=t.element.elements.map(a=>a.getLabel());this.render(s,r,n,t.filterData)}render(t,i,n,o){const s={name:i},r={title:t.getHoverLabel()};if(t instanceof Pt)r.fileKind=U.RR.ROOT_FOLDER;else if(t instanceof Ft)r.title=l.NC("loadedScriptsSession","Debug Session"),r.hideIcon=!0;else if(t instanceof Re){const a=t.getSource();a&&a.uri?(s.resource=a.uri,r.fileKind=U.RR.FILE):r.fileKind=U.RR.FOLDER}r.matches=(0,he.mB)(o),n.label.setResource(s,r)}disposeTemplate(t){t.label.dispose()}}return d.ID="lsrenderer",d})();class Bc{getWidgetAriaLabel(){return l.NC({comment:["Debug is a noun in this context, not a verb."],key:"loadedScriptsAriaLabel"},"Debug Loaded Scripts")}getAriaLabel(e){return e instanceof Pt?l.NC("loadedScriptsRootFolderAriaLabel","Workspace folder {0}, loaded script, debug",e.getLabel()):e instanceof Ft?l.NC("loadedScriptsSessionAriaLabel","Session {0}, loaded script, debug",e.getLabel()):e.hasChildren()?l.NC("loadedScriptsFolderAriaLabel","Folder {0}, loaded script, debug",e.getLabel()):l.NC("loadedScriptsSourceAriaLabel","{0}, loaded script, debug",e.getLabel())}}class Rc{setFilter(e){this.filterText=e}filter(e,t){return this.filterText?e.isLeaf()?e.getLabel().indexOf(this.filterText)>=0?1:0:2:1}}var Vc=v(38264),Pc=v(74045);(0,He.Z)(".monaco-workbench .repl{box-sizing:border-box;height:100%;overflow:hidden}.monaco-workbench .repl .repl-tree .monaco-tl-contents{user-select:text;-webkit-user-select:text;white-space:pre}.monaco-workbench .repl .repl-tree .monaco-tl-contents .expression{font-family:var(--vscode-repl-font-family);font-size:var(--vscode-repl-font-size);line-height:var(--vscode-repl-line-height)}.monaco-workbench .repl .repl-tree .monaco-tl-contents .expression .lazy-button{cursor:pointer}.monaco-workbench .repl .repl-tree .monaco-tl-twistie{background-position-y:calc(100% - var(--vscode-repl-font-size-for-twistie))}.monaco-workbench .repl .repl-tree.word-wrap .monaco-tl-contents{word-wrap:break-word;white-space:pre-wrap;word-break:break-all}.monaco-workbench .repl .repl-tree.word-wrap .monaco-tl-contents .expression.nested-variable{white-space:pre}.monaco-workbench .repl .repl-tree .monaco-tl-twistie,.monaco-workbench .repl .repl-tree .monaco-tl-twistie.collapsible+.monaco-tl-contents{cursor:pointer}.monaco-workbench .repl .repl-tree .output.expression.value-and-source{display:flex}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .count-badge-wrapper,.monaco-workbench .repl .repl-tree .output.expression.value-and-source .value{margin-right:4px}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .count-badge-wrapper .monaco-count-badge{min-height:16px;word-break:keep-all}.monaco-workbench .repl .repl-tree .monaco-tl-contents .arrow{left:2px;position:absolute}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .source{cursor:pointer;direction:rtl;margin-left:auto;margin-right:8px;max-width:400px;overflow:hidden;text-align:right;text-decoration:underline;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .repl .repl-tree .evaluation-result.expression>.value,.monaco-workbench .repl .repl-tree .output.expression>.value{margin-left:0}.monaco-workbench .repl .repl-tree .output.expression .name:not(:empty){margin-right:6px}.monaco-workbench .repl .repl-input-wrapper{align-items:center;display:flex}.monaco-workbench .repl .repl-input-wrapper .suggest-status-bar .monaco-action-bar.right{display:none}.monaco-workbench .repl .repl-input-wrapper .repl-input-chevron{display:flex;flex-shrink:0;font-weight:600;height:100%;justify-content:center;padding:0 6px 0 8px;width:16px}.monaco-workbench .repl .repl-tree .output.expression>.ignore{font-style:italic}.monaco-workbench .repl .repl-tree .output.expression .code-bold{font-weight:700}.monaco-workbench .repl .repl-tree .output.expression .code-italic{font-style:italic}.monaco-workbench .repl .repl-tree .output.expression .code-underline{text-decoration:underline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-double-underline{text-decoration:underline;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-strike-through{text-decoration:line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline{text-decoration:overline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-underline.code-strike-through{text-decoration:overline underline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-underline{text-decoration:overline underline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-strike-through{text-decoration:overline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-underline.code-strike-through{text-decoration:underline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-double-underline.code-strike-through{text-decoration:overline underline line-through;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-double-underline{text-decoration:overline underline;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-double-underline.code-strike-through{text-decoration:underline line-through;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-dim{opacity:.4}.monaco-workbench .repl .repl-tree .output.expression .code-hidden{opacity:0}.monaco-workbench .repl .repl-tree .output.expression .code-blink{animation:code-blink-key 1s cubic-bezier(1,0,0,1) infinite alternate}.monaco-workbench .repl .repl-tree .output.expression .code-rapid-blink{animation:code-blink-key .3s cubic-bezier(1,0,0,1) infinite alternate}@keyframes code-blink-key{to{opacity:.4}}.monaco-workbench .repl .repl-tree .output.expression .code-subscript{font-size:smaller;line-height:normal;vertical-align:sub}.monaco-workbench .repl .repl-tree .output.expression .code-superscript{font-size:smaller;line-height:normal;vertical-align:super}",{});var Oc=v(15023),Hc=v(87808),Wc=v(17404),_c=v(15364),Uc=v(30030);let $c=(()=>{class d{constructor(){this._parsedQueries=[]}set filterQuery(t){if(this._parsedQueries=[],(t=t.trim())&&""!==t){const i=(0,Uc.Eu)(t,",").map(n=>n.trim()).filter(n=>!!n.length);for(const n of i)n.startsWith("!")?this._parsedQueries.push({type:"exclude",query:n.slice(1)}):this._parsedQueries.push({type:"include",query:n})}}filter(t,i){if(t instanceof Qt||t instanceof ot||t instanceof T._w)return 1;let n=!1,o=!1;const s=t.toString(!0);for(const{type:r,query:a}of this._parsedQueries){if("exclude"===r&&d.matchQuery(a,s))return!1;"include"===r&&(n=!0,d.matchQuery(a,s)&&(o=!0))}return n?o:typeof i<"u"?i:1}}return d.matchQuery=he.Oh,d})();var Zc=v(84249),zc=v(57245),ws=v(94429);function ks(d,e,t,i){const n=document.createElement("span"),o=d.length;let r,a,c,s=[],g=!1,p=0,f="";for(;p<o;){let N=!1;if(27===d.charCodeAt(p)&&"["===d.charAt(p+1)){const B=p;p+=2;let k="";for(;p<o;){const P=d.charAt(p);if(k+=P,p++,P.match(/^[ABCDHIJKfhmpsu]$/)){N=!0;break}}if(N){if(Ds(n,f,s,e,i,r,a,c),f="",k.match(/^(?:[34][0-8]|9[0-7]|10[0-7]|[0-9]|2[1-5,7-9]|[34]9|5[8,9]|1[0-9])(?:;[349][0-7]|10[0-7]|[013]|[245]|[34]9)?(?:;[012]?[0-9]?[0-9])*;?m$/)){const P=k.slice(0,-1).split(";").filter(_=>""!==_).map(_=>parseInt(_,10));if(38===P[0]||48===P[0]||58===P[0]){const _=38===P[0]?"foreground":48===P[0]?"background":"underline";5===P[1]?I(P,_):2===P[1]&&M(P,_)}else w(P)}}else p=B}!1===N&&(f+=d.charAt(p),p++)}return f&&Ds(n,f,s,e,i,r,a,c),n;function m(N,B){"foreground"===N?r=B:"background"===N?a=B:"underline"===N&&(c=B),s=s.filter(k=>k!==`code-${N}-colored`),void 0!==B&&s.push(`code-${N}-colored`)}function S(){const N=r;m("foreground",a),m("background",N)}function w(N){for(const B of N)switch(B){case 0:s=[],r=void 0,a=void 0;break;case 1:s=s.filter(k=>"code-bold"!==k),s.push("code-bold");break;case 2:s=s.filter(k=>"code-dim"!==k),s.push("code-dim");break;case 3:s=s.filter(k=>"code-italic"!==k),s.push("code-italic");break;case 4:s=s.filter(k=>"code-underline"!==k&&"code-double-underline"!==k),s.push("code-underline");break;case 5:s=s.filter(k=>"code-blink"!==k),s.push("code-blink");break;case 6:s=s.filter(k=>"code-rapid-blink"!==k),s.push("code-rapid-blink");break;case 7:g||(g=!0,S());break;case 8:s=s.filter(k=>"code-hidden"!==k),s.push("code-hidden");break;case 9:s=s.filter(k=>"code-strike-through"!==k),s.push("code-strike-through");break;case 10:s=s.filter(k=>!k.startsWith("code-font"));break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:s=s.filter(k=>!k.startsWith("code-font")),s.push("code-font-"+(B-10));break;case 21:s=s.filter(k=>"code-underline"!==k&&"code-double-underline"!==k),s.push("code-double-underline");break;case 22:s=s.filter(k=>"code-bold"!==k&&"code-dim"!==k);break;case 23:s=s.filter(k=>"code-italic"!==k&&"code-font-10"!==k);break;case 24:s=s.filter(k=>"code-underline"!==k&&"code-double-underline"!==k);break;case 25:s=s.filter(k=>"code-blink"!==k&&"code-rapid-blink"!==k);break;case 27:g&&(g=!1,S());break;case 28:s=s.filter(k=>"code-hidden"!==k);break;case 29:s=s.filter(k=>"code-strike-through"!==k);break;case 53:s=s.filter(k=>"code-overline"!==k),s.push("code-overline");break;case 55:s=s.filter(k=>"code-overline"!==k);break;case 39:m("foreground",void 0);break;case 49:m("background",void 0);break;case 59:m("underline",void 0);break;case 73:s=s.filter(k=>"code-superscript"!==k&&"code-subscript"!==k),s.push("code-superscript");break;case 74:s=s.filter(k=>"code-superscript"!==k&&"code-subscript"!==k),s.push("code-subscript");break;case 75:s=s.filter(k=>"code-superscript"!==k&&"code-subscript"!==k);break;default:L(B)}}function M(N,B){N.length>=5&&N[2]>=0&&N[2]<=255&&N[3]>=0&&N[3]<=255&&N[4]>=0&&N[4]<=255&&m(B,new Ee.VS(N[2],N[3],N[4]))}function I(N,B){let k=N[2];const P=function jc(d){if(d%1!=0);else{if(d>=16&&d<=231){let e=(d-=16)%6,t=(d=(d-e)/6)%6,i=d=(d-t)/6;const n=51;return e=Math.round(e*n),t=Math.round(t*n),i=Math.round(i*n),new Ee.VS(i,t,e)}if(d>=232&&d<=255){d-=232;const e=Math.round(d/23*255);return new Ee.VS(e,e,e)}}}(k);if(P)m(B,P);else if(k>=0&&k<=15){if("underline"===B){const O=t.getColorTheme().getColor(ws.D2[k]);return void(O&&m(B,O.rgba))}k+=30,k>=38&&(k+=52),"background"===B&&(k+=10),L(k)}}function L(N){const B=t.getColorTheme();let k,P;if(N>=30&&N<=37?(P=N-30,k="foreground"):N>=90&&N<=97?(P=N-90+8,k="foreground"):N>=40&&N<=47?(P=N-40,k="background"):N>=100&&N<=107&&(P=N-100+8,k="background"),void 0!==P&&k){const W=B.getColor(ws.D2[P]);W&&m(k,W.rgba)}}}function Ds(d,e,t,i,n,o,s,r){if(!d||!e)return;const a=i.linkify(e,!0,n);a.className=t.join(" "),o&&(a.style.color=Ee.Il.Format.CSS.formatRGB(new Ee.Il(o))),s&&(a.style.backgroundColor=Ee.Il.Format.CSS.formatRGB(new Ee.Il(s))),r&&(a.style.textDecorationColor=Ee.Il.Format.CSS.formatRGB(new Ee.Il(r))),d.appendChild(a)}const ve=y.$;let xs=(()=>{class d{get templateId(){return d.ID}renderTemplate(t){y.R3(t,ve("span.arrow"+V.kS.asCSSSelector(E.kd)));const i=y.R3(t,ve(".expression"));return{label:new je.q(i)}}renderElement(t,i,n){n.label.set(t.element.value,(0,he.mB)(t.filterData))}disposeTemplate(t){}}return d.ID="replEvaluationInput",d})(),Ot=class ir{constructor(e,t){this.linkDetector=e,this.themeService=t}get templateId(){return ir.ID}renderTemplate(e){return{label:y.R3(e,ve(".expression"))}}renderElement(e,t,i){const n=e.element;y.PO(i.label);const o=ks(n.name,this.linkDetector,this.themeService,void 0);i.label.appendChild(o)}disposeTemplate(e){}};Ot.ID="replGroup",Ot=(0,u.gn)([(0,u.fM)(1,X.XE)],Ot);let Es=(()=>{class d{get templateId(){return d.ID}constructor(t){this.linkDetector=t}renderTemplate(t){const i=y.R3(t,ve(".evaluation-result.expression"));return{value:y.R3(i,ve("span.value"))}}renderElement(t,i,n){dt(t.element,n.value,{showHover:!1,colorize:!0,linkDetector:this.linkDetector})}disposeTemplate(t){}}return d.ID="replEvaluationResult",d})(),Ht=class nr{constructor(e,t,i,n){this.linkDetector=e,this.editorService=t,this.labelService=i,this.themeService=n}get templateId(){return nr.ID}renderTemplate(e){const t=Object.create(null);e.classList.add("output");const i=y.R3(e,ve(".output.expression.value-and-source"));return t.container=e,t.countContainer=y.R3(i,ve(".count-badge-wrapper")),t.count=new Zc.Z(t.countContainer,{},xt.ku),t.value=y.R3(i,ve("span.value")),t.source=y.R3(i,ve(".source")),t.toDispose=[],t.toDispose.push(y.nm(t.source,"click",n=>{n.preventDefault(),n.stopPropagation();const o=t.getReplElementSource();o&&o.source.openInEditor(this.editorService,{startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:o.lineNumber,endColumn:o.column})})),t}renderElement({element:e},t,i){this.setElementCount(e,i),i.elementListener=e.onDidChangeCount(()=>this.setElementCount(e,i)),y.PO(i.value),i.value.className="value",i.value.appendChild(ks(e.value,this.linkDetector,this.themeService,e.session.root)),i.value.classList.add(e.severity===fe.Z.Warning?"warn":e.severity===fe.Z.Error?"error":e.severity===fe.Z.Ignore?"ignore":"info"),i.source.textContent=e.sourceData?`${(0,ce.EZ)(e.sourceData.source.name)}:${e.sourceData.lineNumber}`:"",i.source.title=e.sourceData?`${this.labelService.getUriLabel(e.sourceData.source.uri)}:${e.sourceData.lineNumber}`:"",i.getReplElementSource=()=>e.sourceData}setElementCount(e,t){e.count>=2?(t.count.setCount(e.count),t.countContainer.hidden=!1):t.countContainer.hidden=!0}disposeTemplate(e){(0,F.B9)(e.toDispose)}disposeElement(e,t,i){i.elementListener.dispose()}};Ht.ID="outputReplElement",Ht=(0,u.gn)([(0,u.fM)(1,oe.AR),(0,u.fM)(2,yt.e),(0,u.fM)(3,X.XE)],Ht);let Wt=class or extends Et{get templateId(){return or.ID}constructor(e,t,i){super(t,i),this.linkDetector=e}renderElement(e,t,i){const n=e.element;super.renderExpressionElement(n instanceof Gt?n.expr:n,e,i)}renderExpression(e,t,i){const n=e instanceof Gt;n||!e.name?(t.label.set(""),dt(n?e.expr:e,t.value,{showHover:!1,colorize:!0,linkDetector:this.linkDetector}),t.expression.classList.remove("nested-variable")):(Bo(e,t,!0,i,this.linkDetector),t.expression.classList.toggle("nested-variable",Vn(e)))}getInputBoxOptions(e){}};Wt.ID="replVariable",Wt=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,Y.u)],Wt);let Is=(()=>{class d{constructor(t){this.linkDetector=t}get templateId(){return d.ID}renderTemplate(t){t.classList.add("output");const i=y.R3(t,ve(".output.expression")),n=y.R3(i,ve("span.name"));return{container:t,expression:i,name:n,label:new je.q(n),value:y.R3(i,ve("span.value"))}}renderElement(t,i,n){const o=t.element;n.label.set(o.name?`${o.name}:`:"",(0,he.mB)(t.filterData)),n.name.textContent=o.name?`${o.name}:`:"",dt(o.value,n.value,{showHover:!1,linkDetector:this.linkDetector})}disposeTemplate(t){}}return d.ID="rawObject",d})();function Vn(d){return d instanceof T._w&&(d.parent instanceof ot||d.parent instanceof T._w)}class Kc extends zc.Vj{constructor(e,t){super(),this.configurationService=e,this.replOptions=t}getHeight(e){return this.configurationService.getValue("debug").console.wordWrap?super.getHeight(e):this.estimateHeight(e,!0)}estimateHeight(e,t=!1){const i=this.replOptions.replConfiguration.lineHeight;if("string"==typeof e.value&&!Vn(e)){const s=e.value,r=(s=>s.match(/\n/g)?.length??0)(s)+(t?0:Math.floor(s.length/70))+(e instanceof Oe?0:1);return Math.max(r,1)*i}return i}getTemplateId(e){return e instanceof T._w||e instanceof Gt?Wt.ID:e instanceof ot?Es.ID:e instanceof Qt?xs.ID:e instanceof Oe?Ht.ID:e instanceof st?Ot.ID:Is.ID}hasDynamicHeight(e){return!Vn(e)&&e.toString().length>0}}function Ms(d){return"function"==typeof d.getReplElements}class Gc{hasChildren(e){return!!Ms(e)||!!e.hasChildren}getChildren(e){return Ms(e)?Promise.resolve(e.getReplElements()):Promise.resolve(e.getChildren())}}class Qc{getWidgetAriaLabel(){return(0,l.NC)("debugConsole","Debug Console")}getAriaLabel(e){return e instanceof T._w?(0,l.NC)("replVariableAriaLabel","Variable {0}, value {1}",e.name,e.value):e instanceof Oe||e instanceof Qt||e instanceof ot?e.value+(e instanceof Oe&&e.count>1?(0,l.NC)({key:"occurred",comment:["Front will the value of the debug console element. Placeholder will be replaced by a number which represents occurrance count."]},", occurred {0} times",e.count):""):e instanceof Er?(0,l.NC)("replRawObjectAriaLabel","Debug console variable {0}, value {1}",e.name,e.value):e instanceof st?(0,l.NC)("replGroup","Debug console group {0}",e.name):""}}const li=y.$,Pn="debug.repl.history",Fn="debug.repl.filterHistory",On="debug.repl.filterValue",Ns="replinputdecoration";function _t(d){d.scrollTop=d.scrollHeight-d.renderHeight}const gt=new Set,Ts={getId:d=>d.getId()};let Ye=class gi extends pe.S_{constructor(e,t,i,n,o,s,r,a,c,g,p,f,m,S,w,M,I,L,N){const B=n.get(On,1,"");super({...e,filterOptions:{placeholder:(0,l.NC)({key:"workbench.debug.filter.placeholder",comment:["Text in the brackets after e.g. is not localizable"]},"Filter (e.g. text, !exclude)"),text:B,history:JSON.parse(n.get(Fn,1,"[]"))}},S,g,p,r,c,i,w,o,M),this.debugService=t,this.storageService=n,this.modelService=s,this.textResourcePropertiesService=f,this.editorService=m,this.languageFeaturesService=L,this.logService=N,this.previousTreeScrollHeight=0,this.replInputLineCount=1,this.modelChangeListener=F.JT.None,this.menu=I.createMenu(D.eH.DebugConsoleContext,r),this._register(this.menu),this.history=new Pc.L(JSON.parse(this.storageService.get(Pn,1,"[]")),50),this.filter=new $c,this.filter.filterQuery=B,this.multiSessionRepl=h.h4.bindTo(r),this.replOptions=this._register(this.instantiationService.createInstance(ui,this.id,()=>this.getBackgroundColor())),this._register(this.replOptions.onDidChange(()=>this.onDidStyleChange())),a.registerDecorationType("repl-decoration",Ns,{}),this.multiSessionRepl.set(this.isMultiSessionView),this.registerListeners()}registerListeners(){var e=this;this.debugService.getViewModel().focusedSession&&this.onDidFocusSession(this.debugService.getViewModel().focusedSession),this._register(this.debugService.getViewModel().onDidFocusSession(function(){var t=(0,b.Z)(function*(i){return e.onDidFocusSession(i)});return function(i){return t.apply(this,arguments)}}())),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(function(){var t=(0,b.Z)(function*(i){i instanceof T._w&&e.tree?.hasNode(i)&&(yield e.tree.updateChildren(i,!1,!0),yield e.tree.expand(i))});return function(i){return t.apply(this,arguments)}}())),this._register(this.debugService.onWillNewSession(function(){var t=(0,b.Z)(function*(i){const n=e.tree?.getInput();(!n||0===n.state)&&(yield e.selectSession(i)),e.multiSessionRepl.set(e.isMultiSessionView)});return function(i){return t.apply(this,arguments)}}())),this._register(this.debugService.onDidEndSession(function(){var t=(0,b.Z)(function*(i){yield Promise.resolve(),e.multiSessionRepl.set(e.isMultiSessionView)});return function(i){return t.apply(this,arguments)}}())),this._register(this.themeService.onDidColorThemeChange(()=>{this.refreshReplElements(!1),this.isVisible()&&this.updateInputDecoration()})),this._register(this.onDidChangeBodyVisibility(t=>{t&&(this.model||(this.model=this.modelService.getModel(gi.URI)||this.modelService.createModel("",null,gi.URI,!0)),this.setMode(),this.replInput.setModel(this.model),this.updateInputDecoration(),this.refreshReplElements(!0))})),this._register(this.configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("debug.console.wordWrap")&&this.tree&&(this.tree.dispose(),this.treeContainer.innerText="",y.PO(this.treeContainer),this.createReplTree()),t.affectsConfiguration("debug.console.acceptSuggestionOnEnter")){const i=this.configurationService.getValue("debug");this.replInput.updateOptions({acceptSuggestionOnEnter:"on"===i.console.acceptSuggestionOnEnter?"on":"off"})}})),this._register(this.editorService.onDidActiveEditorChange(()=>{this.setMode()})),this._register(this.filterWidget.onDidChangeFilterText(()=>{this.filter.filterQuery=this.filterWidget.getFilterText(),this.tree&&(this.tree.refilter(),_t(this.tree))}))}onDidFocusSession(e){var t=this;return(0,b.Z)(function*(){var i;e&&(gt.delete(e),t.completionItemProvider?.dispose(),e.capabilities.supportsCompletionsRequest&&(t.completionItemProvider=t.languageFeaturesService.completionProvider.register({scheme:h.lR,pattern:"**/replinput",hasAccessToAllModels:!0},{triggerCharacters:e.capabilities.completionTriggerCharacters||["."],provideCompletionItems:(i=(0,b.Z)(function*(n,o,s,r){t.setHistoryNavigationEnablement(!1);const a=t.replInput.getModel();if(a){const c=a.getWordAtPosition(o),g=c?c.word.length:0,p=a.getValue(),f=t.debugService.getViewModel().focusedStackFrame,m=f?f.frameId:void 0,S=yield e.completions(m,f?.thread.threadId||0,p,o,g,r),w=[],M=I=>ae.e.fromPositions(o.delta(0,-I),o);if(S&&S.body&&S.body.targets&&S.body.targets.forEach(I=>{if(I&&I.label){let L,N=I.text||I.label;if("number"==typeof I.selectionStart){L=4;const B="number"==typeof I.selectionLength?I.selectionLength:0,k=B>0?"${1:"+N.substring(I.selectionStart,I.selectionStart+B)+"}$0":"$0";N=N.substring(0,I.selectionStart)+k+N.substring(I.selectionStart+B)}w.push({label:I.label,insertText:N,detail:I.detail,kind:Hc.gX.fromString(I.type||"property"),filterText:I.start&&I.length?p.substring(I.start,I.start+I.length).concat(I.label):void 0,range:M(I.length||g),sortText:I.sortText,insertTextRules:L})}}),t.configurationService.getValue("debug").console.historySuggestions){const I=t.history.getHistory(),L=String(I.length).length;I.forEach((N,B)=>w.push({label:N,insertText:N,kind:18,range:M(N.length),sortText:"ZZZ"+String(I.length-B).padStart(L,"0")}))}return{suggestions:w}}return Promise.resolve({suggestions:[]})}),function(o,s,r,a){return i.apply(this,arguments)})}))),yield t.selectSession()})()}getFilterStats(){return{total:this.tree?.getNode().children.length??0,filtered:this.tree?.getNode().children.filter(e=>e.visible).length??0}}get isReadonly(){const e=this.tree?.getInput();return!(e&&0!==e.state)}showPreviousValue(){this.isReadonly||this.navigateHistory(!0)}showNextValue(){this.isReadonly||this.navigateHistory(!1)}focusFilter(){this.filterWidget.focus()}setMode(){if(!this.isVisible())return;const e=this.editorService.activeTextEditorControl;(0,Ve.CL)(e)&&(this.modelChangeListener.dispose(),this.modelChangeListener=e.onDidChangeModelLanguage(()=>this.setMode()),this.model&&e.hasModel()&&this.model.setLanguage(e.getModel().getLanguageId()))}onDidStyleChange(){if(this.styleElement){this.replInput.updateOptions({fontSize:this.replOptions.replConfiguration.fontSize,lineHeight:this.replOptions.replConfiguration.lineHeight,fontFamily:"default"===this.replOptions.replConfiguration.fontFamily?Oc.hL.fontFamily:this.replOptions.replConfiguration.fontFamily});const e=this.replInput.getOption(64);this.styleElement.textContent=`\n\t\t\t\t.repl .repl-input-wrapper .repl-input-chevron {\n\t\t\t\t\tline-height: ${e}px\n\t\t\t\t}\n\n\t\t\t\t.repl .repl-input-wrapper .monaco-editor .lines-content {\n\t\t\t\t\tbackground-color: ${this.replOptions.replConfiguration.backgroundColor};\n\t\t\t\t}\n\t\t\t`,this.container.style.setProperty("--vscode-repl-font-family","default"===this.replOptions.replConfiguration.fontFamily?"var(--monaco-monospace-font)":this.replOptions.replConfiguration.fontFamily),this.container.style.setProperty("--vscode-repl-font-size",`${this.replOptions.replConfiguration.fontSize}px`),this.container.style.setProperty("--vscode-repl-font-size-for-twistie",`${this.replOptions.replConfiguration.fontSizeForTwistie}px`),this.container.style.setProperty("--vscode-repl-line-height",this.replOptions.replConfiguration.cssLineHeight),this.tree?.rerender(),this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}navigateHistory(e){const t=(e?this.history.previous()??this.history.first():this.history.next())??"";this.replInput.setValue(t),Ze.i7(t),this.replInput.setPosition({lineNumber:1,column:t.length+1}),this.setHistoryNavigationEnablement(!0)}selectSession(e){var t=this;return(0,b.Z)(function*(){const i=t.tree?.getInput();if(!e){const n=t.debugService.getViewModel().focusedSession;n?e=n:(!i||gt.has(i))&&(e=t.debugService.getModel().getSessions(!0).find(o=>!gt.has(o)))}if(e&&(t.replElementsChangeListener?.dispose(),t.replElementsChangeListener=e.onDidChangeReplElements(()=>{t.refreshReplElements(0===e.getReplElements().length)}),t.tree&&i!==e)){try{yield t.tree.setInput(e)}catch(n){t.logService.error(n)}_t(t.tree)}t.replInput?.updateOptions({readOnly:t.isReadonly}),t.updateInputDecoration()})()}clearRepl(){var e=this;return(0,b.Z)(function*(){const t=e.tree?.getInput();t&&(t.removeReplExpressions(),0===t.state&&(gt.add(t),yield e.selectSession(),e.multiSessionRepl.set(e.isMultiSessionView))),e.replInput.focus()})()}acceptReplInput(){const e=this.tree?.getInput();if(e&&!this.isReadonly){e.addReplExpression(this.debugService.getViewModel().focusedStackFrame,this.replInput.getValue()),_t(this.tree),this.history.add(this.replInput.getValue()),this.replInput.setValue("");const t=this.replInputLineCount>1;this.replInputLineCount=1,t&&this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}getVisibleContent(){let e="";if(this.model&&this.tree){const t=this.textResourcePropertiesService.getEOL(this.model.uri),i=n=>{n.children.forEach(o=>{o.visible&&(e+=o.element.toString().trimRight()+t,!o.collapsed&&o.children.length&&i(o))})};i(this.tree.getNode())}return(0,De.Yd)(e)}layoutBodyContent(e,t){this.bodyContentDimension=new y.Ro(t,e);const i=Math.min(this.replInput.getContentHeight(),e);if(this.tree){const n=this.tree.scrollTop+this.tree.renderHeight>=this.tree.scrollHeight,o=e-i;this.tree.getHTMLElement().style.height=`${o}px`,this.tree.layout(o,t),n&&_t(this.tree)}this.replInputContainer.style.height=`${i}px`,this.replInput.layout({width:t-30,height:i})}collapseAll(){this.tree?.collapseAll()}getReplInput(){return this.replInput}focus(){setTimeout(()=>this.replInput.focus(),0)}getActionViewItem(e){if(e.id===As){const t=(this.tree?this.tree.getInput():void 0)??this.debugService.getViewModel().focusedSession;return this.instantiationService.createInstance(Yc,e,t)}return super.getActionViewItem(e)}get isMultiSessionView(){return this.debugService.getModel().getSessions(!0).filter(e=>e.hasSeparateRepl()&&!gt.has(e)).length>1}get refreshScheduler(){var e=this;const t=new Set;return new Q.pY((0,b.Z)(function*(){if(!e.tree||!e.tree.getInput())return;yield e.tree.updateChildren(void 0,!0,!1,{diffIdentityProvider:Ts});const i=e.tree.getInput();if(i){const s=function(){var r=(0,b.Z)(function*(a){for(const c of a)c instanceof st&&(c.autoExpand&&!t.has(c.getId())&&(t.add(c.getId()),yield e.tree.expand(c)),e.tree.isCollapsed(c)||(yield s(c.getChildren())))});return function(c){return r.apply(this,arguments)}}();yield s(i.getReplElements())}const{total:n,filtered:o}=e.getFilterStats();e.filterWidget.updateBadge(n===o||0===n?void 0:(0,l.NC)("showing filtered repl lines","Showing {0} of {1}",o,n))}),gi.REFRESH_DELAY)}renderBody(e){super.renderBody(e),this.container=y.R3(e,li(".repl")),this.treeContainer=y.R3(this.container,li(`.repl-tree.${Vc.S}`)),this.createReplInput(this.container),this.createReplTree()}createReplTree(){this.replDelegate=new Kc(this.configurationService,this.replOptions);const e=this.configurationService.getValue("debug").console.wordWrap;this.treeContainer.classList.toggle("word-wrap",e);const t=this.instantiationService.createInstance(qe),i=this.tree=this.instantiationService.createInstance(Ge.ls,"DebugRepl",this.treeContainer,this.replDelegate,[this.instantiationService.createInstance(Wt,t),this.instantiationService.createInstance(Ht,t),new xs,this.instantiationService.createInstance(Ot,t),new Es(t),new Is(t)],new Gc,{filter:this.filter,accessibilityProvider:new Qc,identityProvider:Ts,mouseSupport:!1,findWidgetEnabled:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:o=>o.toString(!0)},horizontalScrolling:!e,setRowLineHeight:!1,supportDynamicHeights:e,overrideStyles:{listBackground:this.getBackgroundColor()}});let n;this._register(i.onDidChangeContentHeight(()=>{i.scrollHeight!==this.previousTreeScrollHeight&&i.scrollTop+i.renderHeight>=this.previousTreeScrollHeight-2&&setTimeout(()=>{_t(i)},0),this.previousTreeScrollHeight=i.scrollHeight})),this._register(i.onContextMenu(o=>this.onContextMenu(o))),this._register(i.onMouseClick(()=>{const o=window.getSelection();(!o||"Range"!==o.type||n===o.toString())&&this.replInput.focus(),n=o?o.toString():""})),this.selectSession(),this.styleElement=y.dS(this.container),this.onDidStyleChange()}createReplInput(e){this.replInputContainer=y.R3(e,li(".repl-input-wrapper")),y.R3(this.replInputContainer,li(".repl-input-chevron"+V.kS.asCSSSelector(E.l5)));const{historyNavigationBackwardsEnablement:t,historyNavigationForwardsEnablement:i}=this._register((0,_c.iY)(this.scopedContextKeyService,this));this.setHistoryNavigationEnablement=s=>{t.set(s),i.set(s)},h.AN.bindTo(this.scopedContextKeyService).set(!0),this.scopedInstantiationService=this.instantiationService.createChild(new Io.y([A.i6,this.scopedContextKeyService]));const n=(0,Yt.e)();n.readOnly=!0,n.suggest={showStatusBar:!0};const o=this.configurationService.getValue("debug");n.acceptSuggestionOnEnter="on"===o.console.acceptSuggestionOnEnter?"on":"off",n.ariaLabel=(0,l.NC)("debugConsole","Debug Console"),n.accessibilitySupport=this.configurationService.getValue("editor.accessibilitySupport"),n.cursorBlinking=this.configurationService.getValue("editor.cursorBlinking"),this.replInput=this.scopedInstantiationService.createInstance(Mo.Gm,this.replInputContainer,n,(0,Yt.q)()),this._register(this.replInput.onDidChangeModelContent(()=>{const s=this.replInput.getModel();this.setHistoryNavigationEnablement(!!s&&""===s.getValue());const r=s?Math.min(10,s.getLineCount()):1;r!==this.replInputLineCount&&(this.replInputLineCount=r,this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width))})),this._register(this.replInput.onDidFocusEditorText(()=>this.updateInputDecoration())),this._register(this.replInput.onDidBlurEditorText(()=>this.updateInputDecoration())),this._register(y.mu(this.replInputContainer,y.tw.FOCUS,()=>this.replInputContainer.classList.add("synthetic-focus"))),this._register(y.mu(this.replInputContainer,y.tw.BLUR,()=>this.replInputContainer.classList.remove("synthetic-focus")))}onContextMenu(e){const t=[];(0,ge.LJ)(this.menu,{arg:e.element,shouldForwardArgs:!1},t),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>t,getActionsContext:()=>e.element})}refreshReplElements(e){if(this.tree&&this.isVisible()){if(this.refreshScheduler.isScheduled())return;this.refreshScheduler.schedule(e?0:void 0)}}updateInputDecoration(){if(!this.replInput)return;const e=[];if(this.isReadonly&&this.replInput.hasTextFocus()&&!this.replInput.getValue()){const t=(0,x.Snq)(x.NOs,this.themeService.getColorTheme())?.transparent(.4);e.push({range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:(0,l.NC)("startDebugFirst","Please start a debug session to evaluate expressions"),color:t?t.toString():void 0}}})}this.replInput.setDecorationsByType("repl-decoration",Ns,e)}saveState(){const e=this.history.getHistory();e.length?this.storageService.store(Pn,JSON.stringify(e),1,1):this.storageService.remove(Pn,1);const t=this.filterWidget.getHistory();t.length?this.storageService.store(Fn,JSON.stringify(t),1,1):this.storageService.remove(Fn,1);const i=this.filterWidget.getFilterText();i?this.storageService.store(On,i,1,1):this.storageService.remove(On,1),super.saveState()}dispose(){this.replInput.dispose(),this.replElementsChangeListener?.dispose(),this.refreshScheduler.dispose(),this.modelChangeListener.dispose(),super.dispose()}};Ye.REFRESH_DELAY=50,Ye.URI=ue.ov.parse(`${h.lR}:replinput`),Ye.__decorator=(0,u.gn)([at.HP],Ye.prototype,"refreshScheduler",null),Ye=(0,u.gn)([(0,u.fM)(1,h.tn),(0,u.fM)(2,q.TG),(0,u.fM)(3,Pe.Uy),(0,u.fM)(4,X.XE),(0,u.fM)(5,Yi.q),(0,u.fM)(6,A.i6),(0,u.fM)(7,Eo.$),(0,u.fM)(8,J.XH),(0,u.fM)(9,Y.i),(0,u.fM)(10,Z.Ui),(0,u.fM)(11,Xn.y),(0,u.fM)(12,oe.AR),(0,u.fM)(13,Ke.d),(0,u.fM)(14,Fe.v4),(0,u.fM)(15,be.bU),(0,u.fM)(16,D.co),(0,u.fM)(17,rt.p),(0,u.fM)(18,nt.VZ)],Ye);let ui=class pi extends F.JT{get replConfiguration(){return this._replConfig}constructor(e,t,i,n,o){super(),this.backgroundColorDelegate=t,this.configurationService=i,this.themeService=n,this.viewDescriptorService=o,this._onDidChange=this._register(new R.Q5),this.onDidChange=this._onDidChange.event,this._register(this.themeService.onDidColorThemeChange(s=>this.update())),this._register(this.viewDescriptorService.onDidChangeLocation(s=>{s.views.some(r=>r.id===e)&&this.update()})),this._register(this.configurationService.onDidChangeConfiguration(s=>{(s.affectsConfiguration("debug.console.lineHeight")||s.affectsConfiguration("debug.console.fontSize")||s.affectsConfiguration("debug.console.fontFamily"))&&this.update()})),this.update()}update(){const e=this.configurationService.getValue("debug").console;this._replConfig={fontSize:e.fontSize,fontFamily:e.fontFamily,lineHeight:e.lineHeight?e.lineHeight:pi.lineHeightEm*e.fontSize,cssLineHeight:e.lineHeight?`${e.lineHeight}px`:`${pi.lineHeightEm}em`,backgroundColor:this.themeService.getColorTheme().getColor(this.backgroundColorDelegate()),fontSizeForTwistie:e.fontSize*pi.lineHeightEm/2-8},this._onDidChange.fire()}};ui.lineHeightEm=1.4,ui=(0,u.gn)([(0,u.fM)(2,Z.Ui),(0,u.fM)(3,X.XE),(0,u.fM)(4,J.XH)],ui),(0,H.Qr)(class qc extends H.R6{constructor(){super({id:"repl.action.acceptInput",label:(0,l.NC)({key:"actions.repl.acceptInput",comment:["Apply input from the debug console input box"]},"REPL Accept Input"),alias:"REPL Accept Input",precondition:h.AN,kbOpts:{kbExpr:xe.u.textInputFocus,primary:3,weight:100}})}run(e,t){Wc.SuggestController.get(t)?.cancelSuggestWidget(),Hn(e.get(J.qC))?.acceptReplInput()}}),(0,H.Qr)(class Xc extends H.R6{constructor(){super({id:"repl.action.copyAll",label:(0,l.NC)("actions.repl.copyAll","Debug: Console Copy All"),alias:"Debug Console Copy All",precondition:h.AN})}run(e,t){const i=e.get(ut.p),n=Hn(e.get(J.qC));if(n)return i.writeText(n.getVisibleContent())}}),(0,H.Qr)(class Jc extends H.R6{constructor(){super({id:"repl.action.filter",label:(0,l.NC)("repl.action.filter","REPL Focus Content to Filter"),alias:"REPL Filter",precondition:h.AN,kbOpts:{kbExpr:xe.u.textInputFocus,primary:2084,weight:100}})}run(e,t){Hn(e.get(J.qC))?.focusFilter()}});class Yc extends Mt{getSessions(){return this.debugService.getModel().getSessions(!0).filter(e=>e.hasSeparateRepl()&&!gt.has(e))}mapFocusedSessionToSelected(e){for(;e.parentSession&&!e.hasSeparateRepl();)e=e.parentSession;return e}}function Hn(d){return d.getActiveViewWithId(h.FT)??void 0}const As="workbench.action.debug.selectRepl";(0,D.r1)(class extends pe.Nx{constructor(){super({id:As,viewId:h.FT,title:(0,l.NC)("selectRepl","Select Debug Console"),f1:!1,menu:{id:D.eH.ViewTitle,group:"navigation",when:A.Ao.and(A.Ao.equals("view",h.FT),h.h4),order:20}})}runInView(d,e,t){return(0,b.Z)(function*(){const i=d.get(h.tn);if(t&&0!==t.state&&t!==i.getViewModel().focusedSession){if(2!==t.state){const n=i.getModel().getSessions().find(o=>o.parentSession===t&&2===o.state);n&&(t=n)}yield i.focusStackFrame(void 0,void 0,t,{explicit:!0})}yield e.selectSession(t)})()}}),(0,D.r1)(class extends pe.Nx{constructor(){super({id:"workbench.debug.panel.action.clearReplAction",viewId:h.FT,title:{value:(0,l.NC)("clearRepl","Clear Console"),original:"Clear Console"},f1:!0,icon:E.BU,menu:[{id:D.eH.ViewTitle,group:"navigation",when:A.Ao.equals("view",h.FT),order:30},{id:D.eH.DebugConsoleContext,group:"z_commands",order:20}]})}runInView(d,e){e.clearRepl(),Ze.i7((0,l.NC)("debugConsoleCleared","Debug console was cleared"))}}),(0,D.r1)(class extends pe.Nx{constructor(){super({id:"debug.collapseRepl",title:(0,l.NC)("collapse","Collapse All"),viewId:h.FT,menu:{id:D.eH.DebugConsoleContext,group:"z_commands",order:10}})}runInView(d,e){e.collapseAll(),e.focus()}}),(0,D.r1)(class extends pe.Nx{constructor(){super({id:"debug.replPaste",title:(0,l.NC)("paste","Paste"),viewId:h.FT,precondition:h.KA.notEqualsTo((0,h.wD)(0)),menu:{id:D.eH.DebugConsoleContext,group:"2_cutcopypaste",order:30}})}runInView(d,e){return(0,b.Z)(function*(){const i=yield d.get(ut.p).readText();if(i){const n=e.getReplInput();n.setValue(n.getValue().concat(i)),e.focus();const o=n.getModel(),s=o?o.getLineCount():0,r=o?.getLineMaxColumn(s);"number"==typeof s&&"number"==typeof r&&n.setPosition({lineNumber:s,column:r})}})()}}),(0,D.r1)(class extends pe.Nx{constructor(){super({id:"workbench.debug.action.copyAll",title:(0,l.NC)("copyAll","Copy All"),viewId:h.FT,menu:{id:D.eH.DebugConsoleContext,group:"2_cutcopypaste",order:20}})}runInView(d,e){return(0,b.Z)(function*(){yield d.get(ut.p).writeText(e.getVisibleContent())})()}}),(0,D.r1)(class extends D.Ke{constructor(){super({id:"debug.replCopy",title:(0,l.NC)("copy","Copy"),menu:{id:D.eH.DebugConsoleContext,group:"2_cutcopypaste",order:10}})}run(d,e){return(0,b.Z)(function*(){const t=d.get(ut.p),n=window.getSelection()?.toString();n&&n.length>0?yield t.writeText(n):e&&(yield t.writeText(e.toString()))})()}});var Ls=v(98659);let Wn=!1,_n=!1,Un=class extends pe.qV{constructor(e,t,i,n,o,s,r,a,c,g,p,f){super(e,n,t,r,a,s,o,c,g,p),this.debugService=i,this.needsRefresh=!1,this.menu=f.createMenu(D.eH.DebugWatchContext,a),this._register(this.menu),this.watchExpressionsUpdatedScheduler=new Q.pY(()=>{this.needsRefresh=!1,this.tree.updateChildren()},50),this.watchExpressionsExist=h.Lh.bindTo(a),this.variableReadonly=h.hs.bindTo(a),this.watchExpressionsExist.set(this.debugService.getModel().getWatchExpressions().length>0),this.watchItemType=h.kJ.bindTo(a)}renderBody(e){var t=this;super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-watch");const i=ni(e),n=this.instantiationService.createInstance(Ut),o=this.instantiationService.createInstance(qe);let s;this.tree=this.instantiationService.createInstance(Ge.ls,"WatchExpressions",i,new td,[n,this.instantiationService.createInstance(Be,o)],new id,{accessibilityProvider:new od,identityProvider:{getId:r=>r.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:r=>{if(r!==this.debugService.getViewModel().getSelectedExpression()?.expression)return r.name}},dnd:new sd(this.debugService),overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput(this.debugService),h.D5.bindTo(this.tree.contextKeyService),this._register(this.tree.onContextMenu(r=>this.onContextMenu(r))),this._register(this.tree.onMouseDblClick(r=>this.onMouseDblClick(r))),this._register(this.debugService.getModel().onDidChangeWatchExpressions(function(){var r=(0,b.Z)(function*(a){t.watchExpressionsExist.set(t.debugService.getModel().getWatchExpressions().length>0),t.isBodyVisible()?(a&&!a.name&&(_n=!0),yield t.tree.updateChildren(),_n=!1,a instanceof T.A2&&t.tree.reveal(a)):t.needsRefresh=!0});return function(a){return r.apply(this,arguments)}}())),this._register(this.debugService.getViewModel().onDidFocusStackFrame(()=>{this.isBodyVisible()?this.watchExpressionsUpdatedScheduler.isScheduled()||this.watchExpressionsUpdatedScheduler.schedule():this.needsRefresh=!0})),this._register(this.debugService.getViewModel().onWillUpdateViews(()=>{Wn||this.tree.updateChildren()})),this._register(this.onDidChangeBodyVisibility(r=>{r&&this.needsRefresh&&this.watchExpressionsUpdatedScheduler.schedule()})),this._register(this.debugService.getViewModel().onDidSelectExpression(r=>{const a=r?.expression;a instanceof T.A2||a instanceof T._w&&r?.settingWatch?(s=this.tree.options.horizontalScrolling,s&&this.tree.updateOptions({horizontalScrolling:!1}),a.name&&this.tree.rerender(a)):!a&&void 0!==s&&(this.tree.updateOptions({horizontalScrolling:s}),s=void 0)})),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression(function(){var r=(0,b.Z)(function*(a){a instanceof T._w&&t.tree.hasNode(a)&&(yield t.tree.updateChildren(a,!1,!0),yield t.tree.expand(a))});return function(a){return r.apply(this,arguments)}}()))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){if(e.browserEvent.target.className.indexOf("twistie")>=0)return;const t=e.element,i=this.debugService.getViewModel().getSelectedExpression();t instanceof T.A2&&t!==i?.expression?this.debugService.getViewModel().setSelectedExpression(t,!1):t||this.debugService.addWatchExpression()}onContextMenu(e){const t=e.element,i=this.tree.getSelection();this.watchItemType.set(t instanceof T.A2?"expression":t instanceof T._w?"variable":void 0);const n=[],o=t instanceof T._w?t.presentationHint?.attributes:void 0;this.variableReadonly.set(!!o&&o.indexOf("readOnly")>=0||!!t?.presentationHint?.lazy),(0,ge.LJ)(this.menu,{arg:t,shouldForwardArgs:!0},n),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>n,getActionsContext:()=>t&&i.includes(t)?i:t?[t]:[]})}};Un=(0,u.gn)([(0,u.fM)(1,Y.i),(0,u.fM)(2,h.tn),(0,u.fM)(3,Ke.d),(0,u.fM)(4,q.TG),(0,u.fM)(5,J.XH),(0,u.fM)(6,Z.Ui),(0,u.fM)(7,A.i6),(0,u.fM)(8,Fe.v4),(0,u.fM)(9,X.XE),(0,u.fM)(10,be.bU),(0,u.fM)(11,D.co)],Un);class td{getHeight(e){return 22}getTemplateId(e){return e instanceof T.A2?Ut.ID:Be.ID}}function Bs(d){return"function"==typeof d.getConfigurationManager}class id{hasChildren(e){return Bs(e)||e.hasChildren}getChildren(e){if(Bs(e)){const t=e,i=t.getModel().getWatchExpressions(),n=t.getViewModel();return Promise.all(i.map(o=>o.name&&!_n?o.evaluate(n.focusedSession,n.focusedStackFrame,"watch").then(()=>o):Promise.resolve(o)))}return e.getChildren()}}let Ut=class sr extends Et{constructor(e,t,i,n){super(i,n),this.menuService=e,this.contextKeyService=t}get templateId(){return sr.ID}renderElement(e,t,i){super.renderExpressionElement(e.element,e,i)}renderExpression(e,t,i){let o;o=e.type?e.type===e.value?e.type:`${e.type}: ${e.value}`:e.value,t.label.set("string"==typeof e.value?`${e.name}:`:e.name,i,o),dt(e,t.value,{showChanged:!0,maxValueLength:1024,showHover:!0,colorize:!0})}getInputBoxOptions(e,t){var n,i=this;return t?{initialValue:e.value,ariaLabel:(0,l.NC)("typeNewValue","Type new value"),onFinish:(n=(0,b.Z)(function*(o,s){if(s&&o){const r=i.debugService.getViewModel().focusedStackFrame;r&&(e instanceof T._w||e instanceof T.A2)&&(yield e.setExpression(o,r),i.debugService.getViewModel().updateViews())}}),function(s,r){return n.apply(this,arguments)})}:{initialValue:e.name?e.name:"",ariaLabel:(0,l.NC)("watchExpressionInputAriaLabel","Type watch expression"),placeholder:(0,l.NC)("watchExpressionPlaceholder","Expression to watch"),onFinish:(n,o)=>{o&&n?(this.debugService.renameWatchExpression(e.getId(),n),Wn=!0,this.debugService.getViewModel().updateViews(),Wn=!1):e.name||this.debugService.removeWatchExpressions(e.getId())}}}renderActionBar(e,t){const i=function nd(d,e){return d.createOverlay([[h.SC.key,void 0!==e.memoryReference],[h.kJ.key,"expression"]])}(this.contextKeyService,t),n=this.menuService.createMenu(D.eH.DebugWatchContext,i),o=[],s=t;(0,ge.LJ)(n,{arg:s,shouldForwardArgs:!1},{primary:o,secondary:[]},"inline"),e.clear(),e.context=s,e.push(o,{icon:!0,label:!1})}};Ut.ID="watchexpression",Ut=(0,u.gn)([(0,u.fM)(0,D.co),(0,u.fM)(1,A.i6),(0,u.fM)(2,h.tn),(0,u.fM)(3,Y.u)],Ut);class od{getWidgetAriaLabel(){return(0,l.NC)({comment:["Debug is a noun in this context, not a verb."],key:"watchAriaTreeLabel"},"Debug Watch Expressions")}getAriaLabel(e){return(0,l.NC)(e instanceof T.A2?"watchExpressionAriaLabel":"watchVariableAriaLabel","{0}, value {1}",e.name,e.value)}}class sd{constructor(e){this.debugService=e}onDragOver(e){if(!(e instanceof Ls.kX))return!1;const t=e.elements;return t.length>0&&t[0]instanceof T.A2}getDragURI(e){return e instanceof T.A2&&e!==this.debugService.getViewModel().getSelectedExpression()?.expression?e.getId():null}getDragLabel(e){if(1===e.length)return e[0].name}drop(e,t){if(!(e instanceof Ls.kX))return;const i=e.elements[0],n=this.debugService.getModel().getWatchExpressions(),o=t instanceof T.A2?n.indexOf(t):n.length-1;this.debugService.moveWatchExpression(i.getId(),o)}}(0,D.r1)(class extends pe.Nx{constructor(){super({id:"watch.collapse",viewId:h.Vn,title:(0,l.NC)("collapse","Collapse All"),f1:!1,icon:ii.lA.collapseAll,precondition:h.Lh,menu:{id:D.eH.ViewTitle,order:30,group:"navigation",when:A.Ao.equals("view",h.Vn)}})}runInView(e,t){t.collapseAll()}});const Rs="workbench.debug.viewlet.action.addWatchExpression",Vs=(0,l.NC)("addWatchExpression","Add Expression");(0,D.r1)(class extends D.Ke{constructor(){super({id:Rs,title:Vs,f1:!1,icon:E._L,menu:{id:D.eH.ViewTitle,group:"navigation",when:A.Ao.equals("view",h.Vn)}})}run(e){e.get(h.tn).addWatchExpression()}});const Ps="workbench.debug.viewlet.action.removeAllWatchExpressions",Fs=(0,l.NC)("removeAllWatchExpressions","Remove All Expressions");(0,D.r1)(class extends D.Ke{constructor(){super({id:Ps,title:Fs,f1:!1,icon:E.eC,precondition:h.Lh,menu:{id:D.eH.ViewTitle,order:20,group:"navigation",when:A.Ao.equals("view",h.Vn)}})}run(e){e.get(h.tn).removeWatchExpressions()}});const rd=l.NC("debugCategory","Debug");(function Ca(){const d=(0,x.P6G)("debugTokenExpression.name",{dark:"#c586c0",light:"#9b46b0",hcDark:x.dRz,hcLight:x.dRz},"Foreground color for the token names shown in the debug views (ie. the Variables or Watch view)."),e=(0,x.P6G)("debugTokenExpression.value",{dark:"#cccccc99",light:"#6c6c6ccc",hcDark:x.dRz,hcLight:x.dRz},"Foreground color for the token values shown in the debug views (ie. the Variables or Watch view)."),t=(0,x.P6G)("debugTokenExpression.string",{dark:"#ce9178",light:"#a31515",hcDark:"#f48771",hcLight:"#a31515"},"Foreground color for strings in the debug views (ie. the Variables or Watch view)."),i=(0,x.P6G)("debugTokenExpression.boolean",{dark:"#4e94ce",light:"#0000ff",hcDark:"#75bdfe",hcLight:"#0000ff"},"Foreground color for booleans in the debug views (ie. the Variables or Watch view)."),n=(0,x.P6G)("debugTokenExpression.number",{dark:"#b5cea8",light:"#098658",hcDark:"#89d185",hcLight:"#098658"},"Foreground color for numbers in the debug views (ie. the Variables or Watch view)."),o=(0,x.P6G)("debugTokenExpression.error",{dark:"#f48771",light:"#e51400",hcDark:"#f48771",hcLight:"#e51400"},"Foreground color for expression errors in the debug views (ie. the Variables or Watch view) and for error logs shown in the debug console."),s=(0,x.P6G)("debugView.exceptionLabelForeground",{dark:x.dRz,light:"#FFF",hcDark:x.dRz,hcLight:x.dRz},"Foreground color for a label shown in the CALL STACK view when the debugger breaks on an exception."),r=(0,x.P6G)("debugView.exceptionLabelBackground",{dark:"#6C2022",light:"#A31515",hcDark:"#6C2022",hcLight:"#A31515"},"Background color for a label shown in the CALL STACK view when the debugger breaks on an exception."),a=(0,x.P6G)("debugView.stateLabelForeground",{dark:x.dRz,light:x.dRz,hcDark:x.dRz,hcLight:x.dRz},"Foreground color for a label in the CALL STACK view showing the current session's or thread's state."),c=(0,x.P6G)("debugView.stateLabelBackground",{dark:"#88888844",light:"#88888844",hcDark:"#88888844",hcLight:"#88888844"},"Background color for a label in the CALL STACK view showing the current session's or thread's state."),g=(0,x.P6G)("debugView.valueChangedHighlight",{dark:"#569CD6",light:"#569CD6",hcDark:"#569CD6",hcLight:"#569CD6"},"Color used to highlight value changes in the debug views (ie. in the Variables view)."),p=(0,x.P6G)("debugConsole.infoForeground",{dark:x.c63,light:x.c63,hcDark:x.dRz,hcLight:x.dRz},"Foreground color for info messages in debug REPL console."),f=(0,x.P6G)("debugConsole.warningForeground",{dark:x.uoC,light:x.uoC,hcDark:"#008000",hcLight:x.uoC},"Foreground color for warning messages in debug REPL console."),m=(0,x.P6G)("debugConsole.errorForeground",{dark:x.Ido,light:x.Ido,hcDark:x.Ido,hcLight:x.Ido},"Foreground color for error messages in debug REPL console."),S=(0,x.P6G)("debugConsole.sourceForeground",{dark:x.dRz,light:x.dRz,hcDark:x.dRz,hcLight:x.dRz},"Foreground color for source filenames in debug REPL console."),w=(0,x.P6G)("debugConsoleInputIcon.foreground",{dark:x.dRz,light:x.dRz,hcDark:x.dRz,hcLight:x.dRz},"Foreground color for debug console input marker icon."),M=(0,x.P6G)("debugIcon.pauseForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.pauseForeground","Debug toolbar icon for pause.")),I=(0,x.P6G)("debugIcon.stopForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},(0,l.NC)("debugIcon.stopForeground","Debug toolbar icon for stop.")),L=(0,x.P6G)("debugIcon.disconnectForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},(0,l.NC)("debugIcon.disconnectForeground","Debug toolbar icon for disconnect.")),N=(0,x.P6G)("debugIcon.restartForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},(0,l.NC)("debugIcon.restartForeground","Debug toolbar icon for restart.")),B=(0,x.P6G)("debugIcon.stepOverForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.stepOverForeground","Debug toolbar icon for step over.")),k=(0,x.P6G)("debugIcon.stepIntoForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.stepIntoForeground","Debug toolbar icon for step into.")),P=(0,x.P6G)("debugIcon.stepOutForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.stepOutForeground","Debug toolbar icon for step over.")),_=(0,x.P6G)("debugIcon.continueForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.continueForeground","Debug toolbar icon for continue.")),W=(0,x.P6G)("debugIcon.stepBackForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,l.NC)("debugIcon.stepBackForeground","Debug toolbar icon for step back."));(0,X.Ic)((O,ie)=>{const $n=O.getColor(x.g8u),Zn=O.getColor(x.qeD),ld=O.getColor(x.Rqy),Os=O.getColor(s),Hs=O.getColor(r),ud=O.getColor(a),hd=O.getColor(c),hi=O.getColor(g),gd=O.getColor(x.lUq);ie.addRule(`\n\t\t\t/* Text colour of the call stack row's filename */\n\t\t\t.debug-pane .debug-call-stack .monaco-list-row:not(.selected) .stack-frame > .file .file-name {\n\t\t\t\tcolor: ${ld}\n\t\t\t}\n\n\t\t\t/* Line & column number "badge" for selected call stack row */\n\t\t\t.debug-pane .monaco-list-row.selected .line-number {\n\t\t\t\tbackground-color: ${$n};\n\t\t\t\tcolor: ${Zn};\n\t\t\t}\n\n\t\t\t/* Line & column number "badge" for unselected call stack row (basically all other rows) */\n\t\t\t.debug-pane .line-number {\n\t\t\t\tbackground-color: ${$n.transparent(.6)};\n\t\t\t\tcolor: ${Zn.transparent(.6)};\n\t\t\t}\n\n\t\t\t/* State "badge" displaying the active session's current state.\n\t\t\t* Only visible when there are more active debug sessions/threads running.\n\t\t\t*/\n\t\t\t.debug-pane .debug-call-stack .thread > .state.label,\n\t\t\t.debug-pane .debug-call-stack .session > .state.label {\n\t\t\t\tbackground-color: ${hd};\n\t\t\t\tcolor: ${ud};\n\t\t\t}\n\n\t\t\t/* State "badge" displaying the active session's current state.\n\t\t\t* Only visible when there are more active debug sessions/threads running\n\t\t\t* and thread paused due to a thrown exception.\n\t\t\t*/\n\t\t\t.debug-pane .debug-call-stack .thread > .state.label.exception,\n\t\t\t.debug-pane .debug-call-stack .session > .state.label.exception {\n\t\t\t\tbackground-color: ${Hs};\n\t\t\t\tcolor: ${Os};\n\t\t\t}\n\n\t\t\t/* Info "badge" shown when the debugger pauses due to a thrown exception. */\n\t\t\t.debug-pane .call-stack-state-message > .label.exception {\n\t\t\t\tbackground-color: ${Hs};\n\t\t\t\tcolor: ${Os};\n\t\t\t}\n\n\t\t\t/* Animation of changed values in Debug viewlet */\n\t\t\t@keyframes debugViewletValueChanged {\n\t\t\t\t0%   { background-color: ${hi.transparent(0)} }\n\t\t\t\t5%   { background-color: ${hi.transparent(.9)} }\n\t\t\t\t100% { background-color: ${hi.transparent(.3)} }\n\t\t\t}\n\n\t\t\t.debug-pane .monaco-list-row .expression .value.changed {\n\t\t\t\tbackground-color: ${hi.transparent(.3)};\n\t\t\t\tanimation-name: debugViewletValueChanged;\n\t\t\t\tanimation-duration: 1s;\n\t\t\t\tanimation-fill-mode: forwards;\n\t\t\t}\n\n\t\t\t.monaco-list-row .expression .lazy-button:hover {\n\t\t\t\tbackground-color: ${gd}\n\t\t\t}\n\t\t`);const Ws=O.getColor(x.lRK);Ws&&ie.addRule(`\n\t\t\t.debug-pane .line-number {\n\t\t\t\tborder: 1px solid ${Ws};\n\t\t\t}\n\t\t\t`),(0,ba.c3)(O.type)&&ie.addRule(`\n\t\t\t.debug-pane .line-number {\n\t\t\t\tbackground-color: ${$n};\n\t\t\t\tcolor: ${Zn};\n\t\t\t}`);const pd=O.getColor(d),fd=O.getColor(e),bd=O.getColor(t),md=O.getColor(i),vd=O.getColor(o),Sd=O.getColor(n);ie.addRule(`\n\t\t\t.monaco-workbench .monaco-list-row .expression .name {\n\t\t\t\tcolor: ${pd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value,\n\t\t\t.monaco-workbench .debug-hover-widget .value {\n\t\t\t\tcolor: ${fd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.string,\n\t\t\t.monaco-workbench .debug-hover-widget .value.string {\n\t\t\t\tcolor: ${bd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.boolean,\n\t\t\t.monaco-workbench .debug-hover-widget .value.boolean {\n\t\t\t\tcolor: ${md};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .error,\n\t\t\t.monaco-workbench .debug-hover-widget .error,\n\t\t\t.monaco-workbench .debug-pane .debug-variables .scope .error {\n\t\t\t\tcolor: ${vd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.number,\n\t\t\t.monaco-workbench .debug-hover-widget .value.number {\n\t\t\t\tcolor: ${Sd};\n\t\t\t}\n\t\t`);const Cd=O.getColor(x.dt_)||Ee.Il.fromHex("#80808060"),yd=O.getColor(p),wd=O.getColor(f),kd=O.getColor(m),Dd=O.getColor(S),xd=O.getColor(w);ie.addRule(`\n\t\t\t.repl .repl-input-wrapper {\n\t\t\t\tborder-top: 1px solid ${Cd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.info {\n\t\t\t\tcolor: ${yd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.warn {\n\t\t\t\tcolor: ${wd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.error {\n\t\t\t\tcolor: ${kd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .source {\n\t\t\t\tcolor: ${Dd};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\tcolor: ${xd};\n\t\t\t}\n\t\t`),O.defines(w)||ie.addRule("\n\t\t\t\t.monaco-workbench.vs .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 0.25;\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench.vs-dark .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 0.4;\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench.hc-black .repl .repl-tree .monaco-tl-contents .arrow,\n\t\t\t\t.monaco-workbench.hc-light .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 1;\n\t\t\t\t}\n\t\t\t");const _s=O.getColor(Sa);_s&&ie.addRule(`.monaco-workbench ${V.kS.asCSSSelector(E.NA)} { color: ${_s}; }`);const Us=O.getColor(M);Us&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.cJ)}, .monaco-workbench ${V.kS.asCSSSelector(E.cJ)} { color: ${Us}; }`);const $s=O.getColor(I);$s&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.fR)},.monaco-workbench ${V.kS.asCSSSelector(E.fR)} { color: ${$s}; }`);const Zs=O.getColor(L);Zs&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.DI)},.monaco-workbench .debug-view-content ${V.kS.asCSSSelector(E.DI)}, .monaco-workbench .debug-toolbar ${V.kS.asCSSSelector(E.DI)} { color: ${Zs}; }`);const zs=O.getColor(N);zs&&ie.addRule(`.monaco-workbench ${V.kS.asCSSSelector(E.gv)}, .monaco-workbench ${V.kS.asCSSSelector(E._d)}, .monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.gv)}, .monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E._d)} { color: ${zs}; }`);const js=O.getColor(B);js&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.xv)}, .monaco-workbench ${V.kS.asCSSSelector(E.xv)} { color: ${js}; }`);const Ks=O.getColor(k);Ks&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.Z5)}, .monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.Z5)}, .monaco-workbench ${V.kS.asCSSSelector(E.Z5)} { color: ${Ks}; }`);const Gs=O.getColor(P);Gs&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.Hp)}, .monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.Hp)}, .monaco-workbench ${V.kS.asCSSSelector(E.Hp)} { color: ${Gs}; }`);const Qs=O.getColor(_);Qs&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.Tl)}, .monaco-workbench ${V.kS.asCSSSelector(E.Tl)}, .monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.IO)}, .monaco-workbench ${V.kS.asCSSSelector(E.IO)} { color: ${Qs}; }`);const qs=O.getColor(W);qs&&ie.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${V.kS.asCSSSelector(E.oF)}, .monaco-workbench ${V.kS.asCSSSelector(E.oF)} { color: ${qs}; }`)})})(),le.B.as(Co.I.Workbench).registerWorkbenchContribution(cn,3),le.B.as(Co.I.Workbench).registerWorkbenchContribution(di,4),le.B.as(So.IP.Quickaccess).registerQuickAccessProvider({ctor:An,prefix:C.uT,contextKey:"inLaunchConfigurationsPicker",placeholder:l.NC("startDebugPlaceholder","Type the name of a launch configuration to run."),helpEntries:[{description:l.NC("startDebuggingHelp","Start Debugging"),commandId:C.w8}]}),le.B.as(So.IP.Quickaccess).registerQuickAccessProvider({ctor:vn,prefix:C.OD,contextKey:"inDebugConsolePicker",placeholder:l.NC("tasksQuickAccessPlaceholder","Type the name of a debug console to open."),helpEntries:[{description:l.NC("tasksQuickAccessHelp","Show All Debug Consoles"),commandId:C.QE}]}),(0,H._K)("editor.contrib.callStack",an,1),(0,H._K)(h.KI,on,1),(0,H._K)(h.X,ye,2);const K=(d,e,t,i)=>{D.BH.appendMenuItem(D.eH.CommandPalette,{when:A.Ao.and(h.Qe,t),group:rd,command:{id:d,title:e,category:C.w1,precondition:i}})};K(C.ST,{value:l.NC("terminateThread","Terminate Thread"),original:"Terminate Thread"},h.hO),K(C.xw,C.kj,h.hO,h.KA.isEqualTo("stopped")),K(C.Xs,C.DP,h.hO,h.KA.isEqualTo("stopped")),K(C.WW,C.Sf,h.hO,A.Ao.and(h.o8,h.hO,h.KA.isEqualTo("stopped"))),K(C.GL,C.lG,h.hO,h.KA.isEqualTo("stopped")),K(C.rd,C.eW,h.hO,h.KA.isEqualTo("running")),K(C.De,C.yk,h.hO,A.Ao.or(h.dU.toNegated(),h.rv)),K(C.ZI,C.pl,h.hO,h.KA.isEqualTo("stopped")),K(C.Hn,{value:l.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugFocusConsole"},"Focus on Debug Console View"),original:"Focus on Debug Console View"}),K(C.rg,{value:l.NC("jumpToCursor","Jump to Cursor"),original:"Jump to Cursor"},h.dr),K(C.rg,{value:l.NC("SetNextStatement","Set Next Statement"),original:"Set Next Statement"},h.dr),K(_e.ID,{value:_e.LABEL,original:"Run to Cursor"},h.Qe),K(Ue.ID,{value:Ue.LABEL,original:"Evaluate in Debug Console"},h.hO),K($e.ID,{value:$e.LABEL,original:"Add to Watch"}),K(C.NT,{value:l.NC("inlineBreakpoint","Inline Breakpoint"),original:"Inline Breakpoint"}),K(C.w8,C.xn,A.Ao.and(h.Qe,h.KA.notEqualsTo((0,h.wD)(1)))),K(C.Ob,C.zr),K(C.fH,C.vJ),K(C.Re,C.ss,h.hO),K(C.QE,C.I4),K(C.G,C.Ox),K(C.M1,C.fD,h.hO,h.KA.isEqualTo("stopped")),K(C.Py,C.W4,h.hO,h.KA.isEqualTo("stopped")),K(C.QY,C.SX,h.hO,h.KA.isEqualTo("stopped")),K(C.IW,C.Hp,h.hO,h.KA.isEqualTo("stopped"));const z=(d,e,t,i,n,o,s="navigation",r)=>{D.BH.appendMenuItem(d,{group:s,when:n,order:i,icon:r,command:{id:e,title:t,icon:r,precondition:o}})};z(D.eH.DebugCallStackContext,C._M,C.Yl,10,h.fj.isEqualTo("session"),void 0,"3_modification"),z(D.eH.DebugCallStackContext,C.Sb,C.XV,20,h.fj.isEqualTo("session"),void 0,"3_modification"),z(D.eH.DebugCallStackContext,C.O0,C.SI,21,A.Ao.and(h.fj.isEqualTo("session"),h.uz,h.rv),void 0,"3_modification"),z(D.eH.DebugCallStackContext,C.De,C.yk,30,h.fj.isEqualTo("session"),void 0,"3_modification"),z(D.eH.DebugCallStackContext,C.rd,C.eW,10,A.Ao.and(h.fj.isEqualTo("thread"),h.KA.isEqualTo("running"))),z(D.eH.DebugCallStackContext,C.ZI,C.pl,10,A.Ao.and(h.fj.isEqualTo("thread"),h.KA.isEqualTo("stopped"))),z(D.eH.DebugCallStackContext,C.xw,C.kj,20,h.fj.isEqualTo("thread"),h.KA.isEqualTo("stopped")),z(D.eH.DebugCallStackContext,C.Xs,C.DP,30,h.fj.isEqualTo("thread"),h.KA.isEqualTo("stopped")),z(D.eH.DebugCallStackContext,C.GL,C.lG,40,h.fj.isEqualTo("thread"),h.KA.isEqualTo("stopped")),z(D.eH.DebugCallStackContext,C.ST,l.NC("terminateThread","Terminate Thread"),10,h.fj.isEqualTo("thread"),void 0,"termination"),z(D.eH.DebugCallStackContext,C.U8,l.NC("restartFrame","Restart Frame"),10,A.Ao.and(h.fj.isEqualTo("stackFrame"),h.wx),h.ou),z(D.eH.DebugCallStackContext,C.p3,l.NC("copyStackTrace","Copy Call Stack"),20,h.fj.isEqualTo("stackFrame"),void 0,"3_modification"),z(D.eH.DebugVariablesContext,xn,l.NC("viewMemory","View Binary Data"),15,h.SC,h.hO,"inline",E.Yi),z(D.eH.DebugVariablesContext,ss,l.NC("setValue","Set Value"),10,A.Ao.or(h.jA,A.Ao.and(h.D7,h.Wx)),h.hs.toNegated(),"3_modification"),z(D.eH.DebugVariablesContext,Dn,l.NC("copyValue","Copy Value"),10,void 0,void 0,"5_cutcopypaste"),z(D.eH.DebugVariablesContext,ds,l.NC("copyAsExpression","Copy as Expression"),20,h.D7,void 0,"5_cutcopypaste"),z(D.eH.DebugVariablesContext,ls,l.NC("addToWatchExpressions","Add to Watch"),100,h.D7,void 0,"z_commands"),z(D.eH.DebugVariablesContext,cs,l.NC("breakWhenValueIsRead","Break on Value Read"),200,h.pP,void 0,"z_commands"),z(D.eH.DebugVariablesContext,rs,l.NC("breakWhenValueChanges","Break on Value Change"),210,h.IA,void 0,"z_commands"),z(D.eH.DebugVariablesContext,as,l.NC("breakWhenValueIsAccessed","Break on Value Access"),220,h.DD,void 0,"z_commands"),z(D.eH.DebugWatchContext,Rs,Vs,10,void 0,void 0,"3_modification"),z(D.eH.DebugWatchContext,C.jg,l.NC("editWatchExpression","Edit Expression"),20,h.kJ.isEqualTo("expression"),void 0,"3_modification"),z(D.eH.DebugWatchContext,C.Xg,l.NC("setValue","Set Value"),30,A.Ao.or(A.Ao.and(h.kJ.isEqualTo("expression"),h.Wx),A.Ao.and(h.kJ.isEqualTo("variable"),h.jA)),h.hs.toNegated(),"3_modification"),z(D.eH.DebugWatchContext,Dn,l.NC("copyValue","Copy Value"),40,A.Ao.or(h.kJ.isEqualTo("expression"),h.kJ.isEqualTo("variable")),h.hO,"3_modification"),z(D.eH.DebugWatchContext,xn,l.NC("viewMemory","View Binary Data"),10,h.SC,void 0,"inline",E.Yi),z(D.eH.DebugWatchContext,C.Vf,l.NC("removeWatchExpression","Remove Expression"),20,h.kJ.isEqualTo("expression"),void 0,"inline",E.iO),z(D.eH.DebugWatchContext,Ps,Fs,20,void 0,void 0,"z_commands"),D.BH.appendMenuItem(D.eH.EditorTitle,{submenu:D.eH.EditorTitleRun,rememberDefaultAction:!0,title:{value:l.NC("run","Run or Debug..."),original:"Run or Debug..."},icon:E.xc,group:"navigation",order:-1}),D.BH.appendMenuItem(D.eH.MenubarMainMenu,{submenu:D.eH.MenubarDebugMenu,title:{value:"Run",original:"Run",mnemonicTitle:l.NC({key:"mRun",comment:["&& denotes a mnemonic"]},"&&Run")},order:6}),D.BH.appendMenuItem(D.eH.MenubarNewBreakpointMenu,{group:"1_breakpoints",command:{id:C.NT,title:l.NC({key:"miInlineBreakpoint",comment:["&& denotes a mnemonic"]},"Inline Breakp&&oint")},order:2,when:h.Qe});const ad=le.B.as(J.IP.ViewContainersRegistry).registerViewContainer({id:h.Os,title:l.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),icon:E.v1,ctorDescriptor:new me.M(Ji.XV,[h.Os,{mergeViewWithContainerWhenSingleView:!0}]),storageId:h.Os,hideIfEmpty:!0,order:2},1,{doNotRegisterOpenCommand:!0});le.B.as(J.IP.ViewsRegistry).registerViews([{id:h.FT,name:l.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),containerIcon:E.v1,canToggleVisibility:!1,canMoveView:!0,when:h.Qe,ctorDescriptor:new me.M(Ye),openCommandActionDescriptor:{id:"workbench.debug.action.toggleRepl",mnemonicTitle:l.NC({key:"miToggleDebugConsole",comment:["&& denotes a mnemonic"]},"De&&bug Console"),keybindings:{primary:3127},order:2}}],ad);const $t=le.B.as(J.IP.ViewContainersRegistry).registerViewContainer({id:h.f3,title:{value:l.NC("run and debug","Run and Debug"),original:"Run and Debug"},openCommandActionDescriptor:{id:h.f3,mnemonicTitle:l.NC({key:"miViewRun",comment:["&& denotes a mnemonic"]},"&&Run"),keybindings:{primary:3106},order:3},ctorDescriptor:new me.M(Bn),icon:E.Wd,alwaysUseContainerInfo:!0,order:3},0),Zt=le.B.as(J.IP.ViewsRegistry);Zt.registerViews([{id:h.sk,name:l.NC("variables","Variables"),containerIcon:E.fC,ctorDescriptor:new me.M(yn),order:10,weight:40,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusVariablesView"},when:h.Kw.isEqualTo("default")}],$t),Zt.registerViews([{id:h.Vn,name:l.NC("watch","Watch"),containerIcon:E.WF,ctorDescriptor:new me.M(Un),order:20,weight:10,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusWatchView"},when:h.Kw.isEqualTo("default")}],$t),Zt.registerViews([{id:h.Vw,name:l.NC("callStack","Call Stack"),containerIcon:E.Dt,ctorDescriptor:new me.M(fn),order:30,weight:30,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusCallStackView"},when:h.Kw.isEqualTo("default")}],$t),Zt.registerViews([{id:h.Ww,name:l.NC("breakpoints","Breakpoints"),containerIcon:E.UO,ctorDescriptor:new me.M(Xt.xY),order:40,weight:20,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusBreakpointsView"},when:A.Ao.or(h.LK,h.Kw.isEqualTo("default"),h.$N)}],$t),Zt.registerViews([{id:h.Vm,name:l.NC("loadedScripts","Loaded Scripts"),containerIcon:E.Gx,ctorDescriptor:new me.M(Rn),order:35,weight:5,canToggleVisibility:!0,canMoveView:!0,collapsed:!0,when:A.Ao.and(h.NJ,h.Kw.isEqualTo("default"))}],$t),le.B.as(wt.bS.EditorPane).registerEditorPane(Hr.gS.create(ci,h.xG,l.NC("disassembly","Disassembly")),[new me.M(qt.n)]),le.B.as(Or.IP.Configuration).registerConfiguration({id:"debug",order:20,title:l.NC("debugConfigurationTitle","Debug"),type:"object",properties:{"debug.allowBreakpointsEverywhere":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"allowBreakpointsEverywhere"},"Allow setting breakpoints in any file."),default:!1},"debug.openExplorerOnEnd":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"openExplorerOnEnd"},"Automatically open the explorer view at the end of a debug session."),default:!1},"debug.inlineValues":{type:"string",enum:["on","off","auto"],description:l.NC({comment:["This is the description for a setting"],key:"inlineValues"},"Show variable values inline in editor while debugging."),enumDescriptions:[l.NC("inlineValues.on","Always show variable values inline in editor while debugging."),l.NC("inlineValues.off","Never show variable values inline in editor while debugging."),l.NC("inlineValues.focusNoScroll","Show variable values inline in editor while debugging when the language supports inline value locations.")],default:"auto"},"debug.toolBarLocation":{enum:["floating","docked","hidden"],markdownDescription:l.NC({comment:["This is the description for a setting"],key:"toolBarLocation"},"Controls the location of the debug toolbar. Either `floating` in all views, `docked` in the debug view, or `hidden`."),default:"floating"},"debug.showInStatusBar":{enum:["never","always","onFirstSessionStart"],enumDescriptions:[l.NC("never","Never show debug in Status bar"),l.NC("always","Always show debug in Status bar"),l.NC("onFirstSessionStart","Show debug in Status bar only after debug was started for the first time")],description:l.NC({comment:["This is the description for a setting"],key:"showInStatusBar"},"Controls when the debug Status bar should be visible."),default:"onFirstSessionStart"},"debug.internalConsoleOptions":h._u,"debug.console.closeOnEnd":{type:"boolean",description:l.NC("debug.console.closeOnEnd","Controls if the Debug Console should be automatically closed when the debug session ends."),default:!1},"debug.terminal.clearBeforeReusing":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"debug.terminal.clearBeforeReusing"},"Before starting a new debug session in an integrated or external terminal, clear the terminal."),default:!1},"debug.openDebug":{enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart","openOnDebugBreak"],default:"openOnDebugBreak",description:l.NC("openDebug","Controls when the debug view should open.")},"debug.showSubSessionsInToolBar":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"showSubSessionsInToolBar"},"Controls whether the debug sub-sessions are shown in the debug tool bar. When this setting is false the stop command on a sub-session will also stop the parent session."),default:!1},"debug.console.fontSize":{type:"number",description:l.NC("debug.console.fontSize","Controls the font size in pixels in the Debug Console."),default:re.dz?12:14},"debug.console.fontFamily":{type:"string",description:l.NC("debug.console.fontFamily","Controls the font family in the Debug Console."),default:"default"},"debug.console.lineHeight":{type:"number",description:l.NC("debug.console.lineHeight","Controls the line height in pixels in the Debug Console. Use 0 to compute the line height from the font size."),default:0},"debug.console.wordWrap":{type:"boolean",description:l.NC("debug.console.wordWrap","Controls if the lines should wrap in the Debug Console."),default:!0},"debug.console.historySuggestions":{type:"boolean",description:l.NC("debug.console.historySuggestions","Controls if the Debug Console should suggest previously typed input."),default:!0},"debug.console.collapseIdenticalLines":{type:"boolean",description:l.NC("debug.console.collapseIdenticalLines","Controls if the Debug Console should collapse identical lines and show a number of occurrences with a badge."),default:!0},"debug.console.acceptSuggestionOnEnter":{enum:["off","on"],description:l.NC("debug.console.acceptSuggestionOnEnter","Controls whether suggestions should be accepted on Enter in the Debug Console. Enter is also used to evaluate whatever is typed in the Debug Console."),default:"off"},launch:{type:"object",description:l.NC({comment:["This is the description for a setting"],key:"launch"},"Global debug launch configuration. Should be used as an alternative to 'launch.json' that is shared across workspaces."),default:{configurations:[],compounds:[]},$ref:mt.yY},"debug.focusWindowOnBreak":{type:"boolean",description:l.NC("debug.focusWindowOnBreak","Controls whether the workbench window should be focused when the debugger breaks."),default:!0},"debug.focusEditorOnBreak":{type:"boolean",description:l.NC("debug.focusEditorOnBreak","Controls whether the editor should be focused when the debugger breaks."),default:!0},"debug.onTaskErrors":{enum:["debugAnyway","showErrors","prompt","abort"],enumDescriptions:[l.NC("debugAnyway","Ignore task errors and start debugging."),l.NC("showErrors","Show the Problems view and do not start debugging."),l.NC("prompt","Prompt user."),l.NC("cancel","Cancel debugging.")],description:l.NC("debug.onTaskErrors","Controls what to do when errors are encountered after running a preLaunchTask."),default:"prompt"},"debug.showBreakpointsInOverviewRuler":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"showBreakpointsInOverviewRuler"},"Controls whether breakpoints should be shown in the overview ruler."),default:!1},"debug.showInlineBreakpointCandidates":{type:"boolean",description:l.NC({comment:["This is the description for a setting"],key:"showInlineBreakpointCandidates"},"Controls whether inline breakpoints candidate decorations should be shown in the editor while debugging."),default:!0},"debug.saveBeforeStart":{description:l.NC("debug.saveBeforeStart","Controls what editors to save before starting a debug session."),enum:["allEditorsInActiveGroup","nonUntitledEditorsInActiveGroup","none"],enumDescriptions:[l.NC("debug.saveBeforeStart.allEditorsInActiveGroup","Save all editors in the active group before starting a debug session."),l.NC("debug.saveBeforeStart.nonUntitledEditorsInActiveGroup","Save all editors in the active group except untitled ones before starting a debug session."),l.NC("debug.saveBeforeStart.none","Don't save any editors before starting a debug session.")],default:"allEditorsInActiveGroup",scope:5},"debug.confirmOnExit":{description:l.NC("debug.confirmOnExit","Controls whether to confirm when the window closes if there are active debug sessions."),type:"string",enum:["never","always"],enumDescriptions:[l.NC("debug.confirmOnExit.never","Never confirm."),l.NC("debug.confirmOnExit.always","Always confirm if there are debug sessions.")],default:"never"},"debug.disassemblyView.showSourceCode":{type:"boolean",default:!0,description:l.NC("debug.disassemblyView.showSourceCode","Show Source Code in Disassembly View.")},"debug.autoExpandLazyVariables":{type:"boolean",default:!1,description:l.NC("debug.autoExpandLazyVariables","Automatically show values for variables that are lazily resolved by the debugger, such as getters.")},"debug.enableStatusBarColor":{type:"boolean",description:l.NC("debug.enableStatusBarColor","Color status bar when debugger is active"),default:!0}}});const cd=St.prototype.showError;function dd(){return{...(0,Vr.Z)(),[rt.p.toString()]:new me.M(Lr),[h.tn.toString()]:new me.M(St),[Jn.qb.toString()]:new me.M(qi)}}St.prototype.showError=function(d,e){return cd.call(this,d,e,!1)}}}]);