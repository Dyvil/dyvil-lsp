"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[361],{52361:(uo,_t,p)=>{p.r(_t),p.d(_t,{SimpleTerminalBackend:()=>Yl,SimpleTerminalProcess:()=>ec,default:()=>tc});var u=p(58054),ue=(p(87708),p(21462)),k=p(80823),M=p(31268),c=p(55885),S=p(6418),ne=p(26056),ve=p(41312),w=p(13683),A=p(12997),J=p(29175),T=p(84621),N=p(58535),a=p(12829),se=p(13141),ie=p(31719),g=p(76972),Be=p(89295),G=p(82344),De=p(99740),R=p(51776),D=p(60140);function Ze(o,e={}){let t="";return e.excludeLeadingNewLine||(t+="\r\n"),t+="\x1b[0m\x1b[7m * ",t+=e.loudFormatting?"\x1b[0;104m":"\x1b[0m",t+=` ${o} \x1b[0m\n\r`,t}var Z=p(66179),ge=p(37202),mo=p(81225),me=p(32064),H=p(52786),be=p(39108),Ue=p(86682),Me=p(73059),bt=p(26278),X=p(32243),E=p(62981),Es=p(19980),de=p(93358),fo=p(69046),Ce=p(62465),x=p(73317),ot=p(82927),$t=p(45414),Gt=p(12292),we=p(79026),sn=p(35111),Ms=p(88023),gi=p(10434),Ke=p(53083);const go=(0,ge.q5)("terminal-view-icon",E.lA.terminal,(0,a.NC)("terminalViewIcon","View icon of the terminal view.")),Ns=(0,ge.q5)("terminal-rename",E.lA.gear,(0,a.NC)("renameTerminalIcon","Icon for rename in the terminal quick menu.")),po=(0,ge.q5)("terminal-kill",E.lA.trash,(0,a.NC)("killTerminalIcon","Icon for killing a terminal instance.")),Ls=(0,ge.q5)("terminal-new",E.lA.add,(0,a.NC)("newTerminalIcon","Icon for creating a new terminal instance.")),Rs=(0,ge.q5)("terminal-configure-profile",E.lA.gear,(0,a.NC)("configureTerminalProfileIcon","Icon for creating a new terminal profile.")),Ws=(0,ge.q5)("terminal-decoration-mark",E.lA.circleSmallFilled,(0,a.NC)("terminalDecorationMark","Icon for a terminal decoration mark.")),Bs=(0,ge.q5)("terminal-decoration-incomplete",E.lA.circle,(0,a.NC)("terminalDecorationIncomplete","Icon for a terminal decoration of a command that was incomplete.")),Fs=(0,ge.q5)("terminal-decoration-error",E.lA.errorSmall,(0,a.NC)("terminalDecorationError","Icon for a terminal decoration of a command that errored.")),Os=(0,ge.q5)("terminal-decoration-success",E.lA.circleFilled,(0,a.NC)("terminalDecorationSuccess","Icon for a terminal decoration of a command that was successful.")),Hs=(0,ge.q5)("terminal-command-history-remove",E.lA.close,(0,a.NC)("terminalCommandHistoryRemove","Icon for removing a terminal command from command history.")),Vs=(0,ge.q5)("terminal-command-history-output",E.lA.output,(0,a.NC)("terminalCommandHistoryOutput","Icon for viewing output of a terminal command.")),$s=(0,ge.q5)("terminal-command-history-fuzzy-search",E.lA.searchFuzzy,(0,a.NC)("terminalCommandHistoryFuzzySearch","Icon for toggling fuzzy search of command history."));var ae=p(4865);const P={terminal:(0,a.NC)("terminal","Terminal"),new:(0,a.NC)("terminal.new","New Terminal"),doNotShowAgain:(0,a.NC)("doNotShowAgain","Do Not Show Again"),currentSessionCategory:(0,a.NC)("currentSessionCategory","current session"),previousSessionCategory:(0,a.NC)("previousSessionCategory","previous session"),actionCategory:{value:(0,a.NC)("terminalCategory","Terminal"),original:"Terminal"},focus:{value:(0,a.NC)("workbench.action.terminal.focus","Focus Terminal"),original:"Focus Terminal"},kill:{value:(0,a.NC)("killTerminal","Kill Terminal"),original:"Kill Terminal",short:(0,a.NC)("killTerminal.short","Kill")},moveToEditor:{value:(0,a.NC)("moveToEditor","Move Terminal into Editor Area"),original:"Move Terminal into Editor Area"},moveToTerminalPanel:{value:(0,a.NC)("workbench.action.terminal.moveToTerminalPanel","Move Terminal into Panel"),original:"Move Terminal into Panel"},changeIcon:{value:(0,a.NC)("workbench.action.terminal.changeIcon","Change Icon..."),original:"Change Icon..."},changeColor:{value:(0,a.NC)("workbench.action.terminal.changeColor","Change Color..."),original:"Change Color..."},split:{value:(0,a.NC)("splitTerminal","Split Terminal"),original:"Split Terminal",short:(0,a.NC)("splitTerminal.short","Split")},unsplit:{value:(0,a.NC)("unsplitTerminal","Unsplit Terminal"),original:"Unsplit Terminal"},rename:{value:(0,a.NC)("workbench.action.terminal.rename","Rename..."),original:"Rename..."},toggleSizeToContentWidth:{value:(0,a.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width"),original:"Toggle Size to Content Width"},focusHover:{value:(0,a.NC)("workbench.action.terminal.focusHover","Focus Hover"),original:"Focus Hover"},sendSequence:{value:(0,a.NC)("workbench.action.terminal.sendSequence","Send Custom Sequence To Terminal"),original:"Send Custom Sequence To Terminal"},newWithCwd:{value:(0,a.NC)("workbench.action.terminal.newWithCwd","Create New Terminal Starting in a Custom Working Directory"),original:"Create New Terminal Starting in a Custom Working Directory"},renameWithArgs:{value:(0,a.NC)("workbench.action.terminal.renameWithArg","Rename the Currently Active Terminal"),original:"Rename the Currently Active Terminal"}};var Se=p(49311);let Ae=[],wt=class Ds extends gi.${constructor(e,t,i,n,r,s,l){super(Ds.PREFIX,{canAcceptInBackground:!0}),this._editorService=e,this._terminalService=t,this._terminalEditorService=i,this._terminalGroupService=n,this._commandService=r,this._themeService=s,this._instantiationService=l}_getPicks(e){Ae=[],Ae.push({type:"separator",label:"panel"});const t=this._terminalGroupService.groups;for(let s=0;s<t.length;s++){const l=t[s];for(let d=0;d<l.terminalInstances.length;d++){const f=this._createPick(l.terminalInstances[d],d,e,{groupIndex:s,groupSize:l.terminalInstances.length});f&&Ae.push(f)}}Ae.length>0&&Ae.push({type:"separator",label:"editor"});const i=this._terminalEditorService.instances;for(let s=0;s<i.length;s++){const l=i[s];l.target=D.i2.Editor;const d=this._createPick(l,s,e);d&&Ae.push(d)}Ae.length>0&&Ae.push({type:"separator"});const n=(0,a.NC)("workbench.action.terminal.newplus","Create New Terminal");Ae.push({label:`$(plus) ${n}`,ariaLabel:n,accept:()=>this._commandService.executeCommand("workbench.action.terminal.new")});const r=(0,a.NC)("workbench.action.terminal.newWithProfilePlus","Create New Terminal With Profile");return Ae.push({label:`$(plus) ${r}`,ariaLabel:r,accept:()=>this._commandService.executeCommand("workbench.action.terminal.newWithProfile")}),Ae}_createPick(e,t,i,n){const l=`$(${this._instantiationService.invokeFunction(ae.yX,e)}) ${n?n.groupSize>1?`${n.groupIndex+1}.${t+1}`:`${n.groupIndex+1}`:`${t+1}`}: ${e.title}`,d=[],h=(0,ae.pv)(e);h&&d.push(h);const f=(0,ae.A5)(e,this._themeService.getColorTheme().type);f&&d.push(...f);const v=(0,Ke.Oh)(i,l,!0);if(v)return{label:l,description:e.description,highlights:{label:v},buttons:[{iconClass:H.kS.asClassName(Ns),tooltip:(0,a.NC)("renameTerminal","Rename Terminal")},{iconClass:H.kS.asClassName(po),tooltip:P.kill.value}],iconClasses:d,trigger:b=>{switch(b){case 0:return this._commandService.executeCommand("workbench.action.terminal.rename",e),gi.L.NO_ACTION;case 1:return this._terminalService.safeDisposeTerminal(e),gi.L.REMOVE_ITEM}return gi.L.NO_ACTION},accept:(b,_)=>{if(e.target===D.i2.Editor){const C=this._editorService.findEditors(e.resource);this._terminalEditorService.openEditor(e,{viewColumn:C?.[0].groupId}),this._terminalEditorService.setActiveInstance(e)}else this._terminalGroupService.showPanel(!_.inBackground),this._terminalGroupService.setActiveInstance(e)}}}};wt.PREFIX="term ",wt=(0,c.gn)([(0,c.fM)(0,Se.AR),(0,c.fM)(1,M.BZ),(0,c.fM)(2,M.BZ),(0,c.fM)(3,M.Qy),(0,c.fM)(4,se.H),(0,c.fM)(5,me.XE),(0,c.fM)(6,G.TG)],wt);var m=p(86857);function vo(o,e){const t=[{name:null,description:(0,a.NC)("terminalAutomaticProfile","Automatically detect the default")}];return t.push(...o.map(i=>({name:i.profileName,description:Gs(i)}))),e&&t.push(...e.map(i=>({name:i.title,description:zs(i)}))),{values:t.map(i=>i.name),markdownDescriptions:t.map(i=>i.description)}}function Gs(o){let e=`$(${H.kS.isThemeIcon(o.icon)?o.icon.id:o.icon?o.icon:E.lA.terminal.id}) ${o.profileName}\n- path: ${o.path}`;return o.args&&(e+="string"==typeof o.args?`\n- args: "${o.args}"`:`\n- args: [${0===o.args.length?"":`'${o.args.join("','")}'`}]`),void 0!==o.overrideName&&(e+=`\n- overrideName: ${o.overrideName}`),o.color&&(e+=`\n- color: ${o.color}`),o.env&&(e+=`\n- env: ${JSON.stringify(o.env)}`),e}function zs(o){return`$(${H.kS.isThemeIcon(o.icon)?o.icon.id:o.icon?o.icon:E.lA.terminal.id}) ${o.title}\n- extensionIdentifier: ${o.extensionIdentifier}`}function _o(o,e){if(!o&&!e)return!0;if("string"==typeof o&&"string"==typeof e)return o===e;if(Array.isArray(o)&&Array.isArray(e)){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(o[t]!==e[t])return!1;return!0}return!1}function Fe(o){return!!o&&"string"==typeof o.path&&"string"==typeof o.scheme}var pi=p(49470),St=p(9590),vi=p(95126),zt=p(17360),Oe=p(57948),he=p(48601),Us=p(29689),st=p(75735),Ks=p(56160),Ne=p(17088),He=p(58571);let an,ln;function _i(o){return an||(an=o.get(G.TG).createInstance(wi,"commands")),an}function cn(o){return ln||(ln=o.get(G.TG).createInstance(wi,"dirs")),ln}const bi=new Map;function Qs(o,e){return dn.apply(this,arguments)}function dn(){return dn=(0,u.Z)(function*(o,e){const t=bi.get(e);if(null===t)return[];if(void 0!==t)return t;let i;switch(e){case"bash":i=yield function qs(o){return hn.apply(this,arguments)}(o);break;case"pwsh":i=yield function Js(o){return mn.apply(this,arguments)}(o);break;case"zsh":i=yield function Xs(o){return un.apply(this,arguments)}(o);break;case"fish":i=yield function Ys(o){return fn.apply(this,arguments)}(o);break;default:return[]}if(void 0===i)return bi.set(e,null),[];const n=Array.from(i);return bi.set(e,n),n}),dn.apply(this,arguments)}let wi=class extends A.JT{get entries(){return this._ensureUpToDate(),this._entries.entries()}constructor(e,t,i){super(),this._storageDataKey=e,this._configurationService=t,this._storageService=i,this._timestamp=0,this._isReady=!1,this._isStale=!0,this._entries=new Ks.z6(this._getHistoryLimit()),this._configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration("terminal.integrated.shellIntegration.history")&&(this._entries.limit=this._getHistoryLimit())}),this._storageService.onDidChangeValue(n=>{n.key===this._getTimestampStorageKey()&&!this._isStale&&(this._isStale=this._storageService.getNumber(this._getTimestampStorageKey(),-1,0)!==this._timestamp)})}add(e,t){this._ensureUpToDate(),this._entries.set(e,t),this._saveState()}remove(e){this._ensureUpToDate(),this._entries.delete(e),this._saveState()}clear(){this._ensureUpToDate(),this._entries.clear(),this._saveState()}_ensureUpToDate(){this._isReady||(this._loadState(),this._isReady=!0),this._isStale&&(this._entries.clear(),this._loadState(),this._isStale=!1)}_loadState(){this._timestamp=this._storageService.getNumber(this._getTimestampStorageKey(),-1,0);const e=this._loadPersistedState();if(e)for(const t of e.entries)this._entries.set(t.key,t.value)}_loadPersistedState(){const e=this._storageService.get(this._getEntriesStorageKey(),-1);if(void 0===e||0===e.length)return;let t;try{t=JSON.parse(e)}catch{return}return t}_saveState(){const e={entries:[]};this._entries.forEach((t,i)=>e.entries.push({key:i,value:t})),this._storageService.store(this._getEntriesStorageKey(),JSON.stringify(e),-1,1),this._timestamp=Date.now(),this._storageService.store(this._getTimestampStorageKey(),this._timestamp,-1,1)}_getHistoryLimit(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.history");return"number"==typeof e?e:100}_getTimestampStorageKey(){return`terminal.history.timestamp.${this._storageDataKey}`}_getEntriesStorageKey(){return`terminal.history.entries.${this._storageDataKey}`}};function hn(){return(hn=(0,u.Z)(function*(o){const e=o.get(Ne.sn),t=o.get(Oe.R),i=yield t.getEnvironment();if(1===i?.os||!i&&T.ED)return;const n=yield Zt(st.OB.HOME,".bash_history",!1,e,t);if(void 0===n)return;const r=n.split("\n"),s=new Set;let l,d,h;for(let f=0;f<r.length;f++){l=r[f],void 0===d?d=l:d+=`\n${l}`;for(let v=0;v<l.length;v++)h?l[v]===h&&(h=void 0):l[v].match(/['"]/)&&(h=l[v]);void 0===h&&(d.length>0&&s.add(d.trim()),d=void 0)}return s.values()})).apply(this,arguments)}function un(){return(un=(0,u.Z)(function*(o){const e=o.get(Ne.sn),t=o.get(Oe.R),i=yield t.getEnvironment();if(1===i?.os||!i&&T.ED)return;const n=yield Zt(st.OB.HOME,".zsh_history",!1,e,t);if(void 0===n)return;const r=n.split(/\:\s\d+\:\d+;/),s=new Set;for(let l=0;l<r.length;l++){const d=r[l].replace(/\\\n/g,"\n").trim();d.length>0&&s.add(d)}return s.values()})).apply(this,arguments)}function mn(){return(mn=(0,u.Z)(function*(o){const e=o.get(Ne.sn),t=o.get(Oe.R);let i,n;const r=yield t.getEnvironment(),s=1===r?.os||!r&&T.ED;s?(i=st.OB.APPDATA,n="\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"):(i=st.OB.HOME,n=".local/share/powershell/PSReadline/ConsoleHost_history.txt");const l=yield Zt(i,n,s,e,t);if(void 0===l)return;const d=l.split("\n"),h=new Set;let f,v,b;for(let _=0;_<d.length;_++)if(f=d[_],void 0===v?v=f:v+=`\n${f}`,f.endsWith("`")){for(let C=0;C<f.length;C++)b?f[C]===b&&(b=void 0):f[C].match(/`/)&&(b=f[C]);if(b)v=v.replace(/`$/,""),b=void 0;else{const C=v.trim();C.length>0&&h.add(C),v=void 0}}else{const C=v.trim();C.length>0&&h.add(C),v=void 0}return h.values()})).apply(this,arguments)}function fn(){return(fn=(0,u.Z)(function*(o){const e=o.get(Ne.sn),t=o.get(Oe.R),i=yield t.getEnvironment();if(1===i?.os||!i&&T.ED)return;const r=yield st.OB.XDG_DATA_HOME?Zt(st.OB.XDG_DATA_HOME,"fish/fish_history",!1,e,t):Zt(st.OB.HOME,".local/share/fish/fish_history",!1,e,t);if(void 0===r)return;const s=new Set,l=r.split("\n").filter(d=>d.startsWith("- cmd:")).map(d=>d.substring(6).trimStart());for(let d=0;d<l.length;d++){const h=ea(l[d]).trim();h.length>0&&s.add(h)}return s.values()})).apply(this,arguments)}function ea(o){return function ta(o,e,t){let i,n=e;for(;;)if(i=n,n=n.replace(o,t),n===i)return n}(/(^|[^\\])((?:\\\\)*)(\\n)/g,o,"$1$2\n")}function Zt(o,e,t,i,n){return gn.apply(this,arguments)}function gn(){return(gn=(0,u.Z)(function*(o,e,t,i,n){if(!o)return;const r=!!n.getConnection()?.remoteAuthority,s=N.ov.from({scheme:r?J.lg.vscodeRemote:J.lg.file,path:(t?he.Ku.join:he.KR.join)(o,e)});let l;try{l=yield i.readFile(s)}catch(d){if(d instanceof Ne.Ym&&1===d.fileOperationResult)return;throw d}return void 0!==l?l.value.toString():void 0})).apply(this,arguments)}wi=(0,c.gn)([(0,c.fM)(1,ie.Ui),(0,c.fM)(2,He.Uy)],wi);var bo=p(90290),ia=p(49698),Ct=p(19409),na=p(70473),ra=p(43764),pn=p(42965);const wo="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",So=(0,a.NC)("showTerminalTabs","Show Tabs"),Si=P.actionCategory;function Co(o,e,t,i){return vn.apply(this,arguments)}function vn(){return(vn=(0,u.Z)(function*(o,e,t,i){switch(o.config.splitCwd){case"workspaceRoot":if(void 0!==t&&void 0!==i){if(1===t.length)return t[0].uri;if(t.length>1){const n={placeHolder:(0,a.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal")},r=yield i.executeCommand(sn.RS,[n]);return r?Promise.resolve(r.uri):void 0}}return"";case"initial":return e.getInitialCwd();case"inherited":return e.getCwd()}})).apply(this,arguments)}const yo=function(){var o=(0,u.Z)(function*(e,t){const i=e.get(M.x4).activeInstance;if(i){const n=(0,de.Kn)(t)&&"text"in t?Ci(t.text):void 0;if(!n)return;const r=e.get(pi.qb),s=e.get(be.ec),d=e.get(vi.C).getLastActiveWorkspaceRoot(i.isRemote?J.lg.vscodeRemote:J.lg.file),h=d?(0,de.f6)(s.getWorkspaceFolder(d)):void 0,f=yield r.resolveAsync(h,n);i.sendText(f,!1)}});return function(t,i){return o.apply(this,arguments)}}();let ko,_n=class extends X.aU{constructor(e){super("workbench.action.terminal.launchHelp",(0,a.NC)("terminalLaunchHelp","Open Help")),this._openerService=e}run(){var e=this;return(0,u.Z)(function*(){e._openerService.open("https://aka.ms/vscode-troubleshoot-terminal-launch")})()}};function B(o){o.f1=o.f1??!0,o.category=o.category??Si,o.precondition=o.precondition??m.r.processSupported;const e=o.run,t=o;return delete t.run,(0,x.r1)(class extends x.Ke{constructor(){super(t)}run(i,n){return e(xo(i),i,n)}})}function K(o){const e=o.run;return B({...o,run:(t,i,n)=>{const r=t.service.activeInstance;if(r)return e(r,t,i,n)}})}function xo(o){return{service:o.get(M.x4),groupService:o.get(M.Qy),instanceService:o.get(M.N4),editorService:o.get(M.BZ),profileService:o.get(k.l5),profileResolverService:o.get(k.if)}}function Ve(o){const e=o.get($t.Lw),t=o.get(M.x4);if(!e.lastFocusedList?.getSelection())return;const i=e.lastFocusedList.getSelection(),n=e.lastFocusedList.getFocus(),r=[];if(1===n.length&&!i.includes(n[0]))return r.push(t.getInstanceFromIndex(n[0])),r;for(const s of i)r.push(t.getInstanceFromIndex(s));return r}function Io(o){return(0,de.Kn)(o)&&"profileName"in o?{config:o,location:o.location}:o}function To(o){const e=vo(o);ko?.dispose(),ko=(0,x.r1)(class extends x.Ke{constructor(){super({id:"workbench.action.terminal.newWithProfile",title:{value:(0,a.NC)("workbench.action.terminal.newWithProfile","Create New Terminal (With Profile)"),original:"Create New Terminal (With Profile)"},f1:!0,category:Si,precondition:g.Ao.or(m.r.processSupported,m.r.webExtensionContributedProfile),description:{description:"workbench.action.terminal.newWithProfile",args:[{name:"args",schema:{type:"object",required:["profileName"],properties:{profileName:{description:(0,a.NC)("workbench.action.terminal.newWithProfile.profileName","The name of the profile to create"),type:"string",enum:e.values,markdownEnumDescriptions:e.markdownDescriptions}}}}]}})}run(t,i,n){return(0,u.Z)(function*(){const r=xo(t),s=t.get(be.ec),l=t.get(se.H);let d,h,f,v;if((0,de.Kn)(i)&&i&&"profileName"in i){const _=r.profileService.availableProfiles.find(C=>C.profileName===i.profileName);if(!_)throw new Error(`Could not find terminal profile "${i.profileName}"`);h={config:_}}else i instanceof MouseEvent||i instanceof PointerEvent||i instanceof KeyboardEvent?(d=i,h=n?{config:n}:void 0):h=Io(i);if(d&&(d.altKey||d.ctrlKey)){const _=r.service.activeInstance;if(_)return void(yield r.service.createTerminal({location:{parentTerminal:_},config:h?.config}))}if(s.getWorkspace().folders.length>1){const _={placeHolder:(0,a.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal")},C=yield l.executeCommand(sn.RS,[_]);if(!C)return;v=C.uri}h?(h.cwd=v,f=yield r.service.createTerminal(h)):f=yield r.service.showProfileQuickPick("createInstance",v),f&&(r.service.setActiveInstance(f),yield Ut(f,r))})()}})}function bn(o,e){return o.service.getInstanceFromResource(Ao(e))||o.service.activeInstance}function wn(){return wn=(0,u.Z)(function*(o,e){const t=o.get(we.eJ),i=o.get(ot.e),n=o.get(be.ec),r=o.get(bo.q),s=o.get(ia.O),l=o.get(ie.Ui),d=o.get(pi.qb),h=n.getWorkspace().folders;if(!h.length)return;const f=yield Promise.all(h.map(I=>function la(o,e,t){return Sn.apply(this,arguments)}(I,l,d))),v=function ca(o){const e=new Map;for(const n of o){const r=n.cwd.toString();(!e.get(r)||r===n.folder.uri.toString())&&e.set(r,n)}const t=new Set(e.values());return o.filter(n=>t.has(n))}(f);if(1===v.length)return v[0];const b=v.map(I=>{const $=I.folder.name,F=I.isOverridden?(0,a.NC)("workbench.action.terminal.overriddenCwdDescription","(Overriden) {0}",i.getUriLabel(I.cwd,{relative:!I.isAbsolute})):i.getUriLabel((0,na.XX)(I.cwd),{relative:!0});return{label:$,description:F!==$?F:void 0,pair:I,iconClasses:(0,ra.r)(r,s,I.cwd,Ne.RR.ROOT_FOLDER)}}),_={placeHolder:(0,a.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal"),matchOnDescription:!0,canPickMany:!1},C=e||Ct.T.None;return(yield t.pick(b,_,C))?.pair}),wn.apply(this,arguments)}function Sn(){return(Sn=(0,u.Z)(function*(o,e,t){const i=e.getValue("terminal.integrated.cwd",{resource:o.uri});if(!(0,de.HD)(i)||0===i.length)return{folder:o,cwd:o.uri,isAbsolute:!1,isOverridden:!1};const n=yield t.resolveAsync(o,i);return(0,he.YP)(n)||n.startsWith(Us.N.VARIABLE_LHS)?{folder:o,isAbsolute:!0,isOverridden:!0,cwd:N.ov.from({scheme:o.uri.scheme,path:n})}:{folder:o,isAbsolute:!1,isOverridden:!0,cwd:N.ov.joinPath(o.uri,n)}})).apply(this,arguments)}function Ut(o,e){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,u.Z)(function*(o,e){o.target===D.i2.Editor?(yield e.editorService.revealActiveEditor(),yield o.focusWhenReady(!0)):yield e.groupService.showPanel(!0)})).apply(this,arguments)}function Do(o,e,t){return yn.apply(this,arguments)}function yn(){return(yn=(0,u.Z)(function*(o,e,t){const i=bn(o,t);if(i){const n=yield e.get(we.eJ).input({value:i.title,prompt:(0,a.NC)("workbench.action.terminal.rename.prompt","Enter terminal name")});i.rename(n)}})).apply(this,arguments)}function Ao(o){return N.ov.isUri(o)?o:void 0}function Ci(o){return(0,de.HD)(o)?o:void 0}_n=(0,c.gn)([(0,c.fM)(0,Gt.v4)],_n);var yi=p(15023),Pe=p(69771),Ie=p(82726),yt=p(96970);(0,yt.Z)('.monaco-action-bar .action-item .action-label.extension-action{line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-action-bar .action-dropdown-item>.action-label.extension-action.label,.monaco-action-bar .action-item>.action-label.extension-action.label{padding:0 5px}.monaco-action-bar .action-dropdown-item>.monaco-dropdown .action-label{padding:0}.monaco-action-bar .action-item .action-label.extension-action.label{outline-offset:1px}.monaco-action-bar .action-dropdown-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.text{height:auto;line-height:14px;width:auto}.monaco-action-bar .action-item .action-label.extension-action.built-in-status{border-color:var(--vscode-foreground)}.monaco-action-bar .action-item .action-label.extension-action.label,.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator{background-color:var(--vscode-extensionButton-background)!important}.monaco-action-bar .action-item .action-label.extension-action.label{color:var(--vscode-extensionButton-foreground)!important}.monaco-action-bar .action-item .action-label.extension-action.label:hover{background-color:var(--vscode-extensionButton-hoverBackground)!important}.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator>div{background-color:var(--vscode-extensionButton-separator)}.monaco-action-bar .action-item .action-label.extension-action.label.prominent,.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator.prominent{background-color:var(--vscode-extensionButton-prominentBackground)}.monaco-action-bar .action-item .action-label.extension-action.label.prominent{color:var(--vscode-extensionButton-prominentForeground)!important}.monaco-action-bar .action-item .action-label.extension-action.label.prominent:hover{background-color:var(--vscode-extensionButton-prominentHoverBackground)}.monaco-action-bar .action-item .action-label.extension-action:not(.disabled){border:1px solid var(--vscode-contrastBorder)}.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator{border-bottom:1px solid var(--vscode-contrastBorder);border-top:1px solid var(--vscode-contrastBorder)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-error{color:var(--vscode-editorError-foreground)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-warning{color:var(--vscode-editorWarning-foreground)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-info{color:var(--vscode-editorInfo-foreground)}.monaco-action-bar .action-dropdown-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.icon,.monaco-action-bar .action-item:not(.disabled) .action-label.extension-action.label,.monaco-action-bar .action-item:not(.disabled) .action-label.extension-action.text{margin-top:2px}.monaco-action-bar .action-item .action-label.extension-action.manage.hide,.monaco-action-bar .action-item.action-dropdown-item .action-label.extension-action.hide,.monaco-action-bar .action-item.action-dropdown-item.disabled,.monaco-action-bar .action-item.disabled .action-label.disable-status.hide,.monaco-action-bar .action-item.disabled .action-label.extension-action.extension-sync,.monaco-action-bar .action-item.disabled .action-label.extension-action.hide,.monaco-action-bar .action-item.disabled .action-label.extension-action.hide-when-disabled,.monaco-action-bar .action-item.disabled .action-label.extension-action.ignore,.monaco-action-bar .action-item.disabled .action-label.extension-action.install:not(.installing),.monaco-action-bar .action-item.disabled .action-label.extension-action.language,.monaco-action-bar .action-item.disabled .action-label.extension-action.migrate,.monaco-action-bar .action-item.disabled .action-label.extension-action.reload,.monaco-action-bar .action-item.disabled .action-label.extension-action.theme,.monaco-action-bar .action-item.disabled .action-label.extension-action.undo-ignore,.monaco-action-bar .action-item.disabled .action-label.extension-action.uninstall:not(.uninstalling),.monaco-action-bar .action-item.disabled .action-label.extension-action.update,.monaco-action-bar .action-item.disabled .action-label.extension-status-label.hide,.monaco-action-bar .action-item.disabled .action-label.extension-status.hide{display:none}.monaco-action-bar .extension-action.label{display:inherit}.monaco-action-bar .action-item.disabled .action-label.extension-status:before{opacity:1}.monaco-action-bar .action-item.disabled .action-label.extension-status-label:before{content:"\\2713";padding-right:4px}.monaco-action-bar .action-item.disabled .action-label.extension-action{opacity:1}.monaco-action-bar .action-item.disabled .action-label.extension-action.text{font-style:italic;opacity:.9}',{});var xn=p(44102),$e=p(54922),Y=p(22402);const Po=["{","\t// See https://go.microsoft.com/fwlink/?LinkId=827846 to learn about workspace recommendations.","\t// Extension identifier format: ${publisher}.${name}. Example: vscode.csharp","","\t// List of extensions which should be recommended for users of this workspace.",'\t"recommendations": [',"\t\t","\t],","\t// List of extensions recommended by VS Code that should not be recommended for users of this workspace.",'\t"unwantedRecommendations": [',"\t\t","\t]","}"].join("\n");var pe=p(10932);const ha=(0,G.yh)("extensionRecommendationsService"),In=(0,G.yh)("IExtensionIgnoredRecommendationsService");var ye=p(3602),at=p(22806),Eo=p(76148),re=p(69486),kn=p(22781),xi=p(56980),lt=p(33798),ct=p(41436),Tn=p(4866),xt=p(81532),Dn=p(94485);const Mo=".vscode/extensions.json";var Qe=p(86810),An=p(22849),z=p(60234);const Pn=(0,G.yh)("extensionManifestPropertiesService");var En=p(35837),ua=p(45763),Q=p(49851),Kt=p(73794),Qt=p(62823),Mn=p(45369);const ma=(0,G.yh)("localizationService");var je=p(17324);let It=class extends X.aU{constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y){super("extension.promptExtensionInstallFailure"),this.extension=e,this.version=t,this.installOperation=i,this.installOptions=n,this.error=r,this.productService=s,this.openerService=l,this.notificationService=d,this.dialogService=h,this.commandService=f,this.logService=v,this.extensionManagementServerService=b,this.instantiationService=_,this.galleryService=C,this.extensionManifestPropertiesService=y}run(){var e=this;return(0,u.Z)(function*(){if((0,Qe.n2)(e.error))return;if(e.logService.error(e.error),e.error.name===Ie.m3.Unsupported){const s=T.$L?(0,a.NC)("VS Code for Web","{0} for the Web",e.productService.nameLong):e.productService.nameLong,l=(0,a.NC)("cannot be installed","The '{0}' extension is not available in {1}. Click 'More Information' to learn more.",e.extension.displayName||e.extension.identifier.id,s),{confirmed:d}=yield e.dialogService.confirm({type:R.zb.Info,message:l,primaryButton:(0,a.NC)({key:"more information",comment:["&& denotes a mnemonic"]},"&&More Information"),cancelButton:(0,a.NC)("close","Close")});return void(d&&e.openerService.open(N.ov.parse(T.$L?"https://aka.ms/vscode-web-extensions-guide":"https://aka.ms/vscode-remote")))}if([Ie.m3.Incompatible,Ie.m3.IncompatibleTargetPlatform,Ie.m3.Malicious,Ie.m3.ReleaseVersionNotFound,Ie.m3.Deprecated].includes(e.error.name))return void(yield e.dialogService.info((0,Qe.e$)(e.error)));if(Ie.m3.Signature===e.error.name)return void(yield e.dialogService.prompt({type:"error",message:(0,a.NC)("signature verification failed","{0} cannot verify the '{1}' extension. Are you sure you want to install it?",e.productService.nameLong,e.extension.displayName||e.extension.identifier.id),buttons:[{label:(0,a.NC)("install anyway","Install Anyway"),run:()=>{const s=e.instantiationService.createInstance(e.installOptions?.isMachineScoped?Ii:ki,{donotVerifySignature:!0});return s.extension=e.extension,s.run()}}],cancelButton:(0,a.NC)("cancel","Cancel")}));let i,t=3===e.installOperation?(0,a.NC)("update operation","Error while updating '{0}' extension.",e.extension.displayName||e.extension.identifier.id):(0,a.NC)("install operation","Error while installing '{0}' extension.",e.extension.displayName||e.extension.identifier.id);const n=[];if(Ie.m3.IncompatiblePreRelease===e.error.name)t=(0,Qe.e$)(e.error),i=(0,a.NC)("install release version message","Would you like to install the release version?"),n.push({label:(0,a.NC)("install release version","Install Release Version"),run:()=>{const s=e.installOptions?.isMachineScoped?e.instantiationService.createInstance(Ii,{installPreReleaseVersion:!!e.installOptions.installPreReleaseVersion}):e.instantiationService.createInstance(ki,{installPreReleaseVersion:!!e.installOptions?.installPreReleaseVersion});return s.extension=e.extension,s.run()}});else{const s=yield e.getDownloadUrl();s&&(i=(0,a.NC)("check logs","Please check the [log]({0}) for more details.","command:workbench.action.showWindowLog"),n.push({label:(0,a.NC)("download","Try Downloading Manually..."),run:()=>e.openerService.open(s).then(()=>{e.notificationService.prompt(R.zb.Info,(0,a.NC)("install vsix","Once downloaded, please manually install the downloaded VSIX of '{0}'.",e.extension.identifier.id),[{label:(0,a.NC)("installVSIX","Install from VSIX..."),run:()=>e.commandService.executeCommand(Y.oC)}])})}))}e.notificationService.prompt(R.zb.Error,`${t}${i?` ${i}`:""}`,n)})()}getDownloadUrl(){var e=this;return(0,u.Z)(function*(){if(T.gn||!e.extension.gallery||!e.productService.extensionsGallery||!e.extensionManagementServerService.localExtensionManagementServer&&!e.extensionManagementServerService.remoteExtensionManagementServer)return;let t=e.extension.gallery.properties.targetPlatform;if("universal"!==t&&"undefined"!==t&&e.extensionManagementServerService.remoteExtensionManagementServer)try{const i=yield e.galleryService.getManifest(e.extension.gallery,Ct.T.None);i&&e.extensionManifestPropertiesService.prefersExecuteOnWorkspace(i)&&(t=yield e.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform())}catch(i){return void e.logService.error(i)}return"unknown"!==t?N.ov.parse(`${e.productService.extensionsGallery.serviceUrl}/publishers/${e.extension.publisher}/vsextensions/${e.extension.name}/${e.version}/vspackage${"undefined"!==t?`?targetPlatform=${t}`:""}`):void 0})()}};It=(0,c.gn)([(0,c.fM)(5,xt.a),(0,c.fM)(6,Gt.v4),(0,c.fM)(7,R.lT),(0,c.fM)(8,Be.Ss),(0,c.fM)(9,se.H),(0,c.fM)(10,De.VZ),(0,c.fM)(11,pe.ZV),(0,c.fM)(12,G.TG),(0,c.fM)(13,Ie.Lj),(0,c.fM)(14,Pn)],It);class L extends X.aU{constructor(){super(...arguments),this._extension=null}get extension(){return this._extension}set extension(e){this._extension=e,this.update()}}L.EXTENSION_ACTION_CLASS="extension-action",L.TEXT_ACTION_CLASS=`${L.EXTENSION_ACTION_CLASS} text`,L.LABEL_ACTION_CLASS=`${L.EXTENSION_ACTION_CLASS} label`,L.ICON_ACTION_CLASS=`${L.EXTENSION_ACTION_CLASS} icon`;let kt=class extends L{set manifest(e){this._manifest=e,this.updateLabel()}constructor(e,t,i,n,r,s,l,d,h,f,v){super(e,(0,a.NC)("install","Install"),i,!1),this.options=t,this.extensionsWorkbenchService=n,this.instantiationService=r,this.runtimeExtensionService=s,this.workbenchThemeService=l,this.labelService=d,this.dialogService=h,this.preferencesService=f,this.telemetryService=v,this._manifest=null,this.updateThrottler=new ne.eD,this.update(),this._register(this.labelService.onDidChangeFormatters(()=>this.updateLabel(),this))}update(){this.updateThrottler.queue(()=>this.computeAndUpdateEnablement())}computeAndUpdateEnablement(){var e=this;return(0,u.Z)(function*(){e.enabled=!1,e.extension&&(e.extension.isBuiltin||e.extensionsWorkbenchService.canSetLanguage(e.extension)||3===e.extension.state&&(yield e.extensionsWorkbenchService.canInstall(e.extension))&&(e.enabled=e.options.installPreReleaseVersion?e.extension.hasPreReleaseVersion:e.extension.hasReleaseVersion,e.updateLabel()))})()}run(){var e=this;return(0,u.Z)(function*(){if(!e.extension)return;if(e.extension.deprecationInfo){let n,i=(0,a.NC)("deprecated message","This extension is deprecated as it is no longer being maintained.");(l=n||(n={}))[l.InstallAnyway=0]="InstallAnyway",l[l.ShowAlternateExtension=1]="ShowAlternateExtension",l[l.ConfigureSettings=2]="ConfigureSettings",l[l.Cancel=3]="Cancel";const r=[{label:(0,a.NC)("install anyway","Install Anyway"),run:()=>n.InstallAnyway}];if(e.extension.deprecationInfo.extension){i=(0,a.NC)("deprecated with alternate extension message","This extension is deprecated. Use the {0} extension instead.",e.extension.deprecationInfo.extension.displayName);const l=e.extension.deprecationInfo.extension;r.push({label:(0,a.NC)({key:"Show alternate extension",comment:["&& denotes a mnemonic"]},"&&Open {0}",e.extension.deprecationInfo.extension.displayName),run:(d=(0,u.Z)(function*(){const[h]=yield e.extensionsWorkbenchService.getExtensions([{id:l.id,preRelease:l.preRelease}],Ct.T.None);return yield e.extensionsWorkbenchService.open(h),n.ShowAlternateExtension}),function(){return d.apply(this,arguments)})})}else if(e.extension.deprecationInfo.settings){i=(0,a.NC)("deprecated with alternate settings message","This extension is deprecated as this functionality is now built-in to VS Code.");const l=e.extension.deprecationInfo.settings;r.push({label:(0,a.NC)({key:"configure in settings",comment:["&& denotes a mnemonic"]},"&&Configure Settings"),run:function(){var d=(0,u.Z)(function*(){return yield e.preferencesService.openSettings({query:l.map(h=>`@id:${h}`).join(" ")}),n.ConfigureSettings});return function(){return d.apply(this,arguments)}}()})}else e.extension.deprecationInfo.additionalInfo&&(i=new Q.W5(`${i} ${e.extension.deprecationInfo.additionalInfo}`));const{result:s}=yield e.dialogService.prompt({type:R.zb.Warning,message:(0,a.NC)("install confirmation","Are you sure you want to install '{0}'?",e.extension.displayName),detail:(0,de.HD)(i)?i:void 0,custom:(0,de.HD)(i)?void 0:{markdownDetails:[{markdown:i}]},buttons:r,cancelButton:{run:()=>n.Cancel}});if(s!==n.InstallAnyway)return}var d,l;e.extensionsWorkbenchService.open(e.extension,{showPreReleaseVersion:e.options.installPreReleaseVersion}),(0,lt.Z9)((0,a.NC)("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",e.extension.displayName)),e.telemetryService.publicLog("extensions:action:install",{...e.extension.telemetryData,actionId:e.id});const t=yield e.install(e.extension);if(t?.local){(0,lt.Z9)((0,a.NC)("installExtensionComplete","Installing extension {0} is completed.",e.extension.displayName));const i=yield e.getRunningExtension(t.local);if(i&&(!i.activationEvents||!i.activationEvents.some(n=>n.startsWith("onLanguage")))){const n=yield e.getThemeAction(t);if(n){n.extension=t;try{return n.run({showCurrentTheme:!0,ignoreFocusLost:!0})}finally{n.dispose()}}}}})()}getThemeAction(e){var t=this;return(0,u.Z)(function*(){return(yield t.workbenchThemeService.getColorThemes()).some(s=>Le(s,e))?t.instantiationService.createInstance(Xe):(yield t.workbenchThemeService.getFileIconThemes()).some(s=>Le(s,e))?t.instantiationService.createInstance(Je):(yield t.workbenchThemeService.getProductIconThemes()).some(s=>Le(s,e))?t.instantiationService.createInstance(Ye):void 0})()}install(e){var t=this;return(0,u.Z)(function*(){const i=t.getInstallOptions();try{return yield t.extensionsWorkbenchService.install(e,i)}catch(n){return void(yield t.instantiationService.createInstance(It,e,e.latestVersion,2,i,n).run())}})()}getRunningExtension(e){var t=this;return(0,u.Z)(function*(){return(yield t.runtimeExtensionService.getExtension(e.identifier.id))||(t.runtimeExtensionService.canAddExtension((0,re.Br)(e))?new Promise((n,r)=>{const s=t.runtimeExtensionService.onDidChangeExtensions((0,u.Z)(function*(){const l=yield t.runtimeExtensionService.getExtension(e.identifier.id);l&&(s.dispose(),n(l))}))}):null)})()}updateLabel(){this.label=this.getLabel()}getLabel(e){return this.options.installPreReleaseVersion&&this.extension?.hasPreReleaseVersion?e?(0,a.NC)("install pre-release","Install Pre-Release"):(0,a.NC)("install pre-release version","Install Pre-Release Version"):this.extension?.hasPreReleaseVersion?e?(0,a.NC)("install","Install"):(0,a.NC)("install release version","Install Release Version"):(0,a.NC)("install","Install")}getInstallOptions(){return this.options}};kt.Class=`${L.LABEL_ACTION_CLASS} prominent install`,kt=(0,c.gn)([(0,c.fM)(3,Y.Wi),(0,c.fM)(4,G.TG),(0,c.fM)(5,re.QS),(0,c.fM)(6,ct.Dc),(0,c.fM)(7,ot.e),(0,c.fM)(8,Be.Ss),(0,c.fM)(9,zt.UP),(0,c.fM)(10,je.bU)],kt);let Ii=class As extends kt{constructor(e,t,i,n,r,s,l,d,h,f,v,b){super("extensions.install",e,As.Class,t,i,n,r,s,l,d,b),this.extensionManagementServerService=h,this.workbenchExtensionManagementService=f,this.userDataSyncEnablementService=v,this.updateLabel(),this._register(s.onDidChangeFormatters(()=>this.updateLabel(),this)),this._register(w.ju.any(v.onDidChangeEnablement,w.ju.filter(v.onDidChangeResourceEnablement,_=>"extensions"===_[0]))(()=>this.update()))}getLabel(e){const t=super.getLabel(e),i=(0,a.NC)("do no sync","Do not sync"),n=this.getInstallOptions().isMachineScoped;if(this._manifest&&this.extensionManagementServerService.remoteExtensionManagementServer){if(this.workbenchExtensionManagementService.getExtensionManagementServerToInstall(this._manifest)===this.extensionManagementServerService.remoteExtensionManagementServer){const s=this.extensionManagementServerService.remoteExtensionManagementServer.label;return n?(0,a.NC)({key:"install extension in remote and do not sync",comment:["First placeholder is install action label.","Second placeholder is the name of the action to install an extension in remote server and do not sync it. Placeholder is for the name of remote server.","Third placeholder is do not sync label."]},"{0} in {1} ({2})",t,s,i):(0,a.NC)({key:"install extension in remote",comment:["First placeholder is install action label.","Second placeholder is the name of the action to install an extension in remote server and do not sync it. Placeholder is for the name of remote server."]},"{0} in {1}",t,s)}return n?(0,a.NC)("install extension locally and do not sync","{0} Locally ({1})",t,i):(0,a.NC)("install extension locally","{0} Locally",t)}return n?`${t} (${i})`:t}getInstallOptions(){return{...super.getInstallOptions(),isMachineScoped:this.userDataSyncEnablementService.isEnabled()&&this.userDataSyncEnablementService.isResourceEnabled("extensions")}}};Ii=(0,c.gn)([(0,c.fM)(1,Y.Wi),(0,c.fM)(2,G.TG),(0,c.fM)(3,re.QS),(0,c.fM)(4,ct.Dc),(0,c.fM)(5,ot.e),(0,c.fM)(6,Be.Ss),(0,c.fM)(7,zt.UP),(0,c.fM)(8,pe.ZV),(0,c.fM)(9,pe.sR),(0,c.fM)(10,An.Ud),(0,c.fM)(11,je.bU)],Ii);let ki=class extends kt{constructor(e,t,i,n,r,s,l,d,h,f,v){super("extensions.installAndSync",e,kt.Class,t,i,n,r,s,l,d,v),this.userDataSyncEnablementService=f,this.tooltip=(0,a.NC)({key:"install everywhere tooltip",comment:["Placeholder is the name of the product. Eg: Visual Studio Code or Visual Studio Code - Insiders"]},"Install this extension in all your synced {0} instances",h.nameLong),this._register(w.ju.any(f.onDidChangeEnablement,w.ju.filter(f.onDidChangeResourceEnablement,b=>"extensions"===b[0]))(()=>this.update()))}computeAndUpdateEnablement(){var e=()=>super.computeAndUpdateEnablement,t=this;return(0,u.Z)(function*(){yield e().call(t),t.enabled&&(t.enabled=t.userDataSyncEnablementService.isEnabled()&&t.userDataSyncEnablementService.isResourceEnabled("extensions"))})()}getInstallOptions(){return{...super.getInstallOptions(),isMachineScoped:!1}}};ki=(0,c.gn)([(0,c.fM)(1,Y.Wi),(0,c.fM)(2,G.TG),(0,c.fM)(3,re.QS),(0,c.fM)(4,ct.Dc),(0,c.fM)(5,ot.e),(0,c.fM)(6,Be.Ss),(0,c.fM)(7,zt.UP),(0,c.fM)(8,xt.a),(0,c.fM)(9,An.Ud),(0,c.fM)(10,je.bU)],ki);class Tt extends L{constructor(){super("extension.installing",Tt.LABEL,Tt.CLASS,!1)}update(){this.class=`${Tt.CLASS}${this.extension&&0===this.extension.state?"":" hide"}`}}Tt.LABEL=(0,a.NC)("installing","Installing"),Tt.CLASS=`${L.LABEL_ACTION_CLASS} install installing`;let Dt=class Wt extends L{constructor(e,t,i,n,r,s){super(e,Wt.INSTALL_LABEL,Wt.Class,!1),this.server=t,this.canInstallAnyWhere=i,this.extensionsWorkbenchService=n,this.extensionManagementServerService=r,this.extensionManifestPropertiesService=s,this.updateWhenCounterExtensionChanges=!0,this.update()}update(){if(this.enabled=!1,this.class=Wt.Class,this.canInstall()){const e=this.extensionsWorkbenchService.installed.filter(t=>(0,ye.Q_)(t.identifier,this.extension.identifier)&&t.server===this.server)[0];e?0===e.state&&!e.local&&(this.enabled=!0,this.label=Wt.INSTALLING_LABEL,this.class=Wt.InstallingClass):(this.enabled=!0,this.label=this.getInstallLabel())}}canInstall(){return!!(this.extension&&this.server&&this.extension.local&&1===this.extension.state&&1===this.extension.type&&2!==this.extension.enablementState&&0!==this.extension.enablementState&&4!==this.extension.enablementState)&&!!((0,at.QF)(this.extension.local.manifest)||this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)||this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)||this.server===this.extensionManagementServerService.webExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWeb(this.extension.local.manifest)||this.canInstallAnyWhere&&(this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnUI(this.extension.local.manifest)||this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnWorkspace(this.extension.local.manifest)))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension?.local&&e.extension?.server&&e.server)return e.extensionsWorkbenchService.open(e.extension),(0,lt.Z9)((0,a.NC)("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",e.extension.displayName)),e.extensionsWorkbenchService.installInServer(e.extension,e.server)})()}};Dt.INSTALL_LABEL=(0,a.NC)("install","Install"),Dt.INSTALLING_LABEL=(0,a.NC)("installing","Installing"),Dt.Class=`${L.LABEL_ACTION_CLASS} prominent install`,Dt.InstallingClass=`${L.LABEL_ACTION_CLASS} install installing`,Dt=(0,c.gn)([(0,c.fM)(3,Y.Wi),(0,c.fM)(4,pe.ZV),(0,c.fM)(5,Pn)],Dt);let dt=class tt extends L{constructor(e){super("extensions.uninstall",tt.UninstallLabel,tt.UninstallClass,!1),this.extensionsWorkbenchService=e,this.update()}update(){if(!this.extension)return void(this.enabled=!1);const e=this.extension.state;if(2===e)return this.label=tt.UninstallingLabel,this.class=tt.UnInstallingClass,void(this.enabled=!1);this.label=tt.UninstallLabel,this.class=tt.UninstallClass,this.tooltip=tt.UninstallLabel,this.enabled=1===e&&!this.extension.isBuiltin}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return(0,lt.Z9)((0,a.NC)("uninstallExtensionStart","Uninstalling extension {0} started.",e.extension.displayName)),e.extensionsWorkbenchService.uninstall(e.extension).then(()=>{(0,lt.Z9)((0,a.NC)("uninstallExtensionComplete","Please reload Visual Studio Code to complete the uninstallation of the extension {0}.",e.extension.displayName))})})()}};dt.UninstallLabel=(0,a.NC)("uninstallAction","Uninstall"),dt.UninstallingLabel=(0,a.NC)("Uninstalling","Uninstalling"),dt.UninstallClass=`${L.LABEL_ACTION_CLASS} uninstall`,dt.UnInstallingClass=`${L.LABEL_ACTION_CLASS} uninstall uninstalling`,dt=(0,c.gn)([(0,c.fM)(0,Y.Wi)],dt);class qe extends L{constructor(e,t,i){super(e,t,qe.DisabledClass,!1),this.extensionsWorkbenchService=i,this.updateThrottler=new ne.eD,this.update()}update(){this.updateThrottler.queue(()=>this.computeAndUpdateEnablement())}computeAndUpdateEnablement(){var e=this;return(0,u.Z)(function*(){if(e.enabled=!1,e.class=Nn.DisabledClass,!e.extension||e.extension.deprecationInfo)return;const t=yield e.extensionsWorkbenchService.canInstall(e.extension);e.enabled=t&&1===e.extension.state&&e.extension.outdated,e.class=e.enabled?qe.EnabledClass:qe.DisabledClass})()}}qe.EnabledClass=`${L.LABEL_ACTION_CLASS} prominent update`,qe.DisabledClass=`${qe.EnabledClass} disabled`;let Nn=class extends qe{constructor(e,t,i){super("extensions.update",(0,a.NC)("update","Update"),t),this.verbose=e,this.instantiationService=i}update(){super.update(),this.extension&&(this.label=this.verbose?(0,a.NC)("update to","Update to v{0}",this.extension.latestVersion):(0,a.NC)("update","Update"))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return(0,lt.Z9)((0,a.NC)("updateExtensionStart","Updating extension {0} to version {1} started.",e.extension.displayName,e.extension.latestVersion)),e.install(e.extension)})()}install(e){var t=this;return(0,u.Z)(function*(){try{yield t.extensionsWorkbenchService.install(e,e.local?.preRelease?{installPreReleaseVersion:!0}:void 0),(0,lt.Z9)((0,a.NC)("updateExtensionComplete","Updating extension {0} to version {1} completed.",e.displayName,e.latestVersion))}catch(i){t.instantiationService.createInstance(It,e,e.latestVersion,3,void 0,i).run()}})()}};Nn=(0,c.gn)([(0,c.fM)(1,Y.Wi),(0,c.fM)(2,G.TG)],Nn);let jt=class Yi extends L{constructor(e,t){super("extensionsAction.migrateDeprecatedExtension",(0,a.NC)("migrateExtension","Migrate"),Yi.DisabledClass,!1),this.small=e,this.extensionsWorkbenchService=t,this.update()}update(){if(this.enabled=!1,this.class=Yi.DisabledClass,!this.extension?.local||1!==this.extension.state||!this.extension.deprecationInfo?.extension)return;const e=this.extension.deprecationInfo.extension.id;this.extensionsWorkbenchService.local.some(t=>(0,ye.Q_)(t.identifier,{id:e}))||(this.enabled=!0,this.class=Yi.EnabledClass,this.tooltip=(0,a.NC)("migrate to","Migrate to {0}",this.extension.deprecationInfo.extension.displayName),this.label=this.small?(0,a.NC)("migrate","Migrate"):this.tooltip)}run(){var e=this;return(0,u.Z)(function*(){if(!e.extension?.deprecationInfo?.extension)return;const t=e.extension.local;yield e.extensionsWorkbenchService.uninstall(e.extension);const[i]=yield e.extensionsWorkbenchService.getExtensions([{id:e.extension.deprecationInfo.extension.id,preRelease:e.extension.deprecationInfo?.extension?.preRelease}],Ct.T.None);yield e.extensionsWorkbenchService.install(i,{isMachineScoped:t?.isMachineScoped})})()}};jt.EnabledClass=`${L.LABEL_ACTION_CLASS} migrate`,jt.DisabledClass=`${jt.EnabledClass} disabled`,jt=(0,c.gn)([(0,c.fM)(1,Y.Wi)],jt);let Ti=class extends L{constructor(e,t,i,n,r){super(e,t,i,n),this.instantiationService=r,this._actionViewItem=null}createActionViewItem(){return this._actionViewItem=this.instantiationService.createInstance(Ln,this),this._actionViewItem}run({actionGroups:e,disposeActionsOnHide:t}){return this._actionViewItem?.showMenu(e,t),Promise.resolve()}};Ti=(0,c.gn)([(0,c.fM)(4,G.TG)],Ti);let Ln=class extends Dn.gU{constructor(e,t){super(null,e,{icon:!0,label:!0}),this.contextMenuService=t}showMenu(e,t){if(this.element){const i=this.getActions(e),n=S.i(this.element),r={x:n.left,y:n.top+n.height+10};this.contextMenuService.showContextMenu({getAnchor:()=>r,getActions:()=>i,actionRunner:this.actionRunner,onHide:()=>{t&&(0,A.ex)(i)}})}}getActions(e){let t=[];for(const i of e)t=[...t,...i,new X.Z0];return t.length?t.slice(0,t.length-1):t}};function Rn(){return Rn=(0,u.Z)(function*(o,e,t){return t.invokeFunction(function(){var i=(0,u.Z)(function*(n){const r=n.get(Y.Wi),s=n.get(x.co),l=n.get(ha),d=n.get(In),h=n.get(ct.Dc),f=[];if(o){f.push(["extension",o.identifier.id]),f.push(["isBuiltinExtension",o.isBuiltin]),f.push(["extensionHasConfiguration",o.local&&!!o.local.manifest.contributes&&!!o.local.manifest.contributes.configuration]),f.push(["extensionHasKeybindings",o.local&&!!o.local.manifest.contributes&&!!o.local.manifest.contributes.keybindings]),f.push(["extensionHasCommands",o.local&&!!o.local.manifest.contributes&&!!o.local.manifest.contributes?.commands]),f.push(["isExtensionRecommended",!!l.getAllRecommendationsWithReason()[o.identifier.id.toLowerCase()]]),f.push(["isExtensionWorkspaceRecommended",0===l.getAllRecommendationsWithReason()[o.identifier.id.toLowerCase()]?.reasonId]),f.push(["isUserIgnoredRecommendation",d.globalIgnoredRecommendations.some(I=>I===o.identifier.id.toLowerCase())]),1===o.state&&f.push(["extensionStatus","installed"]),f.push(["installedExtensionIsPreReleaseVersion",!!o.local?.isPreReleaseVersion]),f.push(["galleryExtensionIsPreReleaseVersion",!!o.gallery?.properties.isPreReleaseVersion]),f.push(["extensionHasPreReleaseVersion",o.hasPreReleaseVersion]),f.push(["extensionHasReleaseVersion",o.hasReleaseVersion]);const[_,C,y]=yield Promise.all([h.getColorThemes(),h.getFileIconThemes(),h.getProductIconThemes()]);f.push(["extensionHasColorThemes",_.some(I=>Le(I,o))]),f.push(["extensionHasFileIconThemes",C.some(I=>Le(I,o))]),f.push(["extensionHasProductIconThemes",y.some(I=>Le(I,o))]),f.push(["canSetLanguage",r.canSetLanguage(o)]),f.push(["isActiveLanguagePackExtension",o.gallery&&T.dK===(0,Mn.K)(o.gallery)])}const v=s.createMenu(x.eH.ExtensionContext,e.createOverlay(f)),b=v.getActions({shouldForwardArgs:!0});return v.dispose(),b});return function(n){return i.apply(this,arguments)}}())}),Rn.apply(this,arguments)}function Wn(o,e){const t=[];for(const[,i]of o)t.push(i.map(n=>n instanceof X.wY?n:e.createInstance(Bn,n)));return t}Ln=(0,c.gn)([(0,c.fM)(1,$e.i)],Ln);let At=class fi extends Ti{constructor(e,t,i){super(fi.ID,"","",!0,e),this.extensionService=t,this.contextKeyService=i,this.tooltip=(0,a.NC)("manage","Manage"),this.update()}getActionGroups(){var e=this;return(0,u.Z)(function*(){const t=[],i=yield function ga(o,e,t){return Rn.apply(this,arguments)}(e.extension,e.contextKeyService,e.instantiationService),n=[],r=[],s=[];for(const[l,d]of i)l===Y.J2?r.push(...Wn([[l,d]],e.instantiationService)[0]):l===Y.ED?n.push(...Wn([[l,d]],e.instantiationService)[0]):s.push(...Wn([[l,d]],e.instantiationService));return n.length&&t.push(n),t.push([e.instantiationService.createInstance(Xt),e.instantiationService.createInstance(qt)]),t.push([e.instantiationService.createInstance(Yt),e.instantiationService.createInstance(Jt)]),t.push([...r.length?r:[],e.instantiationService.createInstance(ht),e.instantiationService.createInstance(dt)]),s.forEach(l=>t.push(l)),t.forEach(l=>l.forEach(d=>{d instanceof L&&(d.extension=e.extension)})),t})()}run(){var e=()=>super.run,t=this;return(0,u.Z)(function*(){return yield t.extensionService.whenInstalledExtensionsRegistered(),e().call(t,{actionGroups:yield t.getActionGroups(),disposeActionsOnHide:!0})})()}update(){if(this.class=fi.HideManageExtensionClass,this.enabled=!1,this.extension){const e=this.extension.state;this.enabled=1===e,this.class=this.enabled||2===e?fi.Class:fi.HideManageExtensionClass,this.tooltip=2===e?(0,a.NC)("ManageExtensionAction.uninstallingTooltip","Uninstalling"):""}}};At.ID="extensions.manage",At.Class=`${L.ICON_ACTION_CLASS} manage `+H.kS.asClassName(z.Bl),At.HideManageExtensionClass=`${At.Class} hide`,At=(0,c.gn)([(0,c.fM)(0,G.TG),(0,c.fM)(1,re.QS),(0,c.fM)(2,g.i6)],At);let Bn=class extends L{constructor(e,t){super(e.id,e.label),this.action=e,this.extensionsWorkbenchService=t}update(){this.extension&&this.action.id===Y.K5&&(this.checked=!this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension))}run(){var e=this;return(0,u.Z)(function*(){e.extension&&(yield e.action.run(e.extension.local?(0,ye.Me)(e.extension.local.manifest.publisher,e.extension.local.manifest.name):e.extension.gallery?(0,ye.Me)(e.extension.gallery.publisher,e.extension.gallery.name):e.extension.identifier.id))})()}};Bn=(0,c.gn)([(0,c.fM)(1,Y.Wi)],Bn);let Di=class en extends L{constructor(e,t){super(en.ID,e?"":en.TITLE.value,`${e?L.ICON_ACTION_CLASS+" "+H.kS.asClassName(z.qT):L.LABEL_ACTION_CLASS} hide-when-disabled switch-to-prerelease`,!0),this.commandService=t,this.tooltip=(0,a.NC)("switch to pre-release version tooltip","Switch to Pre-Release version of this extension"),this.update()}update(){this.enabled=!!this.extension&&!this.extension.isBuiltin&&!this.extension.local?.isPreReleaseVersion&&this.extension.hasPreReleaseVersion&&1===this.extension.state}run(){var e=this;return(0,u.Z)(function*(){if(e.enabled)return e.commandService.executeCommand(en.ID,e.extension?.identifier.id)})()}};Di.ID="workbench.extensions.action.switchToPreReleaseVersion",Di.TITLE={value:(0,a.NC)("switch to pre-release version","Switch to Pre-Release Version"),original:"Switch to  Pre-Release Version"},Di=(0,c.gn)([(0,c.fM)(1,se.H)],Di);let Ai=class tn extends L{constructor(e,t){super(tn.ID,e?"":tn.TITLE.value,`${e?L.ICON_ACTION_CLASS+" "+H.kS.asClassName(z.qT):L.LABEL_ACTION_CLASS} hide-when-disabled switch-to-released`),this.commandService=t,this.tooltip=(0,a.NC)("switch to release version tooltip","Switch to Release version of this extension"),this.update()}update(){this.enabled=!(!this.extension||this.extension.isBuiltin||1!==this.extension.state||!this.extension.local?.isPreReleaseVersion||!this.extension.hasReleaseVersion)}run(){var e=this;return(0,u.Z)(function*(){if(e.enabled)return e.commandService.executeCommand(tn.ID,e.extension?.identifier.id)})()}};Ai.ID="workbench.extensions.action.switchToReleaseVersion",Ai.TITLE={value:(0,a.NC)("switch to release version","Switch to Release Version"),original:"Switch to Release Version"},Ai=(0,c.gn)([(0,c.fM)(1,se.H)],Ai);let ht=class eo extends L{constructor(e,t,i,n,r){super(eo.ID,eo.LABEL,L.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=e,this.extensionGalleryService=t,this.quickInputService=i,this.instantiationService=n,this.dialogService=r,this.update()}update(){this.enabled=!(!this.extension||this.extension.isBuiltin||!this.extension.gallery||!this.extension.local||!this.extension.server||1!==this.extension.state||this.extension.deprecationInfo)}run(){var e=this;return(0,u.Z)(function*(){if(!e.enabled)return;const t=yield e.extension.server.extensionManagementService.getTargetPlatform(),i=yield e.extensionGalleryService.getAllCompatibleVersions(e.extension.gallery,e.extension.local.preRelease,t);if(!i.length)return void(yield e.dialogService.info((0,a.NC)("no versions","This extension has no other versions.")));const n=i.map((s,l)=>({id:s.version,label:s.version,description:`${(0,Qt.Z)(new Date(Date.parse(s.date)),!0)}${s.isPreReleaseVersion?` (${(0,a.NC)("pre-release","pre-release")})`:""}${s.version===e.extension.version?` (${(0,a.NC)("current","current")})`:""}`,latest:0===l,ariaLabel:`${s.isPreReleaseVersion?"Pre-Release version":"Release version"} ${s.version}`,isPreReleaseVersion:s.isPreReleaseVersion})),r=yield e.quickInputService.pick(n,{placeHolder:(0,a.NC)("selectVersion","Select Version to Install"),matchOnDetail:!0});if(r){if(e.extension.version===r.id)return;try{r.latest?yield e.extensionsWorkbenchService.install(e.extension,{installPreReleaseVersion:r.isPreReleaseVersion}):yield e.extensionsWorkbenchService.installVersion(e.extension,r.id,{installPreReleaseVersion:r.isPreReleaseVersion})}catch(s){e.instantiationService.createInstance(It,e.extension,r.latest?e.extension.latestVersion:r.id,2,void 0,s).run()}}return null})()}};ht.ID="workbench.extensions.action.install.anotherVersion",ht.LABEL=(0,a.NC)("install another version","Install Another Version..."),ht=(0,c.gn)([(0,c.fM)(0,Y.Wi),(0,c.fM)(1,Ie.Lj),(0,c.fM)(2,we.eJ),(0,c.fM)(3,G.TG),(0,c.fM)(4,Be.Ss)],ht);let qt=class to extends L{constructor(e,t){super(to.ID,to.LABEL,L.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=e,this.extensionEnablementService=t,this.tooltip=(0,a.NC)("enableForWorkspaceActionToolTip","Enable this extension only in this workspace"),this.update()}update(){this.enabled=!1,this.extension&&this.extension.local&&(this.enabled=1===this.extension.state&&!this.extensionEnablementService.isEnabled(this.extension.local)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return e.extensionsWorkbenchService.setEnablement(e.extension,9)})()}};qt.ID="extensions.enableForWorkspace",qt.LABEL=(0,a.NC)("enableForWorkspaceAction","Enable (Workspace)"),qt=(0,c.gn)([(0,c.fM)(0,Y.Wi),(0,c.fM)(1,pe.uI)],qt);let Xt=class io extends L{constructor(e,t){super(io.ID,io.LABEL,L.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=e,this.extensionEnablementService=t,this.tooltip=(0,a.NC)("enableGloballyActionToolTip","Enable this extension"),this.update()}update(){this.enabled=!1,this.extension&&this.extension.local&&(this.enabled=1===this.extension.state&&this.extensionEnablementService.isDisabledGlobally(this.extension.local)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return e.extensionsWorkbenchService.setEnablement(e.extension,8)})()}};Xt.ID="extensions.enableGlobally",Xt.LABEL=(0,a.NC)("enableGloballyAction","Enable"),Xt=(0,c.gn)([(0,c.fM)(0,Y.Wi),(0,c.fM)(1,pe.uI)],Xt);let Jt=class no extends L{constructor(e,t,i,n){super(no.ID,no.LABEL,L.LABEL_ACTION_CLASS),this.workspaceContextService=e,this.extensionsWorkbenchService=t,this.extensionEnablementService=i,this.extensionService=n,this.tooltip=(0,a.NC)("disableForWorkspaceActionToolTip","Disable this extension only in this workspace"),this.update(),this._register(this.extensionService.onDidChangeExtensions(()=>this.update()))}update(){this.enabled=!1,this.extension&&this.extension.local&&this.extensionService.extensions.some(e=>(0,ye.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)&&1!==this.workspaceContextService.getWorkbenchState())&&(this.enabled=1===this.extension.state&&(8===this.extension.enablementState||9===this.extension.enablementState)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return e.extensionsWorkbenchService.setEnablement(e.extension,7)})()}};Jt.ID="extensions.disableForWorkspace",Jt.LABEL=(0,a.NC)("disableForWorkspaceAction","Disable (Workspace)"),Jt=(0,c.gn)([(0,c.fM)(0,be.ec),(0,c.fM)(1,Y.Wi),(0,c.fM)(2,pe.uI),(0,c.fM)(3,re.QS)],Jt);let Yt=class ro extends L{constructor(e,t,i){super(ro.ID,ro.LABEL,L.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=e,this.extensionEnablementService=t,this.extensionService=i,this.tooltip=(0,a.NC)("disableGloballyActionToolTip","Disable this extension"),this.update(),this._register(this.extensionService.onDidChangeExtensions(()=>this.update()))}update(){this.enabled=!1,this.extension&&this.extension.local&&this.extensionService.extensions.some(e=>(0,ye.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier))&&(this.enabled=1===this.extension.state&&(8===this.extension.enablementState||9===this.extension.enablementState)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}run(){var e=this;return(0,u.Z)(function*(){if(e.extension)return e.extensionsWorkbenchService.setEnablement(e.extension,6)})()}};Yt.ID="extensions.disableGlobally",Yt.LABEL=(0,a.NC)("disableGloballyAction","Disable"),Yt=(0,c.gn)([(0,c.fM)(0,Y.Wi),(0,c.fM)(1,pe.uI),(0,c.fM)(2,re.QS)],Yt);let ei=class nn extends L{constructor(e,t){super("extensions.reload",(0,a.NC)("reloadAction","Reload"),nn.DisabledClass,!1),this.hostService=e,this.extensionService=t,this.updateWhenCounterExtensionChanges=!0,this._register(this.extensionService.onDidChangeExtensions(()=>this.update())),this.update()}update(){if(this.enabled=!1,this.tooltip="",!this.extension)return;const e=this.extension.state;if(0===e||2===e||this.extension.local&&this.extension.local.manifest&&this.extension.local.manifest.contributes&&this.extension.local.manifest.contributes.localizations&&this.extension.local.manifest.contributes.localizations.length>0)return;const t=this.extension.reloadRequiredStatus;this.enabled=void 0!==t,this.label=void 0!==t?(0,a.NC)("reload required","Reload Required"):"",this.tooltip=void 0!==t?t:"",this.class=this.enabled?nn.EnabledClass:nn.DisabledClass}run(){return Promise.resolve(this.hostService.reload())}};function Le(o,e){return!!(e&&o.extensionData&&at.kP.equals(o.extensionData.extensionId,e.identifier.id))}function Fn(o,e,t,i){const n=[];for(const r of o)Le(r,t)&&(!i||r!==e)&&n.push({label:r.label,id:r.id});return i&&(n.push({type:"separator",label:(0,a.NC)("current","current")}),n.push({label:e.label,id:e.id})),n}ei.EnabledClass=`${L.LABEL_ACTION_CLASS} reload`,ei.DisabledClass=`${ei.EnabledClass} disabled`,ei=(0,c.gn)([(0,c.fM)(0,Eo.$),(0,c.fM)(1,re.QS)],ei);let Xe=class Bt extends L{constructor(e,t,i,n){super(Bt.ID,Bt.TITLE.value,Bt.DisabledClass,!1),this.workbenchThemeService=t,this.quickInputService=i,this.extensionEnablementService=n,this._register(w.ju.any(e.onDidChangeExtensions,t.onDidColorThemeChange)(()=>this.update(),this)),this.update()}update(){this.workbenchThemeService.getColorThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?Bt.EnabledClass:Bt.DisabledClass})}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>Le(t,this.extension))}run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){var i=this;return(0,u.Z)(function*(){const n=yield i.workbenchThemeService.getColorThemes();if(!i.computeEnablement(n))return;const r=i.workbenchThemeService.getColorTheme(),s=new ne.vp(100),l=Fn(n,r,i.extension,e),d=yield i.quickInputService.pick(l,{placeHolder:(0,a.NC)("select color theme","Select Color Theme"),onDidFocus:h=>s.trigger(()=>i.workbenchThemeService.setColorTheme(h.id,void 0)),ignoreFocusLost:t});return i.workbenchThemeService.setColorTheme(d?d.id:r.id,"auto")})()}};Xe.ID="workbench.extensions.action.setColorTheme",Xe.TITLE={value:(0,a.NC)("workbench.extensions.action.setColorTheme","Set Color Theme"),original:"Set Color Theme"},Xe.EnabledClass=`${L.LABEL_ACTION_CLASS} theme`,Xe.DisabledClass=`${Xe.EnabledClass} disabled`,Xe=(0,c.gn)([(0,c.fM)(0,re.QS),(0,c.fM)(1,ct.Dc),(0,c.fM)(2,we.eJ),(0,c.fM)(3,pe.uI)],Xe);let Je=class Ft extends L{constructor(e,t,i,n){super(Ft.ID,Ft.TITLE.value,Ft.DisabledClass,!1),this.workbenchThemeService=t,this.quickInputService=i,this.extensionEnablementService=n,this._register(w.ju.any(e.onDidChangeExtensions,t.onDidFileIconThemeChange)(()=>this.update(),this)),this.update()}update(){this.workbenchThemeService.getFileIconThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?Ft.EnabledClass:Ft.DisabledClass})}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>Le(t,this.extension))}run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){var i=this;return(0,u.Z)(function*(){const n=yield i.workbenchThemeService.getFileIconThemes();if(!i.computeEnablement(n))return;const r=i.workbenchThemeService.getFileIconTheme(),s=new ne.vp(100),l=Fn(n,r,i.extension,e),d=yield i.quickInputService.pick(l,{placeHolder:(0,a.NC)("select file icon theme","Select File Icon Theme"),onDidFocus:h=>s.trigger(()=>i.workbenchThemeService.setFileIconTheme(h.id,void 0)),ignoreFocusLost:t});return i.workbenchThemeService.setFileIconTheme(d?d.id:r.id,"auto")})()}};Je.ID="workbench.extensions.action.setFileIconTheme",Je.TITLE={value:(0,a.NC)("workbench.extensions.action.setFileIconTheme","Set File Icon Theme"),original:"Set File Icon Theme"},Je.EnabledClass=`${L.LABEL_ACTION_CLASS} theme`,Je.DisabledClass=`${Je.EnabledClass} disabled`,Je=(0,c.gn)([(0,c.fM)(0,re.QS),(0,c.fM)(1,ct.Dc),(0,c.fM)(2,we.eJ),(0,c.fM)(3,pe.uI)],Je);let Ye=class Ot extends L{constructor(e,t,i,n){super(Ot.ID,Ot.TITLE.value,Ot.DisabledClass,!1),this.workbenchThemeService=t,this.quickInputService=i,this.extensionEnablementService=n,this._register(w.ju.any(e.onDidChangeExtensions,t.onDidProductIconThemeChange)(()=>this.update(),this)),this.update()}update(){this.workbenchThemeService.getProductIconThemes().then(e=>{this.enabled=this.computeEnablement(e),this.class=this.enabled?Ot.EnabledClass:Ot.DisabledClass})}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some(t=>Le(t,this.extension))}run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){var i=this;return(0,u.Z)(function*(){const n=yield i.workbenchThemeService.getProductIconThemes();if(!i.computeEnablement(n))return;const r=i.workbenchThemeService.getProductIconTheme(),s=new ne.vp(100),l=Fn(n,r,i.extension,e),d=yield i.quickInputService.pick(l,{placeHolder:(0,a.NC)("select product icon theme","Select Product Icon Theme"),onDidFocus:h=>s.trigger(()=>i.workbenchThemeService.setProductIconTheme(h.id,void 0)),ignoreFocusLost:t});return i.workbenchThemeService.setProductIconTheme(d?d.id:r.id,"auto")})()}};Ye.ID="workbench.extensions.action.setProductIconTheme",Ye.TITLE={value:(0,a.NC)("workbench.extensions.action.setProductIconTheme","Set Product Icon Theme"),original:"Set Product Icon Theme"},Ye.EnabledClass=`${L.LABEL_ACTION_CLASS} theme`,Ye.DisabledClass=`${Ye.EnabledClass} disabled`,Ye=(0,c.gn)([(0,c.fM)(0,re.QS),(0,c.fM)(1,ct.Dc),(0,c.fM)(2,we.eJ),(0,c.fM)(3,pe.uI)],Ye);let ut=class Ht extends L{constructor(e){super(Ht.ID,Ht.TITLE.value,Ht.DisabledClass,!1),this.extensionsWorkbenchService=e,this.update()}update(){this.enabled=!1,this.class=Ht.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&T.dK===(0,Mn.K)(this.extension.gallery)||(this.enabled=!0,this.class=Ht.EnabledClass))}run(){var e=this;return(0,u.Z)(function*(){return e.extension&&e.extensionsWorkbenchService.setLanguage(e.extension)})()}};ut.ID="workbench.extensions.action.setDisplayLanguage",ut.TITLE={value:(0,a.NC)("workbench.extensions.action.setDisplayLanguage","Set Display Language"),original:"Set Display Language"},ut.EnabledClass=`${L.LABEL_ACTION_CLASS} language`,ut.DisabledClass=`${ut.EnabledClass} disabled`,ut=(0,c.gn)([(0,c.fM)(0,Y.Wi)],ut);let mt=class Vt extends L{constructor(e,t){super(Vt.ID,Vt.TITLE.value,Vt.DisabledClass,!1),this.extensionsWorkbenchService=e,this.localeService=t,this.update()}update(){this.enabled=!1,this.class=Vt.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&T.dK!==(0,Mn.K)(this.extension.gallery)||(this.enabled=!0,this.class=Vt.EnabledClass))}run(){var e=this;return(0,u.Z)(function*(){return e.extension&&e.localeService.clearLocalePreference()})()}};mt.ID="workbench.extensions.action.clearLanguage",mt.TITLE={value:(0,a.NC)("workbench.extensions.action.clearLanguage","Clear Display Language"),original:"Clear Display Language"},mt.EnabledClass=`${L.LABEL_ACTION_CLASS} language`,mt.DisabledClass=`${mt.EnabledClass} disabled`,mt=(0,c.gn)([(0,c.fM)(0,Y.Wi),(0,c.fM)(1,ma)],mt);let Pi=class oo extends X.aU{constructor(e,t,i){super(oo.ID,oo.LABEL,void 0,!1),this.paneCompositeService=t,this.extensionWorkbenchService=i,this.extensionId=e}run(){var e=this;return(0,u.Z)(function*(){const i=(yield e.paneCompositeService.openPaneComposite(Y.f3,0,!0))?.getViewPaneContainer();i.search(`@id:${e.extensionId}`),i.focus();const[n]=yield e.extensionWorkbenchService.getExtensions([{id:e.extensionId}],{source:"install-recommendation"},Ct.T.None);return n?e.extensionWorkbenchService.open(n):null})()}};Pi.ID="workbench.extensions.action.showRecommendedExtension",Pi.LABEL=(0,a.NC)("showRecommendedExtension","Show Recommended Extension"),Pi=(0,c.gn)([(0,c.fM)(1,Kt.c),(0,c.fM)(2,Y.Wi)],Pi);let ti=class so extends X.aU{constructor(e,t,i,n){super(so.ID,so.LABEL,void 0,!1),this.paneCompositeService=t,this.instantiationService=i,this.extensionWorkbenchService=n,this.extensionId=e}run(){var e=this;return(0,u.Z)(function*(){const i=(yield e.paneCompositeService.openPaneComposite(Y.f3,0,!0))?.getViewPaneContainer();i.search(`@id:${e.extensionId}`),i.focus();const[n]=yield e.extensionWorkbenchService.getExtensions([{id:e.extensionId}],{source:"install-recommendation"},Ct.T.None);if(n){yield e.extensionWorkbenchService.open(n);try{yield e.extensionWorkbenchService.install(n)}catch(r){e.instantiationService.createInstance(It,n,n.latestVersion,2,void 0,r).run()}}})()}};ti.ID="workbench.extensions.action.installRecommendedExtension",ti.LABEL=(0,a.NC)("installRecommendedExtension","Install Recommended Extension"),ti=(0,c.gn)([(0,c.fM)(1,Kt.c),(0,c.fM)(2,G.TG),(0,c.fM)(3,Y.Wi)],ti);let Ei=class ao extends X.aU{constructor(e,t){super(ao.ID,"Ignore Recommendation"),this.extension=e,this.extensionRecommendationsManagementService=t,this.class=ao.Class,this.tooltip=(0,a.NC)("ignoreExtensionRecommendation","Do not recommend this extension again"),this.enabled=!0}run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!0),Promise.resolve()}};Ei.ID="extensions.ignore",Ei.Class=`${L.LABEL_ACTION_CLASS} ignore`,Ei=(0,c.gn)([(0,c.fM)(1,In)],Ei);let Mi=class lo extends X.aU{constructor(e,t){super(lo.ID,"Undo"),this.extension=e,this.extensionRecommendationsManagementService=t,this.class=lo.Class,this.tooltip=(0,a.NC)("undo","Undo"),this.enabled=!0}run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!1),Promise.resolve()}};Mi.ID="extensions.ignore",Mi.Class=`${L.LABEL_ACTION_CLASS} undo-ignore`,Mi=(0,c.gn)([(0,c.fM)(1,In)],Mi);let Ni=class extends X.aU{constructor(e,t){super("extensions.searchExtensions",(0,a.NC)("search recommendations","Search Extensions"),void 0,!0),this.searchValue=e,this.paneCompositeService=t}run(){var e=this;return(0,u.Z)(function*(){const t=(yield e.paneCompositeService.openPaneComposite(Y.f3,0,!0))?.getViewPaneContainer();t.search(e.searchValue),t.focus()})()}};Ni=(0,c.gn)([(0,c.fM)(1,Kt.c)],Ni);let Li=class extends X.aU{constructor(e,t,i,n,r,s,l,d){super(e,t),this.contextService=i,this.fileService=n,this.textFileService=r,this.editorService=s,this.jsonEditingService=l,this.textModelResolverService=d}openExtensionsFile(e){return this.getOrCreateExtensionsFile(e).then(({created:t,content:i})=>this.getSelectionPosition(i,e,["recommendations"]).then(n=>this.editorService.openEditor({resource:e,options:{pinned:t,selection:n}})),t=>Promise.reject(new Error((0,a.NC)("OpenExtensionsFile.failed","Unable to create 'extensions.json' file inside the '.vscode' folder ({0}).",t))))}openWorkspaceConfigurationFile(e){return this.getOrUpdateWorkspaceConfigurationFile(e).then(t=>this.getSelectionPosition(t.value.toString(),t.resource,["extensions","recommendations"])).then(t=>this.editorService.openEditor({resource:e,options:{selection:t,forceReload:!0}}))}getOrUpdateWorkspaceConfigurationFile(e){return Promise.resolve(this.fileService.readFile(e)).then(t=>{const i=xn.Qc(t.value.toString()).extensions;return i&&i.recommendations?t:this.jsonEditingService.write(e,[{path:["extensions"],value:{recommendations:[]}}],!0).then(()=>this.fileService.readFile(e))})}getSelectionPosition(e,t,i){const n=xn.jv(e),r=xn.SN(n,i);if(r&&r.parent&&r.parent.children){const s=r.parent.children[1],l=s.children&&s.children.length?s.children[s.children.length-1]:null,d=l?l.offset+l.length:s.offset+1;return Promise.resolve(this.textModelResolverService.createModelReference(t)).then(h=>{const f=h.object.textEditorModel.getPositionAt(d);return h.dispose(),{startLineNumber:f.lineNumber,startColumn:f.column,endLineNumber:f.lineNumber,endColumn:f.column}})}return Promise.resolve(void 0)}getOrCreateExtensionsFile(e){return Promise.resolve(this.fileService.readFile(e)).then(t=>({created:!1,extensionsFileResource:e,content:t.value.toString()}),t=>this.textFileService.write(e,Po).then(()=>({created:!0,extensionsFileResource:e,content:Po})))}};Li=(0,c.gn)([(0,c.fM)(2,be.ec),(0,c.fM)(3,Ne.sn),(0,c.fM)(4,Tn.MM),(0,c.fM)(5,Se.AR),(0,c.fM)(6,kn.R),(0,c.fM)(7,xi.S)],Li);let Ri=class extends Li{constructor(e,t,i,n,r,s,l,d){super(e,t,r,i,n,s,l,d),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.update(),this)),this.update()}update(){this.enabled=1!==this.contextService.getWorkbenchState()}run(){switch(this.contextService.getWorkbenchState()){case 2:return this.openExtensionsFile(this.contextService.getWorkspace().folders[0].toResource(Mo));case 3:return this.openWorkspaceConfigurationFile(this.contextService.getWorkspace().configuration)}return Promise.resolve()}};Ri.ID="workbench.extensions.action.configureWorkspaceRecommendedExtensions",Ri.LABEL=(0,a.NC)("configureWorkspaceRecommendedExtensions","Configure Recommended Extensions (Workspace)"),Ri=(0,c.gn)([(0,c.fM)(2,Ne.sn),(0,c.fM)(3,Tn.MM),(0,c.fM)(4,be.ec),(0,c.fM)(5,Se.AR),(0,c.fM)(6,kn.R),(0,c.fM)(7,xi.S)],Ri);let Wi=class extends Li{constructor(e,t,i,n,r,s,l,d,h){super(e,t,r,i,n,s,l,d),this.commandService=h}run(){const t=1===this.contextService.getWorkspace().folders.length?Promise.resolve(this.contextService.getWorkspace().folders[0]):this.commandService.executeCommand(sn.RS);return Promise.resolve(t).then(i=>i?this.openExtensionsFile(i.toResource(Mo)):null)}};Wi.ID="workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions",Wi.LABEL=(0,a.NC)("configureWorkspaceFolderRecommendedExtensions","Configure Recommended Extensions (Workspace Folder)"),Wi=(0,c.gn)([(0,c.fM)(2,Ne.sn),(0,c.fM)(3,Tn.MM),(0,c.fM)(4,be.ec),(0,c.fM)(5,Se.AR),(0,c.fM)(6,kn.R),(0,c.fM)(7,xi.S),(0,c.fM)(8,se.H)],Wi);let ii=class rn extends X.aU{get extension(){return this._extension}set extension(e){this._extension&&e&&(0,ye.Q_)(this._extension.identifier,e.identifier)||(this.initialStatus=null,this.status=null,this.enablementState=null),this._extension=e,this.update()}constructor(e,t,i){super("extensions.action.statusLabel","",rn.DISABLED_CLASS,!1),this.extensionService=e,this.extensionManagementServerService=t,this.extensionEnablementService=i,this.initialStatus=null,this.status=null,this.version=null,this.enablementState=null,this._extension=null}update(){const e=this.computeLabel();this.label=e||"",this.class=e?rn.ENABLED_CLASS:rn.DISABLED_CLASS}computeLabel(){if(!this.extension)return null;const e=this.status,t=this.version,i=this.enablementState;this.status=this.extension.state,this.version=this.extension.version,null===this.initialStatus&&(this.initialStatus=this.status),this.enablementState=this.extension.enablementState;const n=()=>{const s=this.extensionService.extensions.filter(l=>(0,ye.Q_)({id:l.identifier.value,uuid:l.uuid},this.extension.identifier))[0];return!!this.extension.local&&(!(!s||this.extension.version!==s.version)||this.extensionService.canAddExtension((0,re.Br)(this.extension.local)))},r=()=>!!this.extension.local&&(!!this.extensionService.extensions.every(s=>!((0,ye.Q_)({id:s.identifier.value,uuid:s.uuid},this.extension.identifier)&&this.extension.server===this.extensionManagementServerService.getExtensionManagementServer((0,re.IZ)(s))))||this.extensionService.canRemoveExtension((0,re.Br)(this.extension.local)));if(null!==e){if(0===e&&1===this.status)return n()?1===this.initialStatus&&this.version!==t?(0,a.NC)("updated","Updated"):(0,a.NC)("installed","Installed"):null;if(2===e&&3===this.status)return this.initialStatus=this.status,r()?(0,a.NC)("uninstalled","Uninstalled"):null}if(null!==i){const s=this.extensionEnablementService.isEnabledEnablementState(i),l=this.extensionEnablementService.isEnabledEnablementState(this.enablementState);if(!s&&l)return n()?(0,a.NC)("enabled","Enabled"):null;if(s&&!l)return r()?(0,a.NC)("disabled","Disabled"):null}return null}run(){return Promise.resolve()}};ii.ENABLED_CLASS=`${L.TEXT_ACTION_CLASS} extension-status-label`,ii.DISABLED_CLASS=`${ii.ENABLED_CLASS} hide`,ii=(0,c.gn)([(0,c.fM)(0,re.QS),(0,c.fM)(1,pe.ZV),(0,c.fM)(2,pe.uI)],ii);let ni=class on extends Ti{constructor(e,t,i,n){super("extensions.sync","",on.SYNC_CLASS,!1,n),this.configurationService=e,this.extensionsWorkbenchService=t,this.userDataSyncEnablementService=i,this._register(w.ju.filter(this.configurationService.onDidChangeConfiguration,r=>r.affectsConfiguration("settingsSync.ignoredExtensions"))(()=>this.update())),this._register(i.onDidChangeEnablement(()=>this.update())),this.update()}update(){if(this.enabled=!!this.extension&&this.userDataSyncEnablementService.isEnabled()&&1===this.extension.state,this.extension){const e=this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension);this.class=e?on.IGNORED_SYNC_CLASS:on.SYNC_CLASS,this.tooltip=e?(0,a.NC)("ignored","This extension is ignored during sync"):(0,a.NC)("synced","This extension is synced")}}run(){var e=()=>super.run,t=this;return(0,u.Z)(function*(){return e().call(t,{actionGroups:[[new X.aU("extensions.syncignore",t.extensionsWorkbenchService.isExtensionIgnoredToSync(t.extension)?(0,a.NC)("sync","Sync this extension"):(0,a.NC)("do not sync","Do not sync this extension"),void 0,!0,()=>t.extensionsWorkbenchService.toggleExtensionIgnoredToSync(t.extension))]],disposeActionsOnHide:!0})})()}};ni.IGNORED_SYNC_CLASS=`${L.ICON_ACTION_CLASS} extension-sync ${H.kS.asClassName(z.jO)}`,ni.SYNC_CLASS=`${ni.ICON_ACTION_CLASS} extension-sync ${H.kS.asClassName(z.j8)}`,ni=(0,c.gn)([(0,c.fM)(0,ie.Ui),(0,c.fM)(1,Y.Wi),(0,c.fM)(2,An.Ud),(0,c.fM)(3,G.TG)],ni);let On=class vt extends L{get status(){return this._status}constructor(e,t,i,n,r,s,l,d,h,f,v){super("extensions.status","",`${vt.CLASS} hide`,!1),this.extensionManagementServerService=e,this.labelService=t,this.commandService=i,this.workspaceTrustEnablementService=n,this.workspaceTrustService=r,this.extensionsWorkbenchService=s,this.extensionService=l,this.extensionManifestPropertiesService=d,this.contextService=h,this.productService=f,this.workbenchExtensionEnablementService=v,this.updateWhenCounterExtensionChanges=!0,this._onDidChangeStatus=this._register(new w.Q5),this.onDidChangeStatus=this._onDidChangeStatus.event,this.updateThrottler=new ne.eD,this._register(this.labelService.onDidChangeFormatters(()=>this.update(),this)),this._register(this.extensionService.onDidChangeExtensions(()=>this.update())),this.update()}update(){this.updateThrottler.queue(()=>this.computeAndUpdateStatus())}computeAndUpdateStatus(){var e=this;return(0,u.Z)(function*(){if(e.updateStatus(void 0,!0),e.enabled=!1,!e.extension)return;if(e.extension.isMalicious)return void e.updateStatus({icon:z.tO,message:new Q.W5((0,a.NC)("malicious tooltip","This extension was reported to be problematic."))},!0);if(e.extension.deprecationInfo){if(e.extension.deprecationInfo.extension){const n=`[${e.extension.deprecationInfo.extension.displayName}](${N.ov.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([e.extension.deprecationInfo.extension.id]))}`)})`;e.updateStatus({icon:z.tO,message:new Q.W5((0,a.NC)("deprecated with alternate extension tooltip","This extension is deprecated. Use the {0} extension instead.",n))},!0)}else if(e.extension.deprecationInfo.settings){const n=`[${(0,a.NC)("settings","settings")}](${N.ov.parse(`command:workbench.action.openSettings?${encodeURIComponent(JSON.stringify([e.extension.deprecationInfo.settings.map(r=>`@id:${r}`).join(" ")]))}`)})`;e.updateStatus({icon:z.tO,message:new Q.W5((0,a.NC)("deprecated with alternate settings tooltip","This extension is deprecated as this functionality is now built-in to VS Code. Configure these {0} to use this functionality.",n))},!0)}else{const n=new Q.W5((0,a.NC)("deprecated tooltip","This extension is deprecated as it is no longer being maintained."));e.extension.deprecationInfo.additionalInfo&&n.appendMarkdown(` ${e.extension.deprecationInfo.additionalInfo}`),e.updateStatus({icon:z.tO,message:n},!0)}return}if(e.extensionsWorkbenchService.canSetLanguage(e.extension))return;if(e.extension.gallery&&3===e.extension.state&&!(yield e.extensionsWorkbenchService.canInstall(e.extension))){if(e.extensionManagementServerService.localExtensionManagementServer||e.extensionManagementServerService.remoteExtensionManagementServer){const n=yield e.extensionManagementServerService.localExtensionManagementServer?e.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.getTargetPlatform():e.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform(),r=new Q.W5(`${(0,a.NC)("incompatible platform","The '{0}' extension is not available in {1} for {2}.",e.extension.displayName||e.extension.identifier.id,e.productService.nameLong,(0,Ie.nm)(n))} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-platform-specific-extensions)`);return void e.updateStatus({icon:z.tO,message:r},!0)}if(e.extensionManagementServerService.webExtensionManagementServer){const n=(0,a.NC)("VS Code for Web","{0} for the Web",e.productService.nameLong),r=new Q.W5(`${(0,a.NC)("not web tooltip","The '{0}' extension is not available in {1}.",e.extension.displayName||e.extension.identifier.id,n)} [${(0,a.NC)("learn why","Learn Why")}](https://aka.ms/vscode-web-extensions-guide)`);return void e.updateStatus({icon:z.tO,message:r},!0)}}if(!e.extension.local||!e.extension.server||1!==e.extension.state)return;if(2===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("disabled by environment","This extension is disabled by the environment."))},!0);if(3===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("enabled by environment","This extension is enabled because it is required in the current environment."))},!0);if(4===e.extension.enablementState){const n=(0,at.Gd)(e.extension.local.manifest.capabilities?.virtualWorkspaces);return void e.updateStatus({icon:z.DJ,message:new Q.W5(n?(0,Q.p9)(n):(0,a.NC)("disabled because of virtual workspace","This extension has been disabled because it does not support virtual workspaces."))},!0)}if((0,ua.wB)(e.contextService.getWorkspace())){const n=e.extensionManifestPropertiesService.getExtensionVirtualWorkspaceSupportType(e.extension.local.manifest),r=(0,at.Gd)(e.extension.local.manifest.capabilities?.virtualWorkspaces);if("limited"===n||r)return void e.updateStatus({icon:z.tO,message:new Q.W5(r?(0,Q.p9)(r):(0,a.NC)("extension limited because of virtual workspace","This extension has limited features because the current workspace is virtual."))},!0)}if(0===e.extension.enablementState||5===e.extension.enablementState&&e.workbenchExtensionEnablementService.getDependenciesEnablementStates(e.extension.local).every(([,n])=>e.workbenchExtensionEnablementService.isEnabledEnablementState(n)||0===n)){e.enabled=!0;const n=(0,at.Gd)(e.extension.local.manifest.capabilities?.untrustedWorkspaces);return void e.updateStatus({icon:z.$m,message:new Q.W5(n?(0,Q.p9)(n):(0,a.NC)("extension disabled because of trust requirement","This extension has been disabled because the current workspace is not trusted."))},!0)}if(e.workspaceTrustEnablementService.isWorkspaceTrustEnabled()&&!e.workspaceTrustService.isWorkspaceTrusted()){const n=e.extensionManifestPropertiesService.getExtensionUntrustedWorkspaceSupportType(e.extension.local.manifest),r=(0,at.Gd)(e.extension.local.manifest.capabilities?.untrustedWorkspaces);if("limited"===n||r)return e.enabled=!0,void e.updateStatus({icon:z.$m,message:new Q.W5(r?(0,Q.p9)(r):(0,a.NC)("extension limited because of trust requirement","This extension has limited features because the current workspace is not trusted."))},!0)}if(1===e.extension.enablementState&&!e.extensionsWorkbenchService.installed.some(n=>(0,ye.Q_)(n.identifier,e.extension.identifier)&&n.server!==e.extension.server)){let n;return e.extensionManagementServerService.localExtensionManagementServer===e.extension.server?e.extensionManifestPropertiesService.prefersExecuteOnWorkspace(e.extension.local.manifest)&&e.extensionManagementServerService.remoteExtensionManagementServer&&(n=new Q.W5(`${(0,a.NC)("Install in remote server to enable","This extension is disabled in this workspace because it is defined to run in the Remote Extension Host. Please install the extension in '{0}' to enable.",e.extensionManagementServerService.remoteExtensionManagementServer.label)} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)):e.extensionManagementServerService.remoteExtensionManagementServer===e.extension.server?e.extensionManifestPropertiesService.prefersExecuteOnUI(e.extension.local.manifest)&&(e.extensionManagementServerService.localExtensionManagementServer?n=new Q.W5(`${(0,a.NC)("Install in local server to enable","This extension is disabled in this workspace because it is defined to run in the Local Extension Host. Please install the extension locally to enable.",e.extensionManagementServerService.remoteExtensionManagementServer.label)} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`):T.$L&&(n=new Q.W5(`${(0,a.NC)("Defined to run in desktop","This extension is disabled because it is defined to run only in {0} for the Desktop.",e.productService.nameLong)} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`))):e.extensionManagementServerService.webExtensionManagementServer===e.extension.server&&(n=new Q.W5(`${(0,a.NC)("Cannot be enabled","This extension is disabled because it is not supported in {0} for the Web.",e.productService.nameLong)} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)),void(n&&e.updateStatus({icon:z.tO,message:n},!0))}if(e.extensionManagementServerService.remoteExtensionManagementServer){if((0,at.QF)(e.extension.local.manifest)){if(!e.extensionsWorkbenchService.installed.some(s=>(0,ye.Q_)(s.identifier,e.extension.identifier)&&s.server!==e.extension.server)){const s=new Q.W5(e.extension.server===e.extensionManagementServerService.localExtensionManagementServer?(0,a.NC)("Install language pack also in remote server","Install the language pack extension on '{0}' to enable it there also.",e.extensionManagementServerService.remoteExtensionManagementServer.label):(0,a.NC)("Install language pack also locally","Install the language pack extension locally to enable it there also."));e.updateStatus({icon:z.DJ,message:s},!0)}return}const n=e.extensionService.extensions.filter(s=>(0,ye.Q_)({id:s.identifier.value,uuid:s.uuid},e.extension.identifier))[0],r=n?e.extensionManagementServerService.getExtensionManagementServer((0,re.IZ)(n)):null;if(e.extension.server===e.extensionManagementServerService.localExtensionManagementServer&&r===e.extensionManagementServerService.remoteExtensionManagementServer)return void(e.extensionManifestPropertiesService.prefersExecuteOnWorkspace(e.extension.local.manifest)&&e.updateStatus({icon:z.DJ,message:new Q.W5(`${(0,a.NC)("enabled remotely","This extension is enabled in the Remote Extension Host because it prefers to run there.")} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0));if(e.extension.server===e.extensionManagementServerService.remoteExtensionManagementServer&&r===e.extensionManagementServerService.localExtensionManagementServer)return void(e.extensionManifestPropertiesService.prefersExecuteOnUI(e.extension.local.manifest)&&e.updateStatus({icon:z.DJ,message:new Q.W5(`${(0,a.NC)("enabled locally","This extension is enabled in the Local Extension Host because it prefers to run there.")} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0));if(e.extension.server===e.extensionManagementServerService.remoteExtensionManagementServer&&r===e.extensionManagementServerService.webExtensionManagementServer)return void(e.extensionManifestPropertiesService.canExecuteOnWeb(e.extension.local.manifest)&&e.updateStatus({icon:z.DJ,message:new Q.W5(`${(0,a.NC)("enabled in web worker","This extension is enabled in the Web Worker Extension Host because it prefers to run there.")} [${(0,a.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0))}if(5===e.extension.enablementState)return void e.updateStatus({icon:z.tO,message:new Q.W5((0,a.NC)("extension disabled because of dependency","This extension has been disabled because it depends on an extension that is disabled."))},!0);const t=e.workbenchExtensionEnablementService.isEnabled(e.extension.local),i=e.extensionService.extensions.some(n=>(0,ye.Q_)({id:n.identifier.value,uuid:n.uuid},e.extension.identifier));if(t&&i){if(e.extensionManagementServerService.localExtensionManagementServer&&e.extensionManagementServerService.remoteExtensionManagementServer&&e.extension.server===e.extensionManagementServerService.remoteExtensionManagementServer)return void e.updateStatus({message:new Q.W5((0,a.NC)("extension enabled on remote","Extension is enabled on '{0}'",e.extension.server.label))},!0);if(8===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("globally enabled","This extension is enabled globally."))},!0);if(9===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("workspace enabled","This extension is enabled for this workspace by the user."))},!0)}if(!t&&!i){if(6===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("globally disabled","This extension is disabled globally by the user."))},!0);if(7===e.extension.enablementState)return void e.updateStatus({message:new Q.W5((0,a.NC)("workspace disabled","This extension is disabled for this workspace by the user."))},!0)}if(t&&!i&&!e.extension.local.isValid){const n=e.extension.local.validations.filter(([r])=>r===R.zb.Error).map(([,r])=>r);e.updateStatus({icon:z.mb,message:new Q.W5(n.join(" ").trim())},!0)}})()}updateStatus(e,t){this._status!==e&&(this._status&&e&&this._status.message===e.message&&this._status.icon?.id===e.icon?.id||(this._status=e,t&&(this.class=this._status?.icon===z.mb?`${vt.CLASS} extension-status-error ${H.kS.asClassName(z.mb)}`:this._status?.icon===z.tO?`${vt.CLASS} extension-status-warning ${H.kS.asClassName(z.tO)}`:this._status?.icon===z.DJ?`${vt.CLASS} extension-status-info ${H.kS.asClassName(z.DJ)}`:this._status?.icon===z.$m?`${vt.CLASS} ${H.kS.asClassName(z.$m)}`:`${vt.CLASS} hide`),this._onDidChangeStatus.fire()))}run(){var e=this;return(0,u.Z)(function*(){if(e._status?.icon===z.$m)return e.commandService.executeCommand("workbench.trust.manage")})()}};On.CLASS=`${L.ICON_ACTION_CLASS} extension-status`,On=(0,c.gn)([(0,c.fM)(0,pe.ZV),(0,c.fM)(1,ot.e),(0,c.fM)(2,se.H),(0,c.fM)(3,En.ZC),(0,c.fM)(4,En.Y2),(0,c.fM)(5,Y.Wi),(0,c.fM)(6,re.QS),(0,c.fM)(7,Pn),(0,c.fM)(8,be.ec),(0,c.fM)(9,xt.a),(0,c.fM)(10,pe.uI)],On);let Bi=class co extends X.aU{constructor(e=co.ID,t=co.LABEL,i,n,r,s,l,d,h){super(e,t),this.extensionsWorkbenchService=i,this.extensionManagementServerService=n,this.quickInputService=r,this.notificationService=s,this.hostService=l,this.instantiationService=d,this.extensionService=h}get enabled(){return this.extensionsWorkbenchService.local.filter(e=>!e.isBuiltin&&e.local).length>0}run(){return this.quickInputService.pick(this.getEntries(),{placeHolder:(0,a.NC)("selectExtensionToReinstall","Select Extension to Reinstall")}).then(e=>e&&this.reinstallExtension(e.extension))}getEntries(){return this.extensionsWorkbenchService.queryLocal().then(e=>e.filter(i=>!i.isBuiltin&&i.server!==this.extensionManagementServerService.webExtensionManagementServer).map(i=>({id:i.identifier.id,label:i.displayName,description:i.identifier.id,extension:i})))}reinstallExtension(e){return this.instantiationService.createInstance(Ni,"@installed ").run().then(()=>this.extensionsWorkbenchService.reinstall(e).then(t=>{const i=!(t.local&&this.extensionService.canAddExtension((0,re.Br)(t.local))),n=i?(0,a.NC)("ReinstallAction.successReload","Please reload Visual Studio Code to complete reinstalling the extension {0}.",t.identifier.id):(0,a.NC)("ReinstallAction.success","Reinstalling the extension {0} is completed.",t.identifier.id),r=i?[{label:(0,a.NC)("InstallVSIXAction.reloadNow","Reload Now"),run:()=>this.hostService.reload()}]:[];this.notificationService.prompt(R.zb.Info,n,r,{sticky:!0})},t=>this.notificationService.error(t)))}};Bi.ID="workbench.extensions.action.reinstall",Bi.LABEL=(0,a.NC)("reinstall","Reinstall Extension..."),Bi=(0,c.gn)([(0,c.fM)(2,Y.Wi),(0,c.fM)(3,pe.ZV),(0,c.fM)(4,we.eJ),(0,c.fM)(5,R.lT),(0,c.fM)(6,Eo.$),(0,c.fM)(7,G.TG),(0,c.fM)(8,re.QS)],Bi);let Fi=class ho extends X.aU{constructor(e=ho.ID,t=ho.LABEL,i,n,r,s){super(e,t),this.extensionsWorkbenchService=i,this.quickInputService=n,this.instantiationService=r,this.extensionEnablementService=s}get enabled(){return this.extensionsWorkbenchService.local.some(e=>this.isEnabled(e))}run(){var e=this;return(0,u.Z)(function*(){const t=yield e.quickInputService.pick(e.getExtensionEntries(),{placeHolder:(0,a.NC)("selectExtension","Select Extension"),matchOnDetail:!0});if(t&&t.extension){const i=e.instantiationService.createInstance(ht);i.extension=t.extension,yield i.run(),yield e.instantiationService.createInstance(Ni,t.extension.identifier.id).run()}})()}isEnabled(e){const t=this.instantiationService.createInstance(ht);return t.extension=e,t.enabled&&!!e.local&&this.extensionEnablementService.isEnabled(e.local)}getExtensionEntries(){var e=this;return(0,u.Z)(function*(){const t=yield e.extensionsWorkbenchService.queryLocal(),i=[];for(const n of t)e.isEnabled(n)&&i.push({id:n.identifier.id,label:n.displayName||n.identifier.id,description:n.identifier.id,extension:n});return i.sort((n,r)=>n.extension.displayName.localeCompare(r.extension.displayName))})()}};Fi.ID="workbench.extensions.action.install.specificVersion",Fi.LABEL=(0,a.NC)("install previous version","Install Specific Version of Extension..."),Fi=(0,c.gn)([(0,c.fM)(2,Y.Wi),(0,c.fM)(3,we.eJ),(0,c.fM)(4,G.TG),(0,c.fM)(5,pe.uI)],Fi),se.P.registerCommand("workbench.extensions.action.showExtensionsForLanguage",function(o,e){return o.get(Kt.c).openPaneComposite(Y.f3,0,!0).then(i=>i?.getViewPaneContainer()).then(i=>{i.search(`ext:${e.replace(/^\./,"")}`),i.focus()})}),se.P.registerCommand("workbench.extensions.action.showExtensionsWithIds",function(o,e){return o.get(Kt.c).openPaneComposite(Y.f3,0,!0).then(i=>i?.getViewPaneContainer()).then(i=>{const n=e.map(r=>`@id:${r}`).join(" ");i.search(n),i.focus()})}),(0,Z.P6G)("extensionButton.background",{dark:Z.b7$,light:Z.b7$,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonBackground","Button background color for extension actions.")),(0,Z.P6G)("extensionButton.foreground",{dark:Z.j5u,light:Z.j5u,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonForeground","Button foreground color for extension actions.")),(0,Z.P6G)("extensionButton.hoverBackground",{dark:Z.GO4,light:Z.GO4,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonHoverBackground","Button background hover color for extension actions.")),(0,Z.P6G)("extensionButton.separator",{dark:Z.iFQ,light:Z.iFQ,hcDark:Z.iFQ,hcLight:Z.iFQ},(0,a.NC)("extensionButtonSeparator","Button separator color for extension actions")),(0,Z.P6G)("extensionButton.prominentBackground",{dark:Z.b7$,light:Z.b7$,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonProminentBackground","Button background color for extension actions that stand out (e.g. install button).")),(0,Z.P6G)("extensionButton.prominentForeground",{dark:Z.j5u,light:Z.j5u,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonProminentForeground","Button foreground color for extension actions that stand out (e.g. install button).")),(0,Z.P6G)("extensionButton.prominentHoverBackground",{dark:Z.GO4,light:Z.GO4,hcDark:null,hcLight:null},(0,a.NC)("extensionButtonProminentHoverBackground","Button background hover color for extension actions that stand out (e.g. install button).")),(0,me.Ic)((o,e)=>{const t=o.getColor(Z.lXJ);t&&(e.addRule(`.extension-editor .header .actions-status-container > .status ${H.kS.asCSSSelector(z.mb)} { color: ${t}; }`),e.addRule(`.extension-editor .body .subcontent .runtime-status ${H.kS.asCSSSelector(z.mb)} { color: ${t}; }`),e.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${H.kS.asCSSSelector(z.mb)} { color: ${t}; }`));const i=o.getColor(Z.uoC);i&&(e.addRule(`.extension-editor .header .actions-status-container > .status ${H.kS.asCSSSelector(z.tO)} { color: ${i}; }`),e.addRule(`.extension-editor .body .subcontent .runtime-status ${H.kS.asCSSSelector(z.tO)} { color: ${i}; }`),e.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${H.kS.asCSSSelector(z.tO)} { color: ${i}; }`));const n=o.getColor(Z.c63);n&&(e.addRule(`.extension-editor .header .actions-status-container > .status ${H.kS.asCSSSelector(z.DJ)} { color: ${n}; }`),e.addRule(`.extension-editor .body .subcontent .runtime-status ${H.kS.asCSSSelector(z.DJ)} { color: ${n}; }`),e.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${H.kS.asCSSSelector(z.DJ)} { color: ${n}; }`))});let Oi=class{get onConfigChanged(){return this._onConfigChanged.event}constructor(e,t,i,n,r){this._configurationService=e,this._extensionManagementService=t,this._notificationService=i,this._instantiationService=n,this._productService=r,this._linuxDistro=1,this._onConfigChanged=new w.Q5,this._recommendationsShown=!1,this._updateConfig(),this._configurationService.onDidChangeConfiguration(s=>{s.affectsConfiguration(k.H$)&&this._updateConfig()}),T.IJ&&(navigator.userAgent.includes("Ubuntu")?this._linuxDistro=3:navigator.userAgent.includes("Fedora")&&(this._linuxDistro=2))}_updateConfig(){const e=this._configurationService.getValue(k.H$);e.fontWeight=this._normalizeFontWeight(e.fontWeight,k.P3),e.fontWeightBold=this._normalizeFontWeight(e.fontWeightBold,k.rS),this.config=e,this._onConfigChanged.fire()}configFontIsMonospace(){const t=this.config.fontFamily||this._configurationService.getValue("editor").fontFamily||yi.hL.fontFamily,i=this._getBoundingRectFor("i",t,15),n=this._getBoundingRectFor("w",t,15);return!(i&&n&&i.width&&n.width)||i.width===n.width}_createCharMeasureElementIfNecessary(){if(!this.panelContainer)throw new Error("Cannot measure element when terminal is not attached");return(!this._charMeasureElement||!this._charMeasureElement.parentElement)&&(this._charMeasureElement=document.createElement("div"),this.panelContainer.appendChild(this._charMeasureElement)),this._charMeasureElement}_getBoundingRectFor(e,t,i){let n;try{n=this._createCharMeasureElementIfNecessary()}catch{return}const r=n.style;r.display="inline-block",r.fontFamily=t,r.fontSize=i+"px",r.lineHeight="normal",n.innerText=e;const s=n.getBoundingClientRect();return r.display="none",s}_measureFont(e,t,i,n){const r=this._getBoundingRectFor("X",e,t);if(this._lastFontMeasurement&&(!r||!r.width||!r.height))return this._lastFontMeasurement;if(this._lastFontMeasurement={fontFamily:e,fontSize:t,letterSpacing:i,lineHeight:n,charWidth:0,charHeight:0},r&&r.width&&r.height)if(this._lastFontMeasurement.charHeight=Math.ceil(r.height),"off"===this.config.gpuAcceleration)this._lastFontMeasurement.charWidth=r.width;else{const d=(Math.floor(r.width*window.devicePixelRatio)+Math.round(i))/window.devicePixelRatio;this._lastFontMeasurement.charWidth=d-Math.round(i)/window.devicePixelRatio}return this._lastFontMeasurement}getFont(e,t){const i=this._configurationService.getValue("editor");let n=this.config.fontFamily||i.fontFamily||yi.hL.fontFamily,r=this._clampInt(this.config.fontSize,6,100,yi.hL.fontSize);this.config.fontFamily||(2===this._linuxDistro&&(n="'DejaVu Sans Mono'"),3===this._linuxDistro&&(n="'Ubuntu Mono'",r=this._clampInt(r+2,6,100,yi.hL.fontSize))),n+=", monospace";const s=this.config.letterSpacing?Math.max(Math.floor(this.config.letterSpacing),k.f):k.dd,l=this.config.lineHeight?Math.max(this.config.lineHeight,1):k.fr;return t?{fontFamily:n,fontSize:r,letterSpacing:s,lineHeight:l}:e&&e._renderService&&e._renderService.dimensions?.css.cell.width&&e._renderService.dimensions?.css.cell.height?{fontFamily:n,fontSize:r,letterSpacing:s,lineHeight:l,charHeight:e._renderService.dimensions.css.cell.height/l,charWidth:e._renderService.dimensions.css.cell.width-Math.round(s)/window.devicePixelRatio}:this._measureFont(n,r,s,l)}_clampInt(e,t,i,n){let r=parseInt(e,10);return isNaN(r)?n:("number"==typeof t&&(r=Math.max(t,r)),"number"==typeof i&&(r=Math.min(i,r)),r)}showRecommendations(e){var t=this;return(0,u.Z)(function*(){if(!t._recommendationsShown&&(t._recommendationsShown=!0,T.ED&&e.executable&&"wsl.exe"===(0,he.EZ)(e.executable).toLowerCase())){const i=t._productService.exeBasedExtensionTips;if(!i||!i.wsl)return;const n=Object.keys(i.wsl.recommendations).find(r=>i.wsl.recommendations[r].important);n&&!(yield t._isExtensionInstalled(n))&&t._notificationService.prompt(Pe.Z.Info,a.NC("useWslExtension.title","The '{0}' extension is recommended for opening a terminal in WSL.",i.wsl.friendlyName),[{label:a.NC("install","Install"),run:()=>{t._instantiationService.createInstance(ti,n).run()}}],{sticky:!0,neverShowAgain:{id:"terminalConfigHelper/launchRecommendationsIgnore",scope:R.YB.APPLICATION},onCancel:()=>{}})}})()}_isExtensionInstalled(e){var t=this;return(0,u.Z)(function*(){return(yield t._extensionManagementService.getInstalled()).some(n=>n.identifier.id===e)})()}_normalizeFontWeight(e,t){return"normal"===e||"bold"===e?e:this._clampInt(e,k.fc,k.ig,t)}};Oi=(0,c.gn)([(0,c.fM)(0,ie.Ui),(0,c.fM)(1,Ie.J6),(0,c.fM)(2,R.lT),(0,c.fM)(3,G.TG),(0,c.fM)(4,xt.a)],Oi);var ke=p(27741);let Hn=class{constructor(e,t,i,n,r,s){this._terminalProfileService=e,this._terminalProfileResolverService=t,this._configurationService=i,this._quickInputService=n,this._themeService=r,this._notificationService=s}showAndGetResult(e){var t=this;return(0,u.Z)(function*(){const i=yield t._terminalProfileService.getPlatformKey(),n="terminal.integrated.profiles."+i,r=yield t._createAndShow(e),s=`terminal.integrated.defaultProfile.${i}`;if(r){if("setDefault"===e){if("command"in r.profile)return;if("id"in r.profile)return yield t._configurationService.updateValue(s,r.profile.title,2),{config:{extensionIdentifier:r.profile.extensionIdentifier,id:r.profile.id,title:r.profile.title,options:{color:r.profile.color,icon:r.profile.icon}},keyMods:r.keyMods};if("isAutoDetected"in r.profile){const l=yield t._configurationService.getValue(n);if("object"==typeof l){const d={path:r.profile.path};r.profile.args&&(d.args=r.profile.args),l[r.profile.profileName]=d}yield t._configurationService.updateValue(n,l,2)}yield t._configurationService.updateValue(s,r.profileName,2)}else if("createInstance"===e)return"id"in r.profile?{config:{extensionIdentifier:r.profile.extensionIdentifier,id:r.profile.id,title:r.profile.title,options:{icon:r.profile.icon,color:r.profile.color}},keyMods:r.keyMods}:{config:r.profile,keyMods:r.keyMods};return"profileName"in r.profile?r.profile.profileName:r.profile.title}})()}_createAndShow(e){var t=this;return(0,u.Z)(function*(){const i=yield t._terminalProfileService.getPlatformKey(),n=t._terminalProfileService.availableProfiles,r="terminal.integrated.profiles."+i,s=t._terminalProfileService.getDefaultProfileName();let l;const d={placeHolder:"createInstance"===e?a.NC("terminal.integrated.selectProfileToCreate","Select the terminal profile to create"):a.NC("terminal.integrated.chooseDefaultProfile","Select your default terminal profile"),onDidTriggerItemButton:(y=(0,u.Z)(function*(I){if(!(yield t._isProfileSafe(I.item.profile))||"command"in I.item.profile||"id"in I.item.profile)return;const $=t._configurationService.getValue("terminal.integrated.profiles."+i),F=$?Object.keys($):[],V=yield t._quickInputService.input({prompt:a.NC("enterTerminalProfileName","Enter terminal profile name"),value:I.item.profile.profileName,validateInput:(W=(0,u.Z)(function*(q){if(F.includes(q))return a.NC("terminalProfileAlreadyExists","A terminal profile already exists with that name")}),function(te){return W.apply(this,arguments)})});var W;if(!V)return;const O={...$};O[V]={path:I.item.profile.path,args:I.item.profile.args},yield t._configurationService.updateValue(r,O,2)}),function($){return y.apply(this,arguments)}),onKeyMods:y=>l=y},h=[],f=n.filter(y=>!y.isAutoDetected),v=n.filter(y=>y.isAutoDetected);var y;f.length>0&&(h.push({type:"separator",label:a.NC("terminalProfiles","profiles")}),h.push(...t._sortProfileQuickPickItems(f.map(y=>t._createProfileQuickPickItem(y)),s))),h.push({type:"separator",label:a.NC("ICreateContributedTerminalProfileOptions","contributed")});const b=[];for(const y of t._terminalProfileService.contributedProfiles){let I;"string"==typeof y.icon&&(I=y.icon.startsWith("$(")?H.kS.fromString(y.icon):H.kS.fromId(y.icon)),(!I||!(0,ge.Ks)().getIcon(I.id))&&(I=t._terminalProfileResolverService.getDefaultIcon());const $=(0,ae.A5)(y,t._themeService.getColorTheme().type,!0),F=(0,ae.pv)(y),V=[];$&&V.push(...$),F&&V.push(F),b.push({label:`$(${I.id}) ${y.title}`,profile:{extensionIdentifier:y.extensionIdentifier,title:y.title,icon:y.icon,id:y.id,color:y.color},profileName:y.title,iconClasses:V})}b.length>0&&h.push(...t._sortProfileQuickPickItems(b,s)),v.length>0&&(h.push({type:"separator",label:a.NC("terminalProfiles.detected","detected")}),h.push(...t._sortProfileQuickPickItems(v.map(y=>t._createProfileQuickPickItem(y)),s)));const _=(0,ae.m5)(t._themeService.getColorTheme());document.body.appendChild(_);const C=yield t._quickInputService.pick(h,d);if(document.body.removeChild(_),C&&(yield t._isProfileSafe(C.profile)))return l&&(C.keyMods=l),C})()}_isProfileSafe(e){var t=this;return(0,u.Z)(function*(){const i="isUnsafePath"in e&&e.isUnsafePath,n="requiresUnsafePath"in e&&e.requiresUnsafePath;return!i&&!n||(yield new Promise(r=>{const s=[];i&&s.push(e.path),n&&s.push(n),t._notificationService.prompt(R.zb.Warning,a.NC("unsafePathWarning","This terminal profile uses a potentially unsafe path that can be modified by another user: {0}. Are you sure you want to use it?",`"${s.join(",")}"`),[{label:a.NC("yes","Yes"),run:()=>r(!0)},{label:a.NC("cancel","Cancel"),run:()=>r(!1)}]).onDidClose(()=>r(!1))}))})()}_createProfileQuickPickItem(e){const t=[{iconClass:H.kS.asClassName(Rs),tooltip:a.NC("createQuickLaunchProfile","Configure Terminal Profile")}],n=`$(${(e.icon&&H.kS.isThemeIcon(e.icon)?e.icon:E.lA.terminal).id}) ${e.profileName}`,r=e.isFromPath?(0,he.EZ)(e.path):e.path,s=(0,ae.pv)(e),l=[];return s&&l.push(s),e.args?"string"==typeof e.args?{label:n,description:`${e.path} ${e.args}`,profile:e,profileName:e.profileName,buttons:t,iconClasses:l}:{label:n,description:`${r} ${e.args.map(h=>h.includes(" ")?`"${h.replace(/"/g,'\\"')}"`:h).join(" ")}`,profile:e,profileName:e.profileName,buttons:t,iconClasses:l}:{label:n,description:r,profile:e,profileName:e.profileName,buttons:t,iconClasses:l}}_sortProfileQuickPickItems(e,t){return e.sort((i,n)=>n.profileName===t?1:i.profileName===t?-1:i.profileName.localeCompare(n.profileName))}};function Vn(o){const[,e,t]=o.path.split("/");if(!e||!Number.parseInt(t))throw new Error(`Could not parse terminal uri for resource ${o}`);return{workspaceId:e,instanceId:Number.parseInt(t)}}function No(o,e,t){return N.ov.from({scheme:J.lg.vscodeTerminal,path:`/${o}/${e}`,fragment:t||void 0})}function Lo(o){const e=o.dataTransfer?.getData("Terminals");if(e){const t=JSON.parse(e),i=[];for(const n of t)i.push(N.ov.parse(n));return 0===i.length?void 0:i}}function $n(o,e){if(e)for(const t of o)if(t.resource.path===e.path)return t}Hn=(0,c.gn)([(0,c.fM)(0,k.l5),(0,c.fM)(1,k.if),(0,c.fM)(2,ie.Ui),(0,c.fM)(3,we.eJ),(0,c.fM)(4,me.XE),(0,c.fM)(5,R.lT)],Hn);var pa=p(55581),Ro=p(59796),Hi=p(89488);let Ge=class{get isProcessSupportRegistered(){return!!this._processSupportContextKey.get()}get connectionState(){return this._connectionState}get configHelper(){return this._configHelper}get instances(){return this._terminalGroupService.instances.concat(this._terminalEditorService.instances)}getReconnectedTerminals(e){return this._reconnectedTerminals.get(e)}get defaultLocation(){return"editor"===this.configHelper.config.defaultLocation?D.i2.Editor:D.i2.Panel}get activeInstance(){for(const e of this._hostActiveTerminals.values())if(e?.hasFocus)return e;return this._activeInstance}get onDidChangeActiveGroup(){return this._onDidChangeActiveGroup.event}get onDidCreateInstance(){return this._onDidCreateInstance.event}get onDidDisposeInstance(){return this._onDidDisposeInstance.event}get onDidFocusInstance(){return this._onDidFocusInstance.event}get onDidReceiveProcessId(){return this._onDidReceiveProcessId.event}get onDidRequestStartExtensionTerminal(){return this._onDidRequestStartExtensionTerminal.event}get onDidChangeInstanceDimensions(){return this._onDidChangeInstanceDimensions.event}get onDidMaximumDimensionsChange(){return this._onDidMaxiumumDimensionsChange.event}get onDidChangeInstanceCapability(){return this._onDidChangeInstanceCapability.event}get onDidChangeInstances(){return this._onDidChangeInstances.event}get onDidChangeInstanceTitle(){return this._onDidChangeInstanceTitle.event}get onDidChangeInstanceIcon(){return this._onDidChangeInstanceIcon.event}get onDidChangeInstanceColor(){return this._onDidChangeInstanceColor.event}get onDidChangeActiveInstance(){return this._onDidChangeActiveInstance.event}get onDidChangeInstancePrimaryStatus(){return this._onDidChangeInstancePrimaryStatus.event}get onDidInputInstanceData(){return this._onDidInputInstanceData.event}get onDidDisposeGroup(){return this._onDidDisposeGroup.event}get onDidChangeGroups(){return this._onDidChangeGroups.event}get onDidRegisterProcessSupport(){return this._onDidRegisterProcessSupport.event}get onDidChangeConnectionState(){return this._onDidChangeConnectionState.event}constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y,I,$,F){var V=this;this._contextKeyService=e,this._lifecycleService=t,this._logService=i,this._dialogService=n,this._instantiationService=r,this._remoteAgentService=s,this._viewsService=l,this._configurationService=d,this._environmentService=h,this._terminalEditorService=f,this._terminalGroupService=v,this._terminalInstanceService=b,this._editorGroupsService=_,this._terminalProfileService=C,this._extensionService=y,this._notificationService=I,this._workspaceContextService=$,this._commandService=F,this._hostActiveTerminals=new Map,this._escapeSequenceLoggingEnabled=!1,this._isShuttingDown=!1,this._backgroundedTerminalInstances=[],this._backgroundedTerminalDisposables=new Map,this._connectionState=0,this._reconnectedTerminals=new Map,this._onDidChangeActiveGroup=new w.Q5,this._onDidCreateInstance=new w.Q5,this._onDidDisposeInstance=new w.Q5,this._onDidFocusInstance=new w.Q5,this._onDidReceiveProcessId=new w.Q5,this._onDidRequestStartExtensionTerminal=new w.Q5,this._onDidChangeInstanceDimensions=new w.Q5,this._onDidMaxiumumDimensionsChange=new w.Q5,this._onDidChangeInstanceCapability=new w.Q5,this._onDidChangeInstances=new w.Q5,this._onDidChangeInstanceTitle=new w.Q5,this._onDidChangeInstanceIcon=new w.Q5,this._onDidChangeInstanceColor=new w.Q5,this._onDidChangeActiveInstance=new w.Q5,this._onDidChangeInstancePrimaryStatus=new w.Q5,this._onDidInputInstanceData=new w.Q5,this._onDidDisposeGroup=new w.Q5,this._onDidChangeGroups=new w.Q5,this._onDidRegisterProcessSupport=new w.Q5,this._onDidChangeConnectionState=new w.Q5,this._configHelper=this._instantiationService.createInstance(Oi),this.onDidCreateInstance(()=>this._terminalProfileService.refreshAvailableProfiles()),this._forwardInstanceHostEvents(this._terminalGroupService),this._forwardInstanceHostEvents(this._terminalEditorService),this._terminalGroupService.onDidChangeActiveGroup(this._onDidChangeActiveGroup.fire,this._onDidChangeActiveGroup),this._terminalInstanceService.onDidCreateInstance(O=>{O.setEscapeSequenceLogging(this._escapeSequenceLoggingEnabled),this._initInstanceListeners(O),this._onDidCreateInstance.fire(O)}),this._terminalGroupService.onDidChangeActiveInstance(O=>{!O&&!this._isShuttingDown&&this._terminalGroupService.hidePanel(),O?.shellType?this._terminalShellTypeContextKey.set(O.shellType.toString()):O||this._terminalShellTypeContextKey.reset()}),this._handleInstanceContextKeys(),this._terminalShellTypeContextKey=m.r.shellType.bindTo(this._contextKeyService),this._processSupportContextKey=m.r.processSupported.bindTo(this._contextKeyService),this._processSupportContextKey.set(!T.$L||null!==this._remoteAgentService.getConnection()),this._terminalHasBeenCreated=m.r.terminalHasBeenCreated.bindTo(this._contextKeyService),this._terminalCountContextKey=m.r.count.bindTo(this._contextKeyService),this._terminalEditorActive=m.r.terminalEditorActive.bindTo(this._contextKeyService),this.onDidChangeActiveInstance(O=>{this._terminalEditorActive.set(!!O?.target&&O.target===D.i2.Editor)}),t.onBeforeShutdown(function(){var O=(0,u.Z)(function*(W){return W.veto(V._onBeforeShutdown(W.reason),"veto.terminal")});return function(W){return O.apply(this,arguments)}}()),t.onWillShutdown(O=>this._onWillShutdown(O)),this.initializePrimaryBackend(),(0,ne.Vs)(0).then(()=>this._instantiationService.createInstance(Gn,document.head))}showProfileQuickPick(e,t){var i=this;return(0,u.Z)(function*(){const r=yield i._instantiationService.createInstance(Hn).showAndGetResult(e);if(!r||"string"==typeof r)return;const s=r.keyMods;if("createInstance"===e){const l=i.getDefaultInstanceHost().activeInstance;let d;if(r.config&&"id"in r?.config)return void(yield i.createContributedTerminalProfile(r.config.extensionIdentifier,r.config.id,{icon:r.config.options?.icon,color:r.config.options?.color,location:s?.alt&&l?{splitActiveTerminal:!0}:i.defaultLocation}));if(r.config&&"profileName"in r.config&&(d=s?.alt&&l?yield i.createTerminal({location:{parentTerminal:l},config:r.config,cwd:t}):yield i.createTerminal({location:i.defaultLocation,config:r.config,cwd:t})),d&&i.defaultLocation!==D.i2.Editor)return i._terminalGroupService.showPanel(!0),i.setActiveInstance(d),d}})()}initializePrimaryBackend(){var e=this;return(0,u.Z)(function*(){e._primaryBackend=yield e._terminalInstanceService.getBackend(e._environmentService.remoteAuthority);const t=e.configHelper.config.enablePersistentSessions;e._connectionState=0,e._environmentService.remoteAuthority&&t?e._reconnectToRemoteTerminals().then(()=>e._setConnected()):t?e._reconnectToLocalTerminals().then(()=>e._setConnected()):Promise.resolve().then(()=>e._setConnected()),e._primaryBackend?.onDidRequestDetach(function(){var n=(0,u.Z)(function*(r){const s=e.getInstanceFromResource(No(r.workspaceId,r.instanceId));if(s){const l=s?.persistentProcessId;!l||s.shellLaunchConfig.isFeatureTerminal||s.shellLaunchConfig.customPtyImplementation?yield e._primaryBackend?.acceptDetachInstanceReply(r.requestId,void 0):(s.target===D.i2.Editor?e._terminalEditorService.detachInstance(s):e._terminalGroupService.getGroupForInstance(s)?.removeInstance(s),yield s.detachProcessAndDispose(D._x.User),yield e._primaryBackend?.acceptDetachInstanceReply(r.requestId,l))}});return function(r){return n.apply(this,arguments)}}())})()}getPrimaryBackend(){return this._primaryBackend}_forwardInstanceHostEvents(e){e.onDidChangeInstances(this._onDidChangeInstances.fire,this._onDidChangeInstances),e.onDidDisposeInstance(this._onDidDisposeInstance.fire,this._onDidDisposeInstance),e.onDidChangeActiveInstance(t=>this._evaluateActiveInstance(e,t)),e.onDidFocusInstance(t=>{this._onDidFocusInstance.fire(t),this._evaluateActiveInstance(e,t)}),e.onDidChangeInstanceCapability(t=>{this._onDidChangeInstanceCapability.fire(t)}),this._hostActiveTerminals.set(e,void 0)}_evaluateActiveInstance(e,t){if(this._hostActiveTerminals.set(e,t),void 0===t)for(const i of this._hostActiveTerminals.values())i&&(t=i);this._activeInstance=t,this._onDidChangeActiveInstance.fire(t)}setActiveInstance(e){e.shellLaunchConfig.hideFromUser&&this._showBackgroundTerminal(e),e.target===D.i2.Editor?this._terminalEditorService.setActiveInstance(e):this._terminalGroupService.setActiveInstance(e)}focusActiveInstance(){var e=this;return(0,u.Z)(function*(){if(e._activeInstance)return e._activeInstance.target===D.i2.Editor?e._terminalEditorService.focusActiveInstance():e._terminalGroupService.focusActiveInstance()})()}createContributedTerminalProfile(e,t,i){var n=this;return(0,u.Z)(function*(){yield n._extensionService.activateByEvent(`onTerminalProfile:${t}`);const r=n._terminalProfileService.getContributedProfileProvider(e,t);if(r)try{yield r.createContributedTerminalProfile(i),n._terminalGroupService.setActiveInstanceByIndex(n._terminalGroupService.instances.length-1),yield n._terminalGroupService.activeInstance?.focusWhenReady()}catch(s){n._notificationService.error(s.message)}else n._notificationService.error(`No terminal profile provider registered for id "${t}"`)})()}safeDisposeTerminal(e){var t=this;return(0,u.Z)(function*(){if(e.target===D.i2.Editor||!e.hasChildProcesses||"panel"!==t.configHelper.config.confirmOnKill&&"always"!==t.configHelper.config.confirmOnKill||!(yield t._showTerminalCloseConfirmation(!0)))return new Promise(i=>{e.onExit(()=>i()),e.dispose(D._x.User)})})()}_setConnected(){this._connectionState=1,this._onDidChangeConnectionState.fire(),this._logService.trace("Reconnected to terminals")}_reconnectToRemoteTerminals(){var e=this;return(0,u.Z)(function*(){const t=e._environmentService.remoteAuthority;if(!t)return;const i=yield e._terminalInstanceService.getBackend(t);if(!i)return;const n=yield i.getTerminalLayoutInfo();i.reduceConnectionGraceTime(),yield e._recreateTerminalGroups(n),e._attachProcessLayoutListeners()})()}_reconnectToLocalTerminals(){var e=this;return(0,u.Z)(function*(){const t=yield e._terminalInstanceService.getBackend();if(!t)return;const i=yield t.getTerminalLayoutInfo();i&&i.tabs.length>0&&(yield e._recreateTerminalGroups(i)),e._attachProcessLayoutListeners()})()}_recreateTerminalGroups(e){var t=this;return(0,u.Z)(function*(){let n,i=0;if(e){for(const r of e.tabs){const s=r.terminals.filter(l=>l.terminal&&l.terminal.isOrphan);if(s.length){let l,d;i+=s.length;for(const f of s)3!==t._lifecycleService.startupKind&&"Task"===f.terminal?.type||(l?l=yield t.createTerminal({config:{attachPersistentProcess:f.terminal},location:{parentTerminal:l}}):(l=yield t.createTerminal({config:{attachPersistentProcess:f.terminal},location:D.i2.Panel}),d=t._terminalGroupService.getGroupForInstance(l),r.isActive&&(n=d)));const h=t.instances.find(f=>f.shellLaunchConfig.attachPersistentProcess?.id===r.activePersistentProcessId);h&&t.setActiveInstance(h),d?.resizePanes(r.terminals.map(f=>f.relativeSize))}}e.tabs.length&&(t._terminalGroupService.activeGroup=n)}return i})()}toggleEscapeSequenceLogging(){var e=this;return(0,u.Z)(function*(){if(0!==e.instances.length){e._escapeSequenceLoggingEnabled=yield e.instances[0].toggleEscapeSequenceLogging();for(let t=1;t<e.instances.length;t++)e.instances[t].setEscapeSequenceLogging(e._escapeSequenceLoggingEnabled);yield e._toggleDevTools(e._escapeSequenceLoggingEnabled)}})()}_attachProcessLayoutListeners(){this.onDidChangeActiveGroup(()=>this._saveState()),this.onDidChangeActiveInstance(()=>this._saveState()),this.onDidChangeInstances(()=>this._saveState()),this.onDidReceiveProcessId(()=>this._saveState()),this.onDidChangeInstanceTitle(e=>this._updateTitle(e)),this.onDidChangeInstanceIcon(e=>this._updateIcon(e.instance,e.userInitiated))}_handleInstanceContextKeys(){const e=m.r.isOpen.bindTo(this._contextKeyService),t=()=>{e.set(this.instances.length>0),this._terminalCountContextKey.set(this.instances.length)};this.onDidChangeInstances(()=>t())}getActiveOrCreateInstance(e){var t=this;return(0,u.Z)(function*(){const i=t.activeInstance;if(!i)return t.createTerminal();if(!e?.acceptsInput||!0!==i.xterm?.isStdinDisabled)return i;const n=yield t.createTerminal();return t.setActiveInstance(n),yield t.revealActiveTerminal(),n})()}revealActiveTerminal(){var e=this;return(0,u.Z)(function*(){const t=e.activeInstance;t&&(t.target===D.i2.Editor?yield e._terminalEditorService.revealActiveEditor():yield e._terminalGroupService.showPanel())})()}setEditable(e,t){this._editable=t?{instance:e,data:t}:void 0;const i=this._viewsService.getActiveViewWithId(k.e9),n=this.isEditable(e);i?.terminalTabbedView?.setEditable(n)}isEditable(e){return!(!this._editable||this._editable.instance!==e&&e)}getEditableData(e){return this._editable&&this._editable.instance===e?this._editable.data:void 0}requestStartExtensionTerminal(e,t,i){return new Promise(n=>{this._onDidRequestStartExtensionTerminal.fire({proxy:e,cols:t,rows:i,callback:n})})}_onBeforeShutdown(e){return T.$L?(this._isShuttingDown=!0,!1):this._onBeforeShutdownAsync(e)}_onBeforeShutdownAsync(e){var t=this;return(0,u.Z)(function*(){if(0===t.instances.length)return!1;try{if(t._shutdownWindowCount=yield t._nativeDelegate?.getWindowCount(),t._shouldReviveProcesses(e)&&(yield Promise.race([t._primaryBackend?.persistTerminalState(),(0,ne.Vs)(2e3)])),(!t._configHelper.config.enablePersistentSessions||3!==e)&&("always"===t.configHelper.config.confirmOnExit&&t.instances.length>0||"hasChildProcesses"===t.configHelper.config.confirmOnExit&&t.instances.some(s=>s.hasChildProcesses)))return t._onBeforeShutdownConfirmation(e)}catch(i){t._logService.warn("Exception occurred during terminal shutdown",i)}return t._isShuttingDown=!0,!1})()}setNativeDelegate(e){this._nativeDelegate=e}_toggleDevTools(e){var t=this;return(0,u.Z)(function*(){e?t._nativeDelegate?.openDevTools():t._nativeDelegate?.toggleDevTools()})()}_shouldReviveProcesses(e){if(!this._configHelper.config.enablePersistentSessions)return!1;switch(this.configHelper.config.persistentSessionReviveProcess){case"onExit":return 1===e&&1===this._shutdownWindowCount&&!T.dz||4===e||2===e;case"onExitAndWindowClose":return 3!==e;default:return!1}}_onBeforeShutdownConfirmation(e){var t=this;return(0,u.Z)(function*(){const i=yield t._showTerminalCloseConfirmation();return i||(t._isShuttingDown=!0),i})()}_onWillShutdown(e){const t=this._configHelper.config.enablePersistentSessions&&3===e.reason;for(const i of[...this._terminalGroupService.instances,...this._backgroundedTerminalInstances])t&&i.shouldPersist?i.detachProcessAndDispose(D._x.Shutdown):i.dispose(D._x.Shutdown);!t&&!this._shouldReviveProcesses(e.reason)&&this._primaryBackend?.setTerminalLayoutInfo(void 0)}_saveState(){if(this._isShuttingDown||!this.configHelper.config.enablePersistentSessions)return;const t={tabs:this._terminalGroupService.groups.map(i=>i.getLayoutInfo(i===this._terminalGroupService.activeGroup))};this._primaryBackend?.setTerminalLayoutInfo(t)}_updateTitle(e){!this.configHelper.config.enablePersistentSessions||!e||!e.persistentProcessId||!e.title||e.isDisposed||(e.staticTitle?this._primaryBackend?.updateTitle(e.persistentProcessId,e.staticTitle,D.ev.Api):this._primaryBackend?.updateTitle(e.persistentProcessId,e.title,e.titleSource))}_updateIcon(e,t){!this.configHelper.config.enablePersistentSessions||!e||!e.persistentProcessId||!e.icon||e.isDisposed||this._primaryBackend?.updateIcon(e.persistentProcessId,t,e.icon,e.color)}refreshActiveGroup(){this._onDidChangeActiveGroup.fire(this._terminalGroupService.activeGroup)}getInstanceFromId(e){let t=-1;if(this._backgroundedTerminalInstances.forEach((i,n)=>{i.instanceId===e&&(t=n)}),-1!==t)return this._backgroundedTerminalInstances[t];try{return this.instances[this._getIndexFromId(e)]}catch{return}}getInstanceFromIndex(e){return this.instances[e]}getInstanceFromResource(e){return $n(this.instances,e)}isAttachedToTerminal(e){return this.instances.some(t=>t.processId===e.pid)}moveToEditor(e){if(e.target===D.i2.Editor)return;const t=this._terminalGroupService.getGroupForInstance(e);t&&(t.removeInstance(e),this._terminalEditorService.openEditor(e))}moveToTerminalView(e,t,i){var n=this;return(0,u.Z)(function*(){if(N.ov.isUri(e)&&(e=n.getInstanceFromResource(e)),!e)return;if(n._terminalEditorService.detachInstance(e),e.target!==D.i2.Editor)return void(yield n._terminalGroupService.showPanel(!0));let r;if(e.target=D.i2.Panel,t&&(r=n._terminalGroupService.getGroupForInstance(t)),r||(r=n._terminalGroupService.createGroup()),r.addInstance(e),n.setActiveInstance(e),yield n._terminalGroupService.showPanel(!0),t&&i){const s=r.terminalInstances.indexOf(t)+("after"===i?1:0);r.moveInstance(e,s)}n._onDidChangeInstances.fire(),n._onDidChangeActiveGroup.fire(n._terminalGroupService.activeGroup)})()}_initInstanceListeners(e){var t=this;const i=[e.onTitleChanged(this._onDidChangeInstanceTitle.fire,this._onDidChangeInstanceTitle),e.onIconChanged(this._onDidChangeInstanceIcon.fire,this._onDidChangeInstanceIcon),e.onIconChanged(this._onDidChangeInstanceColor.fire,this._onDidChangeInstanceColor),e.onProcessIdReady(this._onDidReceiveProcessId.fire,this._onDidReceiveProcessId),e.statusList.onDidChangePrimaryStatus(()=>this._onDidChangeInstancePrimaryStatus.fire(e)),e.onDimensionsChanged(()=>{this._onDidChangeInstanceDimensions.fire(e),this.configHelper.config.enablePersistentSessions&&this.isProcessSupportRegistered&&this._saveState()}),e.onMaximumDimensionsChanged(()=>this._onDidMaxiumumDimensionsChange.fire(e)),e.onDidInputData(this._onDidInputInstanceData.fire,this._onDidInputInstanceData),e.onDidFocus(this._onDidChangeActiveInstance.fire,this._onDidChangeActiveInstance),e.onRequestAddInstanceToGroup(function(){var n=(0,u.Z)(function*(r){return yield t._addInstanceToGroup(e,r)});return function(r){return n.apply(this,arguments)}}())];e.onDisposed(()=>(0,A.B9)(i))}_addInstanceToGroup(e,t){var i=this;return(0,u.Z)(function*(){const n=Vn(t.uri);if(void 0===n.instanceId)return;let r=i.getInstanceFromResource(t.uri);if(!r){const s=yield i._primaryBackend?.requestDetachInstance(n.workspaceId,n.instanceId);if(s)return r=yield i.createTerminal({config:{attachPersistentProcess:s},resource:t.uri}),void i._terminalGroupService.moveInstance(r,e,t.side)}r=i._terminalGroupService.getInstanceFromResource(t.uri),r?i._terminalGroupService.moveInstance(r,e,t.side):(r=i._terminalEditorService.getInstanceFromResource(t.uri),r&&i.moveToTerminalView(r,e,t.side))})()}registerProcessSupport(e){e&&(this._processSupportContextKey.set(e),this._onDidRegisterProcessSupport.fire())}_getIndexFromId(e){let t=-1;if(this.instances.forEach((i,n)=>{i.instanceId===e&&(t=n)}),-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}_showTerminalCloseConfirmation(e){var t=this;return(0,u.Z)(function*(){let i;i=1===t.instances.length||e?a.NC("terminalService.terminalCloseConfirmationSingular","Do you want to terminate the active terminal session?"):a.NC("terminalService.terminalCloseConfirmationPlural","Do you want to terminate the {0} active terminal sessions?",t.instances.length);const{confirmed:n}=yield t._dialogService.confirm({type:"warning",message:i,primaryButton:a.NC({key:"terminate",comment:["&& denotes a mnemonic"]},"&&Terminate")});return!n})()}getDefaultInstanceHost(){return this.defaultLocation===D.i2.Editor?this._terminalEditorService:this._terminalGroupService}getInstanceHost(e){if(e){if(e===D.i2.Editor)return this._terminalEditorService;if("object"!=typeof e)return this._terminalGroupService;if("viewColumn"in e)return this._terminalEditorService;if("parentTerminal"in e)return e.parentTerminal.target===D.i2.Editor?this._terminalEditorService:this._terminalGroupService}return this}createTerminal(e){var t=this;return(0,u.Z)(function*(){if(0===t._terminalProfileService.availableProfiles.length){const h=e?.config&&"customPtyImplementation"in e.config,f=t._remoteAgentService.getConnection()&&N.ov.isUri(e?.cwd)&&e?.cwd.scheme===J.lg.vscodeFileResource;!h&&!f&&(yield t._terminalProfileService.profilesReady)}const i=e?.config||t._terminalProfileService.getDefaultProfile(),n=i&&"extensionIdentifier"in i?{}:t._terminalInstanceService.convertProfileToShellLaunchConfig(i||{});let r=i&&"extensionIdentifier"in i?i:void 0;!r&&(!e||!e.config)&&(r=yield t._terminalProfileService.getContributedDefaultProfile(n));const s="object"==typeof e?.location&&"splitActiveTerminal"in e.location?e.location.splitActiveTerminal:"object"==typeof e?.location&&"parentTerminal"in e.location;if(yield t._resolveCwd(n,s,e),r){const h=t.resolveLocation(e?.location);let f;f=s?h===D.i2.Editor?{viewColumn:Se.O3}:{splitActiveTerminal:!0}:"object"==typeof e?.location&&"viewColumn"in e.location?e.location:h,yield t.createContributedTerminalProfile(r.extensionIdentifier,r.id,{icon:r.icon,color:r.color,location:f});const v=h===D.i2.Editor?t._terminalEditorService:t._terminalGroupService,b=v.instances[v.instances.length-1];return yield b.focusWhenReady(),t._terminalHasBeenCreated.set(!0),b}if(!n.customPtyImplementation&&!t.isProcessSupportRegistered)throw new Error("Could not create terminal when process support is not registered");if(n.hideFromUser){const h=t._terminalInstanceService.createInstance(n,D.i2.Panel);return t._backgroundedTerminalInstances.push(h),t._backgroundedTerminalDisposables.set(h.instanceId,[h.onDisposed(t._onDidDisposeInstance.fire,t._onDidDisposeInstance)]),t._terminalHasBeenCreated.set(!0),h}t._evaluateLocalCwd(n);const l=t.resolveLocation(e?.location)||t.defaultLocation,d=t._getSplitParent(e?.location);return t._terminalHasBeenCreated.set(!0),d?t._splitTerminal(n,l,d):t._createTerminal(n,l,e)})()}_resolveCwd(e,t,i){var n=this;return(0,u.Z)(function*(){if(!e.cwd)if(i?.cwd)e.cwd=i.cwd;else if(t&&i?.location){let s=n.activeInstance;if("object"==typeof i.location&&"parentTerminal"in i.location&&(s=i.location.parentTerminal),!s)throw new Error("Cannot split without an active instance");e.cwd=yield Co(n.configHelper,s,n._workspaceContextService.getWorkspace().folders,n._commandService)}})()}_splitTerminal(e,t,i){let n;if("object"!=typeof e.cwd&&"object"==typeof i.shellLaunchConfig.cwd&&(e.cwd=N.ov.from({scheme:i.shellLaunchConfig.cwd.scheme,authority:i.shellLaunchConfig.cwd.authority,path:e.cwd||i.shellLaunchConfig.cwd.path})),t===D.i2.Editor||i.target===D.i2.Editor)n=this._terminalEditorService.splitInstance(i,e);else{const r=this._terminalGroupService.getGroupForInstance(i);if(!r)throw new Error(`Cannot split a terminal without a group ${i}`);e.parentTerminalId=i.instanceId,n=r.split(e)}return this._addToReconnected(n),n}_addToReconnected(e){if(!e.reconnectionProperties?.ownerId)return;const t=this._reconnectedTerminals.get(e.reconnectionProperties.ownerId);t?t.push(e):this._reconnectedTerminals.set(e.reconnectionProperties.ownerId,[e])}_createTerminal(e,t,i){let n;const r=this._getEditorOptions(i?.location);return t===D.i2.Editor?(n=this._terminalInstanceService.createInstance(e,D.i2.Editor),this._terminalEditorService.openEditor(n,r)):n=this._terminalGroupService.createGroup(e).terminalInstances[0],this._addToReconnected(n),n}resolveLocation(e){if(e&&"object"==typeof e){if("parentTerminal"in e)return e.parentTerminal.target?e.parentTerminal.target:D.i2.Panel;if("viewColumn"in e)return D.i2.Editor;if("splitActiveTerminal"in e)return this._activeInstance?.target?this._activeInstance?.target:D.i2.Panel}return e}_getSplitParent(e){return e&&"object"==typeof e&&"parentTerminal"in e?e.parentTerminal:e&&"object"==typeof e&&"splitActiveTerminal"in e?this.activeInstance:void 0}_getEditorOptions(e){if(e&&"object"==typeof e&&"viewColumn"in e)return e.viewColumn=(0,pa.G)(this._editorGroupsService,this._configurationService,e.viewColumn),e}_evaluateLocalCwd(e){"string"!=typeof e.cwd&&e.cwd?.scheme===J.lg.file&&(Ue.iN.getValue(this._contextKeyService)?(e.initialText=Ze(a.NC("localTerminalVirtualWorkspace","This shell is open to a {0}local{1} folder, NOT to the virtual folder","\x1b[3m","\x1b[23m"),{excludeLeadingNewLine:!0,loudFormatting:!0}),e.type="Local"):this._remoteAgentService.getConnection()&&(e.initialText=Ze(a.NC("localTerminalRemote","This shell is running on your {0}local{1} machine, NOT on the connected remote machine","\x1b[3m","\x1b[23m"),{excludeLeadingNewLine:!0,loudFormatting:!0}),e.type="Local"))}_showBackgroundTerminal(e){this._backgroundedTerminalInstances.splice(this._backgroundedTerminalInstances.indexOf(e),1);const t=this._backgroundedTerminalDisposables.get(e.instanceId);t&&(0,A.B9)(t),this._backgroundedTerminalDisposables.delete(e.instanceId),e.shellLaunchConfig.hideFromUser=!1,this._terminalGroupService.createGroup(e),1===this.instances.length&&this._terminalGroupService.setActiveInstanceByIndex(0),this._onDidChangeInstances.fire(),this._onDidChangeGroups.fire()}setContainers(e,t){var i=this;return(0,u.Z)(function*(){i._configHelper.panelContainer=e,i._terminalGroupService.setContainer(t)})()}getEditingTerminal(){return this._editingTerminal}setEditingTerminal(e){this._editingTerminal=e}};Ge.__decorator=(0,c.gn)([(0,ve.Ds)(500)],Ge.prototype,"_saveState",null),Ge.__decorator=(0,c.gn)([(0,ve.Ds)(500)],Ge.prototype,"_updateTitle",null),Ge.__decorator=(0,c.gn)([(0,ve.Ds)(500)],Ge.prototype,"_updateIcon",null),Ge=(0,c.gn)([(0,c.fM)(0,g.i6),(0,c.fM)(1,Hi.g),(0,c.fM)(2,De.VZ),(0,c.fM)(3,Be.Ss),(0,c.fM)(4,G.TG),(0,c.fM)(5,Oe.R),(0,c.fM)(6,Me.qC),(0,c.fM)(7,ie.Ui),(0,c.fM)(8,St.n),(0,c.fM)(9,M.BZ),(0,c.fM)(10,M.Qy),(0,c.fM)(11,M.N4),(0,c.fM)(12,Ro.Qw),(0,c.fM)(13,k.l5),(0,c.fM)(14,re.QS),(0,c.fM)(15,R.lT),(0,c.fM)(16,be.ec),(0,c.fM)(17,se.H)],Ge);let Gn=class extends me.bB{constructor(e,t,i,n,r){super(i),this._terminalService=t,this._themeService=i,this._terminalProfileService=n,this._editorService=r,this._registerListeners(),this._styleElement=document.createElement("style"),e.appendChild(this._styleElement),this._register((0,A.OF)(()=>e.removeChild(this._styleElement))),this.updateStyles()}_registerListeners(){this._register(this._terminalService.onDidChangeInstanceIcon(()=>this.updateStyles())),this._register(this._terminalService.onDidChangeInstanceColor(()=>this.updateStyles())),this._register(this._terminalService.onDidCreateInstance(()=>this.updateStyles())),this._register(this._editorService.onDidActiveEditorChange(()=>{this._editorService.activeEditor instanceof ke.S&&this.updateStyles()})),this._register(this._editorService.onDidCloseEditor(()=>{this._editorService.activeEditor instanceof ke.S&&this.updateStyles()})),this._register(this._terminalProfileService.onDidChangeAvailableProfiles(()=>this.updateStyles()))}updateStyles(){super.updateStyles();const e=this._themeService.getColorTheme();let t="";const i=this._themeService.getProductIconTheme();for(const r of this._terminalService.instances){const s=r.icon;if(!s)continue;let l;s instanceof N.ov?l=s:s instanceof Object&&"light"in s&&"dark"in s&&(l=e.type===mo.eL.LIGHT?s.light:s.dark);const d=(0,ae.A5)(r,e.type);if(l instanceof N.ov&&d&&d.length>1&&(t+=`.monaco-workbench .terminal-tab.${d[0]}::before{background-image: ${S.wY(l)};}`),H.kS.isThemeIcon(s)){const f=(0,ge.Ks)().getIcon(s.id);if(f){const v=i.getIcon(f);v&&(t+=`.monaco-workbench .terminal-tab.codicon-${s.id}::before{content: '${v.fontCharacter}' !important; font-family: ${S._h(v.font?.id??"codicon")} !important;}`)}}}const n=e.getColor(Z.XZx);n&&(t+=`.monaco-workbench .show-file-icons .file-icon.terminal-tab::before { color: ${n}; }`),t+=(0,ae.Ip)(e,!0),this._styleElement.textContent=t}};Gn=(0,c.gn)([(0,c.fM)(1,M.x4),(0,c.fM)(2,me.XE),(0,c.fM)(3,k.l5),(0,c.fM)(4,Se.AR)],Gn);var va=p(24041);let zn=class extends A.JT{constructor(e,t,i,n,r,s){super(),this._editorService=e,this._editorGroupsService=t,this._terminalInstanceService=i,this._instantiationService=n,this.instances=[],this._activeInstanceIndex=-1,this._isShuttingDown=!1,this._editorInputs=new Map,this._instanceDisposables=new Map,this._onDidDisposeInstance=new w.Q5,this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=new w.Q5,this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeInstanceCapability=new w.Q5,this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDidChangeActiveInstance=new w.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onDidChangeInstances=new w.Q5,this.onDidChangeInstances=this._onDidChangeInstances.event,this._terminalEditorActive=m.r.terminalEditorActive.bindTo(s),this._register((0,A.OF)(()=>{for(const l of this._instanceDisposables.values())(0,A.B9)(l)})),this._register(r.onWillShutdown(()=>this._isShuttingDown=!0)),this._register(this._editorService.onDidActiveEditorChange(()=>{const l=this._editorService.activeEditor,d=l instanceof ke.S?l?.terminalInstance:void 0,h=!!d&&l instanceof ke.S;if(this._terminalEditorActive.set(h),h)l?.setGroup(this._editorService.activeEditorPane?.group),this.setActiveInstance(d);else for(const f of this.instances)f.resetFocusContextKey()})),this._register(this._editorService.onDidVisibleEditorsChange(()=>{const l=this.instances.map(f=>f.instanceId),h=this._getActiveTerminalEditors().find(f=>{const v=f instanceof ke.S?f.terminalInstance?.instanceId:void 0;return void 0!==v&&!l.includes(v)});h instanceof ke.S&&h.terminalInstance&&(this._editorInputs.set(h.terminalInstance.resource.path,h),this.instances.push(h.terminalInstance))})),this._register(this._editorService.onDidCloseEditor(l=>{const d=l.editor instanceof ke.S?l.editor.terminalInstance:void 0;if(d){const h=this.instances.findIndex(f=>f===d);if(-1!==h){const f=this.instances[h]===this.activeInstance;this._removeInstance(d),f&&this.setActiveInstance(void 0)}}}))}_getActiveTerminalEditors(){return this._editorService.visibleEditors.filter(e=>e instanceof ke.S&&e.terminalInstance?.instanceId)}get activeInstance(){if(0!==this.instances.length&&-1!==this._activeInstanceIndex)return this.instances[this._activeInstanceIndex]}setActiveInstance(e){this._activeInstanceIndex=e?this.instances.findIndex(t=>t===e):-1,this._onDidChangeActiveInstance.fire(this.activeInstance)}focusActiveInstance(){var e=this;return(0,u.Z)(function*(){return e.activeInstance?.focusWhenReady(!0)})()}openEditor(e,t){var i=this;return(0,u.Z)(function*(){const n=i.resolveResource(e);n&&(yield i._activeOpenEditorRequest?.promise,i._activeOpenEditorRequest={instanceId:e.instanceId,promise:i._editorService.openEditor({resource:n,description:e.description||e.shellLaunchConfig.type,options:{pinned:!0,forceReload:!0,preserveFocus:t?.preserveFocus}},t?.viewColumn??Se.LP)},yield i._activeOpenEditorRequest?.promise,i._activeOpenEditorRequest=void 0)})()}resolveResource(e){const t=e.resource,i=t.path,n=this._editorInputs.get(i);if(n)return n.resource;e.target=D.i2.Editor;const r=this._instantiationService.createInstance(ke.S,t,e);return this._registerInstance(i,r,e),r.resource}getInputFromResource(e){const t=this._editorInputs.get(e.path);if(!t)throw new Error(`Could not get input from resource: ${e.path}`);return t}_registerInstance(e,t,i){this._editorInputs.set(e,t),this._instanceDisposables.set(e,[i.onDidFocus(this._onDidFocusInstance.fire,this._onDidFocusInstance),i.onDisposed(this._onDidDisposeInstance.fire,this._onDidDisposeInstance),i.capabilities.onDidAddCapability(()=>this._onDidChangeInstanceCapability.fire(i)),i.capabilities.onDidRemoveCapability(()=>this._onDidChangeInstanceCapability.fire(i))]),this.instances.push(i),this._onDidChangeInstances.fire()}_removeInstance(e){const t=e.resource.path;this._editorInputs.delete(t);const i=this.instances.findIndex(r=>r===e);-1!==i&&this.instances.splice(i,1);const n=this._instanceDisposables.get(t);this._instanceDisposables.delete(t),n&&(0,A.B9)(n),this._onDidChangeInstances.fire()}getInstanceFromResource(e){return $n(this.instances,e)}splitInstance(e,t={}){if(e.target===D.i2.Editor){const r=this._editorInputs.get(e.resource.path)?.group;r&&this._editorGroupsService.activateGroup(r)}const i=this._terminalInstanceService.createInstance(t,D.i2.Editor),n=this.resolveResource(i);return n&&this._editorService.openEditor({resource:N.ov.revive(n),description:i.description,options:{pinned:!0,forceReload:!0}},Se.O3),i}reviveInput(e){if("pid"in e){const t={...e,findRevivedId:!0},i=this._terminalInstanceService.createInstance({attachPersistentProcess:t},D.i2.Editor),n=this._instantiationService.createInstance(ke.S,i.resource,i);return this._registerInstance(i.resource.path,n,i),n}throw new Error(`Could not revive terminal editor input, ${e}`)}detachInstance(e){const i=this._editorInputs.get(e.resource.path);i?.detachInstance(),this._removeInstance(e),this._isShuttingDown||i?.dispose()}revealActiveEditor(e){var t=this;return(0,u.Z)(function*(){const i=t.activeInstance;if(!i||t._activeOpenEditorRequest?.instanceId===i.instanceId)return;const n=t._editorInputs.get(i.resource.path);t._editorService.openEditor(n,{pinned:!0,forceReload:!0,preserveFocus:e,activation:va.kn.PRESERVE})})()}};zn=(0,c.gn)([(0,c.fM)(0,Se.AR),(0,c.fM)(1,Ro.Qw),(0,c.fM)(2,M.N4),(0,c.fM)(3,G.TG),(0,c.fM)(4,Hi.g),(0,c.fM)(5,g.i6)],zn);var Pt=p(27034),Vi=p(94401),_a=p(29773);let Zn=class extends A.JT{get onDidChange(){return this._onDidChange}constructor(e,t,i){super(),this._container=e,this.orientation=t,this._layoutService=i,this._splitViewDisposables=this._register(new A.SL),this._children=[],this._terminalToPane=new Map,this._onDidChange=w.ju.None,this._width=this._container.offsetWidth,this._height=this._container.offsetHeight,this._createSplitView(),this._splitView.layout(1===this.orientation?this._width:this._height)}_createSplitView(){this._splitView=new Pt.z(this._container,{orientation:this.orientation}),this._splitViewDisposables.clear(),this._splitViewDisposables.add(this._splitView.onDidSashReset(()=>this._splitView.distributeViewSizes()))}split(e,t){this._addChild(e,t)}resizePane(e,t,i,n){const r=0===t||1===t;if(r&&1!==this.orientation||!r&&0!==this.orientation)return(1===this.orientation&&3===t||0===this.orientation&&1===t)&&(i*=-1),void this._layoutService.resizePart(n,i,i);if(this._children.length<=1)return;const s=[];for(let h=0;h<this._splitView.length;h++)s.push(this._splitView.getViewSize(h));const l=e!==this._children.length-1,d=l?e+1:e-1;(l&&0===t||!l&&1===t||l&&2===t||!l&&3===t)&&(i*=-1),s[e]+i<80?i=80-s[e]:s[d]-i<80&&(i=s[d]-80),s[e]+=i,s[d]-=i;for(let h=0;h<this._splitView.length-1;h++)this._splitView.resizeView(h,s[h])}resizePanes(e){if(this._children.length<=1)return;e[e.length-1]+=1-e.reduce((i,n)=>i+n,0);let t=0;for(let i=0;i<this._splitView.length;i++)t+=this._splitView.getViewSize(i);for(let i=0;i<this._splitView.length;i++)this._splitView.resizeView(i,t*e[i])}getPaneSize(e){const t=this._terminalToPane.get(e);if(!t)return 0;const i=this._children.indexOf(t);return this._splitView.getViewSize(i)}_addChild(e,t){const i=new ba(e,1===this.orientation?this._height:this._width);i.orientation=this.orientation,"number"==typeof t?this._children.splice(t,0,i):this._children.push(i),this._terminalToPane.set(e,this._children[this._children.indexOf(i)]),this._withDisabledLayout(()=>this._splitView.addView(i,Pt.M.Distribute,t)),this.layout(this._width,this._height),this._onDidChange=w.ju.any(...this._children.map(n=>n.onDidChange))}remove(e){let t=null;for(let i=0;i<this._children.length;i++)this._children[i].instance===e&&(t=i);null!==t&&(this._children.splice(t,1),this._terminalToPane.delete(e),this._splitView.removeView(t,Pt.M.Distribute),e.detachFromElement())}layout(e,t){this._width=e,this._height=t,1===this.orientation?(this._children.forEach(i=>i.orthogonalLayout(t)),this._splitView.layout(e)):(this._children.forEach(i=>i.orthogonalLayout(e)),this._splitView.layout(t))}setOrientation(e){if(this.orientation!==e){for(this.orientation=e;this._container.children.length>0;)this._container.removeChild(this._container.children[0]);this._splitViewDisposables.clear(),this._splitView.dispose(),this._createSplitView(),this._withDisabledLayout(()=>{this._children.forEach(t=>{t.orientation=e,this._splitView.addView(t,1)})})}}_withDisabledLayout(e){this._children.forEach(t=>t.instance.disableLayout=!0),e(),this._children.forEach(t=>t.instance.disableLayout=!1)}};Zn=(0,c.gn)([(0,c.fM)(2,Vi.z)],Zn);class ba{get onDidChange(){return this._onDidChange}constructor(e,t){this.instance=e,this.orthogonalSize=t,this.minimumSize=80,this.maximumSize=Number.MAX_VALUE,this._onDidChange=w.ju.None,this.element=document.createElement("div"),this.element.className="terminal-split-pane",this.instance.attachToElement(this.element)}layout(e){!e||!this.orthogonalSize||this.instance.layout(0===this.orientation?{width:this.orthogonalSize,height:e}:{width:e,height:this.orthogonalSize})}orthogonalLayout(e){this.orthogonalSize=e}}let Un=class extends A.JT{get terminalInstances(){return this._terminalInstances}constructor(e,t,i,n,r,s,l){super(),this._container=e,this._terminalService=i,this._terminalInstanceService=n,this._layoutService=r,this._viewDescriptorService=s,this._instantiationService=l,this._terminalInstances=[],this._panelPosition=2,this._terminalLocation=1,this._instanceDisposables=new Map,this._activeInstanceIndex=-1,this._onDidDisposeInstance=this._register(new w.Q5),this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=this._register(new w.Q5),this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeInstanceCapability=this._register(new w.Q5),this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDisposed=this._register(new w.Q5),this.onDisposed=this._onDisposed.event,this._onInstancesChanged=this._register(new w.Q5),this.onInstancesChanged=this._onInstancesChanged.event,this._onDidChangeActiveInstance=new w.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onPanelOrientationChanged=new w.Q5,this.onPanelOrientationChanged=this._onPanelOrientationChanged.event,t&&this.addInstance(t),this._container&&this.attachToElement(this._container),this._onPanelOrientationChanged.fire(1===this._terminalLocation&&2===this._panelPosition?1:0)}addInstance(e,t){let i;const n=t?this._terminalInstances.findIndex(r=>r.instanceId===t):this._activeInstanceIndex;i="instanceId"in e?e:this._terminalInstanceService.createInstance(e,D.i2.Panel),0===this._terminalInstances.length?(this._terminalInstances.push(i),this._activeInstanceIndex=0):this._terminalInstances.splice(n+1,0,i),this._initInstanceListeners(i),this._splitPaneContainer&&this._splitPaneContainer.split(i,n+1),this._onInstancesChanged.fire()}dispose(){super.dispose(),this._container&&this._groupElement&&(this._container.removeChild(this._groupElement),this._groupElement=void 0),this._terminalInstances=[],this._onInstancesChanged.fire()}get activeInstance(){if(0!==this._terminalInstances.length)return this._terminalInstances[this._activeInstanceIndex]}getLayoutInfo(e){const t=this.terminalInstances.filter(n=>"number"==typeof n.persistentProcessId&&n.shouldPersist),i=t.map(n=>this._splitPaneContainer?.getPaneSize(n)||0).reduce((n,r)=>n+r,0);return{isActive:e,activePersistentProcessId:this.activeInstance?this.activeInstance.persistentProcessId:void 0,terminals:t.map(n=>({relativeSize:i>0?this._splitPaneContainer.getPaneSize(n)/i:0,terminal:n.persistentProcessId||0}))}}_initInstanceListeners(e){this._instanceDisposables.set(e.instanceId,[e.onDisposed(t=>{this._onDidDisposeInstance.fire(t),this._handleOnDidDisposeInstance(t)}),e.onDidFocus(t=>{this._setActiveInstance(t),this._onDidFocusInstance.fire(t)}),e.capabilities.onDidAddCapability(()=>this._onDidChangeInstanceCapability.fire(e)),e.capabilities.onDidRemoveCapability(()=>this._onDidChangeInstanceCapability.fire(e))])}_handleOnDidDisposeInstance(e){this._removeInstance(e)}removeInstance(e){this._removeInstance(e);const t=this._instanceDisposables.get(e.instanceId);t&&((0,A.B9)(t),this._instanceDisposables.delete(e.instanceId))}_removeInstance(e){const t=this._terminalInstances.indexOf(e);if(-1===t)return;const i=e===this.activeInstance;this._terminalInstances.splice(t,1),i&&this._terminalInstances.length>0?(this.setActiveInstanceByIndex(t<this._terminalInstances.length?t:this._terminalInstances.length-1),this.activeInstance?.focus(!0)):t<this._activeInstanceIndex&&this._activeInstanceIndex--,this._splitPaneContainer?.remove(e),0===this._terminalInstances.length?(this._onDisposed.fire(this),this.dispose()):this._onInstancesChanged.fire()}moveInstance(e,t){const i=this.terminalInstances.indexOf(e);-1!==i&&(this._terminalInstances.splice(i,1),this._terminalInstances.splice(t,0,e),this._splitPaneContainer&&(this._splitPaneContainer.remove(e),this._splitPaneContainer.split(e,t)),this._onInstancesChanged.fire())}_setActiveInstance(e){this.setActiveInstanceByIndex(this._getIndexFromId(e.instanceId))}_getIndexFromId(e){let t=-1;if(this.terminalInstances.forEach((i,n)=>{i.instanceId===e&&(t=n)}),-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}setActiveInstanceByIndex(e,t){if(e<0||e>=this._terminalInstances.length)return;const i=this.activeInstance;this._activeInstanceIndex=e,(i!==this.activeInstance||t)&&(this._onInstancesChanged.fire(),this._onDidChangeActiveInstance.fire(this.activeInstance))}attachToElement(e){this._container=e,this._groupElement||(this._groupElement=document.createElement("div"),this._groupElement.classList.add("terminal-group")),this._container.appendChild(this._groupElement),this._splitPaneContainer||(this._panelPosition=this._layoutService.getPanelPosition(),this._terminalLocation=this._viewDescriptorService.getViewLocationById(k.e9),this._splitPaneContainer=this._instantiationService.createInstance(Zn,this._groupElement,1===this._terminalLocation&&2===this._panelPosition?1:0),this.terminalInstances.forEach(i=>this._splitPaneContainer.split(i,this._activeInstanceIndex+1)),this._initialRelativeSizes&&(this.resizePanes(this._initialRelativeSizes),this._initialRelativeSizes=void 0))}get title(){if(0===this._terminalInstances.length)return"";let e=this.terminalInstances[0].title+this._getBellTitle(this.terminalInstances[0]);this.terminalInstances[0].description&&(e+=` (${this.terminalInstances[0].description})`);for(let t=1;t<this.terminalInstances.length;t++){const i=this.terminalInstances[t];i.title&&(e+=`, ${i.title+this._getBellTitle(i)}`,i.description&&(e+=` (${i.description})`))}return e}_getBellTitle(e){return this._terminalService.configHelper.config.enableBell&&e.statusList.statuses.some(t=>"bell"===t.id)?"*":""}setVisible(e){this._groupElement&&(this._groupElement.style.display=e?"":"none"),this.terminalInstances.forEach(t=>t.setVisible(e))}split(e){const t=this._terminalInstanceService.createInstance(e,D.i2.Panel);return this.addInstance(t,e.parentTerminalId),this._setActiveInstance(t),t}addDisposable(e){this._register(e)}layout(e,t){if(this._splitPaneContainer){const i=this._layoutService.getPanelPosition(),n=this._viewDescriptorService.getViewLocationById(k.e9);i===this._panelPosition&&n===this._terminalLocation||(this._splitPaneContainer.setOrientation(1===n&&2===i?1:0),this._panelPosition=i,this._terminalLocation=n,this._onPanelOrientationChanged.fire(this._splitPaneContainer.orientation)),this._splitPaneContainer.layout(e,t)}}focusPreviousPane(){this.setActiveInstanceByIndex(0===this._activeInstanceIndex?this._terminalInstances.length-1:this._activeInstanceIndex-1)}focusNextPane(){this.setActiveInstanceByIndex(this._activeInstanceIndex===this._terminalInstances.length-1?0:this._activeInstanceIndex+1)}resizePane(e){if(!this._splitPaneContainer)return;const t=0===e||1===e,i=this._terminalService.configHelper.getFont(),n=t?i.charWidth:i.charHeight;n&&this._splitPaneContainer.resizePane(this._activeInstanceIndex,e,4*n,(0,_a.L)(this._terminalLocation))}resizePanes(e){this._splitPaneContainer?this._splitPaneContainer.resizePanes(e):this._initialRelativeSizes=e}};Un=(0,c.gn)([(0,c.fM)(2,M.x4),(0,c.fM)(3,M.N4),(0,c.fM)(4,Vi.z),(0,c.fM)(5,Me.XH),(0,c.fM)(6,G.TG)],Un);let Kn=class extends A.JT{get instances(){return this.groups.reduce((e,t)=>e.concat(t.terminalInstances),[])}constructor(e,t,i,n,r){super(),this._contextKeyService=e,this._instantiationService=t,this._viewsService=i,this._viewDescriptorService=n,this._configurationService=r,this.groups=[],this.activeGroupIndex=-1,this._onDidChangeActiveGroup=new w.Q5,this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidDisposeGroup=new w.Q5,this.onDidDisposeGroup=this._onDidDisposeGroup.event,this._onDidChangeGroups=new w.Q5,this.onDidChangeGroups=this._onDidChangeGroups.event,this._onDidShow=new w.Q5,this.onDidShow=this._onDidShow.event,this._onDidDisposeInstance=new w.Q5,this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=new w.Q5,this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeActiveInstance=new w.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onDidChangeInstances=new w.Q5,this.onDidChangeInstances=this._onDidChangeInstances.event,this._onDidChangeInstanceCapability=new w.Q5,this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDidChangePanelOrientation=new w.Q5,this.onDidChangePanelOrientation=this._onDidChangePanelOrientation.event,this.onDidDisposeGroup(s=>this._removeGroup(s)),this._terminalGroupCountContextKey=m.r.groupCount.bindTo(this._contextKeyService),this.onDidChangeGroups(()=>this._terminalGroupCountContextKey.set(this.groups.length)),w.ju.any(this.onDidChangeActiveGroup,this.onDidChangeInstances)(()=>this.updateVisibility())}hidePanel(){const e=this._viewDescriptorService.getViewContainerByViewId(k.e9);e&&1===this._viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length&&(this._viewsService.closeView(k.e9),m.r.tabsMouse.bindTo(this._contextKeyService).set(!1))}showTabs(){this._configurationService.updateValue("terminal.integrated.tabs.enabled",!0)}get activeGroup(){if(!(this.activeGroupIndex<0||this.activeGroupIndex>=this.groups.length))return this.groups[this.activeGroupIndex]}set activeGroup(e){if(void 0===e)return;const t=this.groups.findIndex(i=>i===e);this.setActiveGroupByIndex(t)}get activeInstance(){return this.activeGroup?.activeInstance}setActiveInstance(e){this.setActiveInstanceByIndex(this._getIndexFromId(e.instanceId))}_getIndexFromId(e){const t=this.instances.findIndex(i=>i.instanceId===e);if(-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}setContainer(e){this._container=e,this.groups.forEach(t=>t.attachToElement(e))}focusTabs(){var e=this;return(0,u.Z)(function*(){0!==e.instances.length&&(yield e.showPanel(!0),e._viewsService.getActiveViewWithId(k.e9)?.terminalTabbedView?.focusTabs())})()}focusHover(){var e=this;return(0,u.Z)(function*(){0!==e.instances.length&&e._viewsService.getActiveViewWithId(k.e9)?.terminalTabbedView?.focusHover()})()}focusActiveInstance(){var e=this;return(0,u.Z)(function*(){return e.showPanel(!0)})()}createGroup(e){const t=this._instantiationService.createInstance(Un,this._container,e);return t.onPanelOrientationChanged(i=>this._onDidChangePanelOrientation.fire(i)),this.groups.push(t),t.addDisposable(t.onDidDisposeInstance(this._onDidDisposeInstance.fire,this._onDidDisposeInstance)),t.addDisposable(t.onDidFocusInstance(this._onDidFocusInstance.fire,this._onDidFocusInstance)),t.addDisposable(t.onDidChangeActiveInstance(i=>{t===this.activeGroup&&this._onDidChangeActiveInstance.fire(i)})),t.addDisposable(t.onDidChangeInstanceCapability(this._onDidChangeInstanceCapability.fire,this._onDidChangeInstanceCapability)),t.addDisposable(t.onInstancesChanged(this._onDidChangeInstances.fire,this._onDidChangeInstances)),t.addDisposable(t.onDisposed(this._onDidDisposeGroup.fire,this._onDidDisposeGroup)),t.terminalInstances.length>0&&this._onDidChangeInstances.fire(),1===this.instances.length&&this.setActiveInstanceByIndex(0),this._onDidChangeGroups.fire(),t}showPanel(e){var t=this;return(0,u.Z)(function*(){const i=t._viewsService.getActiveViewWithId(k.e9)??(yield t._viewsService.openView(k.e9,e));if(i?.setExpanded(!0),e){yield(0,ne.Vs)(0);const n=t.activeInstance;n&&(i&&!i.isVisible()&&(yield t._viewsService.openView(k.e9,e)),yield n.focusWhenReady(!0))}t._onDidShow.fire()})()}getInstanceFromResource(e){return $n(this.instances,e)}_removeGroup(e){const i=e===this.activeGroup,n=this.groups.indexOf(e);-1!==n&&(this.groups.splice(n,1),this._onDidChangeGroups.fire()),i?this.groups.length>0&&(this.setActiveGroupByIndex(n<this.groups.length?n:this.groups.length-1,!0),this.activeInstance?.focus(!0)):this.activeGroupIndex>n&&this.setActiveGroupByIndex(this.activeGroupIndex-1),this.activeGroupIndex>=this.groups.length&&this.setActiveGroupByIndex(this.groups.length-1),this._onDidChangeInstances.fire(),this._onDidChangeGroups.fire(),i&&(this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance))}setActiveGroupByIndex(e,t){if(-1===e&&0===this.groups.length)return void(-1!==this.activeGroupIndex&&(this.activeGroupIndex=-1,this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance)));if(e<0||e>=this.groups.length)return;const i=this.activeGroup;this.activeGroupIndex=e,(t||i!==this.activeGroup)&&(this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance))}_getInstanceLocation(e){let t=0;for(;e>=0&&t<this.groups.length;){const i=this.groups[t],n=i.terminalInstances.length;if(e<n)return{group:i,groupIndex:t,instance:i.terminalInstances[e],instanceIndex:e};e-=n,t++}}setActiveInstanceByIndex(e){const t=this.activeInstance,i=this._getInstanceLocation(e),n=i?.group.terminalInstances[i.instanceIndex];if(!i||t===n)return;const r=i.instanceIndex;this.activeGroupIndex=i.groupIndex,this._onDidChangeActiveGroup.fire(this.activeGroup),i.group.setActiveInstanceByIndex(r,!0)}setActiveGroupToNext(){if(this.groups.length<=1)return;let e=this.activeGroupIndex+1;e>=this.groups.length&&(e=0),this.setActiveGroupByIndex(e)}setActiveGroupToPrevious(){if(this.groups.length<=1)return;let e=this.activeGroupIndex-1;e<0&&(e=this.groups.length-1),this.setActiveGroupByIndex(e)}moveGroup(e,t){const i=this.getGroupForInstance(e),n=this.getGroupForInstance(t);if(!i||!n)return;if(i===n){const l=i.terminalInstances.indexOf(t);return void(-1!==l&&i.moveInstance(e,l))}const r=this.groups.indexOf(i),s=this.groups.indexOf(n);this.groups.splice(r,1),this.groups.splice(s,0,i),this._onDidChangeInstances.fire()}moveGroupToEnd(e){const t=this.getGroupForInstance(e);if(!t)return;const i=this.groups.indexOf(t);this.groups.splice(i,1),this.groups.push(t),this._onDidChangeInstances.fire()}moveInstance(e,t,i){const n=this.getGroupForInstance(e),r=this.getGroupForInstance(t);if(!n||!r)return;n!==r&&(n.removeInstance(e),r.addInstance(e));const s=r.terminalInstances.indexOf(t)+("after"===i?1:0);r.moveInstance(e,s)}unsplitInstance(e){const t=this.getGroupForInstance(e);!t||t.terminalInstances.length<2||(t.removeInstance(e),this.createGroup(e))}joinInstances(e){const t=this.getGroupForInstance(e[0]);if(t){let s=!0;for(let l=1;l<t.terminalInstances.length;l++)if(t.terminalInstances.includes(e[l])){s=!1;break}if(!s)return}let i,n;for(const s of e){const l=this.getGroupForInstance(s);if(1===l?.terminalInstances.length){i=s,n=l;break}}n||(n=this.createGroup());const r=this.activeGroup===n;for(const s of e){if(s===i)continue;const l=this.getGroupForInstance(s);l&&(l.removeInstance(s),n.addInstance(s))}this.setActiveInstance(e[0]),this._onDidChangeInstances.fire(),r||this._onDidChangeActiveGroup.fire(this.activeGroup)}instanceIsSplit(e){const t=this.getGroupForInstance(e);return!!t&&t.terminalInstances.length>1}getGroupForInstance(e){return this.groups.find(t=>t.terminalInstances.includes(e))}getGroupLabels(){return this.groups.filter(e=>e.terminalInstances.length>0).map((e,t)=>`${t+1}: ${e.title?e.title:""}`)}updateVisibility(){const e=this._viewsService.isViewVisible(k.e9);this.groups.forEach((t,i)=>t.setVisible(e&&i===this.activeGroupIndex))}};Kn=(0,c.gn)([(0,c.fM)(0,g.i6),(0,c.fM)(1,G.TG),(0,c.fM)(2,Me.qC),(0,c.fM)(3,Me.XH),(0,c.fM)(4,ie.Ui)],Kn);var Wo=p(37781),Et=p(30106),Bo=p(6262),wa=p(53683),Sa=p(74486),Ca=p(63672),Re=p(69476),ya=p(49052),ri=p(53091);class Fo extends A.JT{constructor(){super(...arguments),this._map=new Map,this._onDidRemoveCapability=this._register(new w.Q5),this.onDidRemoveCapability=this._onDidRemoveCapability.event,this._onDidAddCapability=this._register(new w.Q5),this.onDidAddCapability=this._onDidAddCapability.event}get items(){return this._map.keys()}add(e,t){this._map.set(e,t),this._onDidAddCapability.fire(e)}get(e){return this._map.get(e)}remove(e){this._map.has(e)&&(this._map.delete(e),this._onDidRemoveCapability.fire(e))}has(e){return this._map.has(e)}}class xa extends A.JT{constructor(){super(...arguments),this._stores=[],this._onDidRemoveCapability=this._register(new w.Q5),this.onDidRemoveCapability=this._onDidRemoveCapability.event,this._onDidAddCapability=this._register(new w.Q5),this.onDidAddCapability=this._onDidAddCapability.event}get items(){return this._items()}*_items(){for(const e of this._stores)for(const t of e.items)yield t}has(e){for(const t of this._stores)for(const i of t.items)if(i===e)return!0;return!1}get(e){for(const t of this._stores){const i=t.get(e);if(i)return i}}add(e){this._stores.push(e);for(const t of e.items)this._onDidAddCapability.fire(t);e.onDidAddCapability(t=>this._onDidAddCapability.fire(t)),e.onDidRemoveCapability(t=>this._onDidRemoveCapability.fire(t))}}var Ia=p(52105);class ka{constructor(e){this._process=e,this.type=1,this._cwd="",this._onDidChangeCwd=new w.Q5,this.onDidChangeCwd=this._onDidChangeCwd.event}getCwd(){var e=this;return(0,u.Z)(function*(){if(!e._process)return Promise.resolve("");const t=yield e._process.getCwd();return t!==e._cwd&&e._onDidChangeCwd.fire(t),e._cwd=t,e._cwd})()}}class Ta{constructor(e,t){this._totalDataLength=0,this._entries=[{cols:e,rows:t,data:[]}]}handleResize(e,t){if(this._entries.length>0&&0===this._entries[this._entries.length-1].data.length&&this._entries.pop(),this._entries.length>0){const i=this._entries[this._entries.length-1];if(i.cols===e&&i.rows===t)return;if(0===i.cols&&0===i.rows)return i.cols=e,void(i.rows=t)}this._entries.push({cols:e,rows:t,data:[]})}handleData(e){for(this._entries[this._entries.length-1].data.push(e),this._totalDataLength+=e.length;this._totalDataLength>1048576;){const i=this._entries[0],n=this._totalDataLength-1048576;n>=i.data[0].length?(this._totalDataLength-=i.data[0].length,i.data.shift(),0===i.data.length&&this._entries.shift()):(i.data[0]=i.data[0].substr(n),this._totalDataLength-=n)}}generateReplayEventSync(){return this._entries.forEach(e=>{e.data.length>0&&(e.data=[e.data.join("")])}),{events:this._entries.map(e=>({cols:e.cols,rows:e.rows,data:e.data[0]??""})),commands:{isWindowsPty:!1,commands:[]}}}generateReplayEvent(){var e=this;return(0,u.Z)(function*(){return e.generateReplayEventSync()})()}}let $i=class{constructor(e,t,i,n,r){this._diff=e,this._terminalId=t,this._collection=i,this._terminalService=n,this._extensionService=r,this.requiresAction=!0}_getInfo(e){const t=new Set;Gi(t,this._diff.added.values()),Gi(t,this._diff.removed.values()),Gi(t,this._diff.changed.values());let i=(0,a.NC)("extensionEnvironmentContributionInfoStale","The following extensions want to relaunch the terminal to contribute to its environment:");return i+=Oo(this._collection,e,this._extensionService,t),i}_getActions(){return[{label:(0,a.NC)("relaunchTerminalLabel","Relaunch terminal"),run:()=>this._terminalService.getInstanceFromId(this._terminalId)?.relaunch(),commandId:"workbench.action.terminal.relaunch"}]}getStatus(e){return{id:"relaunch-needed",severity:Pe.Z.Warning,icon:E.lA.warning,tooltip:this._getInfo(e),hoverActions:this._getActions()}}};$i=(0,c.gn)([(0,c.fM)(3,M.x4),(0,c.fM)(4,re.QS)],$i);let oi=class{constructor(e,t,i){this._collection=e,this._commandService=t,this._extensionService=i,this.requiresAction=!1}_getInfo(e){const t=new Set;Gi(t,this._collection.getVariableMap(e).values());let i=(0,a.NC)("extensionEnvironmentContributionInfoActive","The following extensions have contributed to this terminal's environment:");return i+=Oo(this._collection,e,this._extensionService,t),i}_getActions(e){return[{label:(0,a.NC)("showEnvironmentContributions","Show environment contributions"),run:()=>this._commandService.executeCommand("workbench.action.terminal.showEnvironmentContributions",e),commandId:"workbench.action.terminal.showEnvironmentContributions"}]}getStatus(e){return{id:"env-var-info-changes-active",severity:Pe.Z.Info,tooltip:this._getInfo(e),hoverActions:this._getActions(e)}}};function Oo(o,e,t,i){const n=["\n"],r=o.getDescriptionMap(void 0),s=o.getDescriptionMap(e);for(const l of i){const d=r.get(l);d&&(n.push(`\n- \`${Qn(l,t)}\``),n.push(`: ${d}`));const h=s.get(l);if(h){const f=d?` (${(0,a.NC)("ScopedEnvironmentContributionInfo","workspace")})`:"";n.push(`\n- \`${Qn(l,t)}${f}\``),n.push(`: ${h}`)}!d&&!h&&n.push(`\n- \`${Qn(l,t)}\``)}return n.join("")}function Gi(o,e){for(const t of e)for(const i of t)o.add(i.extensionIdentifier)}function Qn(o,e){return e.extensions.find(t=>t.id===o)?.displayName||o}oi=(0,c.gn)([(0,c.fM)(1,se.H),(0,c.fM)(2,re.QS)],oi);var Ho=p(69965),_e=(()=>((_e=_e||{})[_e.Replace=1]="Replace",_e[_e.Append=2]="Append",_e[_e.Prepend=3]="Prepend",_e))();const Da=new Map([[_e.Append,"APPEND"],[_e.Prepend,"PREPEND"],[_e.Replace,"REPLACE"]]);class Vo{constructor(e){this.collections=e,this.map=new Map,this.descriptionMap=new Map,e.forEach((t,i)=>{this.populateDescriptionMap(t,i);const n=t.map.entries();let r=n.next();for(;!r.done;){const s=r.value[1],l=r.value[0];let d=this.map.get(l);if(d||(d=[],this.map.set(l,d)),d.length>0&&d[0].type===_e.Replace){r=n.next();continue}const h={extensionIdentifier:i,value:s.value,type:s.type,scope:s.scope,variable:s.variable,options:s.options};h.scope||delete h.scope,d.unshift(h),r=n.next()}})}applyToProcessEnvironment(e,t,i){var n=this;return(0,u.Z)(function*(){let r;T.ED&&(r={},Object.keys(e).forEach(s=>r[s.toLowerCase()]=s));for(const[s,l]of n.getVariableMap(t)){const d=T.ED&&r[s.toLowerCase()]||s;for(const h of l){const f=i?yield i(h.value):h.value;if(h.options?.applyAtProcessCreation??1)switch(h.type){case _e.Append:e[d]=(e[d]||"")+f;break;case _e.Prepend:e[d]=f+(e[d]||"");break;case _e.Replace:e[d]=f}if(h.options?.applyAtShellIntegration){const v=`VSCODE_ENV_${Da.get(h.type)}`;e[v]=(e[v]?e[v]+":":"")+s+"="+n._encodeColons(f)}}}})()}_encodeColons(e){return e.replaceAll(":","\\x3a")}diff(e,t){const i=new Map,n=new Map,r=new Map;if(e.getVariableMap(t).forEach((s,l)=>{const h=Go(s,this.getVariableMap(t).get(l));h&&i.set(l,h)}),this.getVariableMap(t).forEach((s,l)=>{const h=Go(s,e.getVariableMap(t).get(l));h&&r.set(l,h)}),this.getVariableMap(t).forEach((s,l)=>{const h=function Aa(o,e){if(!e)return;const t=new Map;e.forEach(n=>t.set(n.extensionIdentifier,n));const i=[];return o.forEach(n=>{const r=t.get(n.extensionIdentifier);r&&(n.type!==r.type||n.value!==r.value||n.scope?.workspaceFolder?.index!==r.scope?.workspaceFolder?.index)&&i.push(r)}),0===i.length?void 0:i}(s,e.getVariableMap(t).get(l));h&&n.set(l,h)}),0!==i.size||0!==n.size||0!==r.size)return{added:i,changed:n,removed:r}}getVariableMap(e){const t=new Map;return this.map.forEach((i,n)=>{const r=i.filter(s=>$o(s,e));r.length>0&&t.set(r[0].variable,r)}),t}getDescriptionMap(e){const t=new Map;return this.descriptionMap.forEach((i,n)=>{const r=i.filter(s=>$o(s,e,!0));r.length>0&&t.set(r[0].extensionIdentifier,r[0].description)}),t}populateDescriptionMap(e,t){if(!e.descriptionMap)return;const i=e.descriptionMap.entries();let n=i.next();for(;!n.done;){const r=n.value[1],s=n.value[0];let l=this.descriptionMap.get(s);l||(l=[],this.descriptionMap.set(s,l));const d={extensionIdentifier:t,scope:r.scope,description:r.description};d.scope||delete d.scope,l.push(d),n=i.next()}}}function $o(o,e,t=!1){return o.scope?!(!o.scope.workspaceFolder||!e?.workspaceFolder||o.scope.workspaceFolder.index!==e.workspaceFolder.index):!t||e===o.scope}function Go(o,e){if(!e)return o;const t=new Set;e.forEach(n=>t.add(n.extensionIdentifier));const i=[];return o.forEach(n=>{t.has(n.extensionIdentifier)||i.push(n)}),0===i.length?void 0:i}var ft=p(9074);function zo(o){let e=o;return e.includes("\\")&&(e=e.replace(/\\/g,"\\\\")),e=e.replace(/[\`\$\|\&\>\~\#\!\^\*\;\<\"\']/g,""),`'${e}'`}function Ea(o,e,t){if(!o)return"";if(!e)return o;e.match(/[\/\\]$/)&&(e=e.slice(0,e.length-1));const i=o.replace(/\\/g,"/").toLowerCase(),n=e.replace(/\\/g,"/").toLowerCase();return i.includes(n)?`~${t}${o.slice(e.length+1)}`:o}function jn(o){return o.match(/^['"].*['"]$/)&&(o=o.substring(1,o.length-1)),1===T.OS&&o&&":"===o[1]?o[0].toUpperCase()+o.substring(1):o}function Zo(o,e){if(e)if(T.ED)for(const t in e){let i=t;for(const r in o)if(t.toLowerCase()===r.toLowerCase()){i=r;break}const n=e[t];void 0!==n&&Uo(o,i,n)}else Object.keys(e).forEach(t=>{const i=e[t];void 0!==i&&Uo(o,t,i)})}function Uo(o,e,t){"string"==typeof t?o[e]=t:delete o[e]}function Ko(o,e){if(e)for(const t of Object.keys(e)){const i=e[t];null!=i&&(o[t]=i)}}function Qo(o,e){return qn.apply(this,arguments)}function qn(){return qn=(0,u.Z)(function*(o,e){return yield Promise.all(Object.entries(e).map(function(){var t=(0,u.Z)(function*([i,n]){if("string"==typeof n)try{e[i]=yield o(n)}catch{e[i]=n}});return function(i){return t.apply(this,arguments)}}())),e}),qn.apply(this,arguments)}function Xn(){return(Xn=(0,u.Z)(function*(o,e,t,i,n,r){if(o.cwd){const l="object"==typeof o.cwd?o.cwd.fsPath:o.cwd;return jn((yield jo(l,t))||l)}let s;return!o.ignoreConfigurationCwd&&n&&(t&&(n=yield jo(n,t,r)),n&&(he.YP(n)?s=n:i&&(s=he.v_(i.fsPath,n)))),s||(s=i?i.fsPath:e||""),jn(s)})).apply(this,arguments)}function jo(o,e,t){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,u.Z)(function*(o,e,t){if(e)try{return yield e(o)}catch(i){return void t?.error("Could not resolve terminal cwd",i)}return o})).apply(this,arguments)}function Yn(){return(Yn=(0,u.Z)(function*(o,e,t,i,n,r){const s={};if(o.strictEnv)Ko(s,o.env);else{Ko(s,r);const l={...e};t&&(l&&(yield Qo(t,l)),o.env&&(yield Qo(t,o.env))),function Pa(o,...e){const t=e.reduce((r,s)=>(r[s]=!0,r),{}),i=[/^ELECTRON_.+$/,/^VSCODE_(?!(PORTABLE|SHELL_LOGIN|ENV_REPLACE|ENV_APPEND|ENV_PREPEND)).+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(o).filter(r=>!t[r]).forEach(r=>{for(let s=0;s<i.length;s++)if(-1!==r.search(i[s])){delete o[r];break}})}(s,"VSCODE_IPC_HOOK_CLI"),Zo(s,l),Zo(s,o.env),function Ma(o,e,t,i){o.TERM_PROGRAM="vscode",e&&(o.TERM_PROGRAM_VERSION=e),function Na(o,e){if("on"===e)return!0;if("auto"===e){const t=o.LANG;return!t||-1===t.search(/\.UTF\-8$/)&&-1===t.search(/\.utf8$/)&&-1===t.search(/\.euc.+/)}return!1}(o,i)&&(o.LANG=function La(o){const e=o?o.split("-"):[],t=e.length;if(0===t)return"en_US.UTF-8";if(1===t){const i={af:"ZA",am:"ET",be:"BY",bg:"BG",ca:"ES",cs:"CZ",da:"DK",de:"DE",el:"GR",en:"US",es:"ES",et:"EE",eu:"ES",fi:"FI",fr:"FR",he:"IL",hr:"HR",hu:"HU",hy:"AM",is:"IS",it:"IT",ja:"JP",kk:"KZ",ko:"KR",lt:"LT",nl:"NL",no:"NO",pl:"PL",pt:"BR",ro:"RO",ru:"RU",sk:"SK",sl:"SI",sr:"YU",sv:"SE",tr:"TR",uk:"UA",zh:"CN"};e[0]in i&&e.push(i[e[0]])}else e[1]=e[1].toUpperCase();return e.join("_")+".UTF-8"}(t)),o.COLORTERM="truecolor"}(s,i,T.dK,n)}return s})).apply(this,arguments)}function er(){return(er=(0,u.Z)(function*(o,e,t,i,n,r,s=T.ED){let l;if((0,de.HD)(o)?l=o:(l=o.fsPath,s&&1!==r?l=l.replace(/\\/g,"/"):!s&&1===r&&(l=l.replace(/\//g,"\\"))),!e)return l;const d=l.includes(" "),h=l.includes("(")||l.includes(")"),f=he.EZ(e,".exe"),v="pwsh"===f||"pwsh"===t||"powershell"===f||"powershell"===t;if(v&&(d||l.includes("'")))return`& '${l.replace(/'/g,"''")}'`;if(h&&v)return`& '${l}'`;if(1===r){if(void 0!==i)return"gitbash"===i?zo(l.replace(/\\/g,"/")):"wsl"===i?n?.getWslPath(l,"win-to-unix")||l:d?`"${l}"`:l;const b=e.toLowerCase();return b.includes("wsl")||b.includes("bash.exe")&&!b.toLowerCase().includes("git")?n?.getWslPath(l,"win-to-unix")||l:d?`"${l}"`:l}return zo(l)})).apply(this,arguments)}function tr(o,e,t){const i="string"==typeof o?N.ov.parse(o):o;let n=i?(0,de.f6)(e.getWorkspaceFolder(i)):void 0;if(!n){const r=t.getLastActiveWorkspaceRoot();n=r?(0,de.f6)(e.getWorkspaceFolder(r)):void 0}return n}var qo=p(31096),Oa=p(4699);let ir=class extends A.JT{get persistentProcessId(){return this._process?.id}get shouldPersist(){return!!this.reconnectionProperties||!!this._process&&this._process.shouldPersist}get hasWrittenData(){return this._hasWrittenData}get hasChildProcesses(){return this._hasChildProcesses}get reconnectionProperties(){return this._shellLaunchConfig?.attachPersistentProcess?.reconnectionProperties||this._shellLaunchConfig?.reconnectionProperties||void 0}get extEnvironmentVariableCollection(){return this._extEnvironmentVariableCollection}constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y,I,$,F,V,O){super(),this._instanceId=e,this._configHelper=t,this._historyService=s,this._instantiationService=l,this._logService=d,this._workspaceContextService=h,this._configurationResolverService=f,this._workbenchEnvironmentService=v,this._productService=b,this._remoteAgentService=_,this._pathService=C,this._environmentVariableService=y,this._terminalProfileResolverService=I,this._configurationService=$,this._terminalInstanceService=F,this._telemetryService=V,this._notificationService=O,this.processState=1,this.capabilities=new Fo,this._isDisposed=!1,this._process=null,this._processType=0,this._preLaunchInputQueue=[],this._latency=-1,this._latencyLastMeasured=0,this._hasWrittenData=!1,this._hasChildProcesses=!1,this._ptyListenersAttached=!1,this._isDisconnected=!1,this._dimensions={cols:0,rows:0},this._onPtyDisconnect=this._register(new w.Q5),this.onPtyDisconnect=this._onPtyDisconnect.event,this._onPtyReconnect=this._register(new w.Q5),this.onPtyReconnect=this._onPtyReconnect.event,this._onProcessReady=this._register(new w.Q5),this.onProcessReady=this._onProcessReady.event,this._onProcessStateChange=this._register(new w.Q5),this.onProcessStateChange=this._onProcessStateChange.event,this._onBeforeProcessData=this._register(new w.Q5),this.onBeforeProcessData=this._onBeforeProcessData.event,this._onProcessData=this._register(new w.Q5),this.onProcessData=this._onProcessData.event,this._onDidChangeProperty=this._register(new w.Q5),this.onDidChangeProperty=this._onDidChangeProperty.event,this._onEnvironmentVariableInfoChange=this._register(new w.Q5),this.onEnvironmentVariableInfoChanged=this._onEnvironmentVariableInfoChange.event,this._onProcessExit=this._register(new w.Q5),this.onProcessExit=this._onProcessExit.event,this._onRestoreCommands=this._register(new w.Q5),this.onRestoreCommands=this._onRestoreCommands.event,this._cwdWorkspaceFolder=tr(i,this._workspaceContextService,this._historyService),this.ptyProcessReady=this._createPtyProcessReadyPromise(),this.getLatency(),this._ackDataBufferer=new Ha(W=>this._process?.acknowledgeDataEvent(W)),this._dataFilter=this._instantiationService.createInstance(nr),this._dataFilter.onProcessData(W=>{const te={data:"string"==typeof W?W:W.data};this._onBeforeProcessData.fire(te),te.data&&te.data.length>0&&("string"!=typeof W&&(W.data=te.data),this._onProcessData.fire("string"!=typeof W?W:{data:te.data,trackCommit:!1}))}),this.remoteAuthority=i&&"object"==typeof i?(0,Ia.ik)(i):this._workbenchEnvironmentService.remoteAuthority,n&&(this._extEnvironmentVariableCollection=new Vo(n),this._register(this._environmentVariableService.onDidChangeCollections(W=>this._onEnvironmentVariableCollectionChange(W))),this.environmentVariableInfo=this._instantiationService.createInstance(oi,this._extEnvironmentVariableCollection),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo)),this.shellIntegrationNonce=r??(0,Oa.R)()}freePortKillProcess(e){var t=this;return(0,u.Z)(function*(){try{t._process?.freePortKillProcess&&(yield t._process?.freePortKillProcess(e))}catch(i){t._notificationService.notify({message:(0,a.NC)("killportfailure","Could not kill process listening on port {0}, command exited with error {1}",e,i),severity:Pe.Z.Warning})}})()}dispose(e=!1){this._isDisposed=!0,this._process&&(this._setProcessState(5),this._process.shutdown(e),this._process=null),super.dispose()}_createPtyProcessReadyPromise(){return new Promise(e=>{const t=this.onProcessReady(()=>{this._logService.debug(`Terminal process ready (shellProcessId: ${this.shellProcessId})`),t.dispose(),e(void 0)})})}detachFromProcess(e){var t=this;return(0,u.Z)(function*(){yield t._process?.detach?.(e),t._process=null})()}createProcess(e,t,i,n=!0){var r=this;return(0,u.Z)(function*(){let s;if(r._shellLaunchConfig=e,r._dimensions.cols=t,r._dimensions.rows=i,e.customPtyImplementation)r._processType=1,s=e.customPtyImplementation(r._instanceId,t,i);else{const d=yield r._terminalInstanceService.getBackend(r.remoteAuthority);if(!d)throw new Error(`No terminal backend registered for remote authority '${r.remoteAuthority}'`);r.backend=d;const h=function Wa(o,e,t){if(t)return i=>t.resolveWithEnvironment(e,o,i)}(r._cwdWorkspaceFolder,yield r._terminalProfileResolverService.getEnvironment(r.remoteAuthority),r._configurationResolverService);if(r.userHome=r._pathService.resolvedUserHome?.fsPath,r.os=T.OS,r.remoteAuthority){const f=yield r._pathService.userHome();r.userHome=f.path;const v=yield r._remoteAgentService.getEnvironment();if(!v)throw new Error(`Failed to get remote environment for remote authority "${r.remoteAuthority}"`);r.userHome=v.userHome.path,r.os=v.os;const b=yield r._resolveEnvironment(d,h,e),_=(r._configurationService.getValue("task.reconnection")&&e.reconnectionProperties||!e.isFeatureTerminal)&&r._configHelper.config.enablePersistentSessions&&!e.isTransient;if(e.attachPersistentProcess){const C=yield d.attachToProcess(e.attachPersistentProcess.id);C?s=C:(r._logService.warn("Attach to process failed for terminal",e.attachPersistentProcess),e.attachPersistentProcess=void 0)}if(!s){yield r._terminalProfileResolverService.resolveShellLaunchConfig(e,{remoteAuthority:r.remoteAuthority,os:r.os});const C={shellIntegration:{enabled:r._configurationService.getValue("terminal.integrated.shellIntegration.enabled"),suggestEnabled:r._configurationService.getValue("terminal.integrated.shellIntegration.suggestEnabled"),nonce:r.shellIntegrationNonce},windowsEnableConpty:r._configHelper.config.windowsEnableConpty,environmentVariableCollections:r._extEnvironmentVariableCollection?.collections?(0,ft.a)(r._extEnvironmentVariableCollection.collections):void 0,workspaceFolder:r._cwdWorkspaceFolder};try{s=yield d.createProcess(e,"",t,i,r._configHelper.config.unicodeVersion,b,C,_)}catch(y){if("Could not fetch remote environment"===y?.message)return void r._logService.trace("Could not fetch remote environment, silently failing");throw y}}r._isDisposed||r._setupPtyHostListeners(d)}else{if(e.attachPersistentProcess){const f=e.attachPersistentProcess.findRevivedId?yield d.attachToRevivedProcess(e.attachPersistentProcess.id):yield d.attachToProcess(e.attachPersistentProcess.id);f?s=f:(r._logService.warn("Attach to process failed for terminal",e.attachPersistentProcess),e.attachPersistentProcess=void 0)}s||(s=yield r._launchLocalProcess(d,e,t,i,r.userHome,h)),r._isDisposed||r._setupPtyHostListeners(d)}}if(r._isDisposed)return void s.shutdown(!1);r._process=s,r._setProcessState(2),(3===r.os||2===r.os)&&r.capabilities.add(1,new ka(r._process)),r._dataFilter.newProcess(r._process,n),r._processListeners&&(0,A.B9)(r._processListeners),r._processListeners=[s.onProcessReady(d=>{r.shellProcessId=d.pid,r._initialCwd=d.cwd,r._onDidChangeProperty.fire({type:"initialCwd",value:r._initialCwd}),r._onProcessReady.fire(d),r._preLaunchInputQueue.length>0&&r._process&&(s.input(r._preLaunchInputQueue.join("")),r._preLaunchInputQueue.length=0)}),s.onProcessExit(d=>r._onExit(d)),s.onDidChangeProperty(({type:d,value:h})=>{switch(d){case"hasChildProcesses":r._hasChildProcesses=h;break;case"failedShellIntegrationActivation":r._telemetryService?.publicLog2("terminal/shellIntegrationActivationFailureCustomArgs")}r._onDidChangeProperty.fire({type:d,value:h})})],s.onRestoreCommands&&r._processListeners.push(s.onRestoreCommands(d=>{r._onRestoreCommands.fire(d)})),setTimeout(()=>{2===r.processState&&r._setProcessState(3)},500);return(yield s.start())||void 0})()}relaunch(e,t,i,n){var r=this;return(0,u.Z)(function*(){return r.ptyProcessReady=r._createPtyProcessReadyPromise(),r._logService.trace(`Relaunching terminal instance ${r._instanceId}`),r._isDisconnected&&(r._isDisconnected=!1,r._onPtyReconnect.fire()),r._hasWrittenData=!1,r.createProcess(e,t,i,n)})()}_resolveEnvironment(e,t,i){var n=this;return(0,u.Z)(function*(){const r=tr(i.cwd,n._workspaceContextService,n._historyService),l=n._configurationService.getValue("terminal.integrated.env."+(T.ED?"windows":T.dz?"osx":"linux"));let d;n._configHelper.showRecommendations(i),d=i.useShellEnvironment?yield e.getShellEnvironment():yield n._terminalProfileResolverService.getEnvironment(n.remoteAuthority);const h=yield function Ba(o,e,t,i,n,r){return Yn.apply(this,arguments)}(i,l,t,n._productService.version,n._configHelper.config.detectLocale,d);return!n._isDisposed&&!i.strictEnv&&!i.hideFromUser&&(n._extEnvironmentVariableCollection=n._environmentVariableService.mergedCollection,n._register(n._environmentVariableService.onDidChangeCollections(f=>n._onEnvironmentVariableCollectionChange(f))),yield n._extEnvironmentVariableCollection.applyToProcessEnvironment(h,{workspaceFolder:r},t),n._extEnvironmentVariableCollection.getVariableMap({workspaceFolder:r}).size&&(n.environmentVariableInfo=n._instantiationService.createInstance(oi,n._extEnvironmentVariableCollection),n._onEnvironmentVariableInfoChange.fire(n.environmentVariableInfo))),h})()}_launchLocalProcess(e,t,i,n,r,s){var l=this;return(0,u.Z)(function*(){yield l._terminalProfileResolverService.resolveShellLaunchConfig(t,{remoteAuthority:void 0,os:T.OS});const d=l._historyService.getLastActiveWorkspaceRoot(J.lg.file),h=yield function Ra(o,e,t,i,n,r){return Xn.apply(this,arguments)}(t,r,s,d,l._configHelper.config.cwd,l._logService),f=yield l._resolveEnvironment(e,s,t),v={shellIntegration:{enabled:l._configurationService.getValue("terminal.integrated.shellIntegration.enabled"),suggestEnabled:l._configurationService.getValue("terminal.integrated.shellIntegration.suggestEnabled"),nonce:l.shellIntegrationNonce},windowsEnableConpty:l._configHelper.config.windowsEnableConpty,environmentVariableCollections:l._extEnvironmentVariableCollection?(0,ft.a)(l._extEnvironmentVariableCollection.collections):void 0,workspaceFolder:l._cwdWorkspaceFolder},b=(l._configurationService.getValue("task.reconnection")&&t.reconnectionProperties||!t.isFeatureTerminal)&&l._configHelper.config.enablePersistentSessions&&!t.isTransient;return yield e.createProcess(t,h,i,n,l._configHelper.config.unicodeVersion,f,v,b)})()}_setupPtyHostListeners(e){var t=this;this._ptyListenersAttached||(this._ptyListenersAttached=!0,this._register(e.onPtyHostUnresponsive(()=>{this._isDisconnected=!0,this._onPtyDisconnect.fire()})),this._ptyResponsiveListener=e.onPtyHostResponsive(()=>{this._isDisconnected=!1,this._onPtyReconnect.fire()}),this._register((0,A.OF)(()=>this._ptyResponsiveListener?.dispose())),this._register(e.onPtyHostRestart((0,u.Z)(function*(){if(t._isDisconnected||(t._isDisconnected=!0,t._onPtyDisconnect.fire()),t._ptyResponsiveListener?.dispose(),t._ptyResponsiveListener=void 0,t._shellLaunchConfig)if(t._shellLaunchConfig.isFeatureTerminal&&!t.reconnectionProperties)t._onExit(-1);else{const i=(0,a.NC)("ptyHostRelaunch","Restarting the terminal because the connection to the shell process was lost...");t._onProcessData.fire({data:Ze(i,{loudFormatting:!0}),trackCommit:!1}),yield t.relaunch(t._shellLaunchConfig,t._dimensions.cols,t._dimensions.rows,!1)}}))))}getBackendOS(){var e=this;return(0,u.Z)(function*(){let t=T.OS;if(e.remoteAuthority){const i=yield e._remoteAgentService.getEnvironment();if(!i)throw new Error(`Failed to get remote environment for remote authority "${e.remoteAuthority}"`);t=i.os}return t})()}setDimensions(e,t,i){if(!i)return this.ptyProcessReady.then(()=>this._resize(e,t));this._resize(e,t)}setUnicodeVersion(e){var t=this;return(0,u.Z)(function*(){return t._process?.setUnicodeVersion(e)})()}_resize(e,t){if(this._process){try{this._process.resize(e,t)}catch(i){if("EPIPE"!==i.code&&"ERR_IPC_CHANNEL_CLOSED"!==i.code)throw i}this._dimensions.cols=e,this._dimensions.rows=t}}write(e){var t=this;return(0,u.Z)(function*(){yield t.ptyProcessReady,t._dataFilter.disableSeamlessRelaunch(),t._hasWrittenData=!0,t.shellProcessId||1===t._processType?t._process&&t._process.input(e):t._preLaunchInputQueue.push(e)})()}processBinary(e){var t=this;return(0,u.Z)(function*(){yield t.ptyProcessReady,t._dataFilter.disableSeamlessRelaunch(),t._hasWrittenData=!0,t._process?.processBinary(e)})()}get initialCwd(){return this._initialCwd??""}getLatency(){var e=this;return(0,u.Z)(function*(){if(yield e.ptyProcessReady,!e._process)return Promise.resolve(0);if(0===e._latencyLastMeasured||e._latencyLastMeasured+1e3<Date.now()){const t=e._process.getLatency();e._latency=yield t,e._latencyLastMeasured=Date.now()}return Promise.resolve(e._latency)})()}refreshProperty(e){var t=this;return(0,u.Z)(function*(){if(!t._process)throw new Error("Cannot refresh property when process is not set");return t._process.refreshProperty(e)})()}updateProperty(e,t){var i=this;return(0,u.Z)(function*(){return i._process?.updateProperty(e,t)})()}acknowledgeDataEvent(e){this._ackDataBufferer.ack(e)}_onExit(e){this._process=null,2===this.processState&&this._setProcessState(4),3===this.processState&&this._setProcessState(6),this._onProcessExit.fire(e)}_setProcessState(e){this.processState=e,this._onProcessStateChange.fire()}_onEnvironmentVariableCollectionChange(e){const t=this._extEnvironmentVariableCollection.diff(e,{workspaceFolder:this._cwdWorkspaceFolder});void 0!==t?(this.environmentVariableInfo=this._instantiationService.createInstance($i,t,this._instanceId,e),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo)):this.environmentVariableInfo instanceof $i&&(this.environmentVariableInfo=this._instantiationService.createInstance(oi,this._extEnvironmentVariableCollection),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo))}};ir=(0,c.gn)([(0,c.fM)(5,vi.C),(0,c.fM)(6,G.TG),(0,c.fM)(7,De.VZ),(0,c.fM)(8,be.ec),(0,c.fM)(9,pi.qb),(0,c.fM)(10,St.n),(0,c.fM)(11,xt.a),(0,c.fM)(12,Oe.R),(0,c.fM)(13,qo.a),(0,c.fM)(14,Ho.M),(0,c.fM)(15,k.if),(0,c.fM)(16,ie.Ui),(0,c.fM)(17,M.N4),(0,c.fM)(18,je.bU),(0,c.fM)(19,R.lT)],ir);class Ha{constructor(e){this._callback=e,this._unsentCharCount=0}ack(e){for(this._unsentCharCount+=e;this._unsentCharCount>5e3;)this._unsentCharCount-=5e3,this._callback(5e3)}}let nr=class extends A.JT{get onProcessData(){return this._onProcessData.event}constructor(e){super(),this._logService=e,this._disableSeamlessRelaunch=!1,this._onProcessData=this._register(new w.Q5)}newProcess(e,t){if(this._dataListener?.dispose(),this._activeProcess?.shutdown(!1),this._activeProcess=e,!this._firstRecorder||!t||this._disableSeamlessRelaunch)return this._firstDisposable?.dispose(),[this._firstRecorder,this._firstDisposable]=this._createRecorder(e),this._disableSeamlessRelaunch&&t&&this._onProcessData.fire("\x1bc"),this._dataListener=e.onProcessData(n=>this._onProcessData.fire(n)),void(this._disableSeamlessRelaunch=!1);this._secondRecorder&&this.triggerSwap(),this._swapTimeout=window.setTimeout(()=>this.triggerSwap(),3e3),this._dataListener?.dispose(),this._firstDisposable?.dispose();const i=this._createRecorder(e);[this._secondRecorder,this._secondDisposable]=i}disableSeamlessRelaunch(){this._disableSeamlessRelaunch=!0,this._stopRecording(),this.triggerSwap()}triggerSwap(){if(this._swapTimeout&&(window.clearTimeout(this._swapTimeout),this._swapTimeout=void 0),!this._firstRecorder)return;if(!this._secondRecorder)return this._firstRecorder=void 0,void this._firstDisposable?.dispose();const e=this._getDataFromRecorder(this._firstRecorder),t=this._getDataFromRecorder(this._secondRecorder);e===t?this._logService.trace("Seamless terminal relaunch - identical content"):(this._logService.trace("Seamless terminal relaunch - resetting content"),this._onProcessData.fire({data:`\x1bc${t}`,trackCommit:!1})),this._dataListener?.dispose(),this._dataListener=this._activeProcess.onProcessData(i=>this._onProcessData.fire(i)),this._firstRecorder=this._secondRecorder,this._firstDisposable?.dispose(),this._firstDisposable=this._secondDisposable,this._secondRecorder=void 0}_stopRecording(){this._swapTimeout||(this._firstRecorder=void 0,this._firstDisposable?.dispose(),this._secondRecorder=void 0,this._secondDisposable?.dispose())}_createRecorder(e){const t=new Ta(0,0),i=e.onProcessData(n=>t.handleData("string"==typeof n?n:n.data));return[t,i]}_getDataFromRecorder(e){return e.generateReplayEventSync().events.filter(t=>!!t.data).map(t=>t.data).join("")}};nr=(0,c.gn)([(0,c.fM)(0,De.VZ)],nr);var Va=p(29637),$a=p(90457);function zi(o,e,t,i,n,r){return rr.apply(this,arguments)}function rr(){return rr=(0,u.Z)(function*(o,e,t,i,n,r){if(!e.xterm)return;const s=o.get(Se.AR),l=o.get(G.TG),d=o.get(we.eJ),h=o.get(He.Uy),f=`terminal.pinnedRecentCommands.${e.shellType}`;let v,b=[];const _=new Set,C={iconClass:H.kS.asClassName(Hs),tooltip:(0,a.NC)("removeCommand","Remove from Command History")},y={iconClass:H.kS.asClassName(Vs),tooltip:(0,a.NC)("viewCommandOutput","View Command Output"),alwaysVisible:!1};if("command"===i){let te=function(le){return le.replace(/\r?\n/g,"\u23ce").replace(/\s\s\s+/g,"\u22ef")};v=T.dz?(0,a.NC)("selectRecentCommandMac","Select a command to run (hold Option-key to edit the command)"):(0,a.NC)("selectRecentCommand","Select a command to run (hold Alt-key to edit the command)");const O=e.capabilities.get(2),W=O?.commands,q=O?.executingCommand;if(q&&_.add(q),W&&W.length>0){for(const le of W){const We=le.command.trim();if(0===We.length||_.has(We))continue;let et=Ea(le.cwd,e.userHome,1===e.os?"\\":"/");le.exitCode&&(et+=-1===le.exitCode?" failed":` exitCode: ${le.exitCode}`),et=et.trim();const Jr=[y],Lt=b.length>0?b[b.length-1]:void 0;"separator"===Lt?.type||Lt?.label!==We?(b.push({label:te(We),rawLabel:We,description:et,id:le.timestamp.toString(),command:le,buttons:le.hasOutput()?Jr:void 0}),_.add(We)):(Lt.id=le.timestamp.toString(),Lt.description=et)}b=b.reverse()}q&&b.unshift({label:te(q),rawLabel:q,description:O.cwd}),b.length>0&&b.unshift({type:"separator",label:P.currentSessionCategory});const Ee=l.invokeFunction(_i),ui=[];for(const[le,We]of Ee.entries)!_.has(le)&&We.shellType===e.shellType&&(ui.unshift({label:te(le),rawLabel:le,buttons:[C]}),_.add(le));ui.length>0&&b.push({type:"separator",label:P.previousSessionCategory},...ui);const Xr=yield l.invokeFunction(Qs,e.shellType),mi=[];for(const le of Xr)_.has(le)||mi.unshift({label:te(le),rawLabel:le});mi.length>0&&b.push({type:"separator",label:(0,a.NC)("shellFileHistoryCategory","{0} history",e.shellType)},...mi)}else{v=T.dz?(0,a.NC)("selectRecentDirectoryMac","Select a directory to go to (hold Option-key to edit the command)"):(0,a.NC)("selectRecentDirectory","Select a directory to go to (hold Alt-key to edit the command)");const O=e.capabilities.get(0)?.cwds||[];if(O&&O.length>0){for(const te of O)b.push({label:te,rawLabel:te});b=b.reverse(),b.unshift({type:"separator",label:P.currentSessionCategory})}const W=l.invokeFunction(cn),q=[];for(const[te,Ee]of W.entries)(null===Ee||Ee.remoteAuthority===e.remoteAuthority)&&!O.includes(te)&&q.unshift({label:te,rawLabel:te,buttons:[C]});q.length>0&&b.push({type:"separator",label:P.previousSessionCategory},...q)}if(0===b.length)return;const I=new Va.ZD({title:"Fuzzy search",icon:$s,isChecked:"fuzzy"===n,inputActiveOptionBorder:(0,Z.n_1)(Z.PRb),inputActiveOptionForeground:(0,Z.n_1)(Z.Pvw),inputActiveOptionBackground:(0,Z.n_1)(Z.XEs)});I.onChange(()=>{l.invokeFunction(zi,e,t,i,I.checked?"fuzzy":"contiguous",F.value)});const $=l.createInstance(si),F=d.createQuickPick();return F.items=[...b],F.sortByLabel=!1,F.placeholder=v,F.matchOnLabelMode=n||"contiguous",F.toggles=[I],F.onDidTriggerItemButton(function(){var O=(0,u.Z)(function*(W){if(W.button===C)"command"===i?l.invokeFunction(_i)?.remove(W.item.label):l.invokeFunction(cn)?.remove(W.item.label);else if(W.button===y){const q=W.item.command,te=q?.getOutput();if(te&&q?.command){const Ee=yield $.provideTextContent(N.ov.from({scheme:si.scheme,path:`${q.command}... ${(0,Qt.Z)(q.timestamp,!0)}`,fragment:te,query:`terminal-output-${q.timestamp}-${e.instanceId}`}));Ee&&(yield s.openEditor({resource:Ee.uri}))}}yield l.invokeFunction(zi,e,t,i,n,r)});return function(W){return O.apply(this,arguments)}}()),F.onDidChangeValue(function(){var O=(0,u.Z)(function*(W){W||(yield l.invokeFunction(zi,e,t,i,n,W))});return function(W){return O.apply(this,arguments)}}()),F.onDidAccept((0,u.Z)(function*(){const O=F.activeItems[0];let W;W="cwd"===i?`cd ${yield e.preparePathForShell(O.rawLabel)}`:O.rawLabel,F.hide(),e.runCommand(W,!F.keyMods.alt),F.keyMods.alt&&e.focus()})),r&&(F.value=r),new Promise(O=>{t.set(!0),(0,$a.N)(h,f,F,!0),F.onDidHide(()=>{t.set(!1),O()})})}),rr.apply(this,arguments)}let si=class Ps{constructor(e,t){this._modelService=t,e.registerTextModelContentProvider(Ps.scheme,this)}provideTextContent(e){var t=this;return(0,u.Z)(function*(){const i=t._modelService.getModel(e);return i&&!i.isDisposed()?i:t._modelService.createModel(e.fragment,null,e,!1)})()}};si.scheme="TERMINAL_OUTPUT",si=(0,c.gn)([(0,c.fM)(0,xi.S),(0,c.fM)(1,bo.q)],si);let or=class extends A.JT{get onDidAddStatus(){return this._onDidAddStatus.event}get onDidRemoveStatus(){return this._onDidRemoveStatus.event}get onDidChangePrimaryStatus(){return this._onDidChangePrimaryStatus.event}constructor(e){super(),this._configurationService=e,this._statuses=new Map,this._statusTimeouts=new Map,this._onDidAddStatus=this._register(new w.Q5),this._onDidRemoveStatus=this._register(new w.Q5),this._onDidChangePrimaryStatus=this._register(new w.Q5)}get primary(){let e;for(const t of this._statuses.values())(!e||t.severity>=e.severity)&&(e=t);return e}get statuses(){return Array.from(this._statuses.values())}add(e,t){e=this._applyAnimationSetting(e);const i=this._statusTimeouts.get(e.id);if(i&&(window.clearTimeout(i),this._statusTimeouts.delete(e.id)),t&&t>0){const r=window.setTimeout(()=>this.remove(e),t);this._statusTimeouts.set(e.id,r)}const n=this._statuses.get(e.id);if(n&&n!==e&&(this._onDidRemoveStatus.fire(n),this._statuses.delete(n.id)),!this._statuses.has(e.id)){const r=this.primary;this._statuses.set(e.id,e),this._onDidAddStatus.fire(e);const s=this.primary;r!==s&&this._onDidChangePrimaryStatus.fire(s)}}remove(e){const t="string"==typeof e?this._statuses.get(e):e;if(t&&this._statuses.get(t.id)){const i=this.primary?.id===t.id;this._statuses.delete(t.id),this._onDidRemoveStatus.fire(t),i&&this._onDidChangePrimaryStatus.fire(this.primary)}}toggle(e,t){t?this.add(e):this.remove(e)}_applyAnimationSetting(e){if(!e.icon||"spin"!==H.kS.getModifier(e.icon)||this._configurationService.getValue("terminal.integrated.tabs.enableAnimation"))return e;let t;return t=e.icon.id===ge.Tk.id?E.lA.play:H.kS.modify(e.icon,void 0),{...e,icon:t}}};function Xo(o){switch(o){case Pe.Z.Error:return Z.fLH;case Pe.Z.Warning:return Z.J_Y;default:return""}}or=(0,c.gn)([(0,c.fM)(0,ie.Ui)],or);class Ga{constructor(){this._attached=new Map}attachToElement(e){this._container||(this._container=document.createElement("div"),this._container.classList.add("terminal-widget-container"),e.appendChild(this._container))}dispose(){this._container&&this._container.parentElement&&(this._container.parentElement.removeChild(this._container),this._container=void 0)}attachWidget(e){if(this._container)return this._attached.get(e.id)?.dispose(),e.attach(this._container),this._attached.set(e.id,e),{dispose:()=>{this._attached.get(e.id)===e&&(this._attached.delete(e.id),e.dispose())}}}}class za extends A.JT{constructor(e){super(),this._initializationPromise=e,this._isOsSet=!1,this._onLineData=this._register(new w.Q5),this.onLineData=this._onLineData.event}activate(e){var t=this;return(0,u.Z)(function*(){t._xterm=e,yield t._initializationPromise,t._register(e.onLineFeed(()=>{const i=e.buffer,n=i.active.getLine(i.active.baseY+i.active.cursorY);n&&!n.isWrapped&&t._sendLineData(i.active,i.active.baseY+i.active.cursorY-1)})),t._register((0,A.OF)(()=>{const i=e.buffer;t._sendLineData(i.active,i.active.baseY+i.active.cursorY)}))})()}setOperatingSystem(e){if(!this._isOsSet&&this._xterm&&(this._isOsSet=!0,1===e)){const t=this._xterm;this._register(t.parser.registerCsiHandler({final:"H"},()=>{const i=t.buffer;return this._sendLineData(i.active,i.active.baseY+i.active.cursorY),!1}))}}_sendLineData(e,t){let i=e.getLine(t);if(!i)return;let n=i.translateToString(!0);for(;t>0&&i.isWrapped&&(i=e.getLine(--t),i);)n=i.translateToString(!1)+n;this._onLineData.fire(n)}}var Mt=p(13686),j=p(94429),ee=(()=>((ee=ee||{})[ee.Top=0]="Top",ee[ee.Bottom=1]="Bottom",ee))();let sr=class extends A.JT{activate(e){this._terminal=e,this._register(this._terminal.onData(()=>{this._currentMarker=ee.Bottom}))}constructor(e,t){super(),this._capabilities=e,this._themeService=t,this._currentMarker=ee.Bottom,this._selectionStart=null,this._isDisposable=!1}_getMarkers(e){const t=this._capabilities.get(2),i=this._capabilities.get(3),n=this._capabilities.get(4);let r=[];if(t?r=(0,Mt.kX)(t.commands.map(s=>s.marker)):i&&r.push(...i.commands),n&&!e){let s=n.markers().next()?.value;const l=[];for(;s;)l.push(s),s=n.markers().next()?.value;r=l}return r}clearMarker(){this._currentMarker=ee.Bottom,this._resetNavigationDecorations(),this._selectionStart=null}_resetNavigationDecorations(){this._navigationDecorations&&(0,A.B9)(this._navigationDecorations),this._navigationDecorations=[]}_isEmptyCommand(e){return e===ee.Bottom||(e===ee.Top?!this._getMarkers(!0).map(t=>t.line).includes(0):!this._getMarkers(!0).includes(e))}scrollToPreviousMark(e=1,t=!1,i=!1){if(!this._terminal)return;let n;t||(this._selectionStart=null);const r="object"==typeof this._currentMarker?this._getTargetScrollLine(this._terminal,this._currentMarker,e):Math.min(ai(this._terminal,this._currentMarker),this._terminal.buffer.active.baseY),s=this._terminal.buffer.active.viewportY;if("object"==typeof this._currentMarker?this._isMarkerInViewport(this._terminal,this._currentMarker):r===s)this._currentMarker===ee.Bottom?n=this._getMarkers(i).length-1:this._currentMarker===ee.Top?n=-1:this._isDisposable?(n=this._findPreviousMarker(this._terminal,i),this._currentMarker.dispose(),this._isDisposable=!1):n=i&&this._isEmptyCommand(this._currentMarker)?this._findPreviousMarker(this._terminal,!0):this._getMarkers(i).indexOf(this._currentMarker)-1;else{const l=this._getMarkers(i).filter(d=>d.line>=s).length;n=this._getMarkers(i).length-l-1}if(n<0)return this._currentMarker=ee.Top,this._terminal.scrollToTop(),void this._resetNavigationDecorations();this._currentMarker=this._getMarkers(i)[n],this._scrollToMarker(this._currentMarker,e)}scrollToNextMark(e=1,t=!1,i=!0){if(!this._terminal)return;let n;t||(this._selectionStart=null);const r="object"==typeof this._currentMarker?this._getTargetScrollLine(this._terminal,this._currentMarker,e):Math.min(ai(this._terminal,this._currentMarker),this._terminal.buffer.active.baseY),s=this._terminal.buffer.active.viewportY;if(("object"==typeof this._currentMarker?this._isMarkerInViewport(this._terminal,this._currentMarker):r===s)?this._currentMarker===ee.Bottom?n=this._getMarkers(i).length:this._currentMarker===ee.Top?n=0:this._isDisposable?(n=this._findNextMarker(this._terminal,i),this._currentMarker.dispose(),this._isDisposable=!1):n=i&&this._isEmptyCommand(this._currentMarker)?this._findNextMarker(this._terminal,!0):this._getMarkers(i).indexOf(this._currentMarker)+1:n=this._getMarkers(i).filter(d=>d.line<=s).length,n>=this._getMarkers(i).length)return this._currentMarker=ee.Bottom,this._terminal.scrollToBottom(),void this._resetNavigationDecorations();this._currentMarker=this._getMarkers(i)[n],this._scrollToMarker(this._currentMarker,e)}_scrollToMarker(e,t,i,n){if(this._terminal){if(!this._isMarkerInViewport(this._terminal,e)){const r=this._getTargetScrollLine(this._terminal,e,t);this._terminal.scrollToLine(r)}n||this._registerTemporaryDecoration(e,i)}}_createMarkerForOffset(e,t){if(0===t)return e;{const i=this._terminal?.registerMarker(-this._terminal.buffer.active.cursorY+e.line-this._terminal.buffer.active.baseY+t);if(i)return i;throw new Error(`Could not register marker with offset ${e.line}, ${t}`)}}_registerTemporaryDecoration(e,t){if(!this._terminal)return;this._resetNavigationDecorations();const i=this._themeService.getColorTheme().getColor(j.Qh),r=t?t.line-e.line+1:1;for(let s=0;s<r;s++){const l=this._terminal.registerDecoration({marker:this._createMarkerForOffset(e,s),width:this._terminal.cols,overviewRulerOptions:{color:i?.toString()||"#a0a0a0cc"}});if(l){let d;this._navigationDecorations?.push(l),l.onRender(h=>{d||(d=h,r>1?h.classList.add("terminal-scroll-highlight"):h.classList.add("terminal-scroll-highlight","terminal-scroll-highlight-outline"),this._terminal?.element&&(h.style.marginLeft=`-${getComputedStyle(this._terminal.element).paddingLeft}`))}),l.onDispose(()=>{this._navigationDecorations=this._navigationDecorations?.filter(h=>h!==l)}),(0,ne.Vs)(350).then(()=>{d&&d.classList.remove("terminal-scroll-highlight-outline")})}}}_getTargetScrollLine(e,t,i){return 1===i?Math.max(t.line-Math.floor(e.rows/4),0):t.line}_isMarkerInViewport(e,t){const i=e.buffer.active.viewportY;return t.line>=i&&t.line<i+e.rows}scrollToClosestMarker(e,t,i){const n=this._capabilities.get(4);if(!n)return;const r=n.getMark(e);if(!r)return;const s=t?n.getMark(t):r;this._scrollToMarker(r,0,s,!i)}selectToPreviousMark(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this._capabilities.has(2)?this.scrollToPreviousMark(1,!0,!0):this.scrollToPreviousMark(1,!0,!1),Zi(this._terminal,this._currentMarker,this._selectionStart))}selectToNextMark(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this._capabilities.has(2)?this.scrollToNextMark(1,!0,!0):this.scrollToNextMark(1,!0,!1),Zi(this._terminal,this._currentMarker,this._selectionStart))}selectToPreviousLine(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this.scrollToPreviousLine(this._terminal,1,!0),Zi(this._terminal,this._currentMarker,this._selectionStart))}selectToNextLine(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this.scrollToNextLine(this._terminal,1,!0),Zi(this._terminal,this._currentMarker,this._selectionStart))}scrollToPreviousLine(e,t=1,i=!1){if(i||(this._selectionStart=null),this._currentMarker!==ee.Top){if(this._currentMarker===ee.Bottom)this._currentMarker=this._registerMarkerOrThrow(e,this._getOffset(e)-1);else{const n=this._getOffset(e);this._isDisposable&&this._currentMarker.dispose(),this._currentMarker=this._registerMarkerOrThrow(e,n-1)}this._isDisposable=!0,this._scrollToMarker(this._currentMarker,t)}else e.scrollToTop()}scrollToNextLine(e,t=1,i=!1){if(i||(this._selectionStart=null),this._currentMarker!==ee.Bottom){if(this._currentMarker===ee.Top)this._currentMarker=this._registerMarkerOrThrow(e,this._getOffset(e)+1);else{const n=this._getOffset(e);this._isDisposable&&this._currentMarker.dispose(),this._currentMarker=this._registerMarkerOrThrow(e,n+1)}this._isDisposable=!0,this._scrollToMarker(this._currentMarker,t)}else e.scrollToBottom()}_registerMarkerOrThrow(e,t){const i=e.registerMarker(t);if(!i)throw new Error(`Could not create marker for ${t}`);return i}_getOffset(e){if(this._currentMarker===ee.Bottom)return 0;if(this._currentMarker===ee.Top)return 0-(e.buffer.active.baseY+e.buffer.active.cursorY);{let t=ai(e,this._currentMarker);return t-=e.buffer.active.baseY+e.buffer.active.cursorY,t}}_findPreviousMarker(e,t=!1){if(this._currentMarker===ee.Top)return 0;if(this._currentMarker===ee.Bottom)return this._getMarkers(t).length-1;let i;for(i=this._getMarkers(t).length-1;i>=0;i--)if(this._getMarkers(t)[i].line<this._currentMarker.line)return i;return-1}_findNextMarker(e,t=!1){if(this._currentMarker===ee.Top)return 0;if(this._currentMarker===ee.Bottom)return this._getMarkers(t).length-1;let i;for(i=0;i<this._getMarkers(t).length;i++)if(this._getMarkers(t)[i].line>this._currentMarker.line)return i;return this._getMarkers(t).length}};function ai(o,e){return e===ee.Bottom?o.buffer.active.baseY+o.rows-1:e===ee.Top?0:e.line}function Zi(o,e,t){null===t&&(t=ee.Bottom);let i=ai(o,e),n=ai(o,t);if(i>n){const r=i;i=n,n=r}n-=1,o.selectLines(i,n)}sr=(0,c.gn)([(0,c.fM)(1,me.XE)],sr);var ar=p(35814);let li=class{get commands(){return this._commands}get executingCommand(){return this._currentCommand.command}get executingCommandObject(){if(this._currentCommand.commandStartMarker)return{marker:this._currentCommand.commandStartMarker}}get cwd(){return this._cwd}get _isInputting(){return!(!this._currentCommand.commandStartMarker||this._currentCommand.commandExecutedMarker)}get hasInput(){if(this._isInputting&&this._currentCommand?.commandStartMarker){if(this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY===this._currentCommand.commandStartMarker?.line){const e=this._terminal.buffer.active.getLine(this._terminal.buffer.active.cursorY)?.translateToString(!0,this._currentCommand.commandStartX);return void 0===e?void 0:e.length>0}return!0}}constructor(e,t){this._terminal=e,this._logService=t,this.type=2,this._commands=[],this._currentCommand={},this._isWindowsPty=!1,this._commandMarkers=[],this.__isCommandStorageDisabled=!1,this._onCommandStarted=new w.Q5,this.onCommandStarted=this._onCommandStarted.event,this._onBeforeCommandFinished=new w.Q5,this.onBeforeCommandFinished=this._onBeforeCommandFinished.event,this._onCommandFinished=new w.Q5,this.onCommandFinished=this._onCommandFinished.event,this._onCommandExecuted=new w.Q5,this.onCommandExecuted=this._onCommandExecuted.event,this._onCommandInvalidated=new w.Q5,this.onCommandInvalidated=this._onCommandInvalidated.event,this._onCurrentCommandInvalidated=new w.Q5,this.onCurrentCommandInvalidated=this._onCurrentCommandInvalidated.event,this._dimensions={cols:this._terminal.cols,rows:this._terminal.rows},this._terminal.onResize(i=>this._handleResize(i)),this._terminal.onCursorMove(()=>this._handleCursorMove()),this._setupClearListeners()}_handleResize(e){this._isWindowsPty&&this._preHandleResizeWindows(e),this._dimensions.cols=e.cols,this._dimensions.rows=e.rows}_handleCursorMove(){this._terminal.buffer.active===this._terminal.buffer.normal&&this._currentCommand.commandStartMarker&&this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY<this._currentCommand.commandStartMarker.line&&(this._clearCommandsInViewport(),this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire({reason:"windows"}))}_setupClearListeners(){this.onBeforeCommandFinished(e=>{this._isWindowsPty&&("clear"===e.command.trim().toLowerCase()||"cls"===e.command.trim().toLowerCase())&&(this._clearCommandsInViewport(),this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire({reason:"windows"}))}),this._terminal.parser.registerCsiHandler({final:"J"},e=>(this._isWindowsPty||e.length>=1&&(2===e[0]||3===e[0])&&this._clearCommandsInViewport(),!1))}_preHandleResizeWindows(e){const t=this._terminal.buffer.active.baseY,i=e.rows-this._dimensions.rows;i>0&&this._waitForCursorMove().then(()=>{const n=Math.min(i,t);for(let r=this.commands.length-1;r>=0;r--){const s=this.commands[r];if(!s.marker||s.marker.line<t||void 0===s.commandStartLineContent)break;const l=this._terminal.buffer.active.getLine(s.marker.line);if(!l||l.translateToString(!0)===s.commandStartLineContent)continue;const d=s.marker.line-n;this._terminal.buffer.active.getLine(d)?.translateToString(!0)===s.commandStartLineContent&&this._terminal._core._bufferService.buffer.lines.onDeleteEmitter.fire({index:this._terminal.buffer.active.baseY,amount:n})}})}_clearCommandsInViewport(){let e=0;for(let t=this._commands.length-1;t>=0;t--){const i=this._commands[t].marker?.line;if(i&&i<this._terminal.buffer.active.baseY)break;e++}e>0&&this._onCommandInvalidated.fire(this._commands.splice(this._commands.length-e,e))}_waitForCursorMove(){const e=this._terminal.buffer.active.cursorX,t=this._terminal.buffer.active.cursorY;let i=0;return new Promise((n,r)=>{const s=setInterval(()=>{if(e!==this._terminal.buffer.active.cursorX||t!==this._terminal.buffer.active.cursorY)return n(),void clearInterval(s);i+=10,i>1e3&&(clearInterval(s),n())},10)})}setCwd(e){this._cwd=e}setIsWindowsPty(e){this._isWindowsPty=e}setIsCommandStorageDisabled(){this.__isCommandStorageDisabled=!0}getCwdForLine(e){return this._currentCommand.promptStartMarker&&e>=this._currentCommand.promptStartMarker?.line?this._cwd:[...this._commands].reverse().find(i=>i.marker.line<=e-1)?.cwd}handlePromptStart(e){this._currentCommand.promptStartMarker=e?.marker||this._terminal.registerMarker(0),this._logService.debug("CommandDetectionCapability#handlePromptStart",this._terminal.buffer.active.cursorX,this._currentCommand.promptStartMarker?.line)}handleContinuationStart(){this._currentCommand.currentContinuationMarker=this._terminal.registerMarker(0),this._logService.debug("CommandDetectionCapability#handleContinuationStart",this._currentCommand.currentContinuationMarker)}handleContinuationEnd(){this._currentCommand.currentContinuationMarker?(this._currentCommand.continuations||(this._currentCommand.continuations=[]),this._currentCommand.continuations.push({marker:this._currentCommand.currentContinuationMarker,end:this._terminal.buffer.active.cursorX}),this._currentCommand.currentContinuationMarker=void 0,this._logService.debug("CommandDetectionCapability#handleContinuationEnd",this._currentCommand.continuations[this._currentCommand.continuations.length-1])):this._logService.warn("CommandDetectionCapability#handleContinuationEnd Received continuation end without start")}handleRightPromptStart(){this._currentCommand.commandRightPromptStartX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptStart",this._currentCommand.commandRightPromptStartX)}handleRightPromptEnd(){this._currentCommand.commandRightPromptEndX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptEnd",this._currentCommand.commandRightPromptEndX)}handleCommandStart(e){if(this._handleCommandStartOptions=e,this._currentCommand.commandStartMarker=e?.marker||this._currentCommand.commandStartMarker,this._currentCommand.commandStartMarker?.line===this._terminal.buffer.active.cursorY)return this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,void this._logService.debug("CommandDetectionCapability#handleCommandStart",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line);if(this._isWindowsPty)this._handleCommandStartWindows();else{this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._currentCommand.commandStartMarker=e?.marker||this._terminal.registerMarker(0),this._currentCommand.commandExecutedMarker?.dispose(),this._currentCommand.commandExecutedMarker=void 0,this._currentCommand.commandExecutedX=void 0;for(const t of this._commandMarkers)t.dispose();this._commandMarkers.length=0,this._onCommandStarted.fire({marker:e?.marker||this._currentCommand.commandStartMarker,markProperties:e?.markProperties}),this._logService.debug("CommandDetectionCapability#handleCommandStart",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line)}}_handleCommandStartWindows(){this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._commandMarkers.length=0,(0,ne.Vs)(0).then(()=>{if(this._currentCommand.commandExecutedMarker||(this._onCursorMoveListener=this._terminal.onCursorMove(()=>{if(0===this._commandMarkers.length||this._commandMarkers[this._commandMarkers.length-1].line!==this._terminal.buffer.active.cursorY){const e=this._terminal.registerMarker(0);e&&this._commandMarkers.push(e)}})),this._currentCommand.commandStartMarker=this._terminal.registerMarker(0),this._currentCommand.commandStartMarker){const e=this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line);e&&(this._currentCommand.commandStartLineContent=e.translateToString(!0))}this._onCommandStarted.fire({marker:this._currentCommand.commandStartMarker}),this._logService.debug("CommandDetectionCapability#_handleCommandStartWindows",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line)})}handleGenericCommand(e){e?.markProperties?.disableCommandStorage&&this.setIsCommandStorageDisabled(),this.handlePromptStart(e),this.handleCommandStart(e),this.handleCommandExecuted(e),this.handleCommandFinished(void 0,e)}handleCommandExecuted(e){if(this._isWindowsPty)return void this._handleCommandExecutedWindows();if(this._currentCommand.commandExecutedMarker=e?.marker||this._terminal.registerMarker(0),this._currentCommand.commandExecutedX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleCommandExecuted",this._currentCommand.commandExecutedX,this._currentCommand.commandExecutedMarker?.line),!this._currentCommand.commandStartMarker||!this._currentCommand.commandExecutedMarker||void 0===this._currentCommand.commandStartX)return;this._currentCommand.command=this.__isCommandStorageDisabled?"":this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line)?.translateToString(!0,this._currentCommand.commandStartX,this._currentCommand.commandRightPromptStartX).trim();let t=this._currentCommand.commandStartMarker.line+1;const i=this._currentCommand.commandExecutedMarker.line;for(;t<i;t++){const n=this._terminal.buffer.active.getLine(t);if(n){const r=this._currentCommand.continuations?.find(l=>l.marker.line===t);r&&(this._currentCommand.command+="\n"),this._currentCommand.command+=n.translateToString(!0,r?.end??0)}}t===i&&(this._currentCommand.command+=this._terminal.buffer.active.getLine(i)?.translateToString(!0,void 0,this._currentCommand.commandExecutedX)||""),this._onCommandExecuted.fire()}_handleCommandExecutedWindows(){this._onCursorMoveListener?.dispose(),this._onCursorMoveListener=void 0,this._evaluateCommandMarkersWindows(),this._currentCommand.commandExecutedX=this._terminal.buffer.active.cursorX,this._onCommandExecuted.fire(),this._logService.debug("CommandDetectionCapability#handleCommandExecuted",this._currentCommand.commandExecutedX,this._currentCommand.commandExecutedMarker?.line)}invalidateCurrentCommand(e){this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire(e)}handleCommandFinished(e,t){this._isWindowsPty&&this._preHandleCommandFinishedWindows(),this._currentCommand.commandFinishedMarker=t?.marker||this._terminal.registerMarker(0);let i=this._currentCommand.command;if(this._logService.debug("CommandDetectionCapability#handleCommandFinished",this._terminal.buffer.active.cursorX,this._currentCommand.commandFinishedMarker?.line,this._currentCommand.command,this._currentCommand),this._exitCode=e,void 0===this._exitCode){const n=this.commands.length>0?this.commands[this.commands.length-1]:void 0;i&&i.length>0&&n?.command===i&&(this._exitCode=n.exitCode)}if(void 0!==this._currentCommand.commandStartMarker&&this._terminal.buffer.active){if(void 0===this._exitCode&&void 0===i&&(i=""),void 0!==i&&!i.startsWith("\\")||this._handleCommandStartOptions?.ignoreCommandLine){const n=this._terminal.buffer.active,r=Date.now(),s=this._currentCommand.commandExecutedMarker,l=this._currentCommand.commandFinishedMarker,d={command:this._handleCommandStartOptions?.ignoreCommandLine?"":i||"",isTrusted:!!this._currentCommand.isTrusted,marker:this._currentCommand.commandStartMarker,endMarker:l,executedMarker:s,timestamp:r,cwd:this._cwd,exitCode:this._exitCode,commandStartLineContent:this._currentCommand.commandStartLineContent,hasOutput:()=>!s?.isDisposed&&!l?.isDisposed&&!!(s&&l&&s?.line<l.line),getOutput:()=>Jo(s,l,n),getOutputMatch:h=>Yo(this._isWindowsPty&&s?.line===l?.line?this._currentCommand.commandStartMarker:s,l,n,this._terminal.cols,h),markProperties:t?.markProperties};this._commands.push(d),this._logService.debug("CommandDetectionCapability#onCommandFinished",d),this._onBeforeCommandFinished.fire(d),this._currentCommand.isInvalid||this._onCommandFinished.fire(d)}this._currentCommand.previousCommandMarker=this._currentCommand.commandStartMarker,this._currentCommand={},this._handleCommandStartOptions=void 0}}_preHandleCommandFinishedWindows(){this._currentCommand.commandExecutedMarker||(0===this._commandMarkers.length&&(this._currentCommand.commandStartMarker||(this._currentCommand.commandStartMarker=this._terminal.registerMarker(0)),this._currentCommand.commandStartMarker&&this._commandMarkers.push(this._currentCommand.commandStartMarker)),this._evaluateCommandMarkersWindows())}_evaluateCommandMarkersWindows(){if(0!==this._commandMarkers.length){if(this._commandMarkers=this._commandMarkers.sort((e,t)=>e.line-t.line),this._currentCommand.commandStartMarker=this._commandMarkers[0],this._currentCommand.commandStartMarker){const e=this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line);e&&(this._currentCommand.commandStartLineContent=e.translateToString(!0))}this._currentCommand.commandExecutedMarker=this._commandMarkers[this._commandMarkers.length-1]}}setCommandLine(e,t){this._logService.debug("CommandDetectionCapability#setCommandLine",e,t),this._currentCommand.command=e,this._currentCommand.isTrusted=t}serialize(){const e=this.commands.map(t=>({startLine:t.marker?.line,startX:void 0,endLine:t.endMarker?.line,executedLine:t.executedMarker?.line,command:this.__isCommandStorageDisabled?"":t.command,isTrusted:t.isTrusted,cwd:t.cwd,exitCode:t.exitCode,commandStartLineContent:t.commandStartLineContent,timestamp:t.timestamp,markProperties:t.markProperties,aliases:t.aliases}));return this._currentCommand.commandStartMarker&&e.push({startLine:this._currentCommand.commandStartMarker.line,startX:this._currentCommand.commandStartX,endLine:void 0,executedLine:void 0,command:"",isTrusted:!0,cwd:this._cwd,exitCode:void 0,commandStartLineContent:void 0,timestamp:0,markProperties:void 0}),{isWindowsPty:this._isWindowsPty,commands:e}}deserialize(e){e.isWindowsPty&&this.setIsWindowsPty(e.isWindowsPty);const t=this._terminal.buffer.normal;for(const i of e.commands){const n=void 0!==i.startLine?this._terminal.registerMarker(i.startLine-(t.baseY+t.cursorY)):void 0;if(!n)continue;if(!i.endLine){this._currentCommand.commandStartMarker=n,this._currentCommand.commandStartX=i.startX,this._cwd=i.cwd,this._onCommandStarted.fire({marker:n});continue}const r=void 0!==i.endLine?this._terminal.registerMarker(i.endLine-(t.baseY+t.cursorY)):void 0,s=void 0!==i.executedLine?this._terminal.registerMarker(i.executedLine-(t.baseY+t.cursorY)):void 0,l={command:this.__isCommandStorageDisabled?"":i.command,isTrusted:i.isTrusted,marker:n,endMarker:r,executedMarker:s,timestamp:i.timestamp,cwd:i.cwd,commandStartLineContent:i.commandStartLineContent,exitCode:i.exitCode,hasOutput:()=>!s?.isDisposed&&!r?.isDisposed&&!!(s&&r&&s.line<r.line),getOutput:()=>Jo(s,r,t),getOutputMatch:d=>Yo(this._isWindowsPty&&s?.line===r?.line?n:s,r,t,this._terminal.cols,d),markProperties:i.markProperties,wasReplayed:!0};this._commands.push(l),this._logService.debug("CommandDetectionCapability#onCommandFinished",l),this._onCommandFinished.fire(l)}}};function Jo(o,e,t){if(!o||!e)return;const i=o.line,n=e.line;if(i===n)return;let s,r="";for(let l=i;l<n;l++)s=t.getLine(l),s&&(r+=s.translateToString(!s.isWrapped)+(s.isWrapped?"":"\n"));return""===r?void 0:r}function Yo(o,e,t,i,n){if(!o||!e)return;const r=e.line;if(-1===r)return;const s=Math.max(o.line,0),l=n.lineMatcher,d="string"==typeof l?1:n.length||function Za(o){if(!o.multiline)return 1;const e=o.source;let t=1,i=e.indexOf("\\n");for(;-1!==i;)t++,i=e.indexOf("\\n",i+1);return t}(l),h=[];let f;if("bottom"===n.anchor)for(let v=r-(n.offset||0);v>=s;v--){let b=v;const _=v;for(;b>=s&&t.getLine(b)?.isWrapped;)b--;if(v=b,h.unshift(es(t,b,_,i)),f||(f=h[0].match(l)),h.length>=d)break}else for(let v=s+(n.offset||0);v<r;v++){const b=v;let _=v;for(;_+1<r&&t.getLine(_+1)?.isWrapped;)_++;if(v=_,h.push(es(t,b,_,i)),f||(f=h[h.length-1].match(l)),h.length>=d)break}return f?{regexMatch:f,outputLines:h}:void 0}function es(o,e,t,i){const n=Math.max(2048/i*2);t=Math.min(t,e+n);let r="";for(let s=e;s<=t;s++){const l=o.getLine(s);l&&(r+=l.translateToString(!0,0,i))}return r}li.__decorator=(0,c.gn)([(0,ve.Ds)(500)],li.prototype,"_handleCursorMove",null),li=(0,c.gn)([(0,c.fM)(1,De.VZ)],li);class Ua{constructor(){this.type=0,this._cwd="",this._cwds=new Map,this._onDidChangeCwd=new w.Q5,this.onDidChangeCwd=this._onDidChangeCwd.event}get cwds(){return Array.from(this._cwds.keys())}getCwd(){return this._cwd}updateCwd(e){const t=this._cwd!==e;this._cwd=e;const i=this._cwds.get(this._cwd)||0;this._cwds.delete(this._cwd),this._cwds.set(this._cwd,i+1),t&&this._onDidChangeCwd.fire(e)}}class Ka{get commands(){return this._commands}constructor(e){this._terminal=e,this.type=3,this._commands=[],this._onCommandFinished=new w.Q5,this.onCommandFinished=this._onCommandFinished.event,this._terminal.onData(t=>this._onData(t)),this._terminal.parser.registerCsiHandler({final:"J"},t=>(t.length>=1&&(2===t[0]||3===t[0])&&this._clearCommandsInViewport(),!1))}_onData(e){"\r"===e&&this._onEnter()}_onEnter(){if(this._terminal&&this._terminal.buffer.active.cursorX>=2){const e=this._terminal.registerMarker(0);e&&(this._commands.push(e),this._onCommandFinished.fire(e))}}_clearCommandsInViewport(){let e=0;for(let t=this._commands.length-1;t>=0&&!(this._commands[t].line<this._terminal.buffer.active.baseY);t--)e++;this._commands.splice(this._commands.length-e,e)}}class Qa{constructor(e){this._terminal=e,this.type=4,this._idToMarkerMap=new Map,this._anonymousMarkers=new Map,this._onMarkAdded=new w.Q5,this.onMarkAdded=this._onMarkAdded.event}*markers(){for(const e of this._idToMarkerMap.values())yield e;for(const e of this._anonymousMarkers.values())yield e}addMark(e){const t=e?.marker||this._terminal.registerMarker(),i=e?.id;t&&(i?(this._idToMarkerMap.set(i,t),t.onDispose(()=>this._idToMarkerMap.delete(i))):(this._anonymousMarkers.set(t.id,t),t.onDispose(()=>this._anonymousMarkers.delete(t.id))),this._onMarkAdded.fire({marker:t,id:i,hidden:e?.hidden,hoverMessage:e?.hoverMessage}))}getMark(e){return this._idToMarkerMap.get(e)}}let lr=class extends A.JT{get status(){return this._status}constructor(e,t,i,n){super(),this._nonce=e,this._disableTelemetry=t,this._telemetryService=i,this._logService=n,this.capabilities=new Fo,this._hasUpdatedTelemetry=!1,this._commonProtocolDisposables=[],this._status=0,this._onDidChangeStatus=new w.Q5,this.onDidChangeStatus=this._onDidChangeStatus.event,this._register((0,A.OF)(()=>{this._clearActivationTimeout(),this._disposeCommonProtocol()}))}_disposeCommonProtocol(){(0,A.B9)(this._commonProtocolDisposables),this._commonProtocolDisposables.length=0}activate(e){this._terminal=e,this.capabilities.add(3,new Ka(this._terminal)),this._register(e.parser.registerOscHandler(633,t=>this._handleVSCodeSequence(t))),this._register(e.parser.registerOscHandler(1337,t=>this._doHandleITermSequence(t))),this._commonProtocolDisposables.push(e.parser.registerOscHandler(133,t=>this._handleFinalTermSequence(t))),this._register(e.parser.registerOscHandler(7,t=>this._doHandleSetCwd(t))),this._register(e.parser.registerOscHandler(9,t=>this._doHandleSetWindowsFriendlyCwd(t))),this._ensureCapabilitiesOrAddFailureTelemetry()}_handleFinalTermSequence(e){const t=this._doHandleFinalTermSequence(e);return 0===this._status&&(this._status=1,this._onDidChangeStatus.fire(this._status)),t}_doHandleFinalTermSequence(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");switch(t){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart({ignoreCommandLine:!0}),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{const n=1===i.length?parseInt(i[0]):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(n),!0}}return!1}_handleVSCodeSequence(e){const t=this._doHandleVSCodeSequence(e);return!this._hasUpdatedTelemetry&&t&&(this._telemetryService?.publicLog2("terminal/shellIntegrationActivationSucceeded"),this._hasUpdatedTelemetry=!0,this._clearActivationTimeout()),2!==this._status&&(this._status=2,this._onDidChangeStatus.fire(this._status)),t}_ensureCapabilitiesOrAddFailureTelemetry(){var e=this;return(0,u.Z)(function*(){!e._telemetryService||e._disableTelemetry||(e._activationTimeout=setTimeout(()=>{!e.capabilities.get(2)&&!e.capabilities.get(0)&&(e._telemetryService?.publicLog2("terminal/shellIntegrationActivationTimeout"),e._logService.warn("Shell integration failed to add capabilities within 10 seconds")),e._hasUpdatedTelemetry=!0},1e4))})()}_clearActivationTimeout(){void 0!==this._activationTimeout&&(clearTimeout(this._activationTimeout),this._activationTimeout=void 0)}_doHandleVSCodeSequence(e){if(!this._terminal)return!1;const t=e.indexOf(";"),i=-1===t?e:e.substring(0,t),n=-1===t?[]:e.substring(t+1).split(";");switch(i){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart(),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{const r=n[0],s=void 0!==r?parseInt(r):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(s),!0}case"E":{const r=n[0],s=n[1];let l;return l=void 0!==r?ts(r):"",this._createOrGetCommandDetection(this._terminal).setCommandLine(l,s===this._nonce),!0}case"F":return this._createOrGetCommandDetection(this._terminal).handleContinuationStart(),!0;case"G":return this._createOrGetCommandDetection(this._terminal).handleContinuationEnd(),!0;case"H":return this._createOrGetCommandDetection(this._terminal).handleRightPromptStart(),!0;case"I":return this._createOrGetCommandDetection(this._terminal).handleRightPromptEnd(),!0;case"P":{const r=n[0],s=void 0!==r?ts(r):"",{key:l,value:d}=is(s);if(void 0===d)return!0;switch(l){case"Cwd":return this._updateCwd(d),!0;case"IsWindows":return this._createOrGetCommandDetection(this._terminal).setIsWindowsPty("True"===d),!0;case"Task":return this._createOrGetBufferMarkDetection(this._terminal),this.capabilities.get(2)?.setIsCommandStorageDisabled(),!0}}case"SetMark":return this._createOrGetBufferMarkDetection(this._terminal).addMark(function ja(o){let e,t=!1;for(const i of o)void 0!==i&&("Hidden"===i&&(t=!0),i.startsWith("Id=")&&(e=i.substring(3)));return{id:e,hidden:t}}(n)),!0}return!1}_updateCwd(e){e=jn(e),this._createOrGetCwdDetection().updateCwd(e),this.capabilities.get(2)?.setCwd(e)}_doHandleITermSequence(e){if(!this._terminal)return!1;const[t]=e.split(";");"SetMark"===t&&this._createOrGetBufferMarkDetection(this._terminal).addMark();{const{key:i,value:n}=is(t);if(void 0===n)return!0;if("CurrentDir"===i)return this._updateCwd(n),!0}return!1}_doHandleSetWindowsFriendlyCwd(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");return"9"===t&&(i.length&&this._updateCwd(i[0]),!0)}_doHandleSetCwd(e){if(!this._terminal)return!1;const[t]=e.split(";");if(t.match(/^file:\/\/.*\//)){const i=N.ov.parse(t);if(i.path&&i.path.length>0)return this._updateCwd(i.path),!0}return!1}serialize(){return this._terminal&&this.capabilities.has(2)?this._createOrGetCommandDetection(this._terminal).serialize():{isWindowsPty:!1,commands:[]}}deserialize(e){if(!this._terminal)throw new Error("Cannot restore commands before addon is activated");this._createOrGetCommandDetection(this._terminal).deserialize(e)}_createOrGetCwdDetection(){let e=this.capabilities.get(0);return e||(e=new Ua,this.capabilities.add(0,e)),e}_createOrGetCommandDetection(e){let t=this.capabilities.get(2);return t||(t=new li(e,this._logService),this.capabilities.add(2,t)),t}_createOrGetBufferMarkDetection(e){let t=this.capabilities.get(4);return t||(t=new Qa(e),this.capabilities.add(4,t)),t}};function ts(o){return o.replaceAll(/\\(\\|x([0-9a-f]{2}))/gi,(e,t,i)=>i?String.fromCharCode(parseInt(i,16)):t)}function is(o){const e=o.indexOf("=");return-1===e?{key:o,value:void 0}:{key:o.substring(0,e),value:o.substring(1+e)}}lr=(0,c.gn)([(0,c.fM)(3,De.VZ)],lr);var Ui=p(63171);let cr=class extends A.JT{constructor(e,t,i){super(),this._hoverService=e,this._contextMenuVisible=!1,this._register(i.onDidShowContextMenu(()=>this._contextMenuVisible=!0)),this._register(i.onDidHideContextMenu(()=>this._contextMenuVisible=!1)),this._hoverDelayer=this._register(new ne.vp(t.getValue("workbench.hover.delay")))}hideHover(){this._hoverDelayer.cancel(),this._hoverService.hideHover()}createHover(e,t,i){return(0,A.F8)(S.nm(e,S.tw.MOUSE_ENTER,()=>{this._contextMenuVisible||this._hoverDelayer.trigger(()=>{let n=`${(0,a.NC)("terminalPromptContextMenu","Show Command Actions")}`;if(n+="\n\n---\n\n",t)if(t.markProperties||i){if(!t.markProperties?.hoverMessage&&!i)return;n=t.markProperties?.hoverMessage||i||""}else n+=t.exitCode?-1===t.exitCode?(0,a.NC)("terminalPromptCommandFailed","Command executed {0} and failed",(0,Qt.Z)(t.timestamp,!0)):(0,a.NC)("terminalPromptCommandFailedWithExitCode","Command executed {0} and failed (Exit Code {1})",(0,Qt.Z)(t.timestamp,!0),t.exitCode):(0,a.NC)("terminalPromptCommandSuccess","Command executed {0}",(0,Qt.Z)(t.timestamp,!0));else{if(!i)return;n=i}this._hoverService.showHover({content:new Q.W5(n),target:e})})}),S.nm(e,S.tw.MOUSE_LEAVE,()=>this.hideHover()),S.nm(e,S.tw.MOUSE_OUT,()=>this.hideHover()))}};function dr(o,e){if(!e)return;const t=o.inspect("terminal.integrated.fontSize").value,i=o.inspect("terminal.integrated.fontSize").defaultValue,n=o.inspect("terminal.integrated.lineHeight").value;if("number"==typeof t&&"number"==typeof i&&"number"==typeof n){const r=t/i<=1?t/i:1;e.style.width=16*r+"px",e.style.height=16*r*n+"px",e.style.fontSize=16*r+"px",e.style.marginLeft=-17*r+"px"}}cr=(0,c.gn)([(0,c.fM)(0,Ui.B),(0,c.fM)(1,ie.Ui),(0,c.fM)(2,$e.i)],cr);var Ki=p(83772);let hr=class extends A.JT{constructor(e,t,i,n,r,s,l,d,h,f,v,b){super(),this._capabilities=e,this._clipboardService=t,this._contextMenuService=i,this._configurationService=n,this._themeService=r,this._openerService=s,this._quickInputService=l,this._commandService=h,this._audioCueService=v,this._notificationService=b,this._capabilityDisposables=new Map,this._decorations=new Map,this._onDidRequestRunCommand=this._register(new w.Q5),this.onDidRequestRunCommand=this._onDidRequestRunCommand.event,this._register((0,A.OF)(()=>this._dispose())),this._register(this._configurationService.onDidChangeConfiguration(_=>{_.affectsConfiguration("terminal.integrated.fontSize")||_.affectsConfiguration("terminal.integrated.lineHeight")?this.refreshLayouts():_.affectsConfiguration("workbench.colorCustomizations")?this._refreshStyles(!0):_.affectsConfiguration("terminal.integrated.shellIntegration.decorationsEnabled")&&(this._removeCapabilityDisposables(2),this._updateDecorationVisibility())})),this._register(this._themeService.onDidColorThemeChange(()=>this._refreshStyles(!0))),this._updateDecorationVisibility(),this._register(this._capabilities.onDidAddCapability(_=>this._createCapabilityDisposables(_))),this._register(this._capabilities.onDidRemoveCapability(_=>this._removeCapabilityDisposables(_))),this._register(d.onWillShutdown(()=>this._disposeAllDecorations())),this._terminalDecorationHoverService=f.createInstance(cr)}_removeCapabilityDisposables(e){const t=this._capabilityDisposables.get(e);t&&(0,A.B9)(t),this._capabilityDisposables.delete(e)}_createCapabilityDisposables(e){let t=[];const i=this._capabilities.get(e);if(i&&!this._capabilityDisposables.has(e)){switch(i.type){case 4:t=[i.onMarkAdded(n=>this.registerMarkDecoration(n))];break;case 2:t=this._getCommandDetectionListeners(i)}this._capabilityDisposables.set(e,t)}}registerMarkDecoration(e){if(this._terminal&&(this._showGutterDecorations||this._showOverviewRulerDecorations)&&!e.hidden)return this.registerCommandDecoration(void 0,void 0,e)}_updateDecorationVisibility(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled");this._showGutterDecorations="both"===e||"gutter"===e,this._showOverviewRulerDecorations="both"===e||"overviewRuler"===e,this._disposeAllDecorations(),(this._showGutterDecorations||this._showOverviewRulerDecorations)&&(this._attachToCommandCapability(),this._updateGutterDecorationVisibility());const t=this._capabilities.get(2)?.executingCommandObject;t&&this.registerCommandDecoration(t,!0)}_disposeAllDecorations(){this._placeholderDecoration?.dispose();for(const e of this._decorations.values())e.decoration.dispose(),(0,A.B9)(e.disposables)}_updateGutterDecorationVisibility(){const e=document.querySelectorAll("terminal-command-decoration");for(const t of e)this._updateCommandDecorationVisibility(t)}_updateCommandDecorationVisibility(e){this._showGutterDecorations?e.classList.remove("hide"):e.classList.add("hide")}refreshLayouts(){dr(this._configurationService,this._placeholderDecoration?.element);for(const e of this._decorations)dr(this._configurationService,e[1].decoration.element)}_refreshStyles(e){if(e)for(const t of this._decorations.values()){const i=this._getDecorationCssColor(t)?.toString()??"";t.decoration.options?.overviewRulerOptions?t.decoration.options.overviewRulerOptions.color=i:t.decoration.options&&(t.decoration.options.overviewRulerOptions={color:i})}this._updateClasses(this._placeholderDecoration?.element);for(const t of this._decorations.values())this._updateClasses(t.decoration.element,t.exitCode,t.markProperties)}_dispose(){this._terminalDecorationHoverService.dispose();for(const e of this._capabilityDisposables.values())(0,A.B9)(e);this.clearDecorations()}_clearPlaceholder(){this._placeholderDecoration?.dispose(),this._placeholderDecoration=void 0}clearDecorations(){this._placeholderDecoration?.marker.dispose(),this._clearPlaceholder(),this._disposeAllDecorations(),this._decorations.clear()}_attachToCommandCapability(){this._capabilities.has(2)&&this._getCommandDetectionListeners(this._capabilities.get(2))}_getCommandDetectionListeners(e){if(this._capabilityDisposables.has(2)){const i=this._capabilityDisposables.get(2);(0,A.B9)(i),this._capabilityDisposables.delete(e.type)}const t=[];e.executingCommandObject?.marker&&this.registerCommandDecoration(e.executingCommandObject,!0),t.push(e.onCommandStarted(i=>this.registerCommandDecoration(i,!0)));for(const i of e.commands)this.registerCommandDecoration(i);return t.push(e.onCommandFinished(i=>{this.registerCommandDecoration(i),i.exitCode&&this._audioCueService.playAudioCue(Ki.y$.terminalCommandFailed)})),t.push(e.onCommandInvalidated(i=>{for(const n of i){const r=n.marker?.id;if(r){const s=this._decorations.get(r);s&&(s.decoration.dispose(),(0,A.B9)(s.disposables))}}})),t.push(e.onCurrentCommandInvalidated(i=>{"noProblemsReported"===i.reason?Array.from(this._decorations.entries())[this._decorations.size-1]?.[1].decoration.dispose():"windows"===i.reason&&this._clearPlaceholder()})),t}activate(e){this._terminal=e,this._attachToCommandCapability()}registerCommandDecoration(e,t,i){if(!this._terminal||t&&!e||!this._showGutterDecorations&&!this._showOverviewRulerDecorations)return;const n=e?.marker||i?.marker;if(!n)throw new Error(`cannot add a decoration for a command ${JSON.stringify(e)} with no marker`);this._clearPlaceholder();const r=this._getDecorationCssColor(e)?.toString()??"",s=this._terminal.registerDecoration({marker:n,overviewRulerOptions:this._showOverviewRulerDecorations?t?{color:r,position:"left"}:{color:r,position:e?.exitCode?"right":"left"}:void 0});return s?(t&&(this._placeholderDecoration=s),s.onRender(l=>{l.classList.contains(".xterm-decoration-overview-ruler")||(this._decorations.get(s.marker.id)||(s.onDispose(()=>this._decorations.delete(s.marker.id)),this._decorations.set(s.marker.id,{decoration:s,disposables:this._createDisposables(l,e,i),exitCode:e?.exitCode,markProperties:e?.markProperties})),(!l.classList.contains("codicon")||0===e?.marker?.line)&&(dr(this._configurationService,l),this._updateClasses(l,e?.exitCode,e?.markProperties||i)))}),s):void 0}_createDisposables(e,t,i){return void 0!==t?.exitCode||t?.markProperties?t?.markProperties||i?[this._terminalDecorationHoverService.createHover(e,t||i,i?.hoverMessage)]:[this._createContextMenu(e,t),this._terminalDecorationHoverService.createHover(e,t)]:[]}_updateClasses(e,t,i){if(e){for(const n of e.classList)e.classList.remove(n);e.classList.add("terminal-command-decoration","codicon","xterm-decoration"),i?(e.classList.add("default-color",...H.kS.asClassNameArray(Ws)),i.hoverMessage||e.classList.add("default")):(this._updateCommandDecorationVisibility(e),void 0===t?(e.classList.add("default-color","default"),e.classList.add(...H.kS.asClassNameArray(Bs))):t?(e.classList.add("error"),e.classList.add(...H.kS.asClassNameArray(Fs))):e.classList.add(...H.kS.asClassNameArray(Os)))}}_createContextMenu(e,t){var i=this;return S.nm(e,S.tw.CLICK,(0,u.Z)(function*(){i._terminalDecorationHoverService.hideHover();const n=yield i._getCommandActions(t);i._contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>n})}))}_getCommandActions(e){var t=this;return(0,u.Z)(function*(){const i=[];if(""!==e.command){const d=(0,a.NC)("terminal.rerunCommand","Rerun Command");i.push({class:void 0,tooltip:d,id:"terminal.rerunCommand",label:d,enabled:!0,run:(f=(0,u.Z)(function*(){""!==e.command&&(!e.isTrusted&&!(yield new Promise(b=>{t._notificationService.prompt(R.zb.Info,(0,a.NC)("rerun","Do you want to run the command: {0}",e.command),[{label:(0,a.NC)("yes","Yes"),run:()=>b(!0)},{label:(0,a.NC)("no","No"),run:()=>b(!1)}])}))||t._onDidRequestRunCommand.fire({command:e}))}),function(){return f.apply(this,arguments)})});const h=(0,a.NC)("terminal.copyCommand","Copy Command");i.push({class:void 0,tooltip:h,id:"terminal.copyCommand",label:h,enabled:!0,run:()=>t._clipboardService.writeText(e.command)})}var f;if(e.hasOutput()){i.length>0&&i.push(new X.Z0);const d=(0,a.NC)("terminal.copyOutput","Copy Output");i.push({class:void 0,tooltip:d,id:"terminal.copyOutput",label:d,enabled:!0,run:()=>{const f=e.getOutput();"string"==typeof f&&t._clipboardService.writeText(f)}});const h=(0,a.NC)("terminal.copyOutputAsHtml","Copy Output as HTML");i.push({class:void 0,tooltip:h,id:"terminal.copyOutputAsHtml",label:h,enabled:!0,run:()=>t._onDidRequestRunCommand.fire({command:e,copyAsHtml:!0})})}i.length>0&&i.push(new X.Z0);const n=(0,a.NC)("workbench.action.terminal.runRecentCommand","Run Recent Command");i.push({class:void 0,tooltip:n,id:"workbench.action.terminal.runRecentCommand",label:n,enabled:!0,run:()=>t._commandService.executeCommand("workbench.action.terminal.runRecentCommand")});const r=(0,a.NC)("workbench.action.terminal.goToRecentDirectory","Go To Recent Directory");i.push({class:void 0,tooltip:n,id:"workbench.action.terminal.goToRecentDirectory",label:r,enabled:!0,run:()=>t._commandService.executeCommand("workbench.action.terminal.goToRecentDirectory")}),i.push(new X.Z0);const s=(0,a.NC)("terminal.configureCommandDecorations","Configure Command Decorations");i.push({class:void 0,tooltip:s,id:"terminal.configureCommandDecorations",label:s,enabled:!0,run:()=>t._showConfigureCommandDecorationsQuickPick()});const l=(0,a.NC)("terminal.learnShellIntegration","Learn About Shell Integration");return i.push({class:void 0,tooltip:l,id:"terminal.learnShellIntegration",label:l,enabled:!0,run:()=>t._openerService.open("https://code.visualstudio.com/docs/terminal/shell-integration")}),i})()}_showConfigureCommandDecorationsQuickPick(){var e=this;return(0,u.Z)(function*(){const t=e._quickInputService.createQuickPick();t.items=[{id:"a",label:(0,a.NC)("toggleVisibility","Toggle visibility")}],t.canSelectMany=!1,t.onDidAccept(function(){var i=(0,u.Z)(function*(n){"a"===(t.hide(),t.activeItems[0].id)&&e._showToggleVisibilityQuickPick()});return function(n){return i.apply(this,arguments)}}()),t.show()})()}_showToggleVisibilityQuickPick(){var e=this;const t=this._quickInputService.createQuickPick();t.hideInput=!0,t.hideCheckAll=!0,t.canSelectMany=!0,t.title=(0,a.NC)("toggleVisibility","Toggle visibility");const i=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled"),n={label:(0,a.NC)("gutter","Gutter command decorations"),picked:"never"!==i&&"overviewRuler"!==i},r={label:(0,a.NC)("overviewRuler","Overview ruler command decorations"),picked:"never"!==i&&"gutter"!==i};t.items=[n,r];const s=[];"never"!==i&&("gutter"!==i&&s.push(n),"overviewRuler"!==i&&s.push(r)),t.selectedItems=s,t.onDidChangeSelection(function(){var l=(0,u.Z)(function*(d){let h="never";d.includes(n)?h=d.includes(r)?"both":"gutter":d.includes(r)&&(h="overviewRuler"),yield e._configurationService.updateValue("terminal.integrated.shellIntegration.decorationsEnabled",h)});return function(d){return l.apply(this,arguments)}}()),t.ok=!1,t.show()}_getDecorationCssColor(e){let t;return t=void 0===e?.exitCode?j.oA:e.exitCode?j.on:j.ZQ,this._themeService.getColorTheme().getColor(t)?.toString()}};hr=(0,c.gn)([(0,c.fM)(1,pn.p),(0,c.fM)(2,$e.i),(0,c.fM)(3,ie.Ui),(0,c.fM)(4,me.XE),(0,c.fM)(5,Gt.v4),(0,c.fM)(6,we.eJ),(0,c.fM)(7,Hi.g),(0,c.fM)(8,se.H),(0,c.fM)(9,G.TG),(0,c.fM)(10,Ki.e7),(0,c.fM)(11,R.lT)],hr);class ur{constructor(e){this.completion=e,this.score=Ke.CL.Default,this.distance=0,this.labelLow=this.completion.label.toLowerCase()}}class mr{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}}class ns{constructor(e,t,i,n){this._items=e,this._lineContext=t,this.replacementIndex=i,this.replacementLength=n,this._refilterKind=1,this._fuzzyScoreOptions=Ke.mX.default,this._options={}}get items(){return this._ensureCachedState(),this._filteredItems}get stats(){return this._ensureCachedState(),this._stats}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}_ensureCachedState(){0!==this._refilterKind&&this._createCachedState()}_createCachedState(){const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",r="";const s=1===this._refilterKind?this._items:this._filteredItems,l=[],d=!this._options.filterGraceful||s.length>2e3?Ke.EW:Ke.l7;for(let h=0;h<s.length;h++){const f=s[h],v=this.replacementLength,b=v+i;if(n.length!==b&&(n=0===b?"":t.slice(-b),r=n.toLowerCase()),f.word=n,0===b)f.score=Ke.CL.Default;else{let _=0;for(;_<v;){const C=n.charCodeAt(_);if(32!==C&&9!==C)break;_+=1}if(_>=b)f.score=Ke.CL.Default;else{const C=d(n,r,_,f.completion.label,f.labelLow,0,this._fuzzyScoreOptions);if(!C)continue;f.score=C}}f.idx=h,f.distance=1,l.push(f),e.push(f.completion.label.length)}this._filteredItems=l,this._refilterKind=0,this._stats={pLabelLen:e.length?(0,Mt.HW)(e.length-.85,e,(h,f)=>h-f):0}}}(0,yt.Z)('.workbench-suggest-widget{display:flex;flex-direction:column;left:0;position:absolute;top:0;width:430px;z-index:40}.workbench-suggest-widget.message{align-items:center;flex-direction:row}.monaco-workbench .workbench-suggest-details,.workbench-suggest-widget{background-color:var(--vscode-editorSuggestWidget-background);border-color:var(--vscode-editorSuggestWidget-border);border-style:solid;border-width:1px;flex:0 1 auto;width:100%}.monaco-workbench.hc-black .workbench-suggest-details,.monaco-workbench.hc-black .workbench-suggest-widget,.monaco-workbench.hc-light .workbench-suggest-details,.monaco-workbench.hc-light .workbench-suggest-widget{border-width:2px}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar{display:flex}.monaco-workbench .workbench-suggest-widget .suggest-status-bar .left{padding-right:8px}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-label{color:var(--vscode-editorSuggestWidgetStatus-foreground)}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-item:not(:last-of-type) .action-label{margin-right:0}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-item:not(:last-of-type) .action-label:after{content:", ";margin-right:.3em}.monaco-workbench .workbench-suggest-widget.with-status-bar .monaco-list .monaco-list-row.focused.string-label>.contents>.main>.right>.readMore,.monaco-workbench .workbench-suggest-widget.with-status-bar .monaco-list .monaco-list-row>.contents>.main>.right>.readMore{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row{background-position:2px 2px;background-repeat:no-repeat;-mox-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:flex;padding-right:10px;touch-action:none;white-space:nowrap}.workbench-suggest-widget .monaco-list .monaco-list-row.focused{color:var(--vscode-editorSuggestWidget-selectedForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row.focused .codicon{color:var(--vscode-editorSuggestWidget-selectedIconForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents{flex:1;height:100%;overflow:hidden;padding-left:2px}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main{display:flex;justify-content:space-between;overflow:hidden;text-overflow:ellipsis;white-space:pre}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left,.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right{display:flex}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.focused)>.contents>.main .monaco-icon-label{color:var(--vscode-editorSuggestWidget-foreground)}.workbench-suggest-widget:not(.frozen) .monaco-highlighted-label .highlight{font-weight:700}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main .monaco-highlighted-label .highlight{color:var(--vscode-editorSuggestWidget-highlightForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row.focused>.contents>.main .monaco-highlighted-label .highlight{color:var(--vscode-editorSuggestWidget-focusHighlightForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label.deprecated{opacity:.66;text-decoration:unset}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label.deprecated>.monaco-icon-label-container>.monaco-icon-name-container{text-decoration:line-through}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label:before{height:100%}.workbench-suggest-widget .monaco-list .monaco-list-row .icon{background-position:50%;background-repeat:no-repeat;background-size:80%;display:block;height:16px;margin-left:2px;width:16px}.workbench-suggest-widget .monaco-list .monaco-list-row .icon.hide{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row .suggest-icon{align-items:center;display:flex;margin-right:4px}.workbench-suggest-widget.no-icons .monaco-list .monaco-list-row .icon,.workbench-suggest-widget.no-icons .monaco-list .monaco-list-row .suggest-icon:before{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row .icon.customcolor .colorspan{border:.1em solid #000;display:inline-block;height:.7em;margin:0 0 0 .3em;width:.7em}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{opacity:.7}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.signature-label{opacity:.6;overflow:hidden;text-overflow:ellipsis}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.qualifier-label{align-self:center;font-size:85%;line-height:normal;margin-left:12px;opacity:.4;overflow:hidden;text-overflow:ellipsis}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{font-size:85%;margin-left:1.1em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label>.monaco-tokenized-source{display:inline}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.string-label)>.contents>.main>.right>.details-label,.workbench-suggest-widget.docs-side .monaco-list .monaco-list-row.focused:not(.string-label)>.contents>.main>.right>.details-label,.workbench-suggest-widget:not(.shows-details) .monaco-list .monaco-list-row.focused>.contents>.main>.right>.details-label{display:inline}.workbench-suggest-widget:not(.docs-side) .monaco-list .monaco-list-row.focused:hover>.contents>.main>.right.can-expand-details>.details-label{width:calc(100% - 26px)}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left{flex-grow:1;flex-shrink:1;overflow:hidden}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.monaco-icon-label{flex-shrink:0}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.string-label)>.contents>.main>.left>.monaco-icon-label{max-width:100%}.workbench-suggest-widget .monaco-list .monaco-list-row.string-label>.contents>.main>.left>.monaco-icon-label{flex-shrink:1}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right{flex-shrink:4;max-width:70%;overflow:hidden}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.readMore{display:inline-block;height:18px;position:absolute;right:10px;visibility:hidden;width:18px}',{});var Xa=p(82553),Ja=p(82498),Ya=p(19608);class tl{constructor(){this._onDidToggleDetails=new w.Q5,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new A.SL,i=e;i.classList.add("show-file-icons");const n=(0,S.R3)(e,(0,S.$)(".icon")),r=(0,S.R3)(n,(0,S.$)("span.colorspan")),s=(0,S.R3)(e,(0,S.$)(".contents")),l=(0,S.R3)(s,(0,S.$)(".main")),d=(0,S.R3)(l,(0,S.$)(".icon-label.codicon")),h=(0,S.R3)(l,(0,S.$)("span.left")),f=(0,S.R3)(l,(0,S.$)("span.right")),v=new Ya.g(h,{supportHighlights:!0,supportIcons:!0});t.add(v);const b=(0,S.R3)(h,(0,S.$)("span.signature-label")),_=(0,S.R3)(h,(0,S.$)("span.qualifier-label")),C=(0,S.R3)(f,(0,S.$)("span.details-label"));return(()=>{const te="20px";i.style.fontSize="12px",i.style.fontWeight="normal",i.style.letterSpacing="0px",l.style.fontFamily="Hack",l.style.fontFeatureSettings="",l.style.lineHeight=te,n.style.height=te,n.style.width=te})(),{root:i,left:h,right:f,icon:n,colorspan:r,iconLabel:v,iconContainer:d,parametersLabel:b,qualifierLabel:_,detailsLabel:C,disposables:t}}renderElement(e,t,i){const{completion:n}=e;i.root.id=function el(o){return`simple-suggest-aria-id:${o}`}(t),i.colorspan.style.backgroundColor="";const r={labelEscapeNewLines:!0,matches:(0,Ke.mB)(e.score)};i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...H.kS.asClassNameArray(n.icon||E.lA.symbolText)),i.iconLabel.setLabel(n.label,void 0,r),i.parametersLabel.textContent="",i.detailsLabel.textContent=function il(o){return o.replace(/\r\n|\r|\n/g,"")}(n.detail||""),i.root.classList.add("string-label"),(0,S.$Z)(i.detailsLabel),i.right.classList.remove("can-expand-details")}disposeTemplate(e){e.disposables.dispose()}}var nl=p(32536),rl=p(8979);const ol=S.$;let fr=class{get list(){return this._list}constructor(e,t,i,n){this._container=e,this._persistedSize=t,this._state=0,this._forceRenderingAbove=!1,this._pendingLayout=new A.XK,this._showTimeout=new ne._F,this._disposables=new A.SL,this._onDidSelect=new w.Q5,this.onDidSelect=this._onDidSelect.event,this._onDidHide=new w.Q5,this.onDidHide=this._onDidHide.event,this._onDidShow=new w.Q5,this.onDidShow=this._onDidShow.event,this.element=new Ja.f,this.element.domNode.classList.add("workbench-suggest-widget"),this._container.appendChild(this.element.domNode);class r{constructor(h,f,v=!1,b=!1){this.persistedSize=h,this.currentSize=f,this.persistHeight=v,this.persistWidth=b}}let s;this._disposables.add(this.element.onDidWillResize(()=>{s=new r(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(d=>{if(this._resize(d.dimension.width,d.dimension.height),s&&(s.persistHeight=s.persistHeight||!!d.north||!!d.south,s.persistWidth=s.persistWidth||!!d.east||!!d.west),d.done){if(s){const{itemHeight:h,defaultSize:f}=this._getLayoutInfo(),v=Math.round(h/2);let{width:b,height:_}=this.element.size;(!s.persistHeight||Math.abs(s.currentSize.height-_)<=v)&&(_=s.persistedSize?.height??f.height),(!s.persistWidth||Math.abs(s.currentSize.width-b)<=v)&&(b=s.persistedSize?.width??f.width),this._persistedSize.store(new S.Ro(b,_))}s=void 0}}));const l=new tl;this._disposables.add(l),this._listElement=S.R3(this.element.domNode,ol(".tree")),this._list=new Xa.aV("SuggestWidget",this._listElement,{getHeight:d=>this._getLayoutInfo().itemHeight,getTemplateId:d=>"suggestion"},[l],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>(0,a.NC)("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:d=>{let h=d.completion.label;if("string"!=typeof d.completion.label){const{detail:v,description:b}=d.completion.label;v&&b?h=(0,a.NC)("label.full","{0}{1}, {2}",h,v,b):v?h=(0,a.NC)("label.detail","{0}{1}",h,v):b&&(h=(0,a.NC)("label.desc","{0}, {1}",h,b))}const{detail:f}=d.completion;return(0,a.NC)("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",h,f)}}}),i.statusBarMenuId&&(this._status=n.createInstance(rl.I,this.element.domNode,i.statusBarMenuId),this.element.domNode.classList.toggle("with-status-bar",!0)),this._disposables.add(this._list.onMouseDown(d=>this._onListMouseDownOrTap(d))),this._disposables.add(this._list.onTap(d=>this._onListMouseDownOrTap(d))),this._disposables.add(this._list.onDidChangeSelection(d=>this._onListSelection(d)))}dispose(){this._disposables.dispose(),this._status?.dispose(),this.element.dispose()}showSuggestions(e,t,i,n,r){if(this._cursorPosition=r,this._completionModel!==e&&(this._completionModel=e),i&&2!==this._state&&0!==this._state)this._setState(4);else{if(0===this._completionModel.items.length)return this._setState(n?0:2),void(this._completionModel=void 0);try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus([t])}finally{}this._pendingLayout.value=S.lI(()=>{this._pendingLayout.clear(),this._layout(this.element.size)})}}setLineContext(e){this._completionModel&&(this._completionModel.lineContext=e)}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",4===e),this.element.domNode.classList.remove("message"),e){case 0:S.Cp(this._listElement),this._status&&S.Cp(this._status?.element),this._status?.hide(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._cappedHeight=void 0;break;case 1:case 2:this.element.domNode.classList.add("message"),S.Cp(this._listElement),this._status&&S.Cp(this._status?.element),this._show();break;case 3:case 4:case 5:S.$Z(this._listElement),this._status&&S.$Z(this._status?.element),this._show()}}_show(){this._status?.show(),S.$Z(this.element.domNode),this._layout(this._persistedSize.restore()),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}hide(){this._pendingLayout.clear(),this._setState(0),this._onDidHide.fire(this),S.Cp(this.element.domNode),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(4.3*this._getLayoutInfo().itemHeight);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}_layout(e){if(!this._cursorPosition)return;const t=S.D6(document.body),i=this._getLayoutInfo();e||(e=i.defaultSize);let n=e.height,r=e.width;this._status&&(this._status.element.style.lineHeight=`${i.itemHeight}px`);const s=t.width-i.borderHeight-2*i.horizontalPadding;r>s&&(r=s);const l=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:r,d=i.statusBarHeight+this._list.contentHeight+i.borderHeight,h=i.itemHeight+i.statusBarHeight,f=S.i(this._container),v=this._cursorPosition,_=Math.min(t.height-(f.top+v.top+v.height)-i.verticalPadding,d),C=f.top+v.top-i.verticalPadding,y=Math.min(C,d);let I=Math.min(Math.max(y,_)+i.borderHeight,d);n===this._cappedHeight?.capped&&(n=this._cappedHeight.wanted),n<h&&(n=h),n>I&&(n=I),n>_||this._forceRenderingAbove&&C>150?(this._preference=0,this.element.enableSashes(!0,!0,!1,!1),I=y):(this._preference=1,this.element.enableSashes(!1,!0,!0,!1),I=_),this.element.preferredSize=new S.Ro(l,i.defaultSize.height),this.element.maxSize=new S.Ro(s,I),this.element.minSize=new S.Ro(220,h),this._cappedHeight=n===d?{wanted:this._cappedHeight?.wanted??e.height,capped:n}:void 0,this.element.domNode.style.left=`${this._cursorPosition.left}px`,this.element.domNode.style.top=0===this._preference?this._cursorPosition.top-n-i.borderHeight+"px":`${this._cursorPosition.top+this._cursorPosition.height}px`,this._resize(r,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),n&&(t=Math.min(n,t));const{statusBarHeight:r}=this._getLayoutInfo();this._list.layout(t-r,e),this._listElement.style.height=t-r+"px",this._listElement.style.width=`${e}px`,this._listElement.style.height=`${t}px`,this.element.layout(t,e)}_getLayoutInfo(){const t=(0,nl.uZ)(20,8,1e3);return{itemHeight:t,statusBarHeight:0,borderWidth:1,borderHeight:2,typicalHalfwidthCharacterWidth:10,verticalPadding:22,horizontalPadding:14,defaultSize:new S.Ro(430,0+12*t+2)}}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&this._onDidSelect.fire({item:e,index:t,model:i})}selectNext(){this._list.focusNext(1,!0);const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectNextPage(){this._list.focusNextPage();const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectPrevious(){this._list.focusPrevious(1,!0);const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectPreviousPage(){this._list.focusPreviousPage();const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}getFocusedItem(){if(this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};fr=(0,c.gn)([(0,c.fM)(3,G.TG)],fr);var sl=p(22357),gr=p(470);const al={0:E.lA.symbolText,1:E.lA.history,2:E.lA.symbolMethod,3:E.lA.symbolFile,4:E.lA.folder,5:E.lA.symbolProperty,6:E.lA.symbolMethod,7:E.lA.symbolVariable,8:E.lA.symbolValue,9:E.lA.symbolVariable,10:E.lA.symbolNamespace,11:E.lA.symbolInterface,12:E.lA.symbolKeyword,13:E.lA.symbolKeyword};let pr=class extends A.JT{constructor(e,t){super(),this._terminalSuggestWidgetVisibleContextKey=e,this._instantiationService=t,this._enableWidget=!0,this._cursorIndexStart=0,this._cursorIndexDelta=0,this._onBell=new w.Q5,this.onBell=this._onBell.event,this._onAcceptedCompletion=new w.Q5,this.onAcceptedCompletion=this._onAcceptedCompletion.event,this._cachedBashAliases=new Set,this._cachedBashBuiltins=new Set,this._cachedBashCommands=new Set,this._cachedBashKeywords=new Set}activate(e){this._terminal=e,this._register(e.parser.registerOscHandler(633,t=>this._handleVSCodeSequence(t))),this._register(e.onData(t=>{this._handleTerminalInput(t)}))}setContainer(e){this._container=e}_handleVSCodeSequence(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");switch(t){case"Completions":return this._handleCompletionsSequence(this._terminal,e,t,i),!0;case"CompletionsBash":return this._handleCompletionsBashSequence(this._terminal,e,t,i),!0;case"CompletionsBashFirstWord":return this._handleCompletionsBashFirstWordSequence(this._terminal,e,t,i)}return!1}_handleCompletionsSequence(e,t,i,n){if(!e.element||!this._enableWidget)return;const r=parseInt(n[0]),s=parseInt(n[1]);if(this._cursorIndexStart=parseInt(n[2]),!n[3])return void this._onBell.fire();let l=JSON.parse(t.slice(i.length+n[0].length+n[1].length+n[2].length+4));Array.isArray(l)||(l=[l]);const d=l.map(f=>new ur({label:f.CompletionText,icon:al[f.ResultType],detail:f.ToolTip}));this._leadingLineContent=d[0].completion.label.slice(0,s),this._cursorIndexDelta=0;const h=new ns(d,new mr(this._leadingLineContent,r),r,s);1!==d.length||0!==d[0].completion.label.substring(s).length?this._handleCompletionModel(h):this._onBell.fire()}_handleCompletionsBashFirstWordSequence(e,t,i,n){const r=n[0],s=t.slice(i.length+r.length+2).split(";");let l;switch(r){case"alias":l=this._cachedBashAliases;break;case"builtin":l=this._cachedBashBuiltins;break;case"command":l=this._cachedBashCommands;break;case"keyword":l=this._cachedBashKeywords;break;default:return!1}l.clear();const d=new Set;for(const h of s)d.add(h);for(const h of d)l.add(new ur({label:h,icon:E.lA.symbolString,detail:r}));return this._cachedFirstWord=void 0,!0}_handleCompletionsBashSequence(e,t,i,n){if(!e.element)return;let r=parseInt(n[0]);const s=parseInt(n[1]);if(!n[2])return void this._onBell.fire();const l=t.slice(i.length+n[0].length+n[1].length+n[2].length+4).split(";");let d;if(100!==r&&l.length>0?d=l.map(f=>new ur({label:f,icon:E.lA.symbolProperty})):(r=0,this._cachedFirstWord||(this._cachedFirstWord=[...this._cachedBashAliases,...this._cachedBashBuiltins,...this._cachedBashCommands,...this._cachedBashKeywords],this._cachedFirstWord.sort((f,v)=>{const b=f.completion.label.charCodeAt(0),_=v.completion.label.charCodeAt(0),C=b<65||b>90&&b<97||b>122?1:0,y=_<65||_>90&&_<97||_>122?1:0;return C!==y?C-y:f.completion.label.localeCompare(v.completion.label)})),d=this._cachedFirstWord),0===d.length)return;this._leadingLineContent=d[0].completion.label.slice(0,s);const h=new ns(d,new mr(this._leadingLineContent,r),r,s);1!==d.length||0!==d[0].completion.label.substring(s).length?this._handleCompletionModel(h):this._onBell.fire()}_handleCompletionModel(e){if(0===e.items.length||!this._terminal?.element)return;if(1===e.items.length)return void this.acceptSelectedSuggestion({item:e.items[0],model:e});const t=this._ensureSuggestWidget(this._terminal);this._additionalInput=void 0;const i={width:this._terminal._core._renderService.dimensions.device.cell.width,height:this._terminal._core._renderService.dimensions.device.cell.height};if(!i.width||!i.height)return;const n=this._terminal.element.getBoundingClientRect(),s=S.Fx(this._container,"panel").offsetParent.getBoundingClientRect();if(t.showSuggestions(e,0,!1,!1,{left:n.left-s.left+this._terminal.buffer.active.cursorX*i.width,top:n.top-s.top+this._terminal.buffer.active.cursorY*i.height,height:i.height}),this._inputQueue){const l=this._inputQueue;this._inputQueue=void 0;for(const d of l)this._handleTerminalInput(d)}}_ensureSuggestWidget(e){var t=this;return this._terminalSuggestWidgetVisibleContextKey.set(!0),this._suggestWidget||(this._suggestWidget=this._register(this._instantiationService.createInstance(fr,S.Fx(this._container,"panel"),this._instantiationService.createInstance(vr),{})),this._suggestWidget.list.style((0,gr.TU)({listInactiveFocusBackground:sl.OF,listInactiveFocusOutline:Z.xL1})),this._suggestWidget.onDidSelect(function(){var i=(0,u.Z)(function*(n){return t.acceptSelectedSuggestion(n)});return function(n){return i.apply(this,arguments)}}()),this._suggestWidget.onDidHide(()=>this._terminalSuggestWidgetVisibleContextKey.set(!1)),this._suggestWidget.onDidShow(()=>this._terminalSuggestWidgetVisibleContextKey.set(!0))),this._suggestWidget}selectPreviousSuggestion(){this._suggestWidget?.selectPrevious()}selectPreviousPageSuggestion(){this._suggestWidget?.selectPreviousPage()}selectNextSuggestion(){this._suggestWidget?.selectNext()}selectNextPageSuggestion(){this._suggestWidget?.selectNextPage()}acceptSelectedSuggestion(e){e||(e=this._suggestWidget?.getFocusedItem()),e&&this._leadingLineContent&&(this._suggestWidget?.hide(),this._onAcceptedCompletion.fire(["\x1b[D".repeat(Math.max(e.model.replacementLength-this._cursorIndexStart+this._cursorIndexDelta,0)),"\x1b[3~".repeat(this._additionalInput?.length??0),"\x7f".repeat(e.model.replacementLength),e.item.completion.label].join("")),this._enableWidget=!1,(0,ne.Vs)(100).then(t=>this._enableWidget=!0))}hideSuggestWidget(){this._suggestWidget?.hide()}handleNonXtermData(e){this._handleTerminalInput(e)}_handleTerminalInput(e){if(!this._terminal||!this._enableWidget||!this._terminalSuggestWidgetVisibleContextKey.get())return void("-"===e?this._inputQueue=[]:this._inputQueue?.push(e));let t=!1;if("\x7f"===e&&this._additionalInput&&this._additionalInput.length>0&&this._cursorIndexDelta>0&&(t=!0,this._additionalInput=this._additionalInput.substring(0,this._cursorIndexDelta---1)+this._additionalInput.substring(this._cursorIndexDelta)),"\x1b[3~"===e&&this._additionalInput&&this._additionalInput.length>0&&this._cursorIndexDelta<this._additionalInput.length-1&&(t=!0,this._additionalInput=this._additionalInput.substring(0,this._cursorIndexDelta)+this._additionalInput.substring(this._cursorIndexDelta+1)),"\x1b[D"===e&&this._cursorIndexDelta>0&&(t=!0,this._cursorIndexDelta--),"\x1b[C"===e&&(t=!0,this._cursorIndexDelta+=1),e.match(/^[a-z0-9]$/i)&&(t=!0,void 0===this._additionalInput&&(this._additionalInput=""),this._additionalInput+=e,this._cursorIndexDelta++),t){if(this._terminalSuggestWidgetVisibleContextKey.get()&&this._suggestWidget?.setLineContext(new mr(this._leadingLineContent+(this._additionalInput??""),this._additionalInput?.length??0)),0===this._suggestWidget._completionModel?.items.length)return this._additionalInput=void 0,void this.hideSuggestWidget();const i={width:this._terminal._core._renderService.dimensions.device.cell.width,height:this._terminal._core._renderService.dimensions.device.cell.height};if(!i.width||!i.height)return;const n=this._terminal.element.getBoundingClientRect(),s=S.Fx(this._container,"panel").offsetParent.getBoundingClientRect();this._suggestWidget?.showSuggestions(this._suggestWidget._completionModel,0,!1,!1,{left:n.left-s.left+this._terminal.buffer.active.cursorX*i.width,top:n.top-s.top+this._terminal.buffer.active.cursorY*i.height,height:i.height})}else this._additionalInput=void 0,this.hideSuggestWidget()}};pr=(0,c.gn)([(0,c.fM)(1,G.TG)],pr);let _r,br,wr,Sr,Cr,yr,vr=class{constructor(e){this._storageService=e,this._key="terminal.integrated.suggestSize"}restore(){const e=this._storageService.get(this._key,0)??"";try{const t=JSON.parse(e);if(S.Ro.is(t))return S.Ro.lift(t)}catch{}}store(e){this._storageService.store(this._key,JSON.stringify(e),0,1)}reset(){this._storageService.remove(this._key,0)}};function ll(o,e){let t=e.getLine(o);if(!t)return{lineData:void 0,lineIndex:o};let i=t.translateToString(!0);for(;o>0&&t.isWrapped&&(t=e.getLine(--o),t);)i=t.translateToString(!1)+i;return{lineData:i,lineIndex:o}}vr=(0,c.gn)([(0,c.fM)(0,He.Uy)],vr);let Qi=class it extends A.SL{*getBufferReverseIterator(){for(let e=this.raw.buffer.active.length;e>=0;e--){const{lineData:t,lineIndex:i}=ll(e,this.raw.buffer.active);t&&(e=i,yield t)}}get findResult(){return this._lastFindResult}get isStdinDisabled(){return!!this.raw.options.disableStdin}get markTracker(){return this._markNavigationAddon}get shellIntegration(){return this._shellIntegrationAddon}get suggestController(){return this._suggestAddon}get textureAtlas(){const e=this._webglAddon?.textureAtlas||this._canvasAddon?.textureAtlas;if(e)return createImageBitmap(e)}constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y,I){var $;super(),$=this,this._configHelper=t,this._backgroundColorProvider=r,this._capabilities=s,this._terminalSuggestWidgetVisibleContextKey=d,this._configurationService=f,this._instantiationService=v,this._logService=b,this._notificationService=_,this._storageService=C,this._themeService=y,this._telemetryService=I,this._onDidRequestRunCommand=new w.Q5,this.onDidRequestRunCommand=this._onDidRequestRunCommand.event,this._onDidRequestFocus=new w.Q5,this.onDidRequestFocus=this._onDidRequestFocus.event,this._onDidRequestSendText=new w.Q5,this.onDidRequestSendText=this._onDidRequestSendText.event,this._onDidRequestFreePort=new w.Q5,this.onDidRequestFreePort=this._onDidRequestFreePort.event,this._onDidChangeFindResults=new w.Q5,this.onDidChangeFindResults=this._onDidChangeFindResults.event,this._onDidChangeSelection=new w.Q5,this.onDidChangeSelection=this._onDidChangeSelection.event;const F=this._configHelper.getFont(void 0,!0),V=this._configHelper.config,O=this._configurationService.getValue("editor");this.raw=this.add(new e({allowProposedApi:!0,cols:i,rows:n,altClickMovesCursor:V.altClickMovesCursor&&"alt"===O.multiCursorModifier,scrollback:V.scrollback,theme:this._getXtermTheme(),drawBoldTextInBrightColors:V.drawBoldTextInBrightColors,fontFamily:F.fontFamily,fontWeight:V.fontWeight,fontWeightBold:V.fontWeightBold,fontSize:F.fontSize,letterSpacing:F.letterSpacing,lineHeight:F.lineHeight,minimumContrastRatio:V.minimumContrastRatio,tabStopWidth:V.tabStopWidth,cursorBlink:V.cursorBlinking,cursorStyle:"line"===V.cursorStyle?"bar":V.cursorStyle,cursorWidth:V.cursorWidth,macOptionIsMeta:V.macOptionIsMeta,macOptionClickForcesSelection:V.macOptionClickForcesSelection,rightClickSelectsWord:"selectWord"===V.rightClickBehavior,fastScrollModifier:"alt",fastScrollSensitivity:V.fastScrollSensitivity,scrollSensitivity:V.mouseWheelScrollSensitivity,wordSeparator:V.wordSeparators,overviewRulerWidth:10,smoothScrollDuration:V.smoothScrolling?125:0})),this._core=this.raw._core,this.add(this._configurationService.onDidChangeConfiguration(function(){var W=(0,u.Z)(function*(q){q.affectsConfiguration("terminal.integrated.gpuAcceleration")&&(it._suggestedRendererType=void 0),(q.affectsConfiguration("terminal.integrated")||q.affectsConfiguration("editor.fastScrollSensitivity")||q.affectsConfiguration("editor.mouseWheelScrollSensitivity")||q.affectsConfiguration("editor.multiCursorModifier"))&&$.updateConfig(),q.affectsConfiguration("terminal.integrated.unicodeVersion")&&$._updateUnicodeVersion()});return function(q){return W.apply(this,arguments)}}())),this.add(this._themeService.onDidColorThemeChange(W=>this._updateTheme(W))),this.add(this.raw.onSelectionChange(()=>this._onDidChangeSelection.fire())),this._updateUnicodeVersion(),this._refreshImageAddon(),this._markNavigationAddon=this._instantiationService.createInstance(sr,s),this.raw.loadAddon(this._markNavigationAddon),this._decorationAddon=this._instantiationService.createInstance(hr,this._capabilities),this._decorationAddon.onDidRequestRunCommand(W=>this._onDidRequestRunCommand.fire(W)),this.raw.loadAddon(this._decorationAddon),this._shellIntegrationAddon=this._instantiationService.createInstance(lr,l,h,this._telemetryService),this.raw.loadAddon(this._shellIntegrationAddon),this._suggestAddon=this._instantiationService.createInstance(pr,this._terminalSuggestWidgetVisibleContextKey),this.raw.loadAddon(this._suggestAddon),this._suggestAddon.onAcceptedCompletion(function(){var W=(0,u.Z)(function*(q){$._onDidRequestFocus.fire(),$._onDidRequestSendText.fire(q)});return function(q){return W.apply(this,arguments)}}())}getSelectionAsHtml(e){var t=this;return(0,u.Z)(function*(){if(!t._serializeAddon){const n=yield t._getSerializeAddonConstructor();t._serializeAddon=new n,t.raw.loadAddon(t._serializeAddon)}if(e){const n=e.getOutput()?.length,r=e.marker?.line;if(!n||!r)throw new Error(`No row ${r} or output length ${n} for command ${e}`);t.raw.select(0,r+1,n-Math.floor(n/t.raw.cols))}const i=t._serializeAddon.serializeAsHTML({onlySelection:!0});return e&&t.raw.clearSelection(),i})()}attachToElement(e){return this._container||this.raw.open(e),this._shouldLoadWebgl()?this._enableWebglRenderer():this._shouldLoadCanvas()&&this._enableCanvasRenderer(),this._suggestAddon.setContainer(e),this._container=e,this._container.querySelector(".xterm-screen")}updateConfig(){const e=this._configHelper.config;this.raw.options.altClickMovesCursor=e.altClickMovesCursor,this._setCursorBlink(e.cursorBlinking),this._setCursorStyle(e.cursorStyle),this._setCursorWidth(e.cursorWidth),this.raw.options.scrollback=e.scrollback,this.raw.options.drawBoldTextInBrightColors=e.drawBoldTextInBrightColors,this.raw.options.minimumContrastRatio=e.minimumContrastRatio,this.raw.options.tabStopWidth=e.tabStopWidth,this.raw.options.fastScrollSensitivity=e.fastScrollSensitivity,this.raw.options.scrollSensitivity=e.mouseWheelScrollSensitivity,this.raw.options.macOptionIsMeta=e.macOptionIsMeta;const t=this._configurationService.getValue("editor");this.raw.options.altClickMovesCursor=e.altClickMovesCursor&&"alt"===t.multiCursorModifier,this.raw.options.macOptionClickForcesSelection=e.macOptionClickForcesSelection,this.raw.options.rightClickSelectsWord="selectWord"===e.rightClickBehavior,this.raw.options.wordSeparator=e.wordSeparators,this.raw.options.customGlyphs=e.customGlyphs,this.raw.options.smoothScrollDuration=e.smoothScrolling?125:0,this._shouldLoadWebgl()?this._enableWebglRenderer():(this._disposeOfWebglRenderer(),this._shouldLoadCanvas()?this._enableCanvasRenderer():this._disposeOfCanvasRenderer()),this._refreshImageAddon()}_shouldLoadWebgl(){return!Wo.isSafari&&"auto"===this._configHelper.config.gpuAcceleration&&void 0===it._suggestedRendererType||"on"===this._configHelper.config.gpuAcceleration}_shouldLoadCanvas(){return"auto"===this._configHelper.config.gpuAcceleration&&(void 0===it._suggestedRendererType||"canvas"===it._suggestedRendererType)||"canvas"===this._configHelper.config.gpuAcceleration}forceRedraw(){this.raw.clearTextureAtlas()}clearDecorations(){this._decorationAddon?.clearDecorations()}forceRefresh(){this._core.viewport?._innerRefresh()}forceUnpause(){this._canvasAddon&&(this._core._renderService?._handleIntersectionChange({intersectionRatio:1}),this.raw.refresh(0,this.raw.rows-1))}findNext(e,t){var i=this;return(0,u.Z)(function*(){return i._updateFindColors(t),(yield i._getSearchAddon()).findNext(e,t)})()}findPrevious(e,t){var i=this;return(0,u.Z)(function*(){return i._updateFindColors(t),(yield i._getSearchAddon()).findPrevious(e,t)})()}_updateFindColors(e){const t=this._themeService.getColorTheme(),i=t.getColor(j.Es)||t.getColor(ar.v9),n=t.getColor(j.lt),r=t.getColor(j.iP),s=t.getColor(j.Qh),l=t.getColor(j.UO),d=t.getColor(j.L1),h=t.getColor(j.$);e.decorations={activeMatchBackground:n?.toString(),activeMatchBorder:r?.toString()||"transparent",activeMatchColorOverviewRuler:s?.toString()||"transparent",matchBackground:i?l?.blend(i).toString():void 0,matchBorder:d?.toString()||"transparent",matchOverviewRuler:h?.toString()||"transparent"}}_getSearchAddon(){var e=this;return(0,u.Z)(function*(){if(e._searchAddon)return e._searchAddon;const t=yield e._getSearchAddonConstructor();return e._searchAddon=new t({highlightLimit:1e3}),e.raw.loadAddon(e._searchAddon),e._searchAddon.onDidChangeResults(i=>{e._lastFindResult=i,e._onDidChangeFindResults.fire(i)}),e._searchAddon})()}clearSearchDecorations(){this._searchAddon?.clearDecorations()}clearActiveSearchDecoration(){this._searchAddon?.clearActiveDecoration()}getFont(){return this._configHelper.getFont(this._core)}getLongestViewportWrappedLineLength(){let e=0;for(let t=this.raw.buffer.active.length-1;t>=this.raw.buffer.active.viewportY;t--){const i=this._getWrappedLineCount(t,this.raw.buffer.active);e=Math.max(e,i.lineCount*this.raw.cols-i.endSpaces||0),t=i.currentIndex}return e}_getWrappedLineCount(e,t){let i=t.getLine(e);if(!i)throw new Error("Could not get line");let n=e,r=0;for(let s=Math.min(i.length,this.raw.cols)-1;s>=0&&!i?.getCell(s)?.getChars();s--)r++;for(;i?.isWrapped&&n>0;)n--,i=t.getLine(n);return{lineCount:e-n+1,currentIndex:n,endSpaces:r}}scrollDownLine(){this.raw.scrollLines(1)}scrollDownPage(){this.raw.scrollPages(1)}scrollToBottom(){this.raw.scrollToBottom()}scrollUpLine(){this.raw.scrollLines(-1)}scrollUpPage(){this.raw.scrollPages(-1)}scrollToTop(){this.raw.scrollToTop()}clearBuffer(){this.raw.clear(),this._capabilities.get(2)?.handlePromptStart(),this._capabilities.get(2)?.handleCommandStart()}_setCursorBlink(e){this.raw.options.cursorBlink!==e&&(this.raw.options.cursorBlink=e,this.raw.refresh(0,this.raw.rows-1))}_setCursorStyle(e){this.raw.options.cursorStyle!==e&&(this.raw.options.cursorStyle="line"===e?"bar":e)}_setCursorWidth(e){this.raw.options.cursorWidth!==e&&(this.raw.options.cursorWidth=e)}_enableWebglRenderer(){var e=this;return(0,u.Z)(function*(){if(!e.raw.element||e._webglAddon)return;const t=yield e._getWebglAddonConstructor();e._webglAddon=new t,e._disposeOfCanvasRenderer();try{e.raw.loadAddon(e._webglAddon),e._logService.trace("Webgl was loaded"),e._webglAddon.onContextLoss(()=>{e._logService.info("Webgl lost context, disposing of webgl renderer"),e._disposeOfWebglRenderer()})}catch(i){e._logService.warn("Webgl could not be loaded. Falling back to the canvas renderer type.",i),!e._storageService.getBoolean("terminal.integrated.neverMeasureRenderTime",-1,!1)&&"off"!==e._configHelper.config.gpuAcceleration&&e._measureRenderTime(),it._suggestedRendererType="canvas",e._disposeOfWebglRenderer(),e._enableCanvasRenderer()}})()}_enableCanvasRenderer(){var e=this;return(0,u.Z)(function*(){if(!e.raw.element||e._canvasAddon)return;const t=yield e._getCanvasAddonConstructor();e._canvasAddon=new t,e._disposeOfWebglRenderer();try{e.raw.loadAddon(e._canvasAddon),e._logService.trace("Canvas renderer was loaded")}catch(i){e._logService.warn("Canvas renderer could not be loaded, falling back to dom renderer",i),!e._storageService.getBoolean("terminal.integrated.neverMeasureRenderTime",-1,!1)&&"off"!==e._configHelper.config.gpuAcceleration&&e._measureRenderTime(),it._suggestedRendererType="dom",e._disposeOfCanvasRenderer()}})()}_getCanvasAddonConstructor(){return(0,u.Z)(function*(){return _r||(_r=(yield p.e(669).then(p.t.bind(p,91669,19)).then(e=>e.default??e)).CanvasAddon),_r})()}_refreshImageAddon(){var e=this;return(0,u.Z)(function*(){if(e._configHelper.config.experimentalImageSupport){if(!e._imageAddon){const t=yield e._getImageAddonConstructor();e._imageAddon=new t,e.raw.loadAddon(e._imageAddon)}}else{try{e._imageAddon?.dispose()}catch{}e._imageAddon=void 0}})()}_getImageAddonConstructor(){return(0,u.Z)(function*(){return br||(br=(yield p.e(385).then(p.t.bind(p,39385,19)).then(e=>e.default??e)).ImageAddon),br})()}_getSearchAddonConstructor(){return(0,u.Z)(function*(){return wr||(wr=(yield p.e(363).then(p.t.bind(p,42363,19)).then(e=>e.default??e)).SearchAddon),wr})()}_getUnicode11Constructor(){return(0,u.Z)(function*(){return Cr||(Cr=(yield p.e(162).then(p.t.bind(p,77162,19)).then(e=>e.default??e)).Unicode11Addon),Cr})()}_getWebglAddonConstructor(){return(0,u.Z)(function*(){return yr||(yr=(yield p.e(635).then(p.t.bind(p,59635,19)).then(e=>e.default??e)).WebglAddon),yr})()}_getSerializeAddonConstructor(){return(0,u.Z)(function*(){return Sr||(Sr=(yield p.e(349).then(p.t.bind(p,73349,19)).then(e=>e.default??e)).SerializeAddon),Sr})()}_disposeOfCanvasRenderer(){try{this._canvasAddon?.dispose()}catch{}this._canvasAddon=void 0}_disposeOfWebglRenderer(){try{this._webglAddon?.dispose()}catch{}this._webglAddon=void 0}_measureRenderTime(){var e=this;return(0,u.Z)(function*(){const t=[];if(!e._core._renderService?._renderer._renderLayers)return;const i=e._core._renderService._renderer._renderLayers[0],n=i?.onGridChanged;i.onGridChanged=(s,l,d)=>{const h=performance.now();n.call(i,s,l,d),t.push(performance.now()-h),20===t.length&&((()=>{if(t.shift(),t.sort((l,d)=>l-d)[Math.floor(t.length/2)]>50)if("auto"===e._configHelper.config.gpuAcceleration)it._suggestedRendererType="dom",e.updateConfig();else{const l=[{label:(0,a.NC)("yes","Yes"),run:()=>e._configurationService.updateValue("terminal.integrated.gpuAcceleration","off",2)},{label:(0,a.NC)("no","No"),run:()=>{}},{label:(0,a.NC)("dontShowAgain","Don't Show Again"),isSecondary:!0,run:()=>e._storageService.store("terminal.integrated.neverMeasureRenderTime",!0,-1,1)}];e._notificationService.prompt(R.zb.Warning,(0,a.NC)("terminal.slowRendering","Terminal GPU acceleration appears to be slow on your computer. Would you like to switch to disable it which may improve performance? [Read more about terminal settings](https://code.visualstudio.com/docs/editor/integrated-terminal#_changing-how-the-terminal-is-rendered)."),l)}})(),i.onGridChanged=n)}})()}_getXtermTheme(e){e||(e=this._themeService.getColorTheme());const t=e.getColor(j.Y$),i=this._backgroundColorProvider.getBackgroundColor(e),n=e.getColor(j.PY)||t,r=e.getColor(j.oZ)||i,s=e.getColor(j.Qr),l=e.getColor(j.wq),d=e.getColor(j.md)||void 0;return{background:i?.toString(),foreground:t?.toString(),cursor:n?.toString(),cursorAccent:r?.toString(),selectionBackground:s?.toString(),selectionInactiveBackground:l?.toString(),selectionForeground:d?.toString(),black:e.getColor(j.D2[0])?.toString(),red:e.getColor(j.D2[1])?.toString(),green:e.getColor(j.D2[2])?.toString(),yellow:e.getColor(j.D2[3])?.toString(),blue:e.getColor(j.D2[4])?.toString(),magenta:e.getColor(j.D2[5])?.toString(),cyan:e.getColor(j.D2[6])?.toString(),white:e.getColor(j.D2[7])?.toString(),brightBlack:e.getColor(j.D2[8])?.toString(),brightRed:e.getColor(j.D2[9])?.toString(),brightGreen:e.getColor(j.D2[10])?.toString(),brightYellow:e.getColor(j.D2[11])?.toString(),brightBlue:e.getColor(j.D2[12])?.toString(),brightMagenta:e.getColor(j.D2[13])?.toString(),brightCyan:e.getColor(j.D2[14])?.toString(),brightWhite:e.getColor(j.D2[15])?.toString()}}_updateTheme(e){this.raw.options.theme=this._getXtermTheme(e)}refresh(){this._updateTheme(),this._decorationAddon.refreshLayouts()}_updateUnicodeVersion(){var e=this;return(0,u.Z)(function*(){if(!e._unicode11Addon&&"11"===e._configHelper.config.unicodeVersion){const t=yield e._getUnicode11Constructor();e._unicode11Addon=new t,e.raw.loadAddon(e._unicode11Addon)}e.raw.unicode.activeVersion!==e._configHelper.config.unicodeVersion&&(e.raw.unicode.activeVersion=e._configHelper.config.unicodeVersion)})()}_writeText(e){this.raw.write(e)}};Qi._suggestedRendererType=void 0,Qi=(0,c.gn)([(0,c.fM)(9,ie.Ui),(0,c.fM)(10,G.TG),(0,c.fM)(11,De.VZ),(0,c.fM)(12,R.lT),(0,c.fM)(13,He.Uy),(0,c.fM)(14,me.XE),(0,c.fM)(15,je.bU)],Qi);var xr,xe=p(33562);(xr||(xr={})).getTerminalContributions=function e(){return ji.INSTANCE.getTerminalContributions()};class ji{constructor(){this._terminalContributions=[]}registerTerminalContribution(e,t){this._terminalContributions.push({id:e,ctor:t})}getTerminalContributions(){return this._terminalContributions.slice(0)}}let qi;ji.INSTANCE=new ji,xe.B.add("terminal.contributions",ji.INSTANCE);const dl=["bash","zsh","pwsh","pwsh"];let Te=class nt extends A.JT{get domElement(){return this._wrapperElement}get usedShellIntegrationInjection(){return this._usedShellIntegrationInjection}get extEnvironmentVariableCollection(){return this._processManager.extEnvironmentVariableCollection}get waitOnExit(){return this._shellLaunchConfig.attachPersistentProcess?.waitOnExit||this._shellLaunchConfig.waitOnExit}set waitOnExit(e){this._shellLaunchConfig.waitOnExit=e}get target(){return this._target}set target(e){this._target=e}get instanceId(){return this._instanceId}get resource(){return this._resource}get cols(){return void 0!==this._fixedCols?this._fixedCols:this._dimensionsOverride&&this._dimensionsOverride.cols?this._dimensionsOverride.forceExactSize?this._dimensionsOverride.cols:Math.min(Math.max(this._dimensionsOverride.cols,2),this._cols):this._cols}get rows(){return void 0!==this._fixedRows?this._fixedRows:this._dimensionsOverride&&this._dimensionsOverride.rows?this._dimensionsOverride.forceExactSize?this._dimensionsOverride.rows:Math.min(Math.max(this._dimensionsOverride.rows,2),this._rows):this._rows}get isDisposed(){return this._isDisposed}get fixedCols(){return this._fixedCols}get fixedRows(){return this._fixedRows}get maxCols(){return this._cols}get maxRows(){return this._rows}get processId(){return this._processManager.shellProcessId}get processReady(){return this._processManager.ptyProcessReady}get hasChildProcesses(){return this.shellLaunchConfig.attachPersistentProcess?.hasChildProcesses||this._processManager.hasChildProcesses}get reconnectionProperties(){return this.shellLaunchConfig.attachPersistentProcess?.reconnectionProperties||this.shellLaunchConfig.reconnectionProperties}get areLinksReady(){return this._areLinksReady}get initialDataEvents(){return this._initialDataEvents}get exitCode(){return this._exitCode}get exitReason(){return this._exitReason}get hadFocusOnExit(){return this._hadFocusOnExit}get isTitleSetByProcess(){return!!this._messageTitleDisposable}get shellLaunchConfig(){return this._shellLaunchConfig}get shellType(){return this._shellType}get os(){return this._processManager.os}get isRemote(){return void 0!==this._processManager.remoteAuthority}get remoteAuthority(){return this._processManager.remoteAuthority}get hasFocus(){return this._wrapperElement.contains(document.activeElement)??!1}get title(){return this._title}get titleSource(){return this._titleSource}get icon(){return this._getIcon()}get color(){return this._getColor()}get processName(){return this._processName}get sequence(){return this._sequence}get staticTitle(){return this._staticTitle}get workspaceFolder(){return this._workspaceFolder}get cwd(){return this._cwd}get initialCwd(){return this._initialCwd}get description(){if(this._description)return this._description;const e=this.shellLaunchConfig.attachPersistentProcess?.type||this.shellLaunchConfig.type;return e?"Task"===e?a.NC("terminalTypeTask","Task"):a.NC("terminalTypeLocal","Local"):void 0}get userHome(){return this._userHome}get shellIntegrationNonce(){return this._processManager.shellIntegrationNonce}get injectedArgs(){return this._injectedArgs}constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y,I,$,F,V,O,W,q,te,Ee,ui,Xr,mi,le,We,et,Jr,Lt){var U;if(super(),U=this,this._terminalShellTypeContextKey=e,this._terminalInRunCommandPicker=t,this._terminalSuggestWidgetVisibleContextKey=i,this._configHelper=n,this._shellLaunchConfig=r,this._contextKeyService=s,this._terminalProfileResolverService=d,this._pathService=h,this._keybindingService=f,this._notificationService=v,this._preferencesService=b,this._viewsService=_,this._clipboardService=C,this._themeService=y,this._configurationService=I,this._logService=$,this._dialogService=F,this._storageService=V,this._accessibilityService=O,this._productService=W,this._quickInputService=q,this._workspaceContextService=Ee,this._editorService=ui,this._workspaceTrustRequestService=Xr,this._historyService=mi,this._telemetryService=le,this._openerService=We,this._commandService=et,this._audioCueService=Jr,this._viewDescriptorService=Lt,this._contributions=new Map,this._latestXtermWriteData=0,this._latestXtermParseData=0,this._title="",this._titleSource=D.ev.Process,this._cols=0,this._rows=0,this._cwd=void 0,this._initialCwd=void 0,this._injectedArgs=void 0,this._layoutSettingsChanged=!0,this._areLinksReady=!1,this._initialDataEvents=[],this._widgetManager=new Ga,this._processName="",this._usedShellIntegrationInjection=!1,this.capabilities=new xa,this.disableLayout=!1,this._onExit=new w.Q5,this.onExit=this._onExit.event,this._onDisposed=this._register(new w.Q5),this.onDisposed=this._onDisposed.event,this._onProcessIdReady=this._register(new w.Q5),this.onProcessIdReady=this._onProcessIdReady.event,this._onTitleChanged=this._register(new w.Q5),this.onTitleChanged=this._onTitleChanged.event,this._onIconChanged=this._register(new w.Q5),this.onIconChanged=this._onIconChanged.event,this._onData=this._register(new w.Q5),this.onData=this._onData.event,this._onBinary=this._register(new w.Q5),this.onBinary=this._onBinary.event,this._onLineData=this._register(new w.Q5({onDidAddFirstListener:()=>this._onLineDataSetup()})),this.onLineData=this._onLineData.event,this._onRequestExtHostProcess=this._register(new w.Q5),this.onRequestExtHostProcess=this._onRequestExtHostProcess.event,this._onDimensionsChanged=this._register(new w.Q5),this.onDimensionsChanged=this._onDimensionsChanged.event,this._onMaximumDimensionsChanged=this._register(new w.Q5),this.onMaximumDimensionsChanged=this._onMaximumDimensionsChanged.event,this._onDidFocus=this._register(new w.Q5),this.onDidFocus=this._onDidFocus.event,this._onDidRequestFocus=this._register(new w.Q5),this.onDidRequestFocus=this._onDidRequestFocus.event,this._onDidBlur=this._register(new w.Q5),this.onDidBlur=this._onDidBlur.event,this._onDidInputData=this._register(new w.Q5),this.onDidInputData=this._onDidInputData.event,this._onRequestAddInstanceToGroup=this._register(new w.Q5),this.onRequestAddInstanceToGroup=this._onRequestAddInstanceToGroup.event,this._onDidChangeHasChildProcesses=this._register(new w.Q5),this.onDidChangeHasChildProcesses=this._onDidChangeHasChildProcesses.event,this._wrapperElement=document.createElement("div"),this._wrapperElement.classList.add("terminal-wrapper"),this._skipTerminalCommands=[],this._isExiting=!1,this._hadFocusOnExit=!1,this._isVisible=!1,this._isDisposed=!1,this._instanceId=nt._instanceIdCounter++,this._hasHadInput=!1,this._fixedRows=r.attachPersistentProcess?.fixedDimensions?.rows,this._fixedCols=r.attachPersistentProcess?.fixedDimensions?.cols,this._resource=No(this._workspaceContextService.getWorkspace().id,this.instanceId,this.title),this._shellLaunchConfig.attachPersistentProcess?.hideFromUser&&(this._shellLaunchConfig.hideFromUser=this._shellLaunchConfig.attachPersistentProcess.hideFromUser),this._shellLaunchConfig.attachPersistentProcess?.isFeatureTerminal&&(this._shellLaunchConfig.isFeatureTerminal=this._shellLaunchConfig.attachPersistentProcess.isFeatureTerminal),this._shellLaunchConfig.attachPersistentProcess?.type&&(this._shellLaunchConfig.type=this._shellLaunchConfig.attachPersistentProcess.type),this.shellLaunchConfig.cwd){const ce="string"==typeof this._shellLaunchConfig.cwd?N.ov.from({scheme:J.lg.file,path:this._shellLaunchConfig.cwd}):this._shellLaunchConfig.cwd;ce&&(this._workspaceFolder=(0,de.f6)(this._workspaceContextService.getWorkspaceFolder(ce)))}if(!this._workspaceFolder){const ce=this._historyService.getLastActiveWorkspaceRoot();this._workspaceFolder=ce?(0,de.f6)(this._workspaceContextService.getWorkspaceFolder(ce)):void 0}const Rt=this._register(s.createScoped(this._wrapperElement));this._scopedInstantiationService=l.createChild(new ya.y([g.i6,Rt])),this._terminalFocusContextKey=m.r.focus.bindTo(Rt),this._terminalHasFixedWidth=m.r.terminalHasFixedWidth.bindTo(Rt),this._terminalHasTextContextKey=m.r.textSelected.bindTo(Rt),this._terminalAltBufferActiveContextKey=m.r.altBufferActive.bindTo(Rt),this._terminalShellIntegrationEnabledContextKey=m.r.terminalShellIntegrationEnabled.bindTo(Rt),this._logService.trace(`terminalInstance#ctor (instanceId: ${this.instanceId})`,this._shellLaunchConfig),this._register(this.capabilities.onDidAddCapability(ce=>{this._logService.debug("terminalInstance added capability",ce),0===ce?this.capabilities.get(0)?.onDidChangeCwd(oe=>{this._cwd=oe,this._setTitle(this.title,D.ev.Config),this._scopedInstantiationService.invokeFunction(cn)?.add(oe,{remoteAuthority:this.remoteAuthority})}):2===ce&&this.capabilities.get(2)?.onCommandFinished(pt=>{pt.command.trim().length>0&&this._scopedInstantiationService.invokeFunction(_i)?.add(pt.command,{shellType:this._shellType})})})),this._register(this.capabilities.onDidRemoveCapability(ce=>this._logService.debug("terminalInstance removed capability",ce))),!this.shellLaunchConfig.executable&&!te.remoteAuthority&&this._terminalProfileResolverService.resolveIcon(this._shellLaunchConfig,T.OS),this._icon=r.attachPersistentProcess?.icon||r.icon,this.shellLaunchConfig.customPtyImplementation&&this._setTitle(this._shellLaunchConfig.name,D.ev.Api),this.statusList=this._scopedInstantiationService.createInstance(or),this._initDimensions(),this._processManager=this._createProcessManager(),this._register((0,A.OF)(()=>this._dndObserver?.dispose())),this._containerReadyBarrier=new ne.Ug(100),this._attachBarrier=new ne.Ug(1e3),this._xtermReadyPromise=this._createXterm(),this._xtermReadyPromise.then((0,u.Z)(function*(){if(yield U._containerReadyBarrier.wait(),!U.shellLaunchConfig.customPtyImplementation&&U._configHelper.config.shellIntegration?.enabled&&!U.shellLaunchConfig.executable){const ce=yield U._processManager.getBackendOS(),oe=yield U._terminalProfileResolverService.getDefaultProfile({remoteAuthority:U.remoteAuthority,os:ce});U.shellLaunchConfig.executable=oe.path,U.shellLaunchConfig.args=oe.args,U.shellLaunchConfig.isExtensionOwnedTerminal?(U.shellLaunchConfig.icon??=oe.icon,U.shellLaunchConfig.color??=oe.color):(U.shellLaunchConfig.icon=oe.icon,U.shellLaunchConfig.color=oe.color)}yield U._createProcess(),U.shellLaunchConfig.attachPersistentProcess&&(U._cwd=U.shellLaunchConfig.attachPersistentProcess.cwd,U._setTitle(U.shellLaunchConfig.attachPersistentProcess.title,U.shellLaunchConfig.attachPersistentProcess.titleSource),U.setShellType(U.shellType)),U._fixedCols&&(yield U._addScrollbar())})).catch(ce=>{if(!this._isDisposed)throw ce}),this._register(this._configurationService.onDidChangeConfiguration(function(){var ce=(0,u.Z)(function*(oe){oe.affectsConfiguration("accessibility.verbosity.terminal")&&U._setAriaLabel(U.xterm?.raw,U._instanceId,U.title),oe.affectsConfiguration("terminal.integrated")&&(U.updateConfig(),U.setVisible(U._isVisible)),["terminal.integrated.fontSize","terminal.integrated.fontFamily","terminal.integrated.fontWeight","terminal.integrated.fontWeightBold","terminal.integrated.letterSpacing","terminal.integrated.lineHeight","editor.fontFamily"].some(nc=>oe.affectsConfiguration(nc))&&(U._layoutSettingsChanged=!0,yield U._resize()),oe.affectsConfiguration("terminal.integrated.unicodeVersion")&&U._updateUnicodeVersion(),oe.affectsConfiguration("editor.accessibilitySupport")&&U.updateAccessibilitySupport(),(oe.affectsConfiguration("terminal.integrated.tabs.title")||oe.affectsConfiguration("terminal.integrated.tabs.separator")||oe.affectsConfiguration("terminal.integrated.tabs.description"))&&U._labelComputer?.refreshLabel()});return function(oe){return ce.apply(this,arguments)}}())),this._register(this._workspaceContextService.onDidChangeWorkspaceFolders(()=>this._labelComputer?.refreshLabel())),this._register(this.onDidBlur(()=>this.xterm?.suggestController?.hideSuggestWidget()));let Yr=window.setTimeout(()=>{Yr=void 0,this._initialDataEvents=void 0},1e4);this._register((0,A.OF)(()=>{Yr&&window.clearTimeout(Yr)}));const ic=xr.getTerminalContributions();for(const ce of ic){if(this._contributions.has(ce.id)){(0,Qe.dL)(new Error(`Cannot have two terminal contributions with the same id ${ce.id}`));continue}let oe;try{oe=this._scopedInstantiationService.createInstance(ce.ctor,this,this._processManager,this._widgetManager),this._contributions.set(ce.id,oe)}catch(pt){(0,Qe.dL)(pt)}this._xtermReadyPromise.then(pt=>{oe.xtermReady?.(pt)}),this.onDisposed(()=>{oe.dispose()})}}getContribution(e){return this._contributions.get(e)}_getIcon(){return this._icon||(this._icon=this._processManager.processState>=2?(0,ge.Ks)().getIcon(this._configurationService.getValue("terminal.integrated.tabs.defaultIcon")):void 0),this._icon}_getColor(){return this.shellLaunchConfig.color?this.shellLaunchConfig.color:this.shellLaunchConfig?.attachPersistentProcess?.color?this.shellLaunchConfig.attachPersistentProcess.color:void 0}_initDimensions(){if(!this._container)return this._cols=80,void(this._rows=30);const e=window.getComputedStyle(this._container),t=parseInt(e.width),i=parseInt(e.height);this._evaluateColsAndRows(t,i)}_evaluateColsAndRows(e,t){if(!e||!t)return this._setLastKnownColsAndRows(),null;const i=this._getDimension(e,t);if(!i)return this._setLastKnownColsAndRows(),null;const n=this.xterm?this.xterm.getFont():this._configHelper.getFont();if(!n.charWidth||!n.charHeight)return this._setLastKnownColsAndRows(),null;const r=i.width*window.devicePixelRatio,s=n.charWidth*window.devicePixelRatio+n.letterSpacing,l=Math.max(Math.floor(r/s),1),d=i.height*window.devicePixelRatio,h=Math.ceil(n.charHeight*window.devicePixelRatio),f=Math.floor(h*n.lineHeight),v=Math.max(Math.floor(d/f),1);return(this._cols!==l||this._rows!==v)&&(this._cols=l,this._rows=v,this._fireMaximumDimensionsChanged()),i.width}_setLastKnownColsAndRows(){nt._lastKnownGridDimensions&&(this._cols=nt._lastKnownGridDimensions.cols,this._rows=nt._lastKnownGridDimensions.rows)}_fireMaximumDimensionsChanged(){this._onMaximumDimensionsChanged.fire()}_getDimension(e,t){const i=this.xterm?this.xterm.getFont():this._configHelper.getFont();if(!(i&&i.charWidth&&i.charHeight&&this.xterm?.raw.element))return;const n=window.getComputedStyle(this.xterm.raw.element),r=parseInt(n.paddingLeft)+parseInt(n.paddingRight),s=parseInt(n.paddingTop)+parseInt(n.paddingBottom);return nt._lastKnownCanvasDimensions=new S.Ro(Math.min(8e3,e-r),t+(this._hasScrollBar&&!this._horizontalScrollbar?-5:0)-2-s),nt._lastKnownCanvasDimensions}get persistentProcessId(){return this._processManager.persistentProcessId}get shouldPersist(){return this._processManager.shouldPersist&&!this.shellLaunchConfig.isTransient&&(!this.reconnectionProperties||!0===this._configurationService.getValue("task.reconnection"))}_createXterm(){var e=this;return(0,u.Z)(function*(){const t=yield function cl(o){return qi||(qi=ne.jT.withAsyncBody(function(){var e=(0,u.Z)(function*(t){const i=(yield p.e(748).then(p.t.bind(p,88748,19)).then(n=>n.default??n)).Terminal;i.strings.promptLabel=a.NC("terminal.integrated.a11yPromptLabel","Terminal input"),i.strings.tooMuchOutput=o?a.NC("terminal.integrated.useAccessibleBuffer","Use the accessible buffer {0} to manually review output",o.getLabel()):a.NC("terminal.integrated.useAccessibleBufferNoKb","Use the Terminal: Focus Accessible Buffer command to manually review output"),t(i)});return function(t){return e.apply(this,arguments)}}()),qi)}(e._keybindingService.lookupKeybinding("workbench.action.terminal.focusAccessibleBuffer",e._contextKeyService));if(e._isDisposed)throw new Qe.QD("Terminal disposed of during xterm.js creation");const i=e.shellLaunchConfig.hideFromUser||void 0===e.shellLaunchConfig.executable||void 0===e.shellType||!dl.includes(e.shellType),n=e._scopedInstantiationService.createInstance(Qi,t,e._configHelper,e._cols,e._rows,{getBackgroundColor:l=>l.getColor(j.Es)||(e.target===D.i2.Editor?l.getColor(Z.cvW):1===e._viewDescriptorService.getViewLocationById(k.e9)?l.getColor(ar.v9):l.getColor(ar.Qd))},e.capabilities,e._processManager.shellIntegrationNonce,e._terminalSuggestWidgetVisibleContextKey,i);e.xterm=n,e.updateAccessibilitySupport(),e.xterm.onDidRequestRunCommand(l=>{l.copyAsHtml?e.copySelection(!0,l.command):e.sendText(l.command.command,!l.noNewLine)}),e.xterm.onDidRequestFocus(()=>e.focus()),e.xterm.onDidRequestSendText(l=>e.sendText(l,!1));const r=e._shellLaunchConfig.initialText?new Promise(l=>e._writeInitialText(n,l)):void 0,s=new za(r);if(s.onLineData(l=>e._onLineData.fire(l)),e._lineDataEventAddon=s,setTimeout(()=>{n.raw.onBell(()=>{e._configHelper.config.enableBell&&(e.statusList.add({id:"bell",severity:R.zb.Warning,icon:E.lA.bell,tooltip:a.NC("bellStatus","Bell")},e._configHelper.config.bellDuration),e._audioCueService.playSound(Ki.y$.terminalBell.sound))})},1e3),n.raw.onSelectionChange((0,u.Z)(function*(){return e._onSelectionChange()})),n.raw.buffer.onBufferChange(()=>e._refreshAltBufferContextKey()),e._processManager.onProcessData(l=>e._onProcessData(l)),n.raw.onData(function(){var l=(0,u.Z)(function*(d){yield e._processManager.write(d),e._onDidInputData.fire(e)});return function(d){return l.apply(this,arguments)}}()),n.raw.onBinary(l=>e._processManager.processBinary(l)),e._processManager.onProcessReady(function(){var l=(0,u.Z)(function*(d){e._processManager.os&&s.setOperatingSystem(e._processManager.os),1===e._processManager.os&&(n.raw.options.windowsMode=d.requiresWindowsMode||!1)});return function(d){return l.apply(this,arguments)}}()),e._processManager.onRestoreCommands(l=>e.xterm?.shellIntegration.deserialize(l)),e._register(e._viewDescriptorService.onDidChangeLocation(({views:l})=>{l.some(d=>d.id===k.e9)&&n.refresh()})),!e.capabilities.has(0)){let l=n.raw.onKey(d=>{new Bo.y1(d.domEvent).equals(3)&&e._updateProcessCwd()});e._register(e.capabilities.onDidAddCapability(d=>{0===d&&(l?.dispose(),l=void 0)}))}return e._pathService.userHome().then(l=>{e._userHome=l.fsPath}),e._isVisible&&e._open(),n})()}_onLineDataSetup(){var e=this;return(0,u.Z)(function*(){(e.xterm||(yield e._xtermReadyPromise)).raw.loadAddon(e._lineDataEventAddon)})()}runCommand(e,t){var i=this;return(0,u.Z)(function*(){!1!==i.capabilities.get(2)?.hasInput&&(yield i.sendText("\x03",!1),yield(0,ne.Vs)(100)),yield i.sendText(e,t,!t)})()}runRecent(e,t,i){var n=this;return(0,u.Z)(function*(){return n._scopedInstantiationService.invokeFunction(zi,n,n._terminalInRunCommandPicker,e,t,i)})()}detachFromElement(){this._wrapperElement.remove(),this._container=void 0}attachToElement(e){this._container!==e&&(this._attachBarrier.open(),this._container=e,this._container.appendChild(this._wrapperElement),this.xterm?.refresh(),setTimeout(()=>this._initDragAndDrop(e)))}_open(){if(!this.xterm||this.xterm.raw.element)return;if(!this._container||!this._container.isConnected)throw new Error("A container element needs to be set with `attachToElement` and be part of the DOM before calling `_open`");const e=document.createElement("div");this._wrapperElement.appendChild(e),this._container.appendChild(this._wrapperElement);const t=this.xterm;this._wrapperElement.xterm=t.raw;const i=t.attachToElement(e);if(this._register(t.shellIntegration.onDidChangeStatus(()=>{this.hasFocus?this._setShellIntegrationContextKey():this._terminalShellIntegrationEnabledContextKey.reset()})),!t.raw.element||!t.raw.textarea)throw new Error("xterm elements not set after open");this._setAriaLabel(t.raw,this._instanceId,this._title),t.raw.attachCustomKeyEventHandler(n=>{if(this._isExiting)return!1;const r=new Bo.y1(n),s=this._keybindingService.softDispatch(r,r.target);if(this._keybindingService.inChordMode||1===s.kind&&this._configHelper.config.allowChords&&"Escape"!==n.key)return n.preventDefault(),!1;const d="terminal.integrated.showTerminalConfigPrompt";return this._storageService.getBoolean(d,-1,!0)&&!["RightArrow","LeftArrow","UpArrow","DownArrow","Space","Meta","Control","Shift","Alt","","Delete","Backspace","Tab"].includes(n.key)&&!n.ctrlKey&&!n.shiftKey&&!n.altKey&&(this._hasHadInput=!0),2===s.kind&&s.commandId&&this._skipTerminalCommands.some(f=>f===s.commandId)&&!this._configHelper.config.sendKeybindingsToShell?(this._storageService.getBoolean(d,-1,!0)&&this._hasHadInput&&!k.K6.includes(s.commandId)&&(this._notificationService.prompt(R.zb.Info,a.NC("keybindingHandling","Some keybindings don't go to the terminal by default and are handled by {0} instead.",this._productService.nameLong),[{label:a.NC("configureTerminalSettings","Configure Terminal Settings"),run:()=>{this._preferencesService.openSettings({jsonEditor:!1,query:"@id:terminal.integrated.commandsToSkipShell,terminal.integrated.sendKeybindingsToShell,terminal.integrated.allowChords"})}}]),this._storageService.store(d,!1,-1,0)),n.preventDefault(),!1):!(this._configHelper.config.allowMnemonics&&!T.dz&&n.altKey||Ca.n.getTabFocusMode("terminalFocus")&&"Tab"===n.key||T.ED&&n.altKey&&"F4"===n.key&&!n.ctrlKey||!bt.D.clipboard.readText&&"v"===n.key&&n.ctrlKey)}),this._register(S.nm(t.raw.element,"mousedown",()=>{const n=S.nm(document,"mouseup",()=>{setTimeout(()=>this._refreshSelectionContextKey(),0),n.dispose()})})),this._register(S.nm(t.raw.element,"touchstart",()=>{t.raw.focus()})),this._register(S.nm(t.raw.element,"keyup",()=>{setTimeout(()=>this._refreshSelectionContextKey(),0)})),this._register(S.nm(t.raw.textarea,"focus",()=>this._setFocus(!0))),this._register(S.nm(t.raw.textarea,"blur",()=>this._setFocus(!1))),this._register(S.nm(t.raw.textarea,"focusout",()=>this._setFocus(!1))),this._initDragAndDrop(this._container),this._widgetManager.attachToElement(i),this._lastLayoutDimensions&&this.layout(this._lastLayoutDimensions),this.updateConfig(),t.raw.options.disableStdin&&this._attachPressAnyKeyToCloseListener(t.raw)}_setFocus(e){e?(this._terminalFocusContextKey.set(!0),this._setShellIntegrationContextKey(),this._onDidFocus.fire(this)):(this.resetFocusContextKey(),this._onDidBlur.fire(this),this._refreshSelectionContextKey())}_setShellIntegrationContextKey(){this.xterm&&this._terminalShellIntegrationEnabledContextKey.set(2===this.xterm.shellIntegration.status)}resetFocusContextKey(){this._terminalFocusContextKey.reset(),this._terminalShellIntegrationEnabledContextKey.reset()}_initDragAndDrop(e){var t=this;this._dndObserver?.dispose();const i=this._scopedInstantiationService.createInstance(Ir,e);i.onDropTerminal(n=>this._onRequestAddInstanceToGroup.fire(n)),i.onDropFile(function(){var n=(0,u.Z)(function*(r){t.focus(),yield t.sendPath(r,!1)});return function(r){return n.apply(this,arguments)}}()),this._dndObserver=new S.eg(e,i)}hasSelection(){return!!this.xterm&&this.xterm.raw.hasSelection()}copySelection(e,t){var i=this;return(0,u.Z)(function*(){const n=yield i._xtermReadyPromise;if(i.hasSelection()||e&&t)if(e){let s=function(l){l.clipboardData.types.includes("text/plain")||l.clipboardData.setData("text/plain",t?.getOutput()??""),l.clipboardData.setData("text/html",r),l.preventDefault()};const r=yield n.getSelectionAsHtml(t);document.addEventListener("copy",s),document.execCommand("copy"),document.removeEventListener("copy",s)}else yield i._clipboardService.writeText(n.raw.getSelection());else i._notificationService.warn(a.NC("terminal.integrated.copySelection.noSelection","The terminal has no selection to copy"))})()}get selection(){return this.xterm&&this.hasSelection()?this.xterm.raw.getSelection():void 0}clearSelection(){this.xterm?.raw.clearSelection()}selectAll(){this.xterm?.raw.focus(),this.xterm?.raw.selectAll()}_refreshAltBufferContextKey(){this._terminalAltBufferActiveContextKey.set(!(!this.xterm||this.xterm.raw.buffer.active!==this.xterm.raw.buffer.alternate))}_shouldPasteText(e){var t=this;return(0,u.Z)(function*(){if(t.xterm?.raw.modes.bracketedPasteMode)return!0;const i=e.split(/\r?\n/);if(2===i.length&&0===i[1].trim().length||1===i.length||!t._configurationService.getValue("terminal.integrated.enableMultiLinePasteWarning"))return!0;let s=a.NC("preview","Preview:");for(let h=0;h<Math.min(i.length,3);h++){const f=i[h];s+=`\n${f.length>30?`${f.slice(0,30)}\u2026`:f}`}i.length>3&&(s+="\n\u2026");const{confirmed:l,checkboxChecked:d}=yield t._dialogService.confirm({message:a.NC("confirmMoveTrashMessageFilesAndDirectories","Are you sure you want to paste {0} lines of text into the terminal?",i.length),detail:s,primaryButton:a.NC({key:"multiLinePasteButton",comment:["&& denotes a mnemonic"]},"&&Paste"),checkbox:{label:a.NC("doNotAskAgain","Do not ask me again")}});return l&&d&&(yield t._configurationService.updateValue("terminal.integrated.enableMultiLinePasteWarning",!1)),l})()}dispose(e){if(!this._isDisposed){this._isDisposed=!0,this._logService.trace(`terminalInstance#dispose (instanceId: ${this.instanceId})`),(0,A.B9)(this._widgetManager),this.xterm?.raw.element&&(this._hadFocusOnExit=this.hasFocus),this._wrapperElement.xterm&&(this._wrapperElement.xterm=void 0),this._horizontalScrollbar&&(this._horizontalScrollbar.dispose(),this._horizontalScrollbar=void 0);try{this.xterm?.dispose()}catch(t){this._logService.error("Exception occurred during xterm disposal",t)}Wo.isFirefox&&(this.resetFocusContextKey(),this._terminalHasTextContextKey.reset(),this._onDidBlur.fire(this)),this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener.dispose(),this._pressAnyKeyToCloseListener=void 0),void 0===this._exitReason&&(this._exitReason=e??D._x.Unknown),this._processManager.dispose(),this._onProcessExit(void 0),this._onDisposed.fire(this),super.dispose()}}detachProcessAndDispose(e){var t=this;return(0,u.Z)(function*(){yield t._processManager.detachFromProcess(e===D._x.User),t.dispose(e)})()}focus(e){this._refreshAltBufferContextKey(),this.xterm&&(e||!window.getSelection()?.toString())&&(this.xterm.raw.focus(),this._onDidRequestFocus.fire())}focusWhenReady(e){var t=this;return(0,u.Z)(function*(){yield t._xtermReadyPromise,yield t._attachBarrier.wait(),t.focus(e)})()}paste(){var e=this;return(0,u.Z)(function*(){if(!e.xterm)return;const t=yield e._clipboardService.readText();(yield e._shouldPasteText(t))&&(e.focus(),e.xterm.raw.paste(t))})()}pasteSelection(){var e=this;return(0,u.Z)(function*(){if(!e.xterm)return;const t=yield e._clipboardService.readText("selection");(yield e._shouldPasteText(t))&&(e.focus(),e.xterm.raw.paste(t))})()}sendText(e,t,i){var n=this;return(0,u.Z)(function*(){i&&n.xterm?.raw.modes.bracketedPasteMode&&(e=`\x1b[200~${e}\x1b[201~`),e=e.replace(/\r?\n/g,"\r"),t&&!e.endsWith("\r")&&(e+="\r"),yield n._processManager.write(e),n._onDidInputData.fire(n),n.xterm?.suggestController?.handleNonXtermData(e),n.xterm?.scrollToBottom()})()}sendPath(e,t){var i=this;return(0,u.Z)(function*(){return i.sendText(yield i.preparePathForShell(e),t)})()}preparePathForShell(e){var t=this;return(0,u.Z)(function*(){return yield t.processReady,function Fa(o,e,t,i,n,r){return er.apply(this,arguments)}(e,t.shellLaunchConfig.executable,t.title,t.shellType,t._processManager.backend,t._processManager.os)})()}setVisible(e){this._isVisible=e,this._wrapperElement.classList.toggle("active",e),e&&this.xterm&&(this._open(),this._resize(),setTimeout(()=>this.xterm.forceRefresh(),0))}scrollDownLine(){this.xterm?.scrollDownLine()}scrollDownPage(){this.xterm?.scrollDownPage()}scrollToBottom(){this.xterm?.scrollToBottom()}scrollUpLine(){this.xterm?.scrollUpLine()}scrollUpPage(){this.xterm?.scrollUpPage()}scrollToTop(){this.xterm?.scrollToTop()}clearBuffer(){this.xterm?.clearBuffer()}_refreshSelectionContextKey(){const e=!!this._viewsService.getActiveViewWithId(k.e9);let t=!1;const i=this._editorService.activeEditor;i&&(t=i instanceof ke.S),this._terminalHasTextContextKey.set((e||t)&&this.hasSelection())}_createProcessManager(){var e=this;let t;this.shellLaunchConfig.attachPersistentProcess?.environmentVariableCollections&&(t=(0,ft.Vn)(this.shellLaunchConfig.attachPersistentProcess.environmentVariableCollections));const i=this._scopedInstantiationService.createInstance(ir,this._instanceId,this._configHelper,this.shellLaunchConfig?.cwd,t,this.shellLaunchConfig.attachPersistentProcess?.shellIntegrationNonce);return this.capabilities.add(i.capabilities),i.onProcessReady(function(){var n=(0,u.Z)(function*(r){e._onProcessIdReady.fire(e),e._initialCwd=yield e.getInitialCwd(),e._labelComputer||(e._labelComputer=e._register(e._scopedInstantiationService.createInstance(kr,e._configHelper,e)),e._labelComputer.onDidChangeLabel(s=>{e._title=s.title,e._description=s.description,e._onTitleChanged.fire(e)})),e._shellLaunchConfig.name?e._setTitle(e._shellLaunchConfig.name,D.ev.Api):(setTimeout(()=>{e._xtermReadyPromise.then(s=>{e._messageTitleDisposable=s.raw.onTitleChange(l=>e._onTitleChange(l))})}),e._setTitle(e._shellLaunchConfig.executable,D.ev.Process))});return function(r){return n.apply(this,arguments)}}()),i.onProcessExit(n=>this._onProcessExit(n)),i.onDidChangeProperty(({type:n,value:r})=>{switch(n){case"cwd":this._cwd=r,this._labelComputer?.refreshLabel();break;case"initialCwd":this._initialCwd=r,this._cwd=this._initialCwd,this._setTitle(this.title,D.ev.Config),this._icon=this._shellLaunchConfig.attachPersistentProcess?.icon||this._shellLaunchConfig.icon,this._onIconChanged.fire({instance:this,userInitiated:!1});break;case"title":this._setTitle(r??"",D.ev.Process);break;case"overrideDimensions":this.setOverrideDimensions(r,!0);break;case"resolvedShellLaunchConfig":this._setResolvedShellLaunchConfig(r);break;case"shellType":this.setShellType(r);break;case"hasChildProcesses":this._onDidChangeHasChildProcesses.fire(r);break;case"usedShellIntegrationInjection":this._usedShellIntegrationInjection=!0}}),i.onProcessData(n=>{this._initialDataEvents?.push(n.data),this._onData.fire(n.data)}),i.onEnvironmentVariableInfoChanged(n=>this._onEnvironmentVariableInfoChanged(n)),i.onPtyDisconnect(()=>{this.xterm&&(this.xterm.raw.options.disableStdin=!0),this.statusList.add({id:"disconnected",severity:R.zb.Error,icon:E.lA.debugDisconnect,tooltip:a.NC("disconnectStatus","Lost connection to process")})}),i.onPtyReconnect(()=>{this.xterm&&(this.xterm.raw.options.disableStdin=!1),this.statusList.remove("disconnected")}),i}_createProcess(){var e=this;return(0,u.Z)(function*(){if(e._isDisposed)return;e._historyService.getLastActiveWorkspaceRoot(J.lg.file)?(yield e._trust())||e._onProcessExit({message:a.NC("workspaceNotTrustedCreateTerminal","Cannot launch a terminal process in an untrusted workspace")}):e._cwd&&e._userHome&&e._cwd!==e._userHome&&e._onProcessExit({message:a.NC("workspaceNotTrustedCreateTerminalCwd","Cannot launch a terminal process in an untrusted workspace with cwd {0} and userHome {1}",e._cwd,e._userHome)}),e._container&&0===e._cols&&0===e._rows&&(e._initDimensions(),e.xterm?.raw.resize(e._cols||80,e._rows||30));const i=e.shellLaunchConfig.icon;yield e._processManager.createProcess(e._shellLaunchConfig,e._cols||80,e._rows||30).then(n=>{n&&("message"in n?e._onProcessExit(n):"injectedArgs"in n&&(e._injectedArgs=n.injectedArgs))}),e.xterm?.shellIntegration&&e.capabilities.add(e.xterm.shellIntegration.capabilities),(i!==e.shellLaunchConfig.icon||e.shellLaunchConfig.color)&&(e._icon=e._shellLaunchConfig.attachPersistentProcess?.icon||e._shellLaunchConfig.icon,e._onIconChanged.fire({instance:e,userInitiated:!1}))})()}registerMarker(){return this.xterm?.raw.registerMarker()}addBufferMarker(e){this.capabilities.get(4)?.addMark(e)}scrollToMark(e,t,i){this.xterm?.markTracker.scrollToClosestMarker(e,t,i)}freePortKillProcess(e,t){var i=this;return(0,u.Z)(function*(){yield i._processManager?.freePortKillProcess(e),i.runCommand(t,!1)})()}_onProcessData(e){const t=++this._latestXtermWriteData;e.trackCommit?e.writePromise=new Promise(i=>{this.xterm?.raw.write(e.data,()=>{this._latestXtermParseData=t,this._processManager.acknowledgeDataEvent(e.data.length),i()})}):this.xterm?.raw.write(e.data,()=>{this._latestXtermParseData=t,this._processManager.acknowledgeDataEvent(e.data.length)})}_onProcessExit(e){var t=this;return(0,u.Z)(function*(){if(t._isExiting)return;const i=function hl(o,e,t,i){if(void 0===o||0===o)return{code:o,message:void 0};const n="number"==typeof o?o:o.code;let r;switch(typeof o){case"number":{let s;e.executable&&(s=e.executable,"string"==typeof e.args?s+=` ${e.args}`:e.args&&e.args.length&&(s+=e.args.map(l=>` '${l}'`).join())),r=4===t?s?a.NC("launchFailed.exitCodeAndCommandLine",'The terminal process "{0}" failed to launch (exit code: {1}).',s,n):a.NC("launchFailed.exitCodeOnly","The terminal process failed to launch (exit code: {0}).",n):s?a.NC("terminated.exitCodeAndCommandLine",'The terminal process "{0}" terminated with exit code: {1}.',s,n):a.NC("terminated.exitCodeOnly","The terminal process terminated with exit code: {0}.",n);break}case"object":{if(o.message.toString().includes("Could not find pty with id"))break;let s=o.message;const l=o.message.match(/.*error code:\s*(\d+).*$/);if(l)switch(l.length>1?parseInt(l[1]):void 0){case 5:s=`Access was denied to the path containing your executable "${e.executable}". Manage and change your permissions to get this to work`;break;case 267:s=`Invalid starting directory "${i}", review your terminal.integrated.cwd setting`;break;case 1260:s="Windows cannot open this program because it has been prevented by a software restriction policy. For more information, open Event Viewer or contact your system Administrator"}r=a.NC("launchFailed.errorMessage","The terminal process failed to launch: {0}.",s);break}}return{code:n,message:r}}(e,t.shellLaunchConfig,t._processManager.processState,t._initialCwd);if(t._usedShellIntegrationInjection&&4===t._processManager.processState&&0!==i?.code)return t._relaunchWithShellIntegrationDisabled(i?.message),void t._onExit.fire(e);t._isExiting=!0,yield t._flushXtermData(),t._logService.debug(`Terminal process exit (instanceId: ${t.instanceId}) with code ${t._exitCode}`),t._exitCode=i?.code;const n=i?.message;t._logService.debug(`Terminal process exit (instanceId: ${t.instanceId}) state ${t._processManager.processState}`);const r=t.waitOnExit;r&&5!==t._processManager.processState?t._xtermReadyPromise.then(s=>{switch(n&&s.raw.write(Ze(n)),typeof r){case"string":s.raw.write(Ze(r,{excludeLeadingNewLine:!0}));break;case"function":void 0!==t.exitCode&&s.raw.write(Ze(r(t.exitCode),{excludeLeadingNewLine:!0}))}s.raw.options.disableStdin=!0,s.raw.textarea&&t._attachPressAnyKeyToCloseListener(s.raw)}):(t.dispose(D._x.Process),n&&(4===t._processManager.processState||t._configHelper.config.showExitAlert?t._notificationService.notify({message:n,severity:R.zb.Error,actions:{primary:[t._scopedInstantiationService.createInstance(_n)]}}):t._logService.warn(n))),t._onExit.fire(e),t._isDisposed&&t._onExit.dispose()})()}_relaunchWithShellIntegrationDisabled(e){this._shellLaunchConfig.ignoreShellIntegration=!0,this.relaunch(),this.statusList.add({id:"shell-integration-attention-needed",severity:R.zb.Warning,icon:E.lA.warning,tooltip:(`${e} `??0)+a.NC("launchFailed.exitCodeOnlyShellIntegration","Disabling shell integration in user settings might help."),hoverActions:[{commandId:"workbench.action.terminal.learnMore",label:a.NC("shellIntegration.learnMore","Learn more about shell integration"),run:()=>{this._openerService.open("https://code.visualstudio.com/docs/editor/integrated-terminal#_shell-integration")}},{commandId:"workbench.action.openSettings",label:a.NC("shellIntegration.openSettings","Open user settings"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings","terminal.integrated.shellIntegration.enabled")}}]}),this._telemetryService.publicLog2("terminal/shellIntegrationFailureProcessExit")}_flushXtermData(){if(this._latestXtermWriteData===this._latestXtermParseData)return Promise.resolve();let e=0;return new Promise(t=>{const i=setInterval(()=>{(this._latestXtermWriteData===this._latestXtermParseData||5==++e)&&(clearInterval(i),t())},20)})}_attachPressAnyKeyToCloseListener(e){e.textarea&&!this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener=S.nm(e.textarea,"keypress",t=>{this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener.dispose(),this._pressAnyKeyToCloseListener=void 0,this.dispose(D._x.Process),t.preventDefault())}))}_writeInitialText(e,t){if(!this._shellLaunchConfig.initialText)return void t?.();const i="string"==typeof this._shellLaunchConfig.initialText?this._shellLaunchConfig.initialText:this._shellLaunchConfig.initialText?.text;"string"==typeof this._shellLaunchConfig.initialText||this._shellLaunchConfig.initialText.trailingNewLine?e.raw.writeln(i,t):e.raw.write(i,t)}reuseTerminal(e,t=!1){var i=this;return(0,u.Z)(function*(){i._pressAnyKeyToCloseListener?.dispose(),i._pressAnyKeyToCloseListener=void 0;const n=i.xterm;n&&(t||(yield new Promise(r=>n.raw.write("\n\x1b[G",r))),e.initialText&&(i._shellLaunchConfig.initialText=e.initialText,yield new Promise(r=>i._writeInitialText(n,r))),i._isExiting&&i._shellLaunchConfig.waitOnExit&&(n.raw.options.disableStdin=!1,i._isExiting=!1),t&&n.clearDecorations()),i.statusList.remove("relaunch-needed"),t||(e.initialText=" "),i._shellLaunchConfig=e,yield i._processManager.relaunch(i._shellLaunchConfig,i._cols||80,i._rows||30,t).then(r=>{r&&("message"in r?i._onProcessExit(r):"injectedArgs"in r&&(i._injectedArgs=r.injectedArgs))})})()}setEscapeSequenceLogging(e){var t=this;return(0,u.Z)(function*(){(yield t._xtermReadyPromise).raw.options.logLevel=e?"debug":"info"})()}relaunch(){this.reuseTerminal(this._shellLaunchConfig,!0)}_onTitleChange(e){this.isTitleSetByProcess&&this._setTitle(e,D.ev.Sequence)}_trust(){var e=this;return(0,u.Z)(function*(){return!0===(yield e._workspaceTrustRequestService.requestWorkspaceTrust({message:a.NC("terminal.requestTrust","Creating a terminal process requires executing code")}))})()}_onSelectionChange(){var e=this;return(0,u.Z)(function*(){e._configurationService.getValue("terminal.integrated.copyOnSelection")&&e.hasSelection()&&(yield e.copySelection())})()}_updateProcessCwd(){var e=this;return(0,u.Z)(function*(){if(!e._isDisposed&&!e.shellLaunchConfig.customPtyImplementation)try{const t=yield e._refreshProperty("cwd");if("string"!=typeof t)throw new Error(`cwd is not a string ${t}`)}catch(t){if(t instanceof Error&&"Cannot refresh property when process is not set"===t.message)return;throw t}})()}updateConfig(){this._setCommandsToSkipShell(this._configHelper.config.commandsToSkipShell),this._refreshEnvironmentVariableInfoWidgetState(this._processManager.environmentVariableInfo)}_updateUnicodeVersion(){var e=this;return(0,u.Z)(function*(){e._processManager.setUnicodeVersion(e._configHelper.config.unicodeVersion)})()}updateAccessibilitySupport(){this.xterm.raw.options.screenReaderMode=this._accessibilityService.isScreenReaderOptimized()}_setCommandsToSkipShell(e){const t=e.filter(i=>"-"===i[0]).map(i=>i.slice(1));this._skipTerminalCommands=k.Vq.filter(i=>!t.includes(i)).concat(e)}layout(e){if(this._lastLayoutDimensions=e,!(this.disableLayout||e.width<=0||e.height<=0)&&this._evaluateColsAndRows(e.width,e.height)){this._resize(),this._containerReadyBarrier.open();for(const i of this._contributions.values())this.xterm?i.layout?.(this.xterm,e):this._xtermReadyPromise.then(n=>i.layout?.(n,e))}}_resize(){var e=this;return(0,u.Z)(function*(){e._resizeNow(!1)})()}_resizeNow(e){var t=this;return(0,u.Z)(function*(){let i=t.cols,n=t.rows;if(t.xterm){if(t._isVisible&&t._layoutSettingsChanged){const r=t.xterm.getFont(),s=t._configHelper.config;t.xterm.raw.options.letterSpacing=r.letterSpacing,t.xterm.raw.options.lineHeight=r.lineHeight,t.xterm.raw.options.fontSize=r.fontSize,t.xterm.raw.options.fontFamily=r.fontFamily,t.xterm.raw.options.fontWeight=s.fontWeight,t.xterm.raw.options.fontWeightBold=s.fontWeightBold,t._initDimensions(),i=t.cols,n=t.rows,t._layoutSettingsChanged=!1}if(isNaN(i)||isNaN(n))return;(i!==t.xterm.raw.cols||n!==t.xterm.raw.rows)&&((t._fixedRows||t._fixedCols)&&(yield t._updateProperty("fixedDimensions",{cols:t._fixedCols,rows:t._fixedRows})),t._onDimensionsChanged.fire()),t.xterm.raw.resize(i,n),nt._lastKnownGridDimensions={cols:i,rows:n},t._isVisible&&t.xterm.forceUnpause()}e?t._processManager.setDimensions(i,n,!0):yield t._processManager.setDimensions(i,n)})()}setShellType(e){this._shellType=e,e&&this._terminalShellTypeContextKey.set(e?.toString())}_setAriaLabel(e,t,i){const n=[];if(e&&e.textarea){n.push(i&&i.length>0?a.NC("terminalTextBoxAriaLabelNumberAndTitle","Terminal {0}, {1}",t,i):a.NC("terminalTextBoxAriaLabel","Terminal {0}",t)),this._accessibilityService.isScreenReaderOptimized()||n.push(a.NC("terminalScreenReaderMode","Run the command: Toggle Screen Reader Accessibility Mode for an optimized screen reader experience"));const s=this._keybindingService.lookupKeybinding("workbench.action.terminal.showAccessibilityHelp")?.getLabel();this._configurationService.getValue("accessibility.verbosity.terminal")&&s&&n.push(a.NC("terminalHelpAriaLabel","Use {0} for terminal accessibility help",s)),e.textarea.setAttribute("aria-label",n.join("\n"))}}_updateTitleProperties(e,t){if(!e)return this._processName;switch(t){case D.ev.Process:if(1===this._processManager.os)e=he.Ku.parse(e).name;else{const i=e.indexOf(" ");e.startsWith("/")?e=he.EZ(e):i>-1&&(e=e.substring(0,i))}this._processName=e;break;case D.ev.Api:this._staticTitle=e,(0,A.B9)(this._messageTitleDisposable),this._messageTitleDisposable=void 0;break;case D.ev.Sequence:this._sequence=e,1===this._processManager.os&&(e.match(/^[a-zA-Z]:\\.+\.[a-zA-Z]{1,3}/)?(e=he.Ku.parse(e).name,this._sequence=e):this._sequence=void 0)}return this._titleSource=t,e}setOverrideDimensions(e,t=!1){this._dimensionsOverride&&this._dimensionsOverride.forceExactSize&&!e&&0===this._rows&&0===this._cols&&(this._cols=this._dimensionsOverride.cols,this._rows=this._dimensionsOverride.rows),this._dimensionsOverride=e,t?this._resizeNow(!0):this._resize()}setFixedDimensions(){var e=this;return(0,u.Z)(function*(){const t=yield e._quickInputService.input({title:a.NC("setTerminalDimensionsColumn","Set Fixed Dimensions: Column"),placeHolder:"Enter a number of columns or leave empty for automatic width",validateInput:(n=(0,u.Z)(function*(r){return r.length>0&&!r.match(/^\d+$/)?{content:"Enter a number or leave empty size automatically",severity:R.zb.Error}:void 0}),function(s){return n.apply(this,arguments)})});var n;if(void 0===t)return;e._fixedCols=e._parseFixedDimension(t),e._labelComputer?.refreshLabel(),e._terminalHasFixedWidth.set(!!e._fixedCols);const i=yield e._quickInputService.input({title:a.NC("setTerminalDimensionsRow","Set Fixed Dimensions: Row"),placeHolder:"Enter a number of rows or leave empty for automatic height",validateInput:function(){var n=(0,u.Z)(function*(r){return r.length>0&&!r.match(/^\d+$/)?{content:"Enter a number or leave empty size automatically",severity:R.zb.Error}:void 0});return function(s){return n.apply(this,arguments)}}()});void 0!==i&&(e._fixedRows=e._parseFixedDimension(i),e._labelComputer?.refreshLabel(),yield e._refreshScrollbar(),e._resize(),e.focus())})()}_parseFixedDimension(e){if(""===e)return;const t=parseInt(e);if(t<=0)throw new Error(`Could not parse dimension "${e}"`);return t}toggleSizeToContentWidth(){var e=this;return(0,u.Z)(function*(){if(e.xterm?.raw.buffer.active){if(e._hasScrollBar)e._terminalHasFixedWidth.set(!1),e._fixedCols=void 0,e._fixedRows=void 0,e._hasScrollBar=!1,e._initDimensions(),yield e._resize();else{const t=Math.max(e.maxCols,Math.min(e.xterm.getLongestViewportWrappedLineLength(),5e3));t>e.xterm.raw.cols&&(e._fixedCols=t)}yield e._refreshScrollbar(),e._labelComputer?.refreshLabel(),e.focus()}})()}_refreshScrollbar(){return this._fixedCols||this._fixedRows?this._addScrollbar():this._removeScrollbar()}_addScrollbar(){var e=this;return(0,u.Z)(function*(){const t=(e.xterm?e.xterm.getFont():e._configHelper.getFont()).charWidth;if(e.xterm?.raw.element&&e._container&&t&&e._fixedCols&&(e._wrapperElement.classList.add("fixed-dims"),e._hasScrollBar=!0,e._initDimensions(),e._fixedRows=e._rows-1,yield e._resize(),e._terminalHasFixedWidth.set(!0),e._horizontalScrollbar||(e._horizontalScrollbar=e._register(new wa.s$(e._wrapperElement,{vertical:2,horizontal:1,useShadows:!1,scrollYToX:!1,consumeMouseWheelIfScrollbarIsNeeded:!1})),e._container.appendChild(e._horizontalScrollbar.getDomNode())),e._horizontalScrollbar.setScrollDimensions({width:e.xterm.raw.element.clientWidth,scrollWidth:e._fixedCols*t+40}),e._horizontalScrollbar.getDomNode().style.paddingBottom="16px",T.ED))for(let i=e.xterm.raw.buffer.active.viewportY;i<e.xterm.raw.buffer.active.length;i++)e.xterm.raw.buffer.active.getLine(i)._line.isWrapped=!1})()}_removeScrollbar(){var e=this;return(0,u.Z)(function*(){!e._container||!e._horizontalScrollbar||(e._horizontalScrollbar.getDomNode().remove(),e._horizontalScrollbar.dispose(),e._horizontalScrollbar=void 0,e._wrapperElement.remove(),e._wrapperElement.classList.remove("fixed-dims"),e._container.appendChild(e._wrapperElement))})()}_setResolvedShellLaunchConfig(e){this._shellLaunchConfig.args=e.args,this._shellLaunchConfig.cwd=e.cwd,this._shellLaunchConfig.executable=e.executable,this._shellLaunchConfig.env=e.env}_onEnvironmentVariableInfoChanged(e){e.requiresAction&&this.xterm?.raw.textarea?.setAttribute("aria-label",a.NC("terminalStaleTextBoxAriaLabel","Terminal {0} environment is stale, run the 'Show Environment Information' command for more information",this._instanceId)),this._refreshEnvironmentVariableInfoWidgetState(e)}_refreshEnvironmentVariableInfoWidgetState(e){if(!e)return this.statusList.remove("relaunch-needed"),void this.statusList.remove("env-var-info-changes-active");if(e.requiresAction&&this._configHelper.config.environmentChangesRelaunch&&!this._processManager.hasWrittenData&&(!this._shellLaunchConfig.isFeatureTerminal||this.reconnectionProperties&&!0===this._configurationService.getValue("task.reconnection"))&&!this._shellLaunchConfig.customPtyImplementation&&!this._shellLaunchConfig.isExtensionOwnedTerminal&&!this._shellLaunchConfig.attachPersistentProcess)return void this.relaunch();const t=tr(this.shellLaunchConfig.cwd,this._workspaceContextService,this._historyService);this.statusList.add(e.getStatus({workspaceFolder:t}))}toggleEscapeSequenceLogging(){var e=this;return(0,u.Z)(function*(){const t=yield e._xtermReadyPromise;return t.raw.options.logLevel="debug"===t.raw.options.logLevel?"info":"debug","debug"===t.raw.options.logLevel})()}getInitialCwd(){var e=this;return(0,u.Z)(function*(){return e._initialCwd||(e._initialCwd=e._processManager.initialCwd),e._initialCwd})()}getCwd(){var e=this;return(0,u.Z)(function*(){return e.capabilities.has(0)?e.capabilities.get(0).getCwd():e.capabilities.has(1)?e.capabilities.get(1).getCwd():e._processManager.initialCwd})()}_refreshProperty(e){var t=this;return(0,u.Z)(function*(){return yield t.processReady,t._processManager.refreshProperty(e)})()}_updateProperty(e,t){var i=this;return(0,u.Z)(function*(){return i._processManager.updateProperty(e,t)})()}rename(e){var t=this;return(0,u.Z)(function*(){t._setTitle(e,D.ev.Api)})()}_setTitle(e,t){const i=!e,n=(e=this._updateTitleProperties(e,t))!==this._title;this._title=e,this._labelComputer?.refreshLabel(i),this._setAriaLabel(this.xterm?.raw,this._instanceId,this._title),n&&this._onTitleChanged.fire(this)}changeIcon(){var e=this;return(0,u.Z)(function*(){const t=[];for(const n of(0,E.dr)())t.push({label:`$(${n.id})`,description:`${n.id}`,icon:n});const i=yield e._quickInputService.pick(t,{matchOnDescription:!0});i&&(e._icon=i.icon,e._onIconChanged.fire({instance:e,userInitiated:!0}))})()}changeColor(){var e=this;return(0,u.Z)(function*(){if(!e._getIcon())return;const i=e._themeService.getColorTheme(),n=(0,ae.l3)(i),r=(0,ae.m5)(i),s=[];for(const v of n){const b=(0,ae.pv)(v);s.push({label:`$(${E.lA.circleFilled.id}) ${v.replace("terminal.ansi","")}`,id:v,description:v,iconClasses:[b]})}s.push({type:"separator"}),s.push({label:"Reset to default"}),document.body.appendChild(r);const d=e._quickInputService.createQuickPick();d.items=s,d.matchOnDescription=!0,d.show();const h=[],f=yield new Promise(v=>{h.push(d.onDidHide(()=>v(void 0))),h.push(d.onDidAccept(()=>v(d.selectedItems[0])))});(0,A.B9)(h),f&&(e.shellLaunchConfig.color=f.id,e._onIconChanged.fire({instance:e,userInitiated:!0})),d.hide(),document.body.removeChild(r)})()}selectPreviousSuggestion(){this.xterm?.suggestController?.selectPreviousSuggestion()}selectPreviousPageSuggestion(){this.xterm?.suggestController?.selectPreviousPageSuggestion()}selectNextSuggestion(){this.xterm?.suggestController?.selectNextSuggestion()}selectNextPageSuggestion(){this.xterm?.suggestController?.selectNextPageSuggestion()}acceptSelectedSuggestion(e){var t=this;return(0,u.Z)(function*(){t.xterm?.suggestController?.acceptSelectedSuggestion(e)})()}hideSuggestWidget(){this.xterm?.suggestController?.hideSuggestWidget()}forceScrollbarVisibility(){this._wrapperElement.classList.add("force-scrollbar")}resetScrollbarVisibility(){this._wrapperElement.classList.remove("force-scrollbar")}};Te._instanceIdCounter=1,Te.__decorator=(0,c.gn)([(0,ve.Ds)(50)],Te.prototype,"_fireMaximumDimensionsChanged",null),Te.__decorator=(0,c.gn)([(0,ve.Ds)(1e3)],Te.prototype,"relaunch",null),Te.__decorator=(0,c.gn)([(0,ve.Ds)(2e3)],Te.prototype,"_updateProcessCwd",null),Te.__decorator=(0,c.gn)([(0,ve.Ds)(50)],Te.prototype,"_resize",null),Te=(0,c.gn)([(0,c.fM)(5,g.i6),(0,c.fM)(6,G.TG),(0,c.fM)(7,k.if),(0,c.fM)(8,qo.a),(0,c.fM)(9,ri.d),(0,c.fM)(10,R.lT),(0,c.fM)(11,zt.UP),(0,c.fM)(12,Me.qC),(0,c.fM)(13,pn.p),(0,c.fM)(14,me.XE),(0,c.fM)(15,ie.Ui),(0,c.fM)(16,De.VZ),(0,c.fM)(17,Be.Ss),(0,c.fM)(18,He.Uy),(0,c.fM)(19,Ce.F),(0,c.fM)(20,xt.a),(0,c.fM)(21,we.eJ),(0,c.fM)(22,St.n),(0,c.fM)(23,be.ec),(0,c.fM)(24,Se.AR),(0,c.fM)(25,En.N2),(0,c.fM)(26,vi.C),(0,c.fM)(27,je.bU),(0,c.fM)(28,Gt.v4),(0,c.fM)(29,se.H),(0,c.fM)(30,Ki.e7),(0,c.fM)(31,Me.XH)],Te);let Ir=class extends A.JT{get onDropFile(){return this._onDropFile.event}get onDropTerminal(){return this._onDropTerminal.event}constructor(e,t,i){super(),this._container=e,this._layoutService=t,this._viewDescriptorService=i,this._onDropFile=new w.Q5,this._onDropTerminal=new w.Q5,this._register((0,A.OF)(()=>this._clearDropOverlay()))}_clearDropOverlay(){this._dropOverlay&&this._dropOverlay.parentElement&&this._dropOverlay.parentElement.removeChild(this._dropOverlay),this._dropOverlay=void 0}onDragEnter(e){if((0,Re.Mq)(e,Et.go.FILES,Et.go.RESOURCES,"Terminals",Re.Km.FILES)){if(this._dropOverlay||(this._dropOverlay=document.createElement("div"),this._dropOverlay.classList.add("terminal-drop-overlay")),(0,Re.Mq)(e,"Terminals")){const t=this._getDropSide(e);this._dropOverlay.classList.toggle("drop-before","before"===t),this._dropOverlay.classList.toggle("drop-after","after"===t)}this._dropOverlay.parentElement||this._container.appendChild(this._dropOverlay)}}onDragLeave(e){this._clearDropOverlay()}onDragEnd(e){this._clearDropOverlay()}onDragOver(e){if(e.dataTransfer&&this._dropOverlay){if((0,Re.Mq)(e,"Terminals")){const t=this._getDropSide(e);this._dropOverlay.classList.toggle("drop-before","before"===t),this._dropOverlay.classList.toggle("drop-after","after"===t)}this._dropOverlay.style.opacity="1"}}onDrop(e){var t=this;return(0,u.Z)(function*(){if(t._clearDropOverlay(),!e.dataTransfer)return;const i=Lo(e);if(i){for(const l of i){const d=t._getDropSide(e);t._onDropTerminal.fire({uri:l,side:d})}return}let n;const r=e.dataTransfer.getData(Et.go.RESOURCES);r&&(n=N.ov.parse(JSON.parse(r)[0]));const s=e.dataTransfer.getData(Re.Km.FILES);!n&&s&&(n=N.ov.file(JSON.parse(s)[0])),!n&&e.dataTransfer.files.length>0&&e.dataTransfer.files[0].path&&(n=N.ov.file(e.dataTransfer.files[0].path)),n&&t._onDropFile.fire(n)})()}_getDropSide(e){const t=this._container;if(!t)return"after";const i=t.getBoundingClientRect();return 1===this._getViewOrientation()?e.clientX-i.left<i.width/2?"before":"after":e.clientY-i.top<i.height/2?"before":"after"}_getViewOrientation(){const e=this._layoutService.getPanelPosition();return 1===this._viewDescriptorService.getViewLocationById(k.e9)&&2===e?1:0}};Ir=(0,c.gn)([(0,c.fM)(1,Vi.z),(0,c.fM)(2,Me.XH)],Ir);let kr=class extends A.JT{get title(){return this._title}get description(){return this._description}constructor(e,t,i,n){super(),this._configHelper=e,this._instance=t,this._fileService=i,this._workspaceContextService=n,this._title="",this._description="",this._onDidChangeLabel=this._register(new w.Q5),this.onDidChangeLabel=this._onDidChangeLabel.event}refreshLabel(e){this._title=this.computeLabel(this._configHelper.config.tabs.title,"title",e),this._description=this.computeLabel(this._configHelper.config.tabs.description,"description"),(this._title!==this._instance.title||this._description!==this._instance.description||e)&&this._onDidChangeLabel.fire({title:this._title,description:this._description})}computeLabel(e,t,i){const n=this._instance.shellLaunchConfig.attachPersistentProcess?.type||this._instance.shellLaunchConfig.type,r={cwd:this._instance.cwd||this._instance.initialCwd||"",cwdFolder:"",workspaceFolder:this._instance.workspaceFolder?he.EZ(this._instance.workspaceFolder.uri.fsPath):void 0,local:"Local"===n?n:void 0,process:this._instance.processName,sequence:this._instance.sequence,task:"Task"===n?n:void 0,fixedDimensions:this._instance.fixedCols?this._instance.fixedRows?`\u2194${this._instance.fixedCols} \u2195${this._instance.fixedRows}`:`\u2194${this._instance.fixedCols}`:this._instance.fixedRows?`\u2195${this._instance.fixedRows}`:"",separator:{label:this._configHelper.config.tabs.separator}};if(!(e=e.trim()))return"title"===t&&this._instance.processName||"";if(!i&&this._instance.staticTitle&&"title"===t)return this._instance.staticTitle.replace(/[\n\r\t]/g,"")||r.process?.replace(/[\n\r\t]/g,"")||"";const s=this._instance.capabilities.has(0)||this._instance.capabilities.has(1),d=this._workspaceContextService.getWorkspace().folders.length>1;if(r.cwd&&s&&(!this._instance.shellLaunchConfig.isFeatureTerminal||"title"===t)){const f=N.ov.from({scheme:this._instance.workspaceFolder?.uri.scheme||J.lg.file,path:this._instance.cwd?he.DB(this._instance.cwd):void 0});let v=!1;if(d)v=!0;else if(this._instance.workspaceFolder?.uri){const b=this._fileService.hasCapability(this._instance.workspaceFolder.uri,1024);v=0!==f.fsPath.localeCompare(this._instance.workspaceFolder.uri.fsPath,void 0,{sensitivity:b?"case":"base"})}v&&(r.cwdFolder=he.EZ(r.cwd))}const h=(0,Sa.XK)(e,r).replace(/[\n\r\t]/g,"").trim();return""===h&&"title"===t?this._instance.processName||"":h}};kr=(0,c.gn)([(0,c.fM)(2,Ne.sn),(0,c.fM)(3,be.ec)],kr);let Tr=class extends A.JT{get onDidCreateInstance(){return this._onDidCreateInstance.event}constructor(e,t,i){super(),this._instantiationService=e,this._contextKeyService=t,this._environmentService=i,this._backendRegistration=new Map,this._onDidCreateInstance=new w.Q5,this._terminalShellTypeContextKey=m.r.shellType.bindTo(this._contextKeyService),this._terminalInRunCommandPicker=m.r.inTerminalRunCommandPicker.bindTo(this._contextKeyService),this._terminalSuggestWidgetVisibleContextKey=m.r.suggestWidgetVisible.bindTo(this._contextKeyService),this._configHelper=e.createInstance(Oi);for(const n of[void 0,i.remoteAuthority]){let r;const s=new Promise(l=>r=l);this._backendRegistration.set(n,{promise:s,resolve:r})}}createInstance(e,t){const i=this.convertProfileToShellLaunchConfig(e),n=this._instantiationService.createInstance(Te,this._terminalShellTypeContextKey,this._terminalInRunCommandPicker,this._terminalSuggestWidgetVisibleContextKey,this._configHelper,i);return n.target=t,this._onDidCreateInstance.fire(n),n}convertProfileToShellLaunchConfig(e,t){return e&&"profileName"in e?e.path?{executable:e.path,args:e.args,env:e.env,icon:e.icon,color:e.color,name:e.overrideName?e.profileName:void 0,cwd:t}:e:e?(t&&(e.cwd=t),e):{}}getBackend(e){var t=this;return(0,u.Z)(function*(){let i=xe.B.as(k.UU.Backend).getTerminalBackend(e);return i||(yield t._backendRegistration.get(e)?.promise,i=xe.B.as(k.UU.Backend).getTerminalBackend(e)),i})()}didRegisterBackend(e){this._backendRegistration.get(e)?.resolve()}};Tr=(0,c.gn)([(0,c.fM)(0,G.TG),(0,c.fM)(1,g.i6),(0,c.fM)(2,St.n)],Tr);var Dr=p(84776);const rs={type:["string","null"],enum:["terminal.ansiBlack","terminal.ansiRed","terminal.ansiGreen","terminal.ansiYellow","terminal.ansiBlue","terminal.ansiMagenta","terminal.ansiCyan","terminal.ansiWhite"],default:null},os={type:"string",enum:Array.from((0,E.dr)(),o=>o.id),markdownEnumDescriptions:Array.from((0,E.dr)(),o=>`$(${o.id})`)},Nt={args:{description:(0,a.NC)("terminalProfile.args","An optional set of arguments to run the shell executable with."),type:"array",items:{type:"string"}},overrideName:{description:(0,a.NC)("terminalProfile.overrideName","Controls whether or not the profile name overrides the auto detected one."),type:"boolean"},icon:{description:(0,a.NC)("terminalProfile.icon","A codicon ID to associate with the terminal icon."),...os},color:{description:(0,a.NC)("terminalProfile.color","A theme color ID to associate with the terminal icon."),...rs},env:{markdownDescription:(0,a.NC)("terminalProfile.env","An object with environment variables that will be added to the terminal profile process. Set to `null` to delete environment variables from the base environment."),type:"object",additionalProperties:{type:["string","null"]},default:{}}},Ar={type:"object",required:["path"],properties:{path:{description:(0,a.NC)("terminalProfile.path","A single path to a shell executable or an array of paths that will be used as fallbacks when one fails."),type:["string","array"],items:{type:"string"}},...Nt}},Pr={type:"object",required:["path"],properties:{path:{description:(0,a.NC)("terminalAutomationProfile.path","A single path to a shell executable."),type:["string"],items:{type:"string"}},...Nt}};function Er(o){const e=2===o?"linux":1===o?"osx":"windows";return(0,a.NC)({key:"terminal.integrated.profile",comment:["{0} is the platform, {1} is a code block, {2} and {3} are a link start and end"]},"A set of terminal profile customizations for {0} which allows adding, removing or changing how terminals are launched. Profiles are made up of a mandatory path, optional arguments and other presentation options.\n\nTo override an existing profile use its profile name as the key, for example:\n\n{1}\n\n{2}Read more about configuring profiles{3}.",(0,T.PW)(o),'```json\n"terminal.integrated.profile.'+e+'": {\n  "bash": null\n}\n```',"[","](https://code.visualstudio.com/docs/terminal/profiles)")}const ss=(0,a.NC)("terminal.integrated.shell.linux.deprecation","This is deprecated, the new recommended way to configure your default shell is by creating a terminal profile in {0} and setting its profile name as the default in {1}. This will currently take priority over the new profiles settings but that will change in the future.","`#terminal.integrated.profiles.linux#`","`#terminal.integrated.defaultProfile.linux#`"),as=(0,a.NC)("terminal.integrated.shell.osx.deprecation","This is deprecated, the new recommended way to configure your default shell is by creating a terminal profile in {0} and setting its profile name as the default in {1}. This will currently take priority over the new profiles settings but that will change in the future.","`#terminal.integrated.profiles.osx#`","`#terminal.integrated.defaultProfile.osx#`"),ls=(0,a.NC)("terminal.integrated.shell.windows.deprecation","This is deprecated, the new recommended way to configure your default shell is by creating a terminal profile in {0} and setting its profile name as the default in {1}. This will currently take priority over the new profiles settings but that will change in the future.","`#terminal.integrated.profiles.windows#`","`#terminal.integrated.defaultProfile.windows#`"),ul=(0,a.NC)("terminal.integrated.automationShell.linux.deprecation","This is deprecated, the new recommended way to configure your automation shell is by creating a terminal automation profile with {0}. This will currently take priority over the new automation profile settings but that will change in the future.","`#terminal.integrated.automationProfile.linux#`"),ml=(0,a.NC)("terminal.integrated.automationShell.osx.deprecation","This is deprecated, the new recommended way to configure your automation shell is by creating a terminal automation profile with {0}. This will currently take priority over the new automation profile settings but that will change in the future.","`#terminal.integrated.automationProfile.osx#`"),fl=(0,a.NC)("terminal.integrated.automationShell.windows.deprecation","This is deprecated, the new recommended way to configure your automation shell is by creating a terminal automation profile with {0}. This will currently take priority over the new automation profile settings but that will change in the future.","`#terminal.integrated.automationProfile.windows#`"),gl={id:"terminal",order:100,title:(0,a.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.automationShell.linux":{restricted:!0,markdownDescription:(0,a.NC)({key:"terminal.integrated.automationShell.linux",comment:["{0} and {1} are the `shell` and `shellArgs` settings keys"]},"A path that when set will override {0} and ignore {1} values for automation-related terminal usage like tasks and debug.","`terminal.integrated.shell.linux`","`shellArgs`"),type:["string","null"],default:null,markdownDeprecationMessage:ul},"terminal.integrated.automationShell.osx":{restricted:!0,markdownDescription:(0,a.NC)({key:"terminal.integrated.automationShell.osx",comment:["{0} and {1} are the `shell` and `shellArgs` settings keys"]},"A path that when set will override {0} and ignore {1} values for automation-related terminal usage like tasks and debug.","`terminal.integrated.shell.osx`","`shellArgs`"),type:["string","null"],default:null,markdownDeprecationMessage:ml},"terminal.integrated.automationShell.windows":{restricted:!0,markdownDescription:(0,a.NC)({key:"terminal.integrated.automationShell.windows",comment:["{0} and {1} are the `shell` and `shellArgs` settings keys"]},"A path that when set will override {0} and ignore {1} values for automation-related terminal usage like tasks and debug.","`terminal.integrated.shell.windows`","`shellArgs`"),type:["string","null"],default:null,markdownDeprecationMessage:fl},"terminal.integrated.automationProfile.linux":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.automationProfile.linux","The terminal profile to use on Linux for automation-related terminal usage like tasks and debug. This setting will currently be ignored if {0} (now deprecated) is set.","`terminal.integrated.automationShell.linux`"),type:["object","null"],default:null,anyOf:[{type:"null"},Pr],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.automationProfile.osx":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.automationProfile.osx","The terminal profile to use on macOS for automation-related terminal usage like tasks and debug. This setting will currently be ignored if {0} (now deprecated) is set.","`terminal.integrated.automationShell.osx`"),type:["object","null"],default:null,anyOf:[{type:"null"},Pr],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.automationProfile.windows":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.automationProfile.windows","The terminal profile to use for automation-related terminal usage like tasks and debug. This setting will currently be ignored if {0} (now deprecated) is set.","`terminal.integrated.automationShell.windows`"),type:["object","null"],default:null,anyOf:[{type:"null"},Pr],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.shell.linux":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shell.linux","The path of the shell that the terminal uses on Linux. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),type:["string","null"],default:null,markdownDeprecationMessage:ss},"terminal.integrated.shell.osx":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shell.osx","The path of the shell that the terminal uses on macOS. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),type:["string","null"],default:null,markdownDeprecationMessage:as},"terminal.integrated.shell.windows":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shell.windows","The path of the shell that the terminal uses on Windows. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),type:["string","null"],default:null,markdownDeprecationMessage:ls},"terminal.integrated.shellArgs.linux":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellArgs.linux","The command line arguments to use when on the Linux terminal. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),type:"array",items:{type:"string"},default:[],markdownDeprecationMessage:ss},"terminal.integrated.shellArgs.osx":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellArgs.osx","The command line arguments to use when on the macOS terminal. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),type:"array",items:{type:"string"},default:["-l"],markdownDeprecationMessage:as},"terminal.integrated.shellArgs.windows":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellArgs.windows","The command line arguments to use when on the Windows terminal. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles)."),anyOf:[{type:"array",items:{type:"string",markdownDescription:(0,a.NC)("terminal.integrated.shellArgs.windows","The command line arguments to use when on the Windows terminal. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles).")}},{type:"string",markdownDescription:(0,a.NC)("terminal.integrated.shellArgs.windows.string","The command line arguments in [command-line format](https://msdn.microsoft.com/en-au/08dfcab2-eb6e-49a4-80eb-87d4076c98c6) to use when on the Windows terminal. [Read more about configuring the shell](https://code.visualstudio.com/docs/editor/integrated-terminal#_terminal-profiles).")}],default:[],markdownDeprecationMessage:ls},"terminal.integrated.profiles.windows":{restricted:!0,markdownDescription:Er(3),type:"object",default:{PowerShell:{source:"PowerShell",icon:"terminal-powershell"},"Command Prompt":{path:["${env:windir}\\Sysnative\\cmd.exe","${env:windir}\\System32\\cmd.exe"],args:[],icon:"terminal-cmd"},"Git Bash":{source:"Git Bash"}},additionalProperties:{anyOf:[{type:"object",required:["source"],properties:{source:{description:(0,a.NC)("terminalProfile.windowsSource","A profile source that will auto detect the paths to the shell. Note that non-standard executable locations are not supported and must be created manually in a new profile."),enum:["PowerShell","Git Bash"]},...Nt}},{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,a.NC)("terminalProfile.windowsExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,a.NC)("terminalProfile.windowsExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,a.NC)("terminalProfile.windowsExtensionTitle","The name of the extension terminal"),type:"string"},...Nt}},{type:"null"},Ar]}},"terminal.integrated.profiles.osx":{restricted:!0,markdownDescription:Er(1),type:"object",default:{bash:{path:"bash",args:["-l"],icon:"terminal-bash"},zsh:{path:"zsh",args:["-l"]},fish:{path:"fish",args:["-l"]},tmux:{path:"tmux",icon:"terminal-tmux"},pwsh:{path:"pwsh",icon:"terminal-powershell"}},additionalProperties:{anyOf:[{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,a.NC)("terminalProfile.osxExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,a.NC)("terminalProfile.osxExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,a.NC)("terminalProfile.osxExtensionTitle","The name of the extension terminal"),type:"string"},...Nt}},{type:"null"},Ar]}},"terminal.integrated.profiles.linux":{restricted:!0,markdownDescription:Er(2),type:"object",default:{bash:{path:"bash",icon:"terminal-bash"},zsh:{path:"zsh"},fish:{path:"fish"},tmux:{path:"tmux",icon:"terminal-tmux"},pwsh:{path:"pwsh",icon:"terminal-powershell"}},additionalProperties:{anyOf:[{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,a.NC)("terminalProfile.linuxExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,a.NC)("terminalProfile.linuxExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,a.NC)("terminalProfile.linuxExtensionTitle","The name of the extension terminal"),type:"string"},...Nt}},{type:"null"},Ar]}},"terminal.integrated.useWslProfiles":{description:(0,a.NC)("terminal.integrated.useWslProfiles","Controls whether or not WSL distros are shown in the terminal dropdown"),type:"boolean",default:!0},"terminal.integrated.inheritEnv":{scope:1,description:(0,a.NC)("terminal.integrated.inheritEnv","Whether new shells should inherit their environment from VS Code, which may source a login shell to ensure $PATH and other development variables are initialized. This has no effect on Windows."),type:"boolean",default:!0},"terminal.integrated.persistentSessionScrollback":{scope:1,markdownDescription:(0,a.NC)("terminal.integrated.persistentSessionScrollback","Controls the maximum amount of lines that will be restored when reconnecting to a persistent terminal session. Increasing this will restore more lines of scrollback at the cost of more memory and increase the time it takes to connect to terminals on start up. This setting requires a restart to take effect and should be set to a value less than or equal to `#terminal.integrated.scrollback#`."),type:"number",default:100},"terminal.integrated.showLinkHover":{scope:1,description:(0,a.NC)("terminal.integrated.showLinkHover","Whether to show hovers for links in the terminal output."),type:"boolean",default:!0},"terminal.integrated.ignoreProcessNames":{description:(0,a.NC)("terminal.integrated.confirmIgnoreProcesses","A set of process names to ignore when using the {0} setting.","`terminal.integrated.confirmOnKill`"),type:"array",items:{type:"string",uniqueItems:!0},default:["starship","oh-my-posh","bash","zsh"]}}};let Mr;function cs(o,e){const t=xe.B.as(Dr.IP.Configuration);let i;o&&(i=vo(o?.profiles,e));const n=Mr;Mr={id:"terminal",order:100,title:(0,a.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.defaultProfile.linux":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.defaultProfile.linux","The default profile used on Linux. This setting will currently be ignored if either {0} or {1} are set.","`terminal.integrated.shell.linux`","`terminal.integrated.shellArgs.linux`"),type:["string","null"],default:null,enum:3===o?.os?i?.values:void 0,markdownEnumDescriptions:3===o?.os?i?.markdownDescriptions:void 0},"terminal.integrated.defaultProfile.osx":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.defaultProfile.osx","The default profile used on macOS. This setting will currently be ignored if either {0} or {1} are set.","`terminal.integrated.shell.osx`","`terminal.integrated.shellArgs.osx`"),type:["string","null"],default:null,enum:2===o?.os?i?.values:void 0,markdownEnumDescriptions:2===o?.os?i?.markdownDescriptions:void 0},"terminal.integrated.defaultProfile.windows":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.defaultProfile.windows","The default profile used on Windows. This setting will currently be ignored if either {0} or {1} are set.","`terminal.integrated.shell.windows`","`terminal.integrated.shellArgs.windows`"),type:["string","null"],default:null,enum:1===o?.os?i?.values:void 0,markdownEnumDescriptions:1===o?.os?i?.markdownDescriptions:void 0}}},t.updateConfigurations({add:[Mr],remove:n?[n]:[]})}var Nr=p(90655);let ci=class{get onDidChangeAvailableProfiles(){return this._onDidChangeAvailableProfiles.event}get profilesReady(){return this._profilesReadyBarrier.wait().then(()=>{})}get availableProfiles(){return this._platformConfigJustRefreshed||this.refreshAvailableProfiles(),this._availableProfiles||[]}get contributedProfiles(){return this._contributedProfiles||[]}constructor(e,t,i,n,r,s,l){this._contextKeyService=e,this._configurationService=t,this._terminalContributionService=i,this._extensionService=n,this._remoteAgentService=r,this._environmentService=s,this._terminalInstanceService=l,this._contributedProfiles=[],this._platformConfigJustRefreshed=!1,this._profileProviders=new Map,this._onDidChangeAvailableProfiles=new w.Q5,this._extensionService.onDidChangeExtensions(()=>this.refreshAvailableProfiles()),this._webExtensionContributedProfileContextKey=m.r.webExtensionContributedProfile.bindTo(this._contextKeyService),this._updateWebContextKey(),this._profilesReadyBarrier=new ne.Ug(2e4),this.refreshAvailableProfiles(),this._setupConfigListener()}_setupConfigListener(){var e=this;return(0,u.Z)(function*(){const t=yield e.getPlatformKey();e._configurationService.onDidChangeConfiguration(function(){var i=(0,u.Z)(function*(n){(n.affectsConfiguration("terminal.integrated.defaultProfile."+t)||n.affectsConfiguration("terminal.integrated.profiles."+t)||n.affectsConfiguration("terminal.integrated.useWslProfiles"))&&(7!==n.source?(e.refreshAvailableProfiles(),e._platformConfigJustRefreshed=!1):e._platformConfigJustRefreshed=!0)});return function(n){return i.apply(this,arguments)}}())})()}getDefaultProfileName(){return this._defaultProfileName}getDefaultProfile(e){let t;if(e){if(t=this._configurationService.getValue(`terminal.integrated.defaultProfile.${this._getOsKey(e)}`),!t||"string"!=typeof t)return}else t=this._defaultProfileName;if(t)return this.availableProfiles.find(i=>i.profileName===t&&!i.isAutoDetected)}_getOsKey(e){switch(e){case 3:return"linux";case 2:return"osx";case 1:return"windows"}}refreshAvailableProfiles(){this._refreshAvailableProfilesNow()}_refreshAvailableProfilesNow(){var e=this;return(0,u.Z)(function*(){const t=yield e._detectProfiles(!0),i=!(0,Mt.fS)(t,e._availableProfiles,vl),n=yield e._updateContributedProfiles();(i||n)&&(e._availableProfiles=t,e._onDidChangeAvailableProfiles.fire(e._availableProfiles),e._profilesReadyBarrier.open(),e._updateWebContextKey(),yield e._refreshPlatformConfig(e._availableProfiles))})()}_updateContributedProfiles(){var e=this;return(0,u.Z)(function*(){const t=yield e.getPlatformKey(),i=[],n=e._configurationService.getValue("terminal.integrated.profiles."+t);for(const[l,d]of Object.entries(n))null===d&&i.push(l);const r=Array.from(e._terminalContributionService.terminalProfiles.filter(l=>!i.includes(l.title))),s=!(0,Mt.fS)(r,e._contributedProfiles,_l);return e._contributedProfiles=r,s})()}getContributedProfileProvider(e,t){return this._profileProviders.get(e)?.get(t)}_detectProfiles(e){var t=this;return(0,u.Z)(function*(){const i=yield t._terminalInstanceService.getBackend(t._environmentService.remoteAuthority);if(!i)return t._availableProfiles||[];const n=yield t.getPlatformKey();return t._defaultProfileName=t._configurationService.getValue(`terminal.integrated.defaultProfile.${n}`)??void 0,i.getProfiles(t._configurationService.getValue(`terminal.integrated.profiles.${n}`),t._defaultProfileName,e)})()}_updateWebContextKey(){this._webExtensionContributedProfileContextKey.set(T.$L&&this._contributedProfiles.length>0)}_refreshPlatformConfig(e){var t=this;return(0,u.Z)(function*(){const i=yield t._remoteAgentService.getEnvironment();cs({os:i?.os||T.OS,profiles:e},t._contributedProfiles),To(e)})()}getPlatformKey(){var e=this;return(0,u.Z)(function*(){const t=yield e._remoteAgentService.getEnvironment();return t?1===t.os?"windows":2===t.os?"osx":"linux":T.ED?"windows":T.dz?"osx":"linux"})()}registerTerminalProfileProvider(e,t,i){let n=this._profileProviders.get(e);return n||(n=new Map,this._profileProviders.set(e,n)),n.set(t,i),(0,A.OF)(()=>this._profileProviders.delete(t))}registerContributedProfile(e){var t=this;return(0,u.Z)(function*(){const i=yield t.getPlatformKey(),n=yield t._configurationService.getValue(`terminal.integrated.profiles.${i}`);"object"==typeof n&&(n[e.title]={extensionIdentifier:e.extensionIdentifier,icon:e.options.icon,id:e.id,title:e.title,color:e.options.color}),yield t._configurationService.updateValue(`terminal.integrated.profiles.${i}`,n,2)})()}getContributedDefaultProfile(e){var t=this;return(0,u.Z)(function*(){if(e&&!e.extHostTerminalId&&!("executable"in e)){const i=yield t.getPlatformKey(),n=t._configurationService.getValue(`terminal.integrated.defaultProfile.${i}`);return t.contributedProfiles.find(s=>s.title===n)}})()}};function vl(o,e){return o.profileName===e.profileName&&_o(o.args,e.args)&&o.color===e.color&&function Zs(o,e){if(!o&&!e)return!0;if(!o||!e)return!1;if(H.kS.isThemeIcon(o)&&H.kS.isThemeIcon(e))return o.id===e.id&&o.color===e.color;if("object"==typeof o&&"light"in o&&"dark"in o&&"object"==typeof e&&"light"in e&&"dark"in e){const t=o,i=e;if((N.ov.isUri(t.light)||Fe(t.light))&&(N.ov.isUri(t.dark)||Fe(t.dark))&&(N.ov.isUri(i.light)||Fe(i.light))&&(N.ov.isUri(i.dark)||Fe(i.dark)))return t.light.path===i.light.path&&t.dark.path===i.dark.path}return!!(N.ov.isUri(o)&&N.ov.isUri(e)||Fe(o)||Fe(e))&&(o.path===e.path&&o.scheme===e.scheme)}(o.icon,e.icon)&&o.isAutoDetected===e.isAutoDetected&&o.isDefault===e.isDefault&&o.overrideName===e.overrideName&&o.path===e.path}function _l(o,e){return o.extensionIdentifier===e.extensionIdentifier&&o.color===e.color&&o.icon===e.icon&&o.id===e.id&&o.title===e.title}ci.__decorator=(0,c.gn)([(0,ve.P2)(2e3)],ci.prototype,"refreshAvailableProfiles",null),ci=(0,c.gn)([(0,c.fM)(0,g.i6),(0,c.fM)(1,ie.Ui),(0,c.fM)(2,Nr.e),(0,c.fM)(3,re.QS),(0,c.fM)(4,Oe.R),(0,c.fM)(5,St.n),(0,c.fM)(6,M.N4)],ci);var bl=p(5041);class wl{constructor(){this._linkProviders=new Set,this._onDidAddLinkProvider=new w.Q5,this._onDidRemoveLinkProvider=new w.Q5}get linkProviders(){return this._linkProviders}get onDidAddLinkProvider(){return this._onDidAddLinkProvider.event}get onDidRemoveLinkProvider(){return this._onDidRemoveLinkProvider.event}registerLinkProvider(e){const t=[];return this._linkProviders.add(e),this._onDidAddLinkProvider.fire(e),{dispose:()=>{for(const i of t)i.dispose();this._linkProviders.delete(e),this._onDidRemoveLinkProvider.fire(e)}}}}var ds=p(94927);const Xi="Generated";let hs=!1;class Lr{get defaultProfileName(){return this._defaultProfileName}constructor(e,t,i,n,r,s,l,d,h,f){this._context=e,this._configurationService=t,this._configurationResolverService=i,this._historyService=n,this._logService=r,this._terminalProfileService=s,this._workspaceContextService=l,this._remoteAgentService=d,this._storageService=h,this._notificationService=f,this._iconRegistry=(0,ge.Ks)(),this._remoteAgentService.getConnection()?this._remoteAgentService.getEnvironment().then(v=>this._primaryBackendOs=v?.os||T.OS):this._primaryBackendOs=T.OS,this._configurationService.onDidChangeConfiguration(v=>{(v.affectsConfiguration("terminal.integrated.defaultProfile.windows")||v.affectsConfiguration("terminal.integrated.defaultProfile.osx")||v.affectsConfiguration("terminal.integrated.defaultProfile.linux"))&&this._refreshDefaultProfileName()}),this._terminalProfileService.onDidChangeAvailableProfiles(()=>this._refreshDefaultProfileName()),this.showProfileMigrationNotification()}_refreshDefaultProfileName(){var e=this;return(0,u.Z)(function*(){e._primaryBackendOs&&(e._defaultProfileName=(yield e.getDefaultProfile({remoteAuthority:e._remoteAgentService.getConnection()?.remoteAuthority,os:e._primaryBackendOs}))?.profileName)})()}resolveIcon(e,t){if(e.icon)return void(e.icon=this._getCustomIcon(e.icon)||this.getDefaultIcon());if(e.customPtyImplementation)return void(e.icon=this.getDefaultIcon());if(e.executable)return;const i=this._getUnresolvedRealDefaultProfile(t);i&&(e.icon=i.icon),e.icon||(e.icon=this.getDefaultIcon())}getDefaultIcon(e){return this._iconRegistry.getIcon(this._configurationService.getValue("terminal.integrated.tabs.defaultIcon",{resource:e}))||E.lA.terminal}resolveShellLaunchConfig(e,t){var i=this;return(0,u.Z)(function*(){let n;n=e.executable?yield i._resolveProfile({path:e.executable,args:e.args,profileName:Xi,isDefault:!1},t):yield i.getDefaultProfile(t),e.executable=n.path,e.args=n.args,n.env&&(e.env=e.env?{...e.env,...n.env}:n.env);const r=void 0===e||"string"==typeof e.cwd?void 0:e.cwd;e.icon=i._getCustomIcon(e.icon)||i._getCustomIcon(n.icon)||i.getDefaultIcon(r),n.overrideName&&(e.name=n.profileName),e.color=e.color||n.color||i._configurationService.getValue("terminal.integrated.tabs.defaultColor",{resource:r}),void 0===e.useShellEnvironment&&(e.useShellEnvironment=i._configurationService.getValue("terminal.integrated.inheritEnv"))})()}getDefaultShell(e){var t=this;return(0,u.Z)(function*(){return(yield t.getDefaultProfile(e)).path})()}getDefaultShellArgs(e){var t=this;return(0,u.Z)(function*(){return(yield t.getDefaultProfile(e)).args||[]})()}getDefaultProfile(e){var t=this;return(0,u.Z)(function*(){return t._resolveProfile(yield t._getUnresolvedDefaultProfile(e),e)})()}getEnvironment(e){return this._context.getEnvironment(e)}_getCustomIcon(e){if(e){if("string"==typeof e)return H.kS.fromId(e);if(H.kS.isThemeIcon(e))return e;if(N.ov.isUri(e)||Fe(e))return N.ov.revive(e);if("object"==typeof e&&"light"in e&&"dark"in e){const t=e;if((N.ov.isUri(t.light)||Fe(t.light))&&(N.ov.isUri(t.dark)||Fe(t.dark)))return{light:N.ov.revive(t.light),dark:N.ov.revive(t.dark)}}}}_getUnresolvedDefaultProfile(e){var t=this;return(0,u.Z)(function*(){if(e.allowAutomationShell){const r=t._getUnresolvedAutomationShellProfile(e);if(r)return r}const i=yield t._getUnresolvedShellSettingDefaultProfile(e);if(i)return t._setIconForAutomation(e,i);yield t._terminalProfileService.profilesReady;const n=t._getUnresolvedRealDefaultProfile(e.os);return t._setIconForAutomation(e,n||(yield t._getUnresolvedFallbackDefaultProfile(e)))})()}_setIconForAutomation(e,t){if(e.allowAutomationShell){const i=(0,ds.I8)(t);return i.icon=E.lA.tools,i}return t}_getUnresolvedRealDefaultProfile(e){return this._terminalProfileService.getDefaultProfile(e)}_getUnresolvedShellSettingDefaultProfile(e){var t=this;return(0,u.Z)(function*(){let n,i=t._configurationService.getValue(`terminal.integrated.shell.${t._getOsKey(e.os)}`);if(!t._isValidShell(i)){const l=t._configurationService.inspect(`terminal.integrated.shellArgs.${t._getOsKey(e.os)}`);if(!l.userValue&&!l.workspaceValue)return}(!i||!t._isValidShell(i))&&(i=yield t._context.getDefaultSystemShell(e.remoteAuthority,e.os));const r=t._configurationService.getValue(`terminal.integrated.shellArgs.${t._getOsKey(e.os)}`);t._isValidShellArgs(r,e.os)&&(n=r),void 0===n&&(n=2===e.os&&void 0===n&&he.Qc(i).name.match(/(zsh|bash|fish)/)?["--login"]:[]);const s=t._guessProfileIcon(i);return{profileName:Xi,path:i,args:n,icon:s,isDefault:!1}})()}_getUnresolvedFallbackDefaultProfile(e){var t=this;return(0,u.Z)(function*(){const i=yield t._context.getDefaultSystemShell(e.remoteAuthority,e.os);if(e.os===T.OS){let s=t._terminalProfileService.availableProfiles.find(l=>he.Qc(l.path).name===he.Qc(i).name);if(s)return e.allowAutomationShell&&(s=(0,ds.I8)(s),s.icon=E.lA.tools),s}let n;n=2===e.os&&he.Qc(i).name.match(/(zsh|bash)/)?["--login"]:[];const r=t._guessProfileIcon(i);return{profileName:Xi,path:i,args:n,icon:r,isDefault:!1}})()}_getUnresolvedAutomationShellProfile(e){const t=this._configurationService.getValue(`terminal.integrated.automationShell.${this._getOsKey(e.os)}`);if(t&&"string"==typeof t)return{path:t,profileName:Xi,isDefault:!1,icon:E.lA.tools};const i=this._configurationService.getValue(`terminal.integrated.automationProfile.${this._getOsKey(e.os)}`);return this._isValidAutomationProfile(i,e.os)?(i.icon=this._getCustomIcon(i.icon)||E.lA.tools,i):void 0}_resolveProfile(e,t){var i=this;return(0,u.Z)(function*(){if(1===t.os){const l=yield i._context.getEnvironment(t.remoteAuthority),d=!!l.hasOwnProperty("PROCESSOR_ARCHITEW6432"),h=l.windir;if(!d&&h){const f=he.v_(h,"Sysnative").replace(/\//g,"\\").toLowerCase();e.path&&0===e.path.toLowerCase().indexOf(f)&&(e.path=he.v_(h,"System32",e.path.substr(f.length+1)))}e.path&&(e.path=e.path.replace(/\//g,"\\"))}const n=yield i._context.getEnvironment(t.remoteAuthority),r=i._historyService.getLastActiveWorkspaceRoot(t.remoteAuthority?J.lg.vscodeRemote:J.lg.file),s=r?(0,de.f6)(i._workspaceContextService.getWorkspaceFolder(r)):void 0;return e.path=yield i._resolveVariables(e.path,n,s),e.args&&(e.args="string"==typeof e.args?yield i._resolveVariables(e.args,n,s):yield Promise.all(e.args.map(l=>i._resolveVariables(l,n,s)))),e})()}_resolveVariables(e,t,i){var n=this;return(0,u.Z)(function*(){try{e=yield n._configurationResolverService.resolveWithEnvironment(t,i,e)}catch(r){n._logService.error("Could not resolve shell",r)}return e})()}_getOsKey(e){switch(e){case 3:return"linux";case 2:return"osx";case 1:return"windows"}}_guessProfileIcon(e){switch(he.Qc(e).name){case"bash":return E.lA.terminalBash;case"pwsh":case"powershell":return E.lA.terminalPowershell;case"tmux":return E.lA.terminalTmux;case"cmd":return E.lA.terminalCmd;default:return}}_isValidShell(e){return!!e&&"string"==typeof e}_isValidShellArgs(e,t){return!!(void 0===e||1===t&&"string"==typeof e||Array.isArray(e)&&e.every(i=>"string"==typeof i))}createProfileFromShellAndShellArgs(e,t){var i=this;return(0,u.Z)(function*(){const n=i._terminalProfileService.availableProfiles?.find(h=>h.path===e&&(void 0===h.args||"string"==typeof h.args?h.args===t:h.path===e&&(0,Mt.fS)(h.args,t||[]))),r=yield i.getDefaultProfile({remoteAuthority:i._remoteAgentService.getConnection()?.remoteAuthority,os:i._primaryBackendOs});r.profileName=`${r.path} (migrated)`;const s=n||r,l=i._isValidShellArgs(t,i._primaryBackendOs)?t:s.args,d={profileName:s.profileName,path:s.path,args:l,isDefault:!0};return n&&n.profileName===d.profileName&&n.path===d.path&&_o(n.args,d.args)?n.profileName:d})()}_isValidAutomationProfile(e,t){return null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path}showProfileMigrationNotification(){var e=this;return(0,u.Z)(function*(){var i;(e._configurationService.getValue("terminal.integrated.shell."+e._primaryBackendOs)||e._configurationService.inspect("terminal.integrated.shellArgs."+e._primaryBackendOs).userValue)&&e._configurationService.getValue("terminal.integrated.defaultProfile."+e._primaryBackendOs)&&e._storageService.getBoolean("terminals.integrated.profile-migration",1,!0)&&!hs&&(e._notificationService.prompt(Pe.Z.Info,(0,a.NC)("terminalProfileMigration","The terminal is using deprecated shell/shellArgs settings, do you want to migrate it to a profile?"),[{label:(0,a.NC)("migrateToProfile","Migrate"),run:(i=(0,u.Z)(function*(){const n=e._configurationService.getValue("terminal.integrated.shell."+e._primaryBackendOs),r=e._configurationService.getValue("terminal.integrated.shellArgs."+e._primaryBackendOs),s=yield e.createProfileFromShellAndShellArgs(n,r);if("string"==typeof s)yield e._configurationService.updateValue("terminal.integrated.defaultProfile."+e._primaryBackendOs,s),e._logService.trace(`migrated from shell/shellArgs, using existing profile ${s}`);else{const l={...e._configurationService.inspect("terminal.integrated.profiles."+e._primaryBackendOs).userValue},d={path:s.path};s.args&&(d.args=s.args),l[s.profileName]=d,yield e._configurationService.updateValue("terminal.integrated.profiles."+e._primaryBackendOs,l),yield e._configurationService.updateValue("terminal.integrated.defaultProfile."+e._primaryBackendOs,s.profileName),e._logService.trace(`migrated from shell/shellArgs, ${n} ${r} to profile ${JSON.stringify(s)}`)}yield e._configurationService.updateValue("terminal.integrated.shell."+e._primaryBackendOs,void 0),yield e._configurationService.updateValue("terminal.integrated.shellArgs."+e._primaryBackendOs,void 0)}),function(){return i.apply(this,arguments)})}],{neverShowAgain:{id:"terminals.integrated.profile-migration",scope:R.YB.WORKSPACE}}),hs=!0)})()}}Lr.__decorator=(0,c.gn)([(0,ve.Ds)(200)],Lr.prototype,"_refreshDefaultProfileName",null);let Rr=class extends Lr{constructor(e,t,i,n,r,s,l,d,h,f){var v;super({getDefaultSystemShell:(v=(0,u.Z)(function*(b,_){const C=yield f.getBackend(b);if(!C)throw new Qe.QD(`Cannot get default system shell when there is no backend for remote authority '${b}'`);return C.getDefaultSystemShell(_)}),function(_,C){return v.apply(this,arguments)}),getEnvironment:function(){var v=(0,u.Z)(function*(b){const _=yield f.getBackend(b);if(!_)throw new Qe.QD(`Cannot get environment when there is no backend for remote authority '${b}'`);return _.getEnvironment()});return function(_){return v.apply(this,arguments)}}()},t,e,i,n,s,r,l,d,h)}};Rr=(0,c.gn)([(0,c.fM)(0,pi.qb),(0,c.fM)(1,ie.Ui),(0,c.fM)(2,vi.C),(0,c.fM)(3,De.VZ),(0,c.fM)(4,be.ec),(0,c.fM)(5,k.l5),(0,c.fM)(6,Oe.R),(0,c.fM)(7,He.Uy),(0,c.fM)(8,R.lT),(0,c.fM)(9,M.N4)],Rr);let gt=class{get onDidChangeCollections(){return this._onDidChangeCollections.event}constructor(e,t){this._extensionService=e,this._storageService=t,this.collections=new Map,this._onDidChangeCollections=new w.Q5,this._storageService.remove("terminal.integrated.environmentVariableCollections",1);const i=this._storageService.get("terminal.integrated.environmentVariableCollectionsV2",1);i&&(JSON.parse(i).forEach(r=>this.collections.set(r.extensionIdentifier,{persistent:!0,map:(0,ft.XC)(r.collection),descriptionMap:(0,ft.w)(r.description)})),this._invalidateExtensionCollections()),this.mergedCollection=this._resolveMergedCollection(),this._extensionService.onDidChangeExtensions(()=>this._invalidateExtensionCollections())}set(e,t){this.collections.set(e,t),this._updateCollections()}delete(e){this.collections.delete(e),this._updateCollections()}_updateCollections(){this._persistCollectionsEventually(),this.mergedCollection=this._resolveMergedCollection(),this._notifyCollectionUpdatesEventually()}_persistCollectionsEventually(){this._persistCollections()}_persistCollections(){const e=[];this.collections.forEach((i,n)=>{i.persistent&&e.push({extensionIdentifier:n,collection:(0,ft.Fi)(this.collections.get(n).map),description:(0,ft.hd)(i.descriptionMap)})});const t=JSON.stringify(e);this._storageService.store("terminal.integrated.environmentVariableCollectionsV2",t,1,1)}_notifyCollectionUpdatesEventually(){this._notifyCollectionUpdates()}_notifyCollectionUpdates(){this._onDidChangeCollections.fire(this.mergedCollection)}_resolveMergedCollection(){return new Vo(this.collections)}_invalidateExtensionCollections(){var e=this;return(0,u.Z)(function*(){yield e._extensionService.whenInstalledExtensionsRegistered();const t=e._extensionService.extensions;let i=!1;e.collections.forEach((n,r)=>{t.some(l=>l.identifier.value===r)||(e.collections.delete(r),i=!0)}),i&&e._updateCollections()})()}};gt.__decorator=(0,c.gn)([(0,ve.P2)(1e3)],gt.prototype,"_persistCollectionsEventually",null),gt.__decorator=(0,c.gn)([(0,ve.Ds)(1e3)],gt.prototype,"_notifyCollectionUpdatesEventually",null),gt=(0,c.gn)([(0,c.fM)(0,re.QS),(0,c.fM)(1,He.Uy)],gt);var Sl=p(71287),Cl=p(8155);class yl{get providers(){return this._providers}constructor(){this._selectors=new Map,this._providers=new Map,this._onDidRegisterProvider=new w.Q5,this.onDidRegisterProvider=this._onDidRegisterProvider.event,this._onDidRegisterCommandSelector=new w.Q5,this.onDidRegisterCommandSelector=this._onDidRegisterCommandSelector.event,this._onDidUnregisterProvider=new w.Q5,this.onDidUnregisterProvider=this._onDidUnregisterProvider.event,this.extensionQuickFixes=new Promise(e=>xl.setHandler(t=>{e(t.filter(i=>(0,re.$x)(i.description,"terminalQuickFixProvider")).map(i=>i.value?i.value.map(n=>({...n,extensionIdentifier:i.description.identifier.value})):[]).flat())})),this.extensionQuickFixes.then(e=>{for(const t of e)this.registerCommandSelector(t)})}registerCommandSelector(e){this._selectors.set(e.id,e),this._onDidRegisterCommandSelector.fire(e)}registerQuickFixProvider(e,t){let i=!1;return this.extensionQuickFixes.then(()=>{if(i)return;this._providers.set(e,t);const n=this._selectors.get(e);if(!n)throw new Error(`No registered selector for ID: ${e}`);this._onDidRegisterProvider.fire({selector:n,provider:t})}),(0,A.OF)(()=>{i=!0,this._providers.delete(e);const n=this._selectors.get(e);n&&(this._selectors.delete(e),this._onDidUnregisterProvider.fire(n.id))})}}const xl=Cl.ut.registerExtensionPoint({extensionPoint:"terminalQuickFixes",defaultExtensionKind:["workspace"],activationEventsGenerator:(o,e)=>{for(const t of o??[])e.push(`onTerminalQuickFixRequest:${t.id}`)},jsonSchema:{description:(0,a.NC)("vscode.extension.contributes.terminalQuickFixes","Contributes terminal quick fixes."),type:"array",items:{type:"object",additionalProperties:!1,required:["id","commandLineMatcher","outputMatcher","commandExitResult"],defaultSnippets:[{body:{id:"$1",commandLineMatcher:"$2",outputMatcher:"$3",exitStatus:"$4"}}],properties:{id:{description:(0,a.NC)("vscode.extension.contributes.terminalQuickFixes.id","The ID of the quick fix provider"),type:"string"},commandLineMatcher:{description:(0,a.NC)("vscode.extension.contributes.terminalQuickFixes.commandLineMatcher","A regular expression or string to test the command line against"),type:"string"},outputMatcher:{markdownDescription:(0,a.NC)("vscode.extension.contributes.terminalQuickFixes.outputMatcher","A regular expression or string to match a single line of the output against, which provides groups to be referenced in terminalCommand and uri.\n\nFor example:\n\n `lineMatcher: /git push --set-upstream origin (?<branchName>[^s]+)/;`\n\n`terminalCommand: 'git push --set-upstream origin ${group:branchName}';`\n"),type:"object",required:["lineMatcher","anchor","offset","length"],properties:{lineMatcher:{description:"A regular expression or string to test the command line against",type:"string"},anchor:{description:"Where the search should begin in the buffer",enum:["top","bottom"]},offset:{description:"The number of lines vertically from the anchor in the buffer to start matching against",type:"number"},length:{description:"The number of rows to match against, this should be as small as possible for performance reasons",type:"number"}}},commandExitResult:{description:(0,a.NC)("vscode.extension.contributes.terminalQuickFixes.commandExitResult","The command exit result to match on"),enum:["success","error"],enumDescriptions:["The command exited with an exit code of zero.","The command exited with a non-zero exit code."]}}}}});var ze=p(76854);(0,yt.Z)(".monaco-workbench .editor-instance .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport{-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;scrollbar-width:thin;transition:background-color .8s linear}.monaco-workbench .editor-instance .xterm-viewport::-webkit-scrollbar,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport::-webkit-scrollbar{width:10px}.monaco-workbench .editor-instance .xterm-viewport::-webkit-scrollbar-track,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport::-webkit-scrollbar-track{opacity:0}.monaco-workbench .editor-instance .xterm-viewport::-webkit-scrollbar-thumb,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport::-webkit-scrollbar-thumb{background-color:inherit;min-height:20px}.monaco-workbench .editor-instance .force-scrollbar .xterm .xterm-viewport,.monaco-workbench .editor-instance .xterm.focus .xterm-viewport,.monaco-workbench .editor-instance .xterm:focus .xterm-viewport,.monaco-workbench .editor-instance .xterm:hover .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .force-scrollbar .xterm .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm.focus .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm:focus .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm:hover .xterm-viewport{cursor:default;transition:opacity .1s linear}.monaco-workbench .editor-instance .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover,.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover{transition:opacity 0ms linear}.monaco-workbench .editor-instance .xterm .xterm-viewport::-webkit-scrollbar-thumb:window-inactive,.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-viewport::-webkit-scrollbar-thumb:window-inactive{background-color:inherit}",{}),(0,yt.Z)('.monaco-workbench .pane-body.integrated-terminal{align-content:flex-start;align-items:baseline;background-color:transparent!important;display:flex;flex-direction:column;position:relative;user-select:auto;-webkit-user-select:initial;z-index:0}.terminal-command-decoration.hide{visibility:hidden}.monaco-workbench .part.panel .pane-body.integrated-terminal .terminal-outer-container{background-color:var(--vscode-terminal-background,--vscode-panel-background)}.monaco-workbench .editor-instance .terminal-outer-container,.monaco-workbench .editor-instance .terminal-split-pane,.monaco-workbench .pane-body.integrated-terminal .terminal-group,.monaco-workbench .pane-body.integrated-terminal .terminal-groups-container,.monaco-workbench .pane-body.integrated-terminal .terminal-outer-container,.monaco-workbench .pane-body.integrated-terminal .terminal-split-pane{height:100%}.monaco-workbench .part.auxiliarybar .pane-body.integrated-terminal .terminal-outer-container,.monaco-workbench .part.sidebar .pane-body.integrated-terminal .terminal-outer-container{background-color:var(--vscode-terminal-background,--vscode-sideBar-background)}.monaco-workbench .pane-body.integrated-terminal .split-view-view:not(:first-child),.monaco-workbench .pane-body.integrated-terminal .tabs-container{border-color:var(--vscode-terminal-border)}.monaco-workbench .pane-body.integrated-terminal .terminal-drop-overlay{background-color:var(--vscode-terminal-dropBackground,--vscode-editorGroup-dropBackground)}.monaco-workbench .pane-body.integrated-terminal .terminal-tabs-entry.is-active:before{background-color:var(--vscode-terminal-tab-activeBorder)}.monaco-workbench .editor-instance .xterm textarea:focus{opacity:0!important;outline:0!important}.monaco-workbench .terminal-tab:before{font-family:codicon!important;font-size:16px!important}.monaco-workbench .terminal-tab:not(.terminal-uri-icon):before{background-image:none!important}.monaco-workbench .editor-instance .terminal-wrapper{background-color:var(--vscode-terminal-background,--vscode-editorPane-background)}.monaco-workbench .editor-instance .terminal-wrapper,.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper{box-sizing:border-box;display:block;height:100%}.monaco-workbench .editor-instance .xterm,.monaco-workbench .pane-body.integrated-terminal .xterm{bottom:0;left:0;padding:0 10px 2px;position:absolute;right:0}.terminal-side-view .terminal.xterm{top:0}.monaco-workbench .editor-instance .terminal-wrapper.fixed-dims .xterm,.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper.fixed-dims .xterm{position:static}.monaco-workbench .editor-instance .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport{z-index:30}.monaco-workbench .editor-instance .xterm-decoration-overview-ruler,.monaco-workbench .pane-body.integrated-terminal .xterm-decoration-overview-ruler{pointer-events:none;z-index:31}.monaco-workbench .editor-instance .xterm-screen,.monaco-workbench .pane-body.integrated-terminal .xterm-screen{z-index:31}.xterm .xterm-screen{cursor:text}.monaco-workbench .simple-find-part-wrapper.result-count{z-index:33!important}.xterm .xterm-accessibility{pointer-events:none;z-index:32!important}.xterm.enable-mouse-events .xterm-screen{cursor:default}.xterm.xterm-cursor-pointer .xterm-screen{cursor:pointer}.xterm.column-select.focus .xterm-screen{cursor:crosshair}.integrated-terminal.shell-integration .xterm,.monaco-workbench .editor-instance .xterm,.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:first-child .xterm{padding-left:20px!important}.monaco-workbench .editor-instance .terminal-group .monaco-split-view2.horizontal .split-view-view:last-child .xterm,.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:last-child .xterm{padding-right:20px}.monaco-workbench .editor-instance .xterm a:not(.xterm-invalid-link),.monaco-workbench .pane-body.integrated-terminal .xterm a:not(.xterm-invalid-link){position:relative}.monaco-workbench .editor-instance .terminal-wrapper>div,.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper>div{height:100%}.monaco-workbench .editor-instance .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport{box-sizing:border-box}.monaco-workbench .editor-instance .terminal-wrapper.fixed-dims,.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper.fixed-dims{position:relative}.monaco-workbench .editor-instance .terminal-wrapper:not(.fixed-dims) .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper:not(.fixed-dims) .xterm-viewport{width:auto!important}.monaco-workbench .pane-body.integrated-terminal{font-variant-ligatures:none}.monaco-workbench .pane-body.integrated-terminal .split-view-view{box-sizing:border-box;overflow:hidden}.monaco-workbench .pane-body.integrated-terminal .split-view-view:first-child .tabs-container{border-right-style:solid;border-right-width:1px}.monaco-workbench .pane-body.integrated-terminal .split-view-view:last-child .tabs-container,.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:not(:first-child){border-left-style:solid;border-left-width:1px}.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.vertical .split-view-view:not(:first-child){border-top-style:solid;border-top-width:1px}.monaco-workbench .pane-body.integrated-terminal .terminal-groups-container.alt-active .xterm{cursor:default}.monaco-workbench .pane-body.integrated-terminal .xterm{user-select:none;-webkit-user-select:none}.monaco-workbench .pane-body.integrated-terminal .monaco-split-view2.vertical .split-view-view:not(:last-child) .xterm{bottom:auto;top:0}.monaco-workbench .pane-body.integrated-terminal .xterm:focus{outline:none}.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm:focus:before{border:1px solid;bottom:0;content:"";display:block;left:0;pointer-events:none;position:absolute;right:0;top:0;z-index:32}.monaco-workbench.hc-black .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm:focus:before{right:0}.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-helpers{position:absolute;top:0}.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-helper-textarea:focus{opacity:0!important}.monaco-workbench.hc-black.mac .pane-body.integrated-terminal .terminal-groups-container:not(.alt-active) .terminal:not(.enable-mouse-events),.monaco-workbench.vs-dark.mac .pane-body.integrated-terminal .terminal-groups-container:not(.alt-active) .terminal:not(.enable-mouse-events){cursor:-webkit-image-set(url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII=") 1x,url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC") 2x) 5 8,text}.xterm .xterm-cursor-pointer,.xterm.xterm-cursor-pointer{cursor:pointer!important}.monaco-pane-view .pane>.pane-header .monaco-action-bar .switch-terminal,.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal,.part.panel>.title>.title-actions .switch-terminal>.monaco-select-box{border-style:solid;border-width:1px}.xterm-screen .xterm-decoration-container .xterm-decoration.quick-fix{z-index:7}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal{align-items:center;display:flex;flex-shrink:1;font-size:11px;height:20px;margin-right:.3em;margin-top:7px}.monaco-workbench.mac .part.sidebar>.title>.title-actions .switch-terminal{border-radius:4px}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal>.monaco-select-box{background-color:unset!important;border:none!important;display:block!important}.monaco-pane-view .pane>.pane-header .monaco-action-bar .switch-terminal.action-item.select-container{border:none!important}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal>.monaco-select-box{padding:0 22px 0 6px}.monaco-workbench .pane-body.integrated-terminal .tabs-container{display:flex;flex-direction:column;height:100%}.monaco-workbench .terminal-overflow-guard{height:100%;overflow:hidden;position:relative}.monaco-workbench .pane-body.integrated-terminal .tabs-list-container{height:100%;overflow:hidden}.monaco-workbench .pane-body.integrated-terminal .tabs-container>.monaco-toolbar{margin:auto;padding:4px 0 2px}.monaco-workbench .pane-body.integrated-terminal .terminal-tabs-entry.is-active:before{bottom:0;content:"";display:block;left:0;position:absolute;top:0;width:1px}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text>.monaco-toolbar{margin:0;padding:4px 7px 2px;text-align:left}.monaco-workbench .pane-body.integrated-terminal .tabs-list{height:100%}.monaco-workbench .pane-body.integrated-terminal .tabs-list .terminal-tabs-entry{text-align:center}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry{padding-left:10px;padding-right:10px;text-align:left}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry .monaco-icon-label:after{margin-right:0}.monaco-workbench .pane-body.integrated-terminal .tabs-container:not(.has-text) .terminal-tabs-entry .codicon{color:inherit}.monaco-workbench .pane-body.integrated-terminal .tabs-container:not(.has-text) .monaco-icon-description-container{display:none}.monaco-workbench .pane-body.integrated-terminal .tabs-list .codicon{vertical-align:text-bottom}.monaco-workbench .pane-body.integrated-terminal .tabs-list .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list .editable-tab .monaco-icon-name-container{display:none}.monaco-workbench .pane-body.integrated-terminal .tabs-list .actions .action-label{padding:2px}.monaco-workbench .pane-body.integrated-terminal .tabs-list .monaco-list-row:hover .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list:focus-within .monaco-list-row.focused .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list:focus-within .monaco-list-row.selected .actions{display:block}.monaco-action-bar .action-item .single-terminal-tab{align-items:center;display:flex!important}.monaco-action-bar .action-item .single-terminal-tab .codicon:first-child{margin-right:4px}.monaco-action-bar .action-item .single-terminal-tab .codicon:nth-child(2){color:inherit;margin-left:4px}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry .uri-icon{background-repeat:no-repeat;background-size:contain;height:100%;margin-right:4px}.monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label .codicon,.monaco-workbench .terminal-uri-icon .monaco-highlighted-label .codicon{background-size:16px}.monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon:before,.monaco-workbench .terminal-uri-icon .monaco-highlighted-label .codicon:before{content:"";display:inline-block;height:16px;width:16px}.monaco-workbench .pane-body.integrated-terminal .terminal-drop-overlay{bottom:0;display:block;left:0;opacity:0;pointer-events:none;position:absolute;right:0;top:0;z-index:34}.monaco-workbench:not(.reduce-motion) .pane-body.integrated-terminal .terminal-drop-overlay{transition:left 70ms ease-out,right 70ms ease-out,top 70ms ease-out,bottom 70ms ease-out,opacity .15s ease-out}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.horizontal .terminal-drop-overlay.drop-before{right:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.horizontal .terminal-drop-overlay.drop-after{left:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.vertical .terminal-drop-overlay.drop-before{bottom:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.vertical .terminal-drop-overlay.drop-after{top:50%}.monaco-workbench .terminal .terminal-command-decoration:not(.default):hover{background-color:var(--vscode-toolbar-hoverBackground);border-radius:5px;cursor:pointer}.monaco-workbench .terminal .terminal-command-decoration{color:var(--vscode-terminalCommandDecoration-successBackground)}.monaco-workbench .terminal .terminal-command-decoration.error{color:var(--vscode-terminalCommandDecoration-errorBackground)}.monaco-workbench .terminal .terminal-command-decoration.default{color:var(--vscode-terminalCommandDecoration-defaultBackground);pointer-events:none}.monaco-workbench .terminal .terminal-command-decoration.quick-fix{background-color:var(--vscode-terminal-background,--vscode-panel-background);color:var(--vscode-editorLightBulb-foreground)!important}.terminal-scroll-highlight{border-left:5px solid #fff;border-left-width:5px!important;left:0;pointer-events:none;right:0}.terminal-scroll-highlight-outline{border:1px solid #fff;pointer-events:none}.terminal-scroll-highlight{border-color:var(--vscode-focusBorder)}.hc-black .xterm-find-result-decoration,.hc-light .xterm-find-result-decoration{outline-style:dotted!important;outline-style:solid!important}.xterm-find-active-result-decoration{outline-style:solid!important;outline-width:2px!important;z-index:7!important}.monaco-workbench.hc-black .editor-instance .xterm.focus:before,.monaco-workbench.hc-black .editor-instance .xterm:focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm:focus:before,.monaco-workbench.hc-light .editor-instance .xterm.focus:before,.monaco-workbench.hc-light .editor-instance .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm:focus:before{border-color:var(--vscode-contrastActiveBorder)}.monaco-workbench .integrated-terminal .hoverHighlight{background-color:var(--vscode-terminal-hoverHighlightBackground)}.monaco-workbench .editor-instance .force-scrollbar .xterm .xterm-viewport,.monaco-workbench .editor-instance .xterm.focus .xterm-viewport,.monaco-workbench .editor-instance .xterm:focus .xterm-viewport,.monaco-workbench .editor-instance .xterm:hover .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .force-scrollbar .xterm .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm.focus .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm:focus .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm:hover .xterm-viewport{background-color:var(--vscode-scrollbarSlider-background)!important}.monaco-workbench .editor-instance .xterm-viewport,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport{scrollbar-color:var(--vscode-scrollbarSlider-background) transparent}.monaco-workbench .editor-instance .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover,.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover{background-color:var(--vscode-scrollbarSlider-hoverBackground)}.monaco-workbench .editor-instance .xterm-viewport:hover,.monaco-workbench .pane-body.integrated-terminal .xterm-viewport:hover{scrollbar-color:var(--vscode-scrollbarSlider-hoverBackground) transparent}.monaco-workbench .editor-instance .xterm .xterm-viewport::-webkit-scrollbar-thumb:active,.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-viewport::-webkit-scrollbar-thumb:active{background-color:var(--vscode-scrollbarSlider-activeBackground)}.monaco-workbench .terminal-accessible-widget{bottom:0;cursor:default;left:10px;opacity:0;overflow:initial;overflow-x:initial;padding:0;pointer-events:none;position:absolute;right:0;top:0;z-index:0}.monaco-workbench .terminal-accessible-widget div{white-space:pre-wrap}.monaco-workbench .terminal-accessible-widget.active,.monaco-workbench .terminal-accessible-widget.focus-within{background-color:var(--vscode-terminal-background,--vscode-panel-background);opacity:1;pointer-events:all;z-index:33}.monaco-workbench .xterm.terminal.hide{visibility:hidden}',{}),(0,yt.Z)(".monaco-workbench .terminal-widget-container{bottom:0;left:0;overflow:visible;position:absolute;right:0;top:0}.monaco-workbench .terminal-overlay-widget{bottom:0;color:#3794ff;left:0;position:absolute}.monaco-workbench .terminal-hover-target{position:absolute;z-index:33}.monaco-workbench .terminal-env-var-info{height:28px;opacity:.5;position:absolute;right:10px;text-align:center;top:0;width:28px;z-index:32}.monaco-workbench .terminal-env-var-info.requires-action,.monaco-workbench .terminal-env-var-info:hover{opacity:1}.monaco-workbench .terminal-env-var-info.codicon{line-height:28px}",{}),(0,yt.Z)(".xterm{cursor:text;position:relative;user-select:none;-ms-user-select:none;-webkit-user-select:none}.xterm.focus,.xterm:focus{outline:none}.xterm .xterm-helpers{position:absolute;top:0;z-index:5}.xterm .xterm-helper-textarea{border:0;height:0;left:-9999em;margin:0;opacity:0;overflow:hidden;padding:0;position:absolute;resize:none;top:0;white-space:nowrap;width:0;z-index:-5}.xterm .composition-view{background:#000;color:#fff;display:none;position:absolute;white-space:nowrap;z-index:1}.xterm .composition-view.active{display:block}.xterm .xterm-viewport{background-color:#000;bottom:0;cursor:default;left:0;overflow-y:scroll;position:absolute;right:0;top:0}.xterm .xterm-screen{position:relative}.xterm .xterm-screen canvas{left:0;position:absolute;top:0}.xterm .xterm-scroll-area{visibility:hidden}.xterm-char-measure-element{display:inline-block;left:-9999em;line-height:normal;position:absolute;top:0;visibility:hidden}.xterm.enable-mouse-events{cursor:default}.xterm .xterm-cursor-pointer,.xterm.xterm-cursor-pointer{cursor:pointer}.xterm.column-select.focus{cursor:crosshair}.xterm .xterm-accessibility,.xterm .xterm-message{bottom:0;color:transparent;left:0;pointer-events:none;position:absolute;right:0;top:0;z-index:10}.xterm .live-region{height:1px;left:-9999px;overflow:hidden;position:absolute;width:1px}.xterm-dim{opacity:1!important}.xterm-underline-1{text-decoration:underline}.xterm-underline-2{text-decoration:double underline}.xterm-underline-3{text-decoration:wavy underline}.xterm-underline-4{text-decoration:dotted underline}.xterm-underline-5{text-decoration:dashed underline}.xterm-overline{text-decoration:overline}.xterm-overline.xterm-underline-1{text-decoration:overline underline}.xterm-overline.xterm-underline-2{text-decoration:overline double underline}.xterm-overline.xterm-underline-3{text-decoration:overline wavy underline}.xterm-overline.xterm-underline-4{text-decoration:overline dotted underline}.xterm-overline.xterm-underline-5{text-decoration:overline dashed underline}.xterm-strikethrough{text-decoration:line-through}.xterm-screen .xterm-decoration-container .xterm-decoration{position:absolute;z-index:6}.xterm-screen .xterm-decoration-container .xterm-decoration.xterm-decoration-top-layer{z-index:7}.xterm-decoration-overview-ruler{pointer-events:none;position:absolute;right:0;top:0;z-index:8}.xterm-decoration-top{position:relative;z-index:2}",{});var us=p(28759),ms=p(6640),Al=p(11113),Pl=p(9110),Ji=p(36774),fs=p(32304),El=p(30162),Wr=p(98659),Ml=p(27331),Nl=p(383);function Br(o){let e="";const t=o.statusList.statuses,i=[];for(const l of t)e+=`\n\n---\n\n${l.icon?`$(${l.icon?.id}) `:""}${l.tooltip||l.id}`,l.hoverActions&&i.push(...l.hoverActions);const n=ps(o,!0),r=gs(o,!0);return{content:new Q.W5(o.title+n+r+e,{supportThemeIcons:!0}),actions:i}}function gs(o,e){const t=[];o.capabilities.has(2)&&t.push(2),o.capabilities.has(0)&&t.push(0);let i="";return t.length>0?i+=`${e?"\n\n---\n\n":"\n\n"}${(0,a.NC)("shellIntegration.enabled","Shell integration activated")}`:o.shellLaunchConfig.ignoreShellIntegration?i+=`${e?"\n\n---\n\n":"\n\n"}${(0,a.NC)("launchFailed.exitCodeOnlyShellIntegration","The terminal process failed to launch. Disabling shell integration with terminal.integrated.shellIntegration.enabled might help.")}`:o.usedShellIntegrationInjection&&(i+=`${e?"\n\n---\n\n":"\n\n"}${(0,a.NC)("shellIntegration.activationFailed","Shell integration failed to activate")}`),i}function ps(o,e){const t=[];if(o.processId&&t.push((0,a.NC)({key:"shellProcessTooltip.processId",comment:['The first arg is "PID" which shouldn\'t be translated']},"Process ID ({0}): {1}","PID",o.processId)+"\n"),o.shellLaunchConfig.executable){let i=o.shellLaunchConfig.executable;const n=(0,Mt._2)(o.injectedArgs||o.shellLaunchConfig.args||[]).map(r=>`'${r}'`).join(" ");n&&(i+=` ${n}`),t.push((0,a.NC)("shellProcessTooltip.commandLine","Command line: {0}",i))}return t.length?`${e?"\n\n---\n\n":"\n\n"}${t.join("\n")}`:""}const vs=S.$;let Fr=class extends $t.ev{constructor(e,t,i,n,r,s,l,d,h,f,v,b){var _;super("TerminalTabsList",e,{getHeight:()=>22,getTemplateId:()=>"terminal.tabs"},[d.createInstance(Or,e,d.createInstance(fs.RX,fs.hh),()=>this.getSelectedElements())],{horizontalScrolling:!1,supportDynamicHeights:!1,selectionNavigation:!0,identityProvider:{getId:y=>y?.instanceId},accessibilityProvider:d.createInstance(Hr),smoothScrolling:r.getValue("workbench.list.smoothScrolling"),multipleSelectionSupport:!0,additionalScrollHeight:22,dnd:d.createInstance(Vr),openOnSingleClick:!0},t,i,r,d),_=this,this._configurationService=r,this._terminalService=s,this._terminalGroupService=l,this._themeService=f,this._hoverService=b;const C=[this._terminalGroupService.onDidChangeInstances(()=>this.refresh()),this._terminalGroupService.onDidChangeGroups(()=>this.refresh()),this._terminalGroupService.onDidShow(()=>this.refresh()),this._terminalGroupService.onDidChangeInstanceCapability(()=>this.refresh()),this._terminalService.onDidChangeInstanceTitle(()=>this.refresh()),this._terminalService.onDidChangeInstanceIcon(()=>this.refresh()),this._terminalService.onDidChangeInstancePrimaryStatus(()=>this.refresh()),this._terminalService.onDidChangeConnectionState(()=>this.refresh()),this._themeService.onDidColorThemeChange(()=>this.refresh()),this._terminalGroupService.onDidChangeActiveInstance(y=>{if(y){const I=this._terminalGroupService.instances.indexOf(y);this.setSelection([I]),this.reveal(I)}this.refresh()})];v.onWillShutdown(y=>{(0,A.B9)(C)}),this.onMouseDblClick(function(){var y=(0,u.Z)(function*(I){if(0===_.getFocus().length){const F=yield _._terminalService.createTerminal({location:D.i2.Panel});_._terminalGroupService.setActiveInstance(F),yield F.focusWhenReady()}_._terminalService.getEditingTerminal()?.instanceId!==I.element?.instanceId&&"doubleClick"===_._getFocusMode()&&1===_.getFocus().length&&I.element?.focus(!0)});return function(I){return y.apply(this,arguments)}}()),this.onMouseClick(function(){var y=(0,u.Z)(function*(I){_._terminalService.getEditingTerminal()?.instanceId!==I.element?.instanceId&&(I.browserEvent.altKey&&I.element?yield _._terminalService.createTerminal({location:{parentTerminal:I.element}}):"singleClick"===_._getFocusMode()&&_.getSelection().length<=1&&I.element?.focus(!0))});return function(I){return y.apply(this,arguments)}}()),this.onContextMenu(y=>{if(!y.element)return void this.setSelection([]);const I=this.getSelectedElements();(!I||!I.find($=>y.element===$))&&this.setFocus(void 0!==y.index?[y.index]:[])}),this._terminalTabsSingleSelectedContextKey=m.r.tabsSingularSelection.bindTo(t),this._isSplitContextKey=m.r.splitTerminal.bindTo(t),this.onDidChangeSelection(y=>this._updateContextKey()),this.onDidChangeFocus(()=>this._updateContextKey()),this.onDidOpen(function(){var y=(0,u.Z)(function*(I){const $=I.element;$&&(_._terminalGroupService.setActiveInstance($),I.editorOptions.preserveFocus||(yield $.focusWhenReady()))});return function(I){return y.apply(this,arguments)}}()),this._decorationsProvider||(this._decorationsProvider=d.createInstance($r),h.registerDecorationsProvider(this._decorationsProvider)),this.refresh()}_getFocusMode(){return this._configurationService.getValue("terminal.integrated.tabs.focusMode")}refresh(e=!0){e&&this._terminalService.isEditable(void 0)&&this.domFocus(),this.splice(0,this.length,this._terminalGroupService.instances.slice())}focusHover(){const e=this.getSelectedElements()[0];e&&this._hoverService.showHover({...Br(e),target:this.getHTMLElement(),trapFocus:!0},!0)}_updateContextKey(){this._terminalTabsSingleSelectedContextKey.set(1===this.getSelectedElements().length);const e=this.getFocusedElements();this._isSplitContextKey.set(e.length>0&&this._terminalGroupService.instanceIsSplit(e[0]))}};Fr=(0,c.gn)([(0,c.fM)(1,g.i6),(0,c.fM)(2,$t.Lw),(0,c.fM)(3,me.XE),(0,c.fM)(4,ie.Ui),(0,c.fM)(5,M.x4),(0,c.fM)(6,M.Qy),(0,c.fM)(7,G.TG),(0,c.fM)(8,El.Y),(0,c.fM)(9,me.XE),(0,c.fM)(10,Hi.g),(0,c.fM)(11,Ui.B)],Fr);let Or=class{constructor(e,t,i,n,r,s,l,d,h,f,v,b){this._container=e,this._labels=t,this._getSelection=i,this._instantiationService=n,this._terminalService=r,this._terminalGroupService=s,this._hoverService=l,this._configurationService=d,this._keybindingService=h,this._listService=f,this._themeService=v,this._contextViewService=b,this.templateId="terminal.tabs"}renderTemplate(e){const t=S.R3(e,vs(".terminal-tabs-entry")),i={},n=this._labels.create(t,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:{delay:this._configurationService.getValue("workbench.hover.delay"),showHover:l=>this._hoverService.showHover({...l,actions:i.hoverActions,hideOnHover:!0})}}),r=S.R3(n.element,vs(".actions"));return{element:t,label:n,actionBar:new Pl.o(r,{actionViewItemProvider:l=>l instanceof x.U8?this._instantiationService.createInstance(Ji.Mm,l,void 0):void 0}),context:i,elementDisposables:new A.SL}}shouldHideText(){return!!this._container&&this._container.clientWidth<63}shouldHideActionBar(){return!!this._container&&this._container.clientWidth<=105}renderElement(e,t,i){const n=!this.shouldHideText(),r=this._terminalGroupService.getGroupForInstance(e);if(!r)throw new Error(`Could not find group for instance "${e.instanceId}"`);i.element.classList.toggle("has-text",n),i.element.classList.toggle("is-active",this._terminalGroupService.activeInstance===e);let s="";if(r.terminalInstances.length>1){const y=r.terminalInstances.indexOf(e);s=0===y?"\u250c ":y===r.terminalInstances.length-1?"\u2514 ":"\u251c "}const l=Br(e);i.context.hoverActions=l.actions;const d=this._instantiationService.invokeFunction(ae.yX,e),h=!this.shouldHideActionBar();let f="";if(n)this.fillActionBar(e,i),f=s,e.icon&&(f+=`$(${d}) ${e.title}`);else{const y=e.statusList.primary;f=y&&y.severity>Pe.Z.Ignore?`${s}$(${y.icon?.id||d})`:`${s}$(${d})`}h||i.actionBar.clear(),i.elementDisposables.add(S.nm(i.element,S.tw.AUXCLICK,y=>{y.stopImmediatePropagation(),1===y.button&&this._terminalService.safeDisposeTerminal(e)}));const v=[],b=(0,ae.pv)(e);b&&v.push(b);const _=(0,ae.A5)(e,this._themeService.getColorTheme().type);_&&v.push(..._),i.label.setResource({resource:e.resource,name:f,description:n?e.description:void 0},{fileDecorations:{colors:!0,badges:n},title:{markdown:l.content,markdownNotSupportedFallback:void 0},extraClasses:v});const C=this._terminalService.getEditableData(e);i.label.element.classList.toggle("editable-tab",!!C),C&&(i.elementDisposables.add(this._renderInputBox(i.label.element.querySelector(".monaco-icon-label-container"),e,C)),i.actionBar.clear())}_renderInputBox(e,t,i){const n=t.title||"",r=new Ml.Wz(e,this._contextViewService,{validationOptions:{validation:h=>{const f=i.validationMessage(h);return f&&f.severity===Pe.Z.Error?{content:f.content,formatContent:!0,type:3}:null}},ariaLabel:(0,a.NC)("terminalInputAriaLabel","Type terminal name. Press Enter to confirm or Escape to cancel."),inputBoxStyles:gr.Hc});r.element.style.height="22px",r.value=n,r.focus(),r.select({start:0,end:n.length});const s=(0,Nl.I)((h,f)=>{r.element.style.display="none";const v=r.value;(0,A.B9)(d),r.element.remove(),f&&i.onFinish(v,h)}),l=()=>{if(r.isInputValid()){const h=i.validationMessage(r.value);h?r.showMessage({content:h.content,formatContent:!0,type:h.severity===Pe.Z.Info?1:h.severity===Pe.Z.Warning?2:3}):r.hideMessage()}};l();const d=[r,S.mu(r.inputElement,S.tw.KEY_DOWN,h=>{h.stopPropagation(),h.equals(3)?s(r.isInputValid(),!0):h.equals(9)&&s(!1,!0)}),S.mu(r.inputElement,S.tw.KEY_UP,h=>{l()}),S.nm(r.inputElement,S.tw.BLUR,()=>{s(r.isInputValid(),!0)})];return(0,A.OF)(()=>{s(!1,!1)})}disposeElement(e,t,i){i.elementDisposables.clear(),i.actionBar.clear()}disposeTemplate(e){e.elementDisposables.dispose(),e.label.dispose(),e.actionBar.dispose()}fillActionBar(e,t){var i=this;const n=[new X.aU("workbench.action.terminal.splitInstance",P.split.short,H.kS.asClassName(E.lA.splitHorizontal),!0,(0,u.Z)(function*(){i._runForSelectionOrInstance(e,function(){var r=(0,u.Z)(function*(s){i._terminalService.createTerminal({location:{parentTerminal:s}})});return function(s){return r.apply(this,arguments)}}())})),new X.aU("workbench.action.terminal.killInstance",P.kill.short,H.kS.asClassName(E.lA.trashcan),!0,(0,u.Z)(function*(){i._runForSelectionOrInstance(e,r=>i._terminalService.safeDisposeTerminal(r))}))];t.actionBar.clear();for(const r of n)t.actionBar.push(r,{icon:!0,label:!1,keybinding:this._keybindingService.lookupKeybinding(r.id)?.getLabel()})}_runForSelectionOrInstance(e,t){const i=this._getSelection();if(i.includes(e))for(const n of i)n&&t(n);else t(e);this._terminalGroupService.focusTabs(),this._listService.lastFocusedList?.focusNext()}};Or=(0,c.gn)([(0,c.fM)(3,G.TG),(0,c.fM)(4,M.x4),(0,c.fM)(5,M.Qy),(0,c.fM)(6,Ui.B),(0,c.fM)(7,ie.Ui),(0,c.fM)(8,ri.d),(0,c.fM)(9,$t.Lw),(0,c.fM)(10,me.XE),(0,c.fM)(11,$e.u)],Or);let Hr=class{constructor(e){this._terminalGroupService=e}getWidgetAriaLabel(){return(0,a.NC)("terminal.tabs","Terminal tabs")}getAriaLabel(e){let t="";const i=this._terminalGroupService.getGroupForInstance(e);if(i&&i.terminalInstances?.length>1){const n=i.terminalInstances.indexOf(e);t=(0,a.NC)({key:"splitTerminalAriaLabel",comment:["The terminal's ID","The terminal's title","The terminal's split number","The terminal group's total split number"]},"Terminal {0} {1}, split {2} of {3}",e.instanceId,e.title,n+1,i.terminalInstances.length)}else t=(0,a.NC)({key:"terminalAriaLabel",comment:["The terminal's ID","The terminal's title"]},"Terminal {0} {1}",e.instanceId,e.title);return t}};Hr=(0,c.gn)([(0,c.fM)(0,M.Qy)],Hr);let Vr=class{constructor(e,t){this._terminalService=e,this._terminalGroupService=t,this._autoFocusDisposable=A.JT.None,this._primaryBackend=this._terminalService.getPrimaryBackend()}getDragURI(e){return this._terminalService.getEditingTerminal()?.instanceId===e.instanceId?null:e.resource.toString()}getDragLabel(e,t){return 1===e.length?e[0].title:void 0}onDragLeave(){this._autoFocusInstance=void 0,this._autoFocusDisposable.dispose(),this._autoFocusDisposable=A.JT.None}onDragStart(e,t){if(!t.dataTransfer)return;const i=e.getData();if(!Array.isArray(i))return;const n=i.filter(r=>"instanceId"in r);n.length>0&&t.dataTransfer.setData("Terminals",JSON.stringify(n.map(r=>r.resource.toString())))}onDragOver(e,t,i,n){if(e instanceof Wr.s2&&!(0,Re.Mq)(n,Et.go.FILES,Et.go.RESOURCES,"Terminals",Re.Km.FILES))return!1;const r=this._autoFocusInstance!==t;return r&&(this._autoFocusDisposable.dispose(),this._autoFocusInstance=t),t||(0,Re.Mq)(n,"Terminals")?(r&&t&&(this._autoFocusDisposable=(0,ne.Vg)(()=>{this._terminalService.setActiveInstance(t),this._autoFocusInstance=void 0},500)),{feedback:i?[i]:void 0,accept:!0,effect:1}):e instanceof Wr.kX}drop(e,t,i,n){var r=this;return(0,u.Z)(function*(){let s;r._autoFocusDisposable.dispose(),r._autoFocusInstance=void 0;const l=[],d=Lo(n);if(d)for(const f of d){const v=r._terminalService.getInstanceFromResource(f);if(v)s=[v],r._terminalService.moveToTerminalView(v);else if(r._primaryBackend){const b=Vn(f);b.instanceId&&l.push(r._primaryBackend.requestDetachInstance(b.workspaceId,b.instanceId))}}if(l.length){let v,f=yield Promise.all(l);f=f.filter(b=>void 0!==b);for(const b of f)v=yield r._terminalService.createTerminal({config:{attachPersistentProcess:b}});return void(v&&r._terminalService.setActiveInstance(v))}if(void 0===s){if(!(e instanceof Wr.kX))return void r._handleExternalDrop(t,n);const f=e.getData();if(!f||!Array.isArray(f))return;s=[];for(const v of f)"instanceId"in v&&s.push(v)}if(!t)return r._terminalGroupService.moveGroupToEnd(s[0]),void r._terminalService.setActiveInstance(s[0]);let h=!1;for(const f of s)r._terminalGroupService.moveGroup(f,t),h||(r._terminalService.setActiveInstance(f),h=!0)})()}_handleExternalDrop(e,t){var i=this;return(0,u.Z)(function*(){if(!e||!t.dataTransfer)return;let n;const r=t.dataTransfer.getData(Et.go.RESOURCES);r&&(n=N.ov.parse(JSON.parse(r)[0]));const s=t.dataTransfer.getData(Re.Km.FILES);!n&&s&&(n=N.ov.file(JSON.parse(s)[0])),!n&&t.dataTransfer.files.length>0&&t.dataTransfer.files[0].path&&(n=N.ov.file(t.dataTransfer.files[0].path)),n&&(i._terminalService.setActiveInstance(e),e.focus(),yield e.sendPath(n,!1))})()}};Vr=(0,c.gn)([(0,c.fM)(0,M.x4),(0,c.fM)(1,M.Qy)],Vr);let $r=class{constructor(e){this._terminalService=e,this.label=(0,a.NC)("label","Terminal"),this._onDidChange=new w.Q5,this._terminalService.onDidChangeInstancePrimaryStatus(t=>this._onDidChange.fire([t.resource]))}get onDidChange(){return this._onDidChange.event}provideDecorations(e){if(e.scheme!==J.lg.vscodeTerminal)return;const t=this._terminalService.getInstanceFromResource(e);if(!t)return;const i=t?.statusList?.primary;return i?.icon?{color:Xo(i.severity),letter:i.icon,tooltip:i.tooltip}:void 0}dispose(){this.dispose()}};$r=(0,c.gn)([(0,c.fM)(0,M.x4)],$r);var Ll=p(48671);function di(o,e,t,i,n){const r=new Ll.nV(o),s={x:r.posx,y:r.posy},l=[];(0,Ji.LJ)(t,void 0,l),n&&l.push(...n),i.showContextMenu({getAnchor:()=>s,getActions:()=>l,getActionsContext:()=>e})}const hi=S.$;let Gr=class extends A.JT{constructor(e,t,i,n,r,s,l,d,h,f,v){super(),this._terminalService=t,this._terminalGroupService=i,this._instantiationService=n,this._notificationService=r,this._contextMenuService=s,this._configurationService=l,this._storageService=h,this._hoverService=v,this._cancelContextMenu=!1,this._parentElement=e,this._tabContainer=hi(".tabs-container");const b=hi(".tabs-list-container");this._tabListElement=hi(".tabs-list"),b.appendChild(this._tabListElement),this._tabContainer.appendChild(b),this._instanceMenu=this._register(d.createMenu(x.eH.TerminalInstanceContext,f)),this._tabsListMenu=this._register(d.createMenu(x.eH.TerminalTabContext,f)),this._tabsListEmptyMenu=this._register(d.createMenu(x.eH.TerminalTabEmptyAreaContext,f)),this._tabList=this._register(this._instantiationService.createInstance(Fr,this._tabListElement));const _=hi(".terminal-outer-container");this._terminalContainer=hi(".terminal-groups-container"),_.appendChild(this._terminalContainer),this._terminalService.setContainers(e,this._terminalContainer),this._terminalIsTabsNarrowContextKey=m.r.tabsNarrow.bindTo(f),this._terminalTabsFocusContextKey=m.r.tabsFocus.bindTo(f),this._terminalTabsMouseContextKey=m.r.tabsMouse.bindTo(f),this._tabTreeIndex="left"===this._terminalService.configHelper.config.tabs.location?0:1,this._terminalContainerIndex="left"===this._terminalService.configHelper.config.tabs.location?1:0,l.onDidChangeConfiguration(C=>{C.affectsConfiguration("terminal.integrated.tabs.enabled")||C.affectsConfiguration("terminal.integrated.tabs.hideCondition")?this._refreshShowTabs():C.affectsConfiguration("terminal.integrated.tabs.location")&&(this._tabTreeIndex="left"===this._terminalService.configHelper.config.tabs.location?0:1,this._terminalContainerIndex="left"===this._terminalService.configHelper.config.tabs.location?1:0,this._shouldShowTabs()&&(this._splitView.swapViews(0,1),this._removeSashListener(),this._addSashListener(),this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth())))}),this._register(this._terminalGroupService.onDidChangeInstances(()=>this._refreshShowTabs())),this._register(this._terminalGroupService.onDidChangeGroups(()=>this._refreshShowTabs())),this._attachEventListeners(e,this._terminalContainer),this._terminalGroupService.onDidChangePanelOrientation(C=>{this._panelOrientation=C,0===this._panelOrientation?this._terminalContainer.classList.add("terminal-side-view"):this._terminalContainer.classList.remove("terminal-side-view")}),this._splitView=new Pt.z(e,{orientation:1,proportionalLayout:!1}),this._setupSplitView(_)}_shouldShowTabs(){const t=this._terminalService.configHelper.config.tabs.hideCondition;return!!this._terminalService.configHelper.config.tabs.enabled&&("never"===t||"singleTerminal"===t&&this._terminalGroupService.instances.length>1||"singleGroup"===t&&this._terminalGroupService.groups.length>1)}_refreshShowTabs(){this._shouldShowTabs()?1===this._splitView.length&&(this._addTabTree(),this._addSashListener(),this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth()),this.rerenderTabs()):2===this._splitView.length&&!this._terminalTabsMouseContextKey.get()&&(this._splitView.removeView(this._tabTreeIndex),this._plusButton&&this._tabContainer.removeChild(this._plusButton),this._removeSashListener())}_getLastListWidth(){const t=this._storageService.get(0===this._panelOrientation?"tabs-list-width-vertical":"tabs-list-width-horizontal",0);return t&&parseInt(t)?parseInt(t):0===this._panelOrientation?46:120}_handleOnDidSashReset(){let e=80;const t=document.createElement("canvas");t.width=1,t.height=1;const i=t.getContext("2d");if(i){const r=window.getComputedStyle(this._tabListElement);i.font=`${r.fontStyle} ${r.fontSize} ${r.fontFamily}`;const s=this._terminalGroupService.instances.reduce((l,d)=>Math.max(l,i.measureText(d.title+(d.description||"")).width+this._getAdditionalWidth(d)),0);e=Math.ceil(Math.max(s,80))}Math.ceil(this._splitView.getViewSize(this._tabTreeIndex))===e&&(e=46),this._splitView.resizeView(this._tabTreeIndex,e),this._updateListWidth(e)}_getAdditionalWidth(e){const i=e.statusList.statuses.length>0?30:0;return 40+((this._terminalGroupService.getGroupForInstance(e)?.terminalInstances.length||0)>1?30:0)+i}_handleOnDidSashChange(){const e=this._splitView.getViewSize(this._tabTreeIndex);!this._width||e<=0||this._updateListWidth(e)}_updateListWidth(e){e<63&&e>=46?this._splitView.resizeView(this._tabTreeIndex,e=46):e>=63&&e<80&&this._splitView.resizeView(this._tabTreeIndex,e=80),this.rerenderTabs(),this._storageService.store(0===this._panelOrientation?"tabs-list-width-vertical":"tabs-list-width-horizontal",e,0,0)}_setupSplitView(e){this._register(this._splitView.onDidSashReset(()=>this._handleOnDidSashReset())),this._register(this._splitView.onDidSashChange(()=>this._handleOnDidSashChange())),this._shouldShowTabs()&&this._addTabTree(),this._splitView.addView({element:e,layout:t=>this._terminalGroupService.groups.forEach(i=>i.layout(t,this._height||0)),minimumSize:120,maximumSize:Number.POSITIVE_INFINITY,onDidChange:()=>A.JT.None,priority:2},Pt.M.Distribute,this._terminalContainerIndex),this._shouldShowTabs()&&this._addSashListener()}_addTabTree(){this._splitView.addView({element:this._tabContainer,layout:e=>this._tabList.layout(this._height||0,e),minimumSize:46,maximumSize:500,onDidChange:()=>A.JT.None,priority:1},Pt.M.Distribute,this._tabTreeIndex),this.rerenderTabs()}rerenderTabs(){this._updateHasText(),this._tabList.refresh()}_addSashListener(){let e;this._sashDisposables=[this._splitView.sashes[0].onDidStart(t=>{e=window.setInterval(()=>{this.rerenderTabs()},100)}),this._splitView.sashes[0].onDidEnd(t=>{window.clearInterval(e),e=0})]}_removeSashListener(){this._sashDisposables&&((0,A.B9)(this._sashDisposables),this._sashDisposables=void 0)}_updateHasText(){const e=this._tabListElement.clientWidth>63;this._tabContainer.classList.toggle("has-text",e),this._terminalIsTabsNarrowContextKey.set(!e)}layout(e,t){this._height=t,this._width=e,this._splitView.layout(e),this._shouldShowTabs()&&this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth()),this._updateHasText()}_attachEventListeners(e,t){var i=this;this._register(S.nm(this._tabContainer,"mouseleave",function(){var n=(0,u.Z)(function*(r){i._terminalTabsMouseContextKey.set(!1),i._refreshShowTabs(),r.stopPropagation()});return function(r){return n.apply(this,arguments)}}())),this._register(S.nm(this._tabContainer,"mouseenter",function(){var n=(0,u.Z)(function*(r){i._terminalTabsMouseContextKey.set(!0),r.stopPropagation()});return function(r){return n.apply(this,arguments)}}())),this._register(S.nm(t,"mousedown",function(){var n=(0,u.Z)(function*(r){const s=i._terminalGroupService.activeInstance;if(0!==i._terminalGroupService.instances.length&&s){if(2===r.which&&T.IJ)s.focus();else if(3===r.which){const l=i._terminalService.configHelper.config.rightClickBehavior;if("nothing"===l)return void(r.shiftKey||(i._cancelContextMenu=!0));if("copyPaste"===l||"paste"===l){if("copyPaste"===l&&r.shiftKey)return void di(r,i._parentElement,i._instanceMenu,i._contextMenuService);"copyPaste"===l&&s.hasSelection()?(yield s.copySelection(),s.clearSelection()):bt.D.clipboard.readText?s.paste():i._notificationService.info(`This browser doesn't support the clipboard.readText API needed to trigger a paste, try ${T.dz?"\u2318":"Ctrl"}+V instead.`),T.dz&&setTimeout(()=>{s.clearSelection()},0),i._cancelContextMenu=!0}}}else i._cancelContextMenu=!0});return function(r){return n.apply(this,arguments)}}())),this._register(S.nm(t,"contextmenu",n=>{"nothing"===this._terminalService.configHelper.config.rightClickBehavior&&!n.shiftKey&&(this._cancelContextMenu=!0),this._cancelContextMenu||di(n,this._parentElement,this._instanceMenu,this._contextMenuService),n.preventDefault(),n.stopImmediatePropagation(),this._cancelContextMenu=!1})),this._register(S.nm(this._tabContainer,"contextmenu",n=>{if("nothing"===this._terminalService.configHelper.config.rightClickBehavior&&!n.shiftKey&&(this._cancelContextMenu=!0),!this._cancelContextMenu){const s=0===this._tabList.getFocus().length;di(n,this._parentElement,s?this._tabsListEmptyMenu:this._tabsListMenu,this._contextMenuService,s?this._getTabActions():void 0)}n.preventDefault(),n.stopImmediatePropagation(),this._cancelContextMenu=!1})),this._register(S.nm(document,"keydown",n=>{t.classList.toggle("alt-active",!!n.altKey)})),this._register(S.nm(document,"keyup",n=>{t.classList.toggle("alt-active",!!n.altKey)})),this._register(S.nm(e,"keyup",n=>{27===n.keyCode&&n.stopPropagation()})),this._register(S.nm(this._tabContainer,S.tw.FOCUS_IN,()=>{this._terminalTabsFocusContextKey.set(!0)})),this._register(S.nm(this._tabContainer,S.tw.FOCUS_OUT,()=>{this._terminalTabsFocusContextKey.set(!1)}))}_getTabActions(){var e=this;return[new X.Z0,"left"===this._configurationService.inspect("terminal.integrated.tabs.location").userValue?new X.aU("moveRight",(0,a.NC)("moveTabsRight","Move Tabs Right"),void 0,void 0,(0,u.Z)(function*(){e._configurationService.updateValue("terminal.integrated.tabs.location","right")})):new X.aU("moveLeft",(0,a.NC)("moveTabsLeft","Move Tabs Left"),void 0,void 0,(0,u.Z)(function*(){e._configurationService.updateValue("terminal.integrated.tabs.location","left")})),new X.aU("hideTabs",(0,a.NC)("hideTabs","Hide Tabs"),void 0,void 0,(0,u.Z)(function*(){e._configurationService.updateValue("terminal.integrated.tabs.enabled",!1)}))]}setEditable(e){e||this._tabList.domFocus(),this._tabList.refresh(!1)}focusTabs(){if(!this._shouldShowTabs())return;this._terminalTabsFocusContextKey.set(!0);const e=this._tabList.getSelection();this._tabList.domFocus(),e&&this._tabList.setFocus(e)}focus(){if(0!==this._terminalService.connectionState)this._focus();else{const e=document.activeElement;this._register(this._terminalService.onDidChangeConnectionState(()=>{document.activeElement===e&&this._focus()}))}}focusHover(){if(this._shouldShowTabs())return void this._tabList.focusHover();const e=this._terminalGroupService.activeInstance;e&&this._hoverService.showHover({...Br(e),target:this._terminalContainer,trapFocus:!0},!0)}_focus(){this._terminalGroupService.activeInstance?.focusWhenReady()}};Gr=(0,c.gn)([(0,c.fM)(1,M.x4),(0,c.fM)(2,M.Qy),(0,c.fM)(3,G.TG),(0,c.fM)(4,R.lT),(0,c.fM)(5,$e.i),(0,c.fM)(6,ie.Ui),(0,c.fM)(7,x.co),(0,c.fM)(8,He.Uy),(0,c.fM)(9,g.i6),(0,c.fM)(10,Ui.B)],Gr);var Rl=p(61909),_s=p(51762),bs=p(16170);function zr(o,e,t,i,n,r){let s=[],l=[];e=e.filter(_=>!_.isAutoDetected);const d=o===D.i2.Editor||"object"==typeof o&&"viewColumn"in o&&o.viewColumn===Se.LP?{viewColumn:Se.O3}:{splitActiveTerminal:!0};for(const _ of e){const C=_.profileName===t,y={config:_,location:o},I={config:_,location:d},$=_.profileName.replace(/[\n\r\t]/g,"");s.push(new X.aU("workbench.action.terminal.newWithProfile",C?(0,a.NC)("defaultTerminalProfile","{0} (Default)",$):$,void 0,!0,(0,u.Z)(function*(){const F=yield n.createTerminal(y);n.setActiveInstance(F),yield n.focusActiveInstance()}))),l.push(new X.aU("workbench.action.terminal.split",C?(0,a.NC)("defaultTerminalProfile","{0} (Default)",$):$,void 0,!0,(0,u.Z)(function*(){const F=yield n.createTerminal(I);n.setActiveInstance(F),yield n.focusActiveInstance()})))}for(const _ of i){const y=_.title===t?(0,a.NC)("defaultTerminalProfile","{0} (Default)",_.title.replace(/[\n\r\t]/g,"")):_.title.replace(/[\n\r\t]/g,"");s.push(new X.aU("contributed",y,void 0,!0,()=>n.createTerminal({config:{extensionIdentifier:_.extensionIdentifier,id:_.id,title:y},location:o}))),l.push(new X.aU("contributed-split",y,void 0,!0,()=>n.createTerminal({config:{extensionIdentifier:_.extensionIdentifier,id:_.id,title:y},location:d})))}const h=s.find(_=>_.label.endsWith("(Default)"));h&&(s=s.filter(_=>_!==h).sort((_,C)=>_.label.localeCompare(C.label)),s.unshift(h)),s.length>0&&(s.push(new X.wY("split.profile",(0,a.NC)("splitTerminal","Split Terminal"),l)),s.push(new X.Z0));const f=r.getActions();s.push(...X.Z0.join(...f.map(_=>_[1])));const v=l.find(_=>_.label.endsWith("(Default)"));return v&&(l=l.filter(_=>_!==v).sort((_,C)=>_.label.localeCompare(C.label)),l.unshift(v)),{dropdownAction:new X.aU("refresh profiles","Launch Profile...","codicon-chevron-down",!0),dropdownMenuActions:s,className:`terminal-tab-actions-${n.resolveLocation(o)}`}}let Zr=class extends Al.qV{get terminalTabbedView(){return this._terminalTabbedView}constructor(e,t,i,n,r,s,l,d,h,f,v,b,_,C,y,I,$,F){super(e,t,s,r,i,n,l,C,f,v),this._contextKeyService=i,this._configurationService=r,this._contextMenuService=s,this._instantiationService=l,this._terminalService=d,this._terminalGroupService=h,this._notificationService=b,this._keybindingService=_,this._menuService=y,this._terminalProfileService=I,this._terminalProfileResolverService=$,this._themeService=F,this._isWelcomeShowing=!1,this._register(this._terminalService.onDidRegisterProcessSupport(()=>{this._onDidChangeViewWelcomeState.fire()})),this._register(this._terminalService.onDidChangeInstances(()=>{this._isWelcomeShowing&&(this._isWelcomeShowing=!0,this._onDidChangeViewWelcomeState.fire(),!this._terminalTabbedView&&this._parentDomElement&&(this._createTabsView(),this.layoutBody(this._parentDomElement.offsetHeight,this._parentDomElement.offsetWidth)))})),this._dropdownMenu=this._register(this._menuService.createMenu(x.eH.TerminalNewDropdownContext,this._contextKeyService)),this._singleTabMenu=this._register(this._menuService.createMenu(x.eH.TerminalInlineTabContext,this._contextKeyService)),this._register(this._terminalProfileService.onDidChangeAvailableProfiles(V=>this._updateTabActionBar(V))),this._viewShowing=m.r.viewShowing.bindTo(this._contextKeyService),this._register(this.onDidChangeBodyVisibility(V=>{V&&this._terminalTabbedView?.rerenderTabs()})),this._register(this._configurationService.onDidChangeConfiguration(V=>{this._parentDomElement&&(V.affectsConfiguration("terminal.integrated.shellIntegration.decorationsEnabled")||V.affectsConfiguration("terminal.integrated.shellIntegration.enabled"))&&this._updateForShellIntegration(this._parentDomElement)})),this._register(this._terminalService.onDidCreateInstance(V=>{V.capabilities.onDidAddCapability(O=>{2===O&&this._gutterDecorationsEnabled()&&this._parentDomElement?.classList.add("shell-integration")})}))}_updateForShellIntegration(e){e.classList.toggle("shell-integration",this._gutterDecorationsEnabled())}_gutterDecorationsEnabled(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled");return("both"===e||"gutter"===e)&&this._configurationService.getValue("terminal.integrated.shellIntegration.enabled")}_initializeTerminal(){this.isBodyVisible()&&this._terminalService.isProcessSupportRegistered&&1===this._terminalService.connectionState&&!this._terminalGroupService.groups.length&&this._terminalService.createTerminal({location:D.i2.Panel})}renderBody(e){var t=this;super.renderBody(e),this._parentDomElement||this._updateForShellIntegration(e),this._parentDomElement=e,this._parentDomElement.classList.add("integrated-terminal"),this._fontStyleElement=document.createElement("style"),this._instantiationService.createInstance(Qr,this._parentDomElement),this.shouldShowWelcome()||this._createTabsView(),this._parentDomElement.appendChild(this._fontStyleElement),this._register(this.configurationService.onDidChangeConfiguration(i=>{if((i.affectsConfiguration("terminal.integrated.fontFamily")||i.affectsConfiguration("editor.fontFamily"))&&!this._terminalService.configHelper.configFontIsMonospace()){const r=[{label:a.NC("terminal.useMonospace","Use 'monospace'"),run:()=>this.configurationService.updateValue("terminal.integrated.fontFamily","monospace")}];this._notificationService.prompt(R.zb.Warning,a.NC("terminal.monospaceOnly","The terminal only supports monospace fonts. Be sure to restart VS Code if this is a newly installed font."),r)}})),this._register(this.onDidChangeBodyVisibility(function(){var i=(0,u.Z)(function*(n){if(t._viewShowing.set(n),n)t._terminalService.isProcessSupportRegistered||t._onDidChangeViewWelcomeState.fire(),t._initializeTerminal(),t._terminalGroupService.showPanel(!1);else for(const r of t._terminalGroupService.instances)r.resetFocusContextKey();t._terminalGroupService.updateVisibility()});return function(n){return i.apply(this,arguments)}}())),this._register(this._terminalService.onDidChangeConnectionState(()=>this._initializeTerminal())),this.layoutBody(this._parentDomElement.offsetHeight,this._parentDomElement.offsetWidth)}_createTabsView(){this._parentDomElement&&(this._terminalTabbedView=this.instantiationService.createInstance(Gr,this._parentDomElement))}layoutBody(e,t){super.layoutBody(e,t),this._terminalTabbedView?.layout(t,e)}getActionViewItem(e){switch(e.id){case"workbench.action.terminal.split":{const t=this,i=new class extends X.aU{constructor(){super(e.id,e.label,e.class,e.enabled),this.checked=e.checked,this.tooltip=e.tooltip}dispose(){e.dispose()}run(){return(0,u.Z)(function*(){const n=t._terminalGroupService.activeInstance;if(n)return(yield t._terminalService.createTerminal({location:{parentTerminal:n}}))?.focusWhenReady()})()}};return new Dn.gU(e,i,{icon:!0,label:!1,keybinding:this._getKeybindingLabel(e)})}case"workbench.action.terminal.switchTerminal":return this._instantiationService.createInstance(Ur,e);case"workbench.action.terminal.focus":if(e instanceof x.U8){const t=[];return(0,Ji.LJ)(this._singleTabMenu,void 0,t),this._instantiationService.createInstance(Kr,e,t)}case"workbench.action.terminal.new":if(e instanceof x.U8){const t=zr(D.i2.Panel,this._terminalProfileService.availableProfiles,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);return this._newDropdown?.dispose(),this._newDropdown=new _s.C(e,t.dropdownAction,t.dropdownMenuActions,t.className,this._contextMenuService,{},this._keybindingService,this._notificationService,this._contextKeyService,this._themeService),this._updateTabActionBar(this._terminalProfileService.availableProfiles),this._newDropdown}}return super.getActionViewItem(e)}_getDefaultProfileName(){let e;try{e=this._terminalProfileService.getDefaultProfileName()}catch{e=this._terminalProfileResolverService.defaultProfileName}return e}_getKeybindingLabel(e){return(0,de.f6)(this._keybindingService.lookupKeybinding(e.id)?.getLabel())}_updateTabActionBar(e){const t=zr(D.i2.Panel,e,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);this._newDropdown?.update(t.dropdownAction,t.dropdownMenuActions)}focus(){if(0!==this._terminalService.connectionState)this._terminalGroupService.showPanel(!0);else{const e=document.activeElement;this._register(this._terminalService.onDidChangeConnectionState(()=>{document.activeElement===e&&this._terminalGroupService.showPanel(!0)}))}}shouldShowWelcome(){return this._isWelcomeShowing=!this._terminalService.isProcessSupportRegistered&&0===this._terminalService.instances.length,this._isWelcomeShowing}};Zr=(0,c.gn)([(0,c.fM)(1,ri.d),(0,c.fM)(2,g.i6),(0,c.fM)(3,Me.XH),(0,c.fM)(4,ie.Ui),(0,c.fM)(5,$e.i),(0,c.fM)(6,G.TG),(0,c.fM)(7,M.x4),(0,c.fM)(8,M.Qy),(0,c.fM)(9,me.XE),(0,c.fM)(10,je.bU),(0,c.fM)(11,R.lT),(0,c.fM)(12,ri.d),(0,c.fM)(13,Gt.v4),(0,c.fM)(14,x.co),(0,c.fM)(15,k.l5),(0,c.fM)(16,k.if),(0,c.fM)(17,me.XE)],Zr);let Ur=class extends Dn.Lc{constructor(e,t,i,n,r){super(null,e,ws(t,i),i.activeGroupIndex,n,gr.BM,{ariaLabel:a.NC("terminals","Open Terminals."),optionsAsChildren:!0}),this._terminalService=t,this._terminalGroupService=i,this._register(t.onDidChangeInstances(()=>this._updateItems(),this)),this._register(t.onDidChangeActiveGroup(()=>this._updateItems(),this)),this._register(t.onDidChangeActiveInstance(()=>this._updateItems(),this)),this._register(t.onDidChangeInstanceTitle(()=>this._updateItems(),this)),this._register(i.onDidChangeGroups(()=>this._updateItems(),this)),this._register(t.onDidChangeConnectionState(()=>this._updateItems(),this)),this._register(r.onDidChangeAvailableProfiles(()=>this._updateItems(),this)),this._register(t.onDidChangeInstancePrimaryStatus(()=>this._updateItems(),this))}render(e){super.render(e),e.classList.add("switch-terminal"),e.style.borderColor=(0,Z.n_1)(Z.a9O)}_updateItems(){const e=ws(this._terminalService,this._terminalGroupService);this.setOptions(e,this._terminalGroupService.activeGroupIndex)}};function ws(o,e){let t;return t=1===o.connectionState?e.getGroupLabels().map(i=>({text:i})):[{text:a.NC("terminalConnectingLabel","Starting...")}],t.push({text:wo,isDisabled:!0}),t.push({text:So}),t}Ur=(0,c.gn)([(0,c.fM)(1,M.x4),(0,c.fM)(2,M.Qy),(0,c.fM)(3,$e.u),(0,c.fM)(4,k.l5)],Ur);let Kr=class extends Ji.Mm{constructor(e,t,i,n,r,s,l,d,h,f,v){super(e,{draggable:!0},i,n,r,s,h),this._actions=t,this._terminalService=l,this._terminalGroupService=d,this._commandService=f,this._instantiationService=v,this._elementDisposables=[],this._register(w.ju.debounce(w.ju.any(this._terminalService.onDidChangeInstancePrimaryStatus,this._terminalGroupService.onDidChangeActiveInstance,w.ju.map(this._terminalService.onDidChangeInstanceIcon,b=>b.instance),w.ju.map(this._terminalService.onDidChangeInstanceColor,b=>b.instance),this._terminalService.onDidChangeInstanceTitle,this._terminalService.onDidChangeInstanceCapability),(b,_)=>(b||(b=new Set),_&&b.add(_),b))(b=>{for(const _ of b)this.updateLabel(_)})),this._register((0,A.OF)(()=>(0,A.B9)(this._elementDisposables)))}onClick(e){var t=this;return(0,u.Z)(function*(){e.altKey&&t._menuItemAction.alt?t._commandService.executeCommand(t._menuItemAction.alt.id,{target:D.i2.Panel}):t._openContextMenu()})()}updateLabel(e){if((!e||e===this._terminalGroupService.activeInstance)&&(0===this._elementDisposables.length&&this.element&&this.label&&(this._elementDisposables.push(S.nm(this.element,S.tw.CONTEXT_MENU,t=>{2===t.button&&(this._openContextMenu(),t.preventDefault())})),this._elementDisposables.push(S.nm(this.element,S.tw.AUXCLICK,t=>{if(1===t.button){const i=this._terminalGroupService.activeInstance;i&&this._terminalService.safeDisposeTerminal(i),t.preventDefault()}})),this._elementDisposables.push(S.nm(this.element,S.tw.DRAG_START,t=>{const i=this._terminalGroupService.activeInstance;t.dataTransfer&&i&&t.dataTransfer.setData("Terminals",JSON.stringify([i.resource.toString()]))}))),this.label)){const t=this.label,i=this._terminalGroupService.activeInstance;if(!i)return void S.mc(t,"");t.classList.add("single-terminal-tab");let n="";const r=i.statusList.primary;if(r){const d=Xo(r.severity);this._themeService.getColorTheme();const h=this._themeService.getColorTheme().getColor(d);h&&(n=h.toString())}t.style.color=n,S.mc(t,...(0,Rl.T)(this._instantiationService.invokeFunction(Bl,i,this._terminalService.configHelper.config.tabs.separator,H.kS.isThemeIcon(this._commandAction.item.icon)?this._commandAction.item.icon:void 0))),this._altCommand&&(t.classList.remove(this._altCommand),this._altCommand=void 0),this._color&&(t.classList.remove(this._color),this._color=void 0),this._class&&(t.classList.remove(this._class),t.classList.remove("terminal-uri-icon"),this._class=void 0);const s=(0,ae.pv)(i);s&&(this._color=s,t.classList.add(s));const l=(0,ae.A5)(i,this._themeService.getColorTheme().type);l&&(this._class=l?.[0],t.classList.add(...l)),this._commandAction.item.icon&&(this._altCommand="alt-command",t.classList.add(this._altCommand)),this._action.tooltip=function Fl(o,e){if(!o)return"";const t=[];return t.push(Ss(o,e)+ps(o,!1)+gs(o,!1)),t.push(o.statusList.primary?.tooltip||""),t.filter(i=>i).join("\n\n")}(i,this._terminalService.configHelper.config.tabs.separator),this.updateTooltip()}}_openContextMenu(){this._contextMenuService.showContextMenu({getAnchor:()=>this.element,getActions:()=>this._actions,getActionsContext:()=>this.label})}};function Bl(o,e,t,i){if(!e||!e.title)return"";const n=H.kS.isThemeIcon(e.icon)?e.icon.id:o.get(k.if).getDefaultIcon(),r=`$(${i?.id||n}) ${Ss(e,t)}`,s=e.statusList.primary;return s?.icon?`${r} $(${s.icon.id})`:r}function Ss(o,e){return o?o.description?`${o.title} ${e} ${o.description}`:o.title:""}Kr=(0,c.gn)([(0,c.fM)(2,ri.d),(0,c.fM)(3,R.lT),(0,c.fM)(4,g.i6),(0,c.fM)(5,me.XE),(0,c.fM)(6,M.x4),(0,c.fM)(7,M.Qy),(0,c.fM)(8,$e.i),(0,c.fM)(9,se.H),(0,c.fM)(10,G.TG)],Kr);let Qr=class extends me.bB{constructor(e,t,i,n){super(t),this._themeService=t,this._terminalService=i,this._terminalGroupService=n,this._registerListeners(),this._styleElement=document.createElement("style"),e.appendChild(this._styleElement),this._register((0,A.OF)(()=>e.removeChild(this._styleElement))),this.updateStyles()}_registerListeners(){this._register(this._terminalService.onDidChangeInstanceIcon(()=>this.updateStyles())),this._register(this._terminalService.onDidChangeInstanceColor(()=>this.updateStyles())),this._register(this._terminalService.onDidChangeInstances(()=>this.updateStyles())),this._register(this._terminalGroupService.onDidChangeGroups(()=>this.updateStyles()))}updateStyles(){super.updateStyles();const e=this._themeService.getColorTheme();let t="";for(const i of this._terminalService.instances){const n=i.icon;if(!n)continue;let r;n instanceof N.ov?r=n:n instanceof Object&&"light"in n&&"dark"in n&&(r=e.type===mo.eL.LIGHT?n.light:n.dark);const s=(0,ae.A5)(i,e.type);r instanceof N.ov&&s&&s.length>1&&(t+=`.monaco-workbench .${s[0]} .monaco-highlighted-label .codicon, .monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon{background-image: ${S.wY(r)};}`)}for(const i of this._terminalService.instances){const n=(0,ae.pv)(i);if(!n||!i.color)continue;const r=e.getColor(i.color);r&&(t+=`.monaco-workbench .${n} .codicon:first-child:not(.codicon-split-horizontal):not(.codicon-trashcan):not(.file-icon){ color: ${r} !important; }`)}this._styleElement.textContent=t}};Qr=(0,c.gn)([(0,c.fM)(1,me.XE),(0,c.fM)(2,M.x4),(0,c.fM)(3,M.Qy)],Qr);var Vl=p(48780),$l=p(70958);const Cs="\n- "+["`${cwd}`: "+(0,a.NC)("cwd","the terminal's current working directory"),"`${cwdFolder}`: "+(0,a.NC)("cwdFolder","the terminal's current working directory, displayed for multi-root workspaces or in a single root workspace when the value differs from the initial working directory. On Windows, this will only be displayed when shell integration is enabled."),"`${workspaceFolder}`: "+(0,a.NC)("workspaceFolder","the workspace in which the terminal was launched"),"`${local}`: "+(0,a.NC)("local","indicates a local terminal in a remote workspace"),"`${process}`: "+(0,a.NC)("process","the name of the terminal process"),"`${separator}`: "+(0,a.NC)("separator","a conditional separator {0} that only shows when surrounded by variables with values or static text.","(` - `)"),"`${sequence}`: "+(0,a.NC)("sequence","the name provided to the terminal by the process"),"`${task}`: "+(0,a.NC)("task","indicates this terminal is associated with a task")].join("\n- ");let ys=(0,a.NC)("terminalTitle","Controls the terminal title. Variables are substituted based on the context:");ys+=Cs;let xs=(0,a.NC)("terminalDescription","Controls the terminal description, which appears to the right of the title. Variables are substituted based on the context:");xs+=Cs;const Gl={id:"terminal",order:100,title:(0,a.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.sendKeybindingsToShell":{markdownDescription:(0,a.NC)("terminal.integrated.sendKeybindingsToShell","Dispatches most keybindings to the terminal instead of the workbench, overriding {0}, which can be used alternatively for fine tuning.","`#terminal.integrated.commandsToSkipShell#`"),type:"boolean",default:!1},"terminal.integrated.tabs.defaultColor":{description:(0,a.NC)("terminal.integrated.tabs.defaultColor","A theme color ID to associate with terminal icons by default."),...rs,scope:4},"terminal.integrated.tabs.defaultIcon":{description:(0,a.NC)("terminal.integrated.tabs.defaultIcon","A codicon ID to associate with terminal icons by default."),...os,default:E.lA.terminal.id,scope:4},"terminal.integrated.tabs.enabled":{description:(0,a.NC)("terminal.integrated.tabs.enabled","Controls whether terminal tabs display as a list to the side of the terminal. When this is disabled a dropdown will display instead."),type:"boolean",default:!0},"terminal.integrated.tabs.enableAnimation":{description:(0,a.NC)("terminal.integrated.tabs.enableAnimation","Controls whether terminal tab statuses support animation (eg. in progress tasks)."),type:"boolean",default:!0},"terminal.integrated.tabs.hideCondition":{description:(0,a.NC)("terminal.integrated.tabs.hideCondition","Controls whether the terminal tabs view will hide under certain conditions."),type:"string",enum:["never","singleTerminal","singleGroup"],enumDescriptions:[(0,a.NC)("terminal.integrated.tabs.hideCondition.never","Never hide the terminal tabs view"),(0,a.NC)("terminal.integrated.tabs.hideCondition.singleTerminal","Hide the terminal tabs view when there is only a single terminal opened"),(0,a.NC)("terminal.integrated.tabs.hideCondition.singleGroup","Hide the terminal tabs view when there is only a single terminal group opened")],default:"singleTerminal"},"terminal.integrated.tabs.showActiveTerminal":{description:(0,a.NC)("terminal.integrated.tabs.showActiveTerminal","Shows the active terminal information in the view. This is particularly useful when the title within the tabs aren't visible."),type:"string",enum:["always","singleTerminal","singleTerminalOrNarrow","never"],enumDescriptions:[(0,a.NC)("terminal.integrated.tabs.showActiveTerminal.always","Always show the active terminal"),(0,a.NC)("terminal.integrated.tabs.showActiveTerminal.singleTerminal","Show the active terminal when it is the only terminal opened"),(0,a.NC)("terminal.integrated.tabs.showActiveTerminal.singleTerminalOrNarrow","Show the active terminal when it is the only terminal opened or when the tabs view is in its narrow textless state"),(0,a.NC)("terminal.integrated.tabs.showActiveTerminal.never","Never show the active terminal")],default:"singleTerminalOrNarrow"},"terminal.integrated.tabs.showActions":{description:(0,a.NC)("terminal.integrated.tabs.showActions","Controls whether terminal split and kill buttons are displays next to the new terminal button."),type:"string",enum:["always","singleTerminal","singleTerminalOrNarrow","never"],enumDescriptions:[(0,a.NC)("terminal.integrated.tabs.showActions.always","Always show the actions"),(0,a.NC)("terminal.integrated.tabs.showActions.singleTerminal","Show the actions when it is the only terminal opened"),(0,a.NC)("terminal.integrated.tabs.showActions.singleTerminalOrNarrow","Show the actions when it is the only terminal opened or when the tabs view is in its narrow textless state"),(0,a.NC)("terminal.integrated.tabs.showActions.never","Never show the actions")],default:"singleTerminalOrNarrow"},"terminal.integrated.tabs.location":{type:"string",enum:["left","right"],enumDescriptions:[(0,a.NC)("terminal.integrated.tabs.location.left","Show the terminal tabs view to the left of the terminal"),(0,a.NC)("terminal.integrated.tabs.location.right","Show the terminal tabs view to the right of the terminal")],default:"right",description:(0,a.NC)("terminal.integrated.tabs.location","Controls the location of the terminal tabs, either to the left or right of the actual terminal(s).")},"terminal.integrated.tabFocusMode":{markdownDescription:(0,a.NC)("tabFocusMode","Controls whether the terminal receives tabs or defers them to the workbench for navigation. When set, this overrides {0} when the terminal is focused.","`#editor.tabFocusMode#`"),type:["boolean","null"],default:null},"terminal.integrated.defaultLocation":{type:"string",enum:["editor","view"],enumDescriptions:[(0,a.NC)("terminal.integrated.defaultLocation.editor","Create terminals in the editor"),(0,a.NC)("terminal.integrated.defaultLocation.view","Create terminals in the terminal view")],default:"view",description:(0,a.NC)("terminal.integrated.defaultLocation","Controls where newly created terminals will appear.")},"terminal.integrated.tabs.focusMode":{type:"string",enum:["singleClick","doubleClick"],enumDescriptions:[(0,a.NC)("terminal.integrated.tabs.focusMode.singleClick","Focus the terminal when clicking a terminal tab"),(0,a.NC)("terminal.integrated.tabs.focusMode.doubleClick","Focus the terminal when double-clicking a terminal tab")],default:"doubleClick",description:(0,a.NC)("terminal.integrated.tabs.focusMode","Controls whether focusing the terminal of a tab happens on double or single click.")},"terminal.integrated.macOptionIsMeta":{description:(0,a.NC)("terminal.integrated.macOptionIsMeta","Controls whether to treat the option key as the meta key in the terminal on macOS."),type:"boolean",default:!1},"terminal.integrated.macOptionClickForcesSelection":{description:(0,a.NC)("terminal.integrated.macOptionClickForcesSelection","Controls whether to force selection when using Option+click on macOS. This will force a regular (line) selection and disallow the use of column selection mode. This enables copying and pasting using the regular terminal selection, for example, when mouse mode is enabled in tmux."),type:"boolean",default:!1},"terminal.integrated.altClickMovesCursor":{markdownDescription:(0,a.NC)("terminal.integrated.altClickMovesCursor","If enabled, alt/option + click will reposition the prompt cursor to underneath the mouse when {0} is set to {1} (the default value). This may not work reliably depending on your shell.","`#editor.multiCursorModifier#`","`'alt'`"),type:"boolean",default:!0},"terminal.integrated.copyOnSelection":{description:(0,a.NC)("terminal.integrated.copyOnSelection","Controls whether text selected in the terminal will be copied to the clipboard."),type:"boolean",default:!1},"terminal.integrated.enableMultiLinePasteWarning":{markdownDescription:(0,a.NC)("terminal.integrated.enableMultiLinePasteWarning","Show a warning dialog when pasting multiple lines into the terminal. The dialog does not show when:\n\n- Bracketed paste mode is enabled (the shell supports multi-line paste natively)\n- The paste is handled by the shell's readline (in the case of pwsh)"),type:"boolean",default:!0},"terminal.integrated.drawBoldTextInBrightColors":{description:(0,a.NC)("terminal.integrated.drawBoldTextInBrightColors",'Controls whether bold text in the terminal will always use the "bright" ANSI color variant.'),type:"boolean",default:!0},"terminal.integrated.fontFamily":{markdownDescription:(0,a.NC)("terminal.integrated.fontFamily","Controls the font family of the terminal. Defaults to {0}'s value.","`#editor.fontFamily#`"),type:"string"},"terminal.integrated.fontSize":{description:(0,a.NC)("terminal.integrated.fontSize","Controls the font size in pixels of the terminal."),type:"number",default:T.dz?12:14,minimum:6,maximum:100},"terminal.integrated.letterSpacing":{description:(0,a.NC)("terminal.integrated.letterSpacing","Controls the letter spacing of the terminal. This is an integer value which represents the number of additional pixels to add between characters."),type:"number",default:k.dd},"terminal.integrated.lineHeight":{description:(0,a.NC)("terminal.integrated.lineHeight","Controls the line height of the terminal. This number is multiplied by the terminal font size to get the actual line-height in pixels."),type:"number",default:k.fr},"terminal.integrated.minimumContrastRatio":{markdownDescription:(0,a.NC)("terminal.integrated.minimumContrastRatio","When set, the foreground color of each cell will change to try meet the contrast ratio specified. Note that this will not apply to `powerline` characters per #146406. Example values:\n\n- 1: Do nothing and use the standard theme colors.\n- 4.5: [WCAG AA compliance (minimum)](https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html) (default).\n- 7: [WCAG AAA compliance (enhanced)](https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast7.html).\n- 21: White on black or black on white."),type:"number",default:4.5,tags:["accessibility"]},"terminal.integrated.tabStopWidth":{markdownDescription:(0,a.NC)("terminal.integrated.tabStopWidth","The number of cells in a tab stop."),type:"number",minimum:1,default:8},"terminal.integrated.fastScrollSensitivity":{markdownDescription:(0,a.NC)("terminal.integrated.fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`."),type:"number",default:5},"terminal.integrated.mouseWheelScrollSensitivity":{markdownDescription:(0,a.NC)("terminal.integrated.mouseWheelScrollSensitivity","A multiplier to be used on the `deltaY` of mouse wheel scroll events."),type:"number",default:1},"terminal.integrated.bellDuration":{markdownDescription:(0,a.NC)("terminal.integrated.bellDuration","The number of milliseconds to show the bell within a terminal tab when triggered."),type:"number",default:1e3},"terminal.integrated.fontWeight":{anyOf:[{type:"number",minimum:k.fc,maximum:k.ig,errorMessage:(0,a.NC)("terminal.integrated.fontWeightError",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:k.oE}],description:(0,a.NC)("terminal.integrated.fontWeight",'The font weight to use within the terminal for non-bold text. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.'),default:"normal"},"terminal.integrated.fontWeightBold":{anyOf:[{type:"number",minimum:k.fc,maximum:k.ig,errorMessage:(0,a.NC)("terminal.integrated.fontWeightError",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:k.oE}],description:(0,a.NC)("terminal.integrated.fontWeightBold",'The font weight to use within the terminal for bold text. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.'),default:"bold"},"terminal.integrated.cursorBlinking":{description:(0,a.NC)("terminal.integrated.cursorBlinking","Controls whether the terminal cursor blinks."),type:"boolean",default:!1},"terminal.integrated.cursorStyle":{description:(0,a.NC)("terminal.integrated.cursorStyle","Controls the style of terminal cursor."),enum:[k.CW.BLOCK,k.CW.LINE,k.CW.UNDERLINE],default:k.CW.BLOCK},"terminal.integrated.cursorWidth":{markdownDescription:(0,a.NC)("terminal.integrated.cursorWidth","Controls the width of the cursor when {0} is set to {1}.","`#terminal.integrated.cursorStyle#`","`line`"),type:"number",default:1},"terminal.integrated.scrollback":{description:(0,a.NC)("terminal.integrated.scrollback","Controls the maximum number of lines the terminal keeps in its buffer. We pre-allocate memory based on this value in order to ensure a smooth experience. As such, as the value increases, so will the amount of memory."),type:"number",default:1e3},"terminal.integrated.detectLocale":{markdownDescription:(0,a.NC)("terminal.integrated.detectLocale","Controls whether to detect and set the `$LANG` environment variable to a UTF-8 compliant option since VS Code's terminal only supports UTF-8 encoded data coming from the shell."),type:"string",enum:["auto","off","on"],markdownEnumDescriptions:[(0,a.NC)("terminal.integrated.detectLocale.auto","Set the `$LANG` environment variable if the existing variable does not exist or it does not end in `'.UTF-8'`."),(0,a.NC)("terminal.integrated.detectLocale.off","Do not set the `$LANG` environment variable."),(0,a.NC)("terminal.integrated.detectLocale.on","Always set the `$LANG` environment variable.")],default:"auto"},"terminal.integrated.gpuAcceleration":{type:"string",enum:["auto","on","off","canvas"],markdownEnumDescriptions:[(0,a.NC)("terminal.integrated.gpuAcceleration.auto","Let VS Code detect which renderer will give the best experience."),(0,a.NC)("terminal.integrated.gpuAcceleration.on","Enable GPU acceleration within the terminal."),(0,a.NC)("terminal.integrated.gpuAcceleration.off","Disable GPU acceleration within the terminal. The terminal will render much slower when GPU acceleration is off but it should reliably work on all systems."),(0,a.NC)("terminal.integrated.gpuAcceleration.canvas","Use the terminal's fallback canvas renderer which uses a 2d context instead of webgl which may perform better on some systems. Note that some features are limited in the canvas renderer like opaque selection.")],default:"auto",description:(0,a.NC)("terminal.integrated.gpuAcceleration","Controls whether the terminal will leverage the GPU to do its rendering.")},"terminal.integrated.tabs.separator":{type:"string",default:" - ",markdownDescription:(0,a.NC)("terminal.integrated.tabs.separator","Separator used by {0} and {0}.","`terminal.integrated.tabs.title`","`terminal.integrated.tabs.description`")},"terminal.integrated.tabs.title":{type:"string",default:"${process}",markdownDescription:ys},"terminal.integrated.tabs.description":{type:"string",default:"${task}${separator}${local}${separator}${cwdFolder}",markdownDescription:xs},"terminal.integrated.rightClickBehavior":{type:"string",enum:["default","copyPaste","paste","selectWord","nothing"],enumDescriptions:[(0,a.NC)("terminal.integrated.rightClickBehavior.default","Show the context menu."),(0,a.NC)("terminal.integrated.rightClickBehavior.copyPaste","Copy when there is a selection, otherwise paste."),(0,a.NC)("terminal.integrated.rightClickBehavior.paste","Paste on right click."),(0,a.NC)("terminal.integrated.rightClickBehavior.selectWord","Select the word under the cursor and show the context menu."),(0,a.NC)("terminal.integrated.rightClickBehavior.nothing","Do nothing and pass event to terminal.")],default:T.dz?"selectWord":T.ED?"copyPaste":"default",description:(0,a.NC)("terminal.integrated.rightClickBehavior","Controls how terminal reacts to right click.")},"terminal.integrated.cwd":{restricted:!0,description:(0,a.NC)("terminal.integrated.cwd","An explicit start path where the terminal will be launched, this is used as the current working directory (cwd) for the shell process. This may be particularly useful in workspace settings if the root directory is not a convenient cwd."),type:"string",default:void 0,scope:4},"terminal.integrated.confirmOnExit":{description:(0,a.NC)("terminal.integrated.confirmOnExit","Controls whether to confirm when the window closes if there are active terminal sessions."),type:"string",enum:["never","always","hasChildProcesses"],enumDescriptions:[(0,a.NC)("terminal.integrated.confirmOnExit.never","Never confirm."),(0,a.NC)("terminal.integrated.confirmOnExit.always","Always confirm if there are terminals."),(0,a.NC)("terminal.integrated.confirmOnExit.hasChildProcesses","Confirm if there are any terminals that have child processes.")],default:"never"},"terminal.integrated.confirmOnKill":{description:(0,a.NC)("terminal.integrated.confirmOnKill","Controls whether to confirm killing terminals when they have child processes. When set to editor, terminals in the editor area will be marked as changed when they have child processes. Note that child process detection may not work well for shells like Git Bash which don't run their processes as child processes of the shell."),type:"string",enum:["never","editor","panel","always"],enumDescriptions:[(0,a.NC)("terminal.integrated.confirmOnKill.never","Never confirm."),(0,a.NC)("terminal.integrated.confirmOnKill.editor","Confirm if the terminal is in the editor."),(0,a.NC)("terminal.integrated.confirmOnKill.panel","Confirm if the terminal is in the panel."),(0,a.NC)("terminal.integrated.confirmOnKill.always","Confirm if the terminal is either in the editor or panel.")],default:"editor"},"terminal.integrated.enableBell":{description:(0,a.NC)("terminal.integrated.enableBell","Controls whether the terminal bell is enabled. This shows up as a visual bell next to the terminal's name."),type:"boolean",default:!1},"terminal.integrated.commandsToSkipShell":{markdownDescription:(0,a.NC)("terminal.integrated.commandsToSkipShell","A set of command IDs whose keybindings will not be sent to the shell but instead always be handled by VS Code. This allows keybindings that would normally be consumed by the shell to act instead the same as when the terminal is not focused, for example `Ctrl+P` to launch Quick Open.\n\n&nbsp;\n\nMany commands are skipped by default. To override a default and pass that command's keybinding to the shell instead, add the command prefixed with the `-` character. For example add `-workbench.action.quickOpen` to allow `Ctrl+P` to reach the shell.\n\n&nbsp;\n\nThe following list of default skipped commands is truncated when viewed in Settings Editor. To see the full list, {1} and search for the first command from the list below.\n\n&nbsp;\n\nDefault Skipped Commands:\n\n{0}",k.Vq.sort().map(o=>`- ${o}`).join("\n"),`[${(0,a.NC)("openDefaultSettingsJson","open the default settings JSON")}](command:workbench.action.openRawDefaultSettings '${(0,a.NC)("openDefaultSettingsJson.capitalized","Open Default Settings (JSON)")}')`),type:"array",items:{type:"string"},default:[]},"terminal.integrated.allowChords":{markdownDescription:(0,a.NC)("terminal.integrated.allowChords","Whether or not to allow chord keybindings in the terminal. Note that when this is true and the keystroke results in a chord it will bypass {0}, setting this to false is particularly useful when you want ctrl+k to go to your shell (not VS Code).","`#terminal.integrated.commandsToSkipShell#`"),type:"boolean",default:!0},"terminal.integrated.allowMnemonics":{markdownDescription:(0,a.NC)("terminal.integrated.allowMnemonics","Whether to allow menubar mnemonics (for example Alt+F) to trigger the open of the menubar. Note that this will cause all alt keystrokes to skip the shell when true. This does nothing on macOS."),type:"boolean",default:!1},"terminal.integrated.env.osx":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.env.osx","Object with environment variables that will be added to the VS Code process to be used by the terminal on macOS. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.env.linux":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.env.linux","Object with environment variables that will be added to the VS Code process to be used by the terminal on Linux. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.env.windows":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.env.windows","Object with environment variables that will be added to the VS Code process to be used by the terminal on Windows. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.environmentChangesIndicator":{markdownDescription:(0,a.NC)("terminal.integrated.environmentChangesIndicator","Whether to display the environment changes indicator on each terminal which explains whether extensions have made, or want to make changes to the terminal's environment."),type:"string",enum:["off","on","warnonly"],enumDescriptions:[(0,a.NC)("terminal.integrated.environmentChangesIndicator.off","Disable the indicator."),(0,a.NC)("terminal.integrated.environmentChangesIndicator.on","Enable the indicator."),(0,a.NC)("terminal.integrated.environmentChangesIndicator.warnonly","Only show the warning indicator when a terminal's environment is 'stale', not the information indicator that shows a terminal has had its environment modified by an extension.")],default:"warnonly"},"terminal.integrated.environmentChangesRelaunch":{markdownDescription:(0,a.NC)("terminal.integrated.environmentChangesRelaunch","Whether to relaunch terminals automatically if extension want to contribute to their environment and have not been interacted with yet."),type:"boolean",default:!0},"terminal.integrated.showExitAlert":{description:(0,a.NC)("terminal.integrated.showExitAlert",'Controls whether to show the alert "The terminal process terminated with exit code" when exit code is non-zero.'),type:"boolean",default:!0},"terminal.integrated.splitCwd":{description:(0,a.NC)("terminal.integrated.splitCwd","Controls the working directory a split terminal starts with."),type:"string",enum:["workspaceRoot","initial","inherited"],enumDescriptions:[(0,a.NC)("terminal.integrated.splitCwd.workspaceRoot","A new split terminal will use the workspace root as the working directory. In a multi-root workspace a choice for which root folder to use is offered."),(0,a.NC)("terminal.integrated.splitCwd.initial","A new split terminal will use the working directory that the parent terminal started with."),(0,a.NC)("terminal.integrated.splitCwd.inherited","On macOS and Linux, a new split terminal will use the working directory of the parent terminal. On Windows, this behaves the same as initial.")],default:"inherited"},"terminal.integrated.windowsEnableConpty":{description:(0,a.NC)("terminal.integrated.windowsEnableConpty","Whether to use ConPTY for Windows terminal process communication (requires Windows 10 build number 18309+). Winpty will be used if this is false."),type:"boolean",default:!0},"terminal.integrated.wordSeparators":{description:(0,a.NC)("terminal.integrated.wordSeparators","A string containing all characters to be considered word separators by the double-click to select word feature."),type:"string",default:" ()[]{}',\"`\u2500\u2018\u2019|"},"terminal.integrated.enableFileLinks":{description:(0,a.NC)("terminal.integrated.enableFileLinks","Whether to enable file links in terminals. Links can be slow when working on a network drive in particular because each file link is verified against the file system. Changing this will take effect only in new terminals."),type:"string",enum:["off","on","notRemote"],enumDescriptions:[(0,a.NC)("enableFileLinks.off","Always off."),(0,a.NC)("enableFileLinks.on","Always on."),(0,a.NC)("enableFileLinks.notRemote","Enable only when not in a remote workspace.")],default:"on"},"terminal.integrated.unicodeVersion":{type:"string",enum:["6","11"],enumDescriptions:[(0,a.NC)("terminal.integrated.unicodeVersion.six","Version 6 of Unicode. This is an older version which should work better on older systems."),(0,a.NC)("terminal.integrated.unicodeVersion.eleven","Version 11 of Unicode. This version provides better support on modern systems that use modern versions of Unicode.")],default:"11",description:(0,a.NC)("terminal.integrated.unicodeVersion","Controls what version of Unicode to use when evaluating the width of characters in the terminal. If you experience emoji or other wide characters not taking up the right amount of space or backspace either deleting too much or too little then you may want to try tweaking this setting.")},"terminal.integrated.localEchoLatencyThreshold":{description:(0,a.NC)("terminal.integrated.localEchoLatencyThreshold","Length of network delay, in milliseconds, where local edits will be echoed on the terminal without waiting for server acknowledgement. If '0', local echo will always be on, and if '-1' it will be disabled."),type:"integer",minimum:-1,default:30},"terminal.integrated.localEchoEnabled":{markdownDescription:(0,a.NC)("terminal.integrated.localEchoEnabled","When local echo should be enabled. This will override {0}","`#terminal.integrated.localEchoLatencyThreshold#`"),type:"string",enum:["on","off","auto"],enumDescriptions:[(0,a.NC)("terminal.integrated.localEchoEnabled.on","Always enabled"),(0,a.NC)("terminal.integrated.localEchoEnabled.off","Always disabled"),(0,a.NC)("terminal.integrated.localEchoEnabled.auto","Enabled only for remote workspaces")],default:"auto"},"terminal.integrated.localEchoExcludePrograms":{description:(0,a.NC)("terminal.integrated.localEchoExcludePrograms","Local echo will be disabled when any of these program names are found in the terminal title."),type:"array",items:{type:"string",uniqueItems:!0},default:k.gM},"terminal.integrated.localEchoStyle":{description:(0,a.NC)("terminal.integrated.localEchoStyle","Terminal style of locally echoed text; either a font style or an RGB color."),default:"dim",oneOf:[{type:"string",default:"dim",enum:["bold","dim","italic","underlined","inverted"]},{type:"string",format:"color-hex",default:"#ff0000"}]},"terminal.integrated.enablePersistentSessions":{description:(0,a.NC)("terminal.integrated.enablePersistentSessions","Persist terminal sessions/history for the workspace across window reloads."),type:"boolean",default:!0},"terminal.integrated.persistentSessionReviveProcess":{markdownDescription:(0,a.NC)("terminal.integrated.persistentSessionReviveProcess","When the terminal process must be shut down (for example on window or application close), this determines when the previous terminal session contents/history should be restored and processes be recreated when the workspace is next opened.\n\nCaveats:\n\n- Restoring of the process current working directory depends on whether it is supported by the shell.\n- Time to persist the session during shutdown is limited, so it may be aborted when using high-latency remote connections."),type:"string",enum:["onExit","onExitAndWindowClose","never"],markdownEnumDescriptions:[(0,a.NC)("terminal.integrated.persistentSessionReviveProcess.onExit","Revive the processes after the last window is closed on Windows/Linux or when the `workbench.action.quit` command is triggered (command palette, keybinding, menu)."),(0,a.NC)("terminal.integrated.persistentSessionReviveProcess.onExitAndWindowClose","Revive the processes after the last window is closed on Windows/Linux or when the `workbench.action.quit` command is triggered (command palette, keybinding, menu), or when the window is closed."),(0,a.NC)("terminal.integrated.persistentSessionReviveProcess.never","Never restore the terminal buffers or recreate the process.")],default:"onExit"},"terminal.integrated.customGlyphs":{description:(0,a.NC)("terminal.integrated.customGlyphs","Whether to draw custom glyphs for block element and box drawing characters instead of using the font, which typically yields better rendering with continuous lines. Note that this doesn't work when {0} is disabled.","`#terminal.integrated.gpuAcceleration#`"),type:"boolean",default:!0},"terminal.integrated.autoReplies":{markdownDescription:(0,a.NC)("terminal.integrated.autoReplies","A set of messages that, when encountered in the terminal, will be automatically responded to. Provided the message is specific enough, this can help automate away common responses.\n\nRemarks:\n\n- Use {0} to automatically respond to the terminate batch job prompt on Windows.\n- The message includes escape sequences so the reply might not happen with styled text.\n- Each reply can only happen once every second.\n- Use {1} in the reply to mean the enter key.\n- To unset a default key, set the value to null.\n- Restart VS Code if new don't apply.",'`"Terminate batch job (Y/N)": "Y\\r"`','`"\\r"`'),type:"object",additionalProperties:{oneOf:[{type:"string",description:(0,a.NC)("terminal.integrated.autoReplies.reply","The reply to send to the process.")},{type:"null"}]},default:{}},"terminal.integrated.shellIntegration.enabled":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellIntegration.enabled","Determines whether or not shell integration is auto-injected to support features like enhanced command tracking and current working directory detection. \n\nShell integration works by injecting the shell with a startup script. The script gives VS Code insight into what is happening within the terminal.\n\nSupported shells:\n\n- Linux/macOS: bash, fish, pwsh, zsh\n - Windows: pwsh\n\nThis setting applies only when terminals are created, so you will need to restart your terminals for it to take effect.\n\n Note that the script injection may not work if you have custom arguments defined in the terminal profile, have enabled {1}, have a [complex bash `PROMPT_COMMAND`](https://code.visualstudio.com/docs/editor/integrated-terminal#_complex-bash-promptcommand), or other unsupported setup. To disable decorations, see {0}","`#terminal.integrated.shellIntegrations.decorationsEnabled#`","`#editor.accessibilitySupport#`"),type:"boolean",default:!0},"terminal.integrated.shellIntegration.decorationsEnabled":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellIntegration.decorationsEnabled","When shell integration is enabled, adds a decoration for each command."),type:"string",enum:["both","gutter","overviewRuler","never"],enumDescriptions:[(0,a.NC)("terminal.integrated.shellIntegration.decorationsEnabled.both","Show decorations in the gutter (left) and overview ruler (right)"),(0,a.NC)("terminal.integrated.shellIntegration.decorationsEnabled.gutter","Show gutter decorations to the left of the terminal"),(0,a.NC)("terminal.integrated.shellIntegration.decorationsEnabled.overviewRuler","Show overview ruler decorations to the right of the terminal"),(0,a.NC)("terminal.integrated.shellIntegration.decorationsEnabled.never","Do not show decorations")],default:"both"},"terminal.integrated.shellIntegration.history":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellIntegration.history","Controls the number of recently used commands to keep in the terminal command history. Set to 0 to disable terminal command history."),type:"number",default:100},"terminal.integrated.shellIntegration.suggestEnabled":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.shellIntegration.suggestEnabled","Enables experimental terminal Intellisense suggestions for supported shells when {0} is set to {1}. If shell integration is installed manually, {2} needs to be set to {3} before calling the script.","`#terminal.integrated.shellIntegration.enabled#`","`true`","`VSCODE_SUGGEST`","`1`"),type:"boolean",default:!1,tags:["experimental"]},"terminal.integrated.smoothScrolling":{markdownDescription:(0,a.NC)("terminal.integrated.smoothScrolling","Controls whether the terminal will scroll using an animation."),type:"boolean",default:!1},"terminal.integrated.experimentalImageSupport":{restricted:!0,markdownDescription:(0,a.NC)("terminal.integrated.experimentalImageSupport","Enables experimental image support in the terminal. Both sixel and iTerm's inline image protocol are supported on Linux and macOS, Windows support will light up automatically when ConPTY passes through the sequences. Images will not be retained currently between window reloads/reconnects."),type:"boolean",default:!1,tags:["experimental"]}}};var Zl=p(48982),Ul=p(73533),Kl=p(18323);let jr=class extends Kl.J{constructor(e,t,i,n,r,s,l,d,h,f,v,b,_){super(M.VR,e,t,i),this._terminalEditorService=n,this._terminalProfileResolverService=r,this._terminalService=s,this._instantiationService=h,this._contextMenuService=f,this._notificationService=v,this._terminalProfileService=b,this._workbenchLayoutService=_,this._editorInput=void 0,this._cancelContextMenu=!1,this._dropdownMenu=this._register(d.createMenu(x.eH.TerminalNewDropdownContext,l)),this._instanceMenu=this._register(d.createMenu(x.eH.TerminalEditorInstanceContext,l))}setInput(e,t,i,n){var r=()=>super.setInput,s=this;return(0,u.Z)(function*(){s._editorInput?.terminalInstance?.detachFromElement(),s._editorInput=e,yield r().call(s,e,t,i,n),s._editorInput.terminalInstance?.attachToElement(s._overflowGuardElement),s._lastDimension&&s.layout(s._lastDimension),s._editorInput.terminalInstance?.setVisible(s.isVisible()&&s._workbenchLayoutService.isVisible("workbench.parts.editor")),s._editorInput.terminalInstance&&(s._register(s._editorInput.terminalInstance.onDidFocus(()=>s._setActiveInstance())),s._editorInput.setCopyLaunchConfig(s._editorInput.terminalInstance.shellLaunchConfig))})()}clearInput(){super.clearInput(),this._editorInput?.terminalInstance?.detachFromElement(),this._editorInput=void 0}_setActiveInstance(){this._editorInput?.terminalInstance&&this._terminalEditorService.setActiveInstance(this._editorInput.terminalInstance)}focus(){this._editorInput?.terminalInstance?.focus()}createEditor(e){this._editorInstanceElement=e,this._overflowGuardElement=S.$(".terminal-overflow-guard"),this._editorInstanceElement.appendChild(this._overflowGuardElement),this._registerListeners()}_registerListeners(){var e=this;this._editorInstanceElement&&(this._register(S.nm(this._editorInstanceElement,"mousedown",function(){var t=(0,u.Z)(function*(i){if(0!==e._terminalEditorService.instances.length)if(2===i.which&&T.IJ)e._terminalEditorService.activeInstance?.focus();else if(3===i.which){const n=e._terminalService.configHelper.config.rightClickBehavior;if("nothing"===n)return void(i.shiftKey||(e._cancelContextMenu=!0));if("copyPaste"===n||"paste"===n){const r=e._terminalEditorService.activeInstance;if(!r)return;if("copyPaste"===n&&i.shiftKey)return void di(i,e._editorInstanceElement,e._instanceMenu,e._contextMenuService);"copyPaste"===n&&r.hasSelection()?(yield r.copySelection(),r.clearSelection()):bt.D.clipboard.readText?r.paste():e._notificationService.info(`This browser doesn't support the clipboard.readText API needed to trigger a paste, try ${T.dz?"\u2318":"Ctrl"}+V instead.`),T.dz&&setTimeout(()=>{r.clearSelection()},0),e._cancelContextMenu=!0}}});return function(i){return t.apply(this,arguments)}}())),this._register(S.nm(this._editorInstanceElement,"contextmenu",t=>{const i=this._terminalService.configHelper.config.rightClickBehavior;if("nothing"===i&&!t.shiftKey)return t.preventDefault(),t.stopImmediatePropagation(),void(this._cancelContextMenu=!1);!this._cancelContextMenu&&"copyPaste"!==i&&"paste"!==i&&(this._cancelContextMenu||di(t,this._editorInstanceElement,this._instanceMenu,this._contextMenuService),t.preventDefault(),t.stopImmediatePropagation(),this._cancelContextMenu=!1)})))}layout(e){this._editorInput?.terminalInstance?.layout(e),this._lastDimension=e}setVisible(e,t){super.setVisible(e,t),this._editorInput?.terminalInstance?.setVisible(e&&this._workbenchLayoutService.isVisible("workbench.parts.editor"))}getActionViewItem(e){if("workbench.action.createTerminalEditor"===e.id&&e instanceof x.U8){const i=zr({viewColumn:Se.LP},this._terminalProfileService.availableProfiles,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);return this._instantiationService.createInstance(_s.C,e,i.dropdownAction,i.dropdownMenuActions,i.className,this._contextMenuService,{})}return super.getActionViewItem(e)}_getDefaultProfileName(){let e;try{e=this._terminalProfileService.getDefaultProfileName()}catch{e=this._terminalProfileResolverService.defaultProfileName}return e}};jr=(0,c.gn)([(0,c.fM)(0,je.bU),(0,c.fM)(1,me.XE),(0,c.fM)(2,He.Uy),(0,c.fM)(3,M.BZ),(0,c.fM)(4,k.if),(0,c.fM)(5,M.x4),(0,c.fM)(6,g.i6),(0,c.fM)(7,x.co),(0,c.fM)(8,G.TG),(0,c.fM)(9,$e.i),(0,c.fM)(10,R.lT),(0,c.fM)(11,k.l5),(0,c.fM)(12,Vi.z)],jr);var Ql=p(94014),Is=p(742),jl=p(39569);let qr=class extends A.JT{constructor(e,t,i,n,r,s,l){var d;super(),e.registerEditor(`${J.lg.vscodeTerminal}:/**`,{id:M.VR,label:P.terminal,priority:Is.OP.exclusive},{canSupportResource:d=>d.scheme===J.lg.vscodeTerminal,singlePerResource:!0},{createEditorInput:(d=(0,u.Z)(function*({resource:h,options:f}){let v=n.getInstanceFromResource(h);if(v)s.getGroupForInstance(v)?.removeInstance(v);else{const C=Vn(h);if(!C.instanceId)throw new Error("Terminal identifier without instanceId");const y=n.getPrimaryBackend();if(!y)throw new Error("No terminal primary backend");const I=yield y.requestDetachInstance(C.workspaceId,C.instanceId);if(!I)throw new Error("No terminal persistent process to attach");v=l.createInstance({attachPersistentProcess:I},D.i2.Editor)}const b=r.resolveResource(v);return{editor:r.getInputFromResource(b),options:{...f,pinned:!0,forceReload:!0,override:M.VR}}}),function(f){return d.apply(this,arguments)})}),i.registerFormatter({scheme:J.lg.vscodeTerminal,formatting:{label:"${path}",separator:""}}),t.onDidCreateTerminal(function(){var d=(0,u.Z)(function*(h){const f=yield n.createTerminal({config:h,location:D.i2.Panel});n.setActiveInstance(f),yield n.revealActiveTerminal()});return function(h){return d.apply(this,arguments)}}())}};qr=(0,c.gn)([(0,c.fM)(0,Is.es),(0,c.fM)(1,jl.b),(0,c.fM)(2,ot.e),(0,c.fM)(3,M.x4),(0,c.fM)(4,M.BZ),(0,c.fM)(5,M.Qy),(0,c.fM)(6,M.N4)],qr),xe.B.as($l.IP.Quickaccess).registerQuickAccessProvider({ctor:wt,prefix:wt.PREFIX,contextKey:"inTerminalPicker",placeholder:a.NC("tasksQuickAccessPlaceholder","Type the name of a terminal to open."),helpEntries:[{description:a.NC("tasksQuickAccessHelp","Show All Opened Terminals"),commandId:"workbench.action.quickOpenTerm"}]});const ks="workbench.action.quickOpenNavigateNextInTerminalPicker";se.P.registerCommand({id:ks,handler:(0,ms.x8)(ks,!0)});const Ts="workbench.action.quickOpenNavigatePreviousInTerminalPicker";se.P.registerCommand({id:Ts,handler:(0,ms.x8)(Ts,!1)}),xe.B.as(Ql.I.Workbench).registerWorkbenchContribution(qr,3),function pl(){xe.B.as(Dr.IP.Configuration).registerConfiguration(gl),cs()}(),function zl(){xe.B.as(Dr.IP.Configuration).registerConfiguration(Gl)}(),xe.B.as(Zl.bS.EditorPane).registerEditorPane(Ul.gS.create(jr,M.VR,P.terminal),[new ue.M(ke.S)]),xe.B.as(Re.IP.DragAndDropContribution).register({dataFormatKey:"Terminals",getEditorInputs(o){const e=[];try{const t=JSON.parse(o);for(const i of t)e.push({resource:N.ov.parse(i)})}catch{}return e},setData(o,e){const t=o.filter(({resource:i})=>i.scheme===J.lg.vscodeTerminal);t.length&&e.dataTransfer?.setData("Terminals",JSON.stringify(t.map(({resource:i})=>i.toString())))}});const Jl=xe.B.as(Me.IP.ViewContainersRegistry).registerViewContainer({id:k.e9,title:a.NC("terminal","Terminal"),icon:go,ctorDescriptor:new ue.M(Vl.XV,[k.e9,{mergeViewWithContainerWhenSingleView:!0}]),storageId:k.e9,hideIfEmpty:!0,order:3},1,{doNotRegisterOpenCommand:!0,isDefault:!0});function fe(o,e){us.W.registerCommandAndKeybindingRule({id:"workbench.action.terminal.sendSequence",weight:200,when:e.when||m.r.focus,primary:e.primary,mac:e.mac,linux:e.linux,win:e.win,handler:yo,args:{text:o}})}xe.B.as(Me.IP.ViewsRegistry).registerViews([{id:k.e9,name:a.NC("terminal","Terminal"),containerIcon:go,canToggleVisibility:!1,canMoveView:!0,ctorDescriptor:new ue.M(Zr),openCommandActionDescriptor:{id:"workbench.action.terminal.toggleTerminal",mnemonicTitle:a.NC({key:"miToggleIntegratedTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal"),keybindings:{primary:2139,mac:{primary:347}},order:3}}],Jl),function oa(){var o;B({id:"workbench.action.terminal.newInActiveWorkspace",title:{value:(0,a.NC)("workbench.action.terminal.newInActiveWorkspace","Create New Terminal (In Active Workspace)"),original:"Create New Terminal (In Active Workspace)"},run:(o=(0,u.Z)(function*(e){if(e.service.isProcessSupportRegistered){const t=yield e.service.createTerminal({location:e.service.defaultLocation});if(!t)return;e.service.setActiveInstance(t)}yield e.groupService.showPanel(!0)}),function(t){return o.apply(this,arguments)})}),To([]),B({id:"workbench.action.createTerminalEditor",title:{value:(0,a.NC)("workbench.action.terminal.createTerminalEditor","Create New Terminal in Editor Area"),original:"Create New Terminal in Editor Area"},run:function(){var o=(0,u.Z)(function*(e,t,i){const n=(0,de.Kn)(i)&&"location"in i?i:{location:D.i2.Editor};(yield e.service.createTerminal(n)).focusWhenReady()});return function(t,i,n){return o.apply(this,arguments)}}()}),B({id:"workbench.action.createTerminalEditorSide",title:{value:(0,a.NC)("workbench.action.terminal.createTerminalEditorSide","Create New Terminal in Editor Area to the Side"),original:"Create New Terminal in Editor Area to the Side"},run:function(){var o=(0,u.Z)(function*(e){(yield e.service.createTerminal({location:{viewColumn:Se.O3}})).focusWhenReady()});return function(t){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.moveToEditor",title:P.moveToEditor,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.terminalEditorActive.toNegated(),m.r.viewShowing),run:(o,e)=>e.service.moveToEditor(o)}),B({id:"workbench.action.terminal.moveToEditorInstance",title:P.moveToEditor,f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),run:function(){var o=(0,u.Z)(function*(e,t){const i=Ve(t);if(i&&0!==i.length){for(const n of i)e.service.moveToEditor(n);i[i.length-1].focus()}});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.moveToTerminalPanel",title:P.moveToTerminalPanel,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.terminalEditorActive),run:(o,e,t)=>{const i=Ao(t)??o.editorService.activeInstance;i&&o.service.moveToTerminalView(i)}}),B({id:"workbench.action.terminal.showTabs",title:{value:(0,a.NC)("workbench.action.terminal.showTabs","Show Tabs"),original:"Show Tabs"},f1:!1,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.showTabs()}),B({id:"workbench.action.terminal.focusPreviousPane",title:{value:(0,a.NC)("workbench.action.terminal.focusPreviousPane","Focus Previous Terminal in Terminal Group"),original:"Focus Previous Terminal in Terminal Group"},keybinding:{primary:527,secondary:[528],mac:{primary:2575,secondary:[2576]},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e){e.groupService.activeGroup?.focusPreviousPane(),yield e.groupService.showPanel(!0)});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.focusNextPane",title:{value:(0,a.NC)("workbench.action.terminal.focusNextPane","Focus Next Terminal in Terminal Group"),original:"Focus Next Terminal in Terminal Group"},keybinding:{primary:529,secondary:[530],mac:{primary:2577,secondary:[2578]},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e){e.groupService.activeGroup?.focusNextPane(),yield e.groupService.showPanel(!0)});return function(t){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.runRecentCommand",title:{value:(0,a.NC)("workbench.action.terminal.runRecentCommand","Run Recent Command..."),original:"Run Recent Command..."},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:[{primary:2096,mac:{primary:304},when:g.Ao.and(m.r.focus,Ce.U),weight:200},{primary:2608,mac:{primary:816},when:g.Ao.and(m.r.focus,Ce.U.negate()),weight:200}],run:function(){var o=(0,u.Z)(function*(e,t){yield e.runRecent("command"),e?.target===D.i2.Editor?yield t.editorService.revealActiveEditor():yield t.groupService.showPanel(!1)});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.copyLastCommandOutput",title:{value:(0,a.NC)("workbench.action.terminal.copyLastCommand","Copy Last Command Output"),original:"Copy Last Command Output"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t,i){const n=i.get(pn.p),r=e.capabilities.get(2)?.commands;if(!r||0===r.length)return;const s=r[r.length-1];if(!s?.hasOutput())return;const l=s.getOutput();(0,de.HD)(l)&&(yield n.writeText(l))});return function(t,i,n){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.goToRecentDirectory",title:{value:(0,a.NC)("workbench.action.terminal.goToRecentDirectory","Go to Recent Directory..."),original:"Go to Recent Directory..."},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:{primary:2085,when:m.r.focus,weight:200},run:function(){var o=(0,u.Z)(function*(e,t){yield e.runRecent("cwd"),e?.target===D.i2.Editor?yield t.editorService.revealActiveEditor():yield t.groupService.showPanel(!1)});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.resizePaneLeft",title:{value:(0,a.NC)("workbench.action.terminal.resizePaneLeft","Resize Terminal Left"),original:"Resize Terminal Left"},keybinding:{linux:{primary:3087},mac:{primary:2319},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeGroup?.resizePane(0)}),B({id:"workbench.action.terminal.resizePaneRight",title:{value:(0,a.NC)("workbench.action.terminal.resizePaneRight","Resize Terminal Right"),original:"Resize Terminal Right"},keybinding:{linux:{primary:3089},mac:{primary:2321},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeGroup?.resizePane(1)}),B({id:"workbench.action.terminal.resizePaneUp",title:{value:(0,a.NC)("workbench.action.terminal.resizePaneUp","Resize Terminal Up"),original:"Resize Terminal Up"},keybinding:{mac:{primary:2320},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeGroup?.resizePane(2)}),B({id:"workbench.action.terminal.resizePaneDown",title:{value:(0,a.NC)("workbench.action.terminal.resizePaneDown","Resize Terminal Down"),original:"Resize Terminal Down"},keybinding:{mac:{primary:2322},when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeGroup?.resizePane(3)}),B({id:"workbench.action.terminal.focus",title:P.focus,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e){const t=e.service.activeInstance||(yield e.service.createTerminal({location:D.i2.Panel}));if(t)return e.service.setActiveInstance(t),e.groupService.showPanel(!0)});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.focusTabs",title:{value:(0,a.NC)("workbench.action.terminal.focus.tabsView","Focus Terminal Tabs View"),original:"Focus Terminal Tabs View"},keybinding:{primary:3165,weight:200,when:g.Ao.or(m.r.tabsFocus,m.r.focus)},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.focusTabs()}),B({id:"workbench.action.terminal.focusNext",title:{value:(0,a.NC)("workbench.action.terminal.focusNext","Focus Next Terminal Group"),original:"Focus Next Terminal Group"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:{primary:2060,mac:{primary:3166},when:g.Ao.and(m.r.focus,m.r.editorFocus.negate()),weight:200},run:function(){var o=(0,u.Z)(function*(e){e.groupService.setActiveGroupToNext(),yield e.groupService.showPanel(!0)});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.focusPrevious",title:{value:(0,a.NC)("workbench.action.terminal.focusPrevious","Focus Previous Terminal Group"),original:"Focus Previous Terminal Group"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:{primary:2059,mac:{primary:3164},when:g.Ao.and(m.r.focus,m.r.editorFocus.negate()),weight:200},run:function(){var o=(0,u.Z)(function*(e){e.groupService.setActiveGroupToPrevious(),yield e.groupService.showPanel(!0)});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.runSelectedText",title:{value:(0,a.NC)("workbench.action.terminal.runSelectedText","Run Selected Text In Active Terminal"),original:"Run Selected Text In Active Terminal"},run:function(){var o=(0,u.Z)(function*(e,t){const n=t.get(fo.$).getActiveCodeEditor();if(!n||!n.hasModel())return;const r=yield e.service.getActiveOrCreateInstance({acceptsInput:!0}),s=n.getSelection();let l;if(s.isEmpty())l=n.getModel().getLineContent(s.selectionStartLineNumber).trim();else{const d=T.ED?1:2;l=n.getModel().getValueInRange(s,d)}r.sendText(l,!0,!0),yield e.service.revealActiveTerminal()});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.runActiveFile",title:{value:(0,a.NC)("workbench.action.terminal.runActiveFile","Run Active File In Active Terminal"),original:"Run Active File In Active Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t){const i=t.get(fo.$),n=t.get(R.lT),r=t.get(St.n),s=i.getActiveCodeEditor();if(!s||!s.hasModel())return;const l=yield e.service.getActiveOrCreateInstance({acceptsInput:!0}),d=l?l.isRemote:!!r.remoteAuthority,h=s.getModel().uri;if(!(!d&&h.scheme!==J.lg.file&&h.scheme!==J.lg.vscodeUserData||d&&h.scheme!==J.lg.vscodeRemote))return yield l.sendPath(h,!0),e.groupService.showPanel();n.warn((0,a.NC)("workbench.action.terminal.runActiveFile.noFile","Only files on disk can be run in the terminal"))});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.scrollDown",title:{value:(0,a.NC)("workbench.action.terminal.scrollDown","Scroll Down (Line)"),original:"Scroll Down (Line)"},keybinding:{primary:2572,linux:{primary:3090},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollDownLine()}),K({id:"workbench.action.terminal.scrollDownPage",title:{value:(0,a.NC)("workbench.action.terminal.scrollDownPage","Scroll Down (Page)"),original:"Scroll Down (Page)"},keybinding:{primary:1036,mac:{primary:12},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollDownPage()}),K({id:"workbench.action.terminal.scrollToBottom",title:{value:(0,a.NC)("workbench.action.terminal.scrollToBottom","Scroll to Bottom"),original:"Scroll to Bottom"},keybinding:{primary:2061,linux:{primary:1037},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollToBottom()}),K({id:"workbench.action.terminal.scrollUp",title:{value:(0,a.NC)("workbench.action.terminal.scrollUp","Scroll Up (Line)"),original:"Scroll Up (Line)"},keybinding:{primary:2571,linux:{primary:3088},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollUpLine()}),K({id:"workbench.action.terminal.scrollUpPage",title:{value:(0,a.NC)("workbench.action.terminal.scrollUpPage","Scroll Up (Page)"),original:"Scroll Up (Page)"},f1:!0,category:Si,keybinding:{primary:1035,mac:{primary:11},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollUpPage()}),K({id:"workbench.action.terminal.scrollToTop",title:{value:(0,a.NC)("workbench.action.terminal.scrollToTop","Scroll to Top"),original:"Scroll to Top"},keybinding:{primary:2062,linux:{primary:1038},when:g.Ao.and(m.r.focus,m.r.altBufferActive.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.scrollToTop()}),K({id:"workbench.action.terminal.clearSelection",title:{value:(0,a.NC)("workbench.action.terminal.clearSelection","Clear Selection"),original:"Clear Selection"},keybinding:{primary:9,when:g.Ao.and(m.r.focus,m.r.textSelected,m.r.notFindVisible),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>{o.hasSelection()&&o.clearSelection()}}),B({id:"workbench.action.terminal.changeIcon",title:P.changeIcon,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e,t)=>bn(o,t)?.changeIcon()}),B({id:"workbench.action.terminal.changeIconPanel",title:P.changeIcon,f1:!1,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeInstance?.changeIcon()}),B({id:"workbench.action.terminal.changeIconInstance",title:P.changeIcon,f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.tabsSingularSelection),run:(o,e)=>Ve(e)?.[0].changeIcon()}),B({id:"workbench.action.terminal.changeColor",title:P.changeColor,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e,t)=>bn(o,t)?.changeColor()}),B({id:"workbench.action.terminal.changeColorPanel",title:P.changeColor,f1:!1,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.groupService.activeInstance?.changeColor()}),B({id:"workbench.action.terminal.changeColorInstance",title:P.changeColor,f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.tabsSingularSelection),run:(o,e)=>Ve(e)?.[0].changeColor()}),B({id:"workbench.action.terminal.rename",title:P.rename,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e,t)=>Do(o,e,t)}),B({id:"workbench.action.terminal.renamePanel",title:P.rename,f1:!1,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e)=>Do(o,e)}),B({id:"workbench.action.terminal.renameInstance",title:P.rename,f1:!1,keybinding:{primary:60,mac:{primary:3},when:g.Ao.and(m.r.tabsFocus),weight:200},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.tabsSingularSelection),run:function(){var o=(0,u.Z)(function*(e,t){const i=t.get(R.lT),n=Ve(t)?.[0];var r;n&&(e.service.setEditingTerminal(n),e.service.setEditable(n,{validationMessage:r=>function sa(o){return o&&0!==o.trim().length?null:{content:(0,a.NC)("emptyTerminalNameInfo","Providing no name will reset it to the default value"),severity:R.zb.Info}}(r),onFinish:(r=(0,u.Z)(function*(s,l){if(e.service.setEditable(n,null),e.service.setEditingTerminal(void 0),l)try{yield n.rename(s)}catch(d){i.error(d)}}),function(l,d){return r.apply(this,arguments)})}))});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.detachSession",title:{value:(0,a.NC)("workbench.action.terminal.detachSession","Detach Session"),original:"Detach Session"},run:o=>o.detachProcessAndDispose(D._x.User)}),B({id:"workbench.action.terminal.attachToSession",title:{value:(0,a.NC)("workbench.action.terminal.attachToSession","Attach to Session"),original:"Attach to Session"},run:function(){var o=(0,u.Z)(function*(e,t){const i=t.get(we.eJ),n=t.get(ot.e),r=t.get(Oe.R),s=t.get(R.lT),l=r.getConnection()?.remoteAuthority??void 0,d=yield t.get(M.N4).getBackend(l);if(!d)throw new Error(`No backend registered for remote authority '${l}'`);const h=yield d.listProcesses();d.reduceConnectionGraceTime();const v=h.filter(_=>!e.service.isAttachedToTerminal(_)).map(_=>{const C=n.getUriLabel(N.ov.file(_.cwd));return{label:_.title,detail:_.workspaceName?`${_.workspaceName} \u2e31 ${C}`:C,description:_.pid?String(_.pid):"",term:_}});if(0===v.length)return void s.info((0,a.NC)("noUnattachedTerminals","There are no unattached terminals to attach to"));const b=yield i.pick(v,{canPickMany:!1});if(b){const _=yield e.service.createTerminal({config:{attachPersistentProcess:b.term}});e.service.setActiveInstance(_),yield Ut(_,e)}});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.quickOpenTerm",title:{value:(0,a.NC)("quickAccessTerminal","Switch Active Terminal"),original:"Switch Active Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e)=>e.get(we.eJ).quickAccess.show(wt.PREFIX)}),K({id:"workbench.action.terminal.scrollToPreviousCommand",title:{value:(0,a.NC)("workbench.action.terminal.scrollToPreviousCommand","Scroll To Previous Command"),original:"Scroll To Previous Command"},keybinding:{primary:2064,when:g.Ao.and(m.r.focus,Ce.U.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.xterm?.markTracker.scrollToPreviousMark(void 0,void 0,o.capabilities.has(2))}),K({id:"workbench.action.terminal.scrollToNextCommand",title:{value:(0,a.NC)("workbench.action.terminal.scrollToNextCommand","Scroll To Next Command"),original:"Scroll To Next Command"},keybinding:{primary:2066,when:g.Ao.and(m.r.focus,Ce.U.negate()),weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>{o.xterm?.markTracker.scrollToNextMark(),o.focus()}}),K({id:"workbench.action.terminal.selectToPreviousCommand",title:{value:(0,a.NC)("workbench.action.terminal.selectToPreviousCommand","Select To Previous Command"),original:"Select To Previous Command"},keybinding:{primary:3088,when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>{o.xterm?.markTracker.selectToPreviousMark(),o.focus()}}),K({id:"workbench.action.terminal.selectToNextCommand",title:{value:(0,a.NC)("workbench.action.terminal.selectToNextCommand","Select To Next Command"),original:"Select To Next Command"},keybinding:{primary:3090,when:m.r.focus,weight:200},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>{o.xterm?.markTracker.selectToNextMark(),o.focus()}}),K({id:"workbench.action.terminal.selectToPreviousLine",title:{value:(0,a.NC)("workbench.action.terminal.selectToPreviousLine","Select To Previous Line"),original:"Select To Previous Line"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e){e.xterm?.markTracker.selectToPreviousLine(),e.focus()});return function(t){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.selectToNextLine",title:{value:(0,a.NC)("workbench.action.terminal.selectToNextLine","Select To Next Line"),original:"Select To Next Line"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e){e.xterm?.markTracker.selectToNextLine(),e.focus()});return function(t){return o.apply(this,arguments)}}()}),B({id:"toggleEscapeSequenceLogging",title:{value:(0,a.NC)("workbench.action.terminal.toggleEscapeSequenceLogging","Toggle Escape Sequence Logging"),original:"Toggle Escape Sequence Logging"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:o=>o.service.toggleEscapeSequenceLogging()}),B({id:"workbench.action.terminal.sendSequence",title:P.sendSequence,f1:!1,description:{description:P.sendSequence.value,args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{description:(0,a.NC)("sendSequence","The sequence of text to send to the terminal"),type:"string"}}}}]},run:(o,e,t)=>yo(e,t)}),B({id:"workbench.action.terminal.newWithCwd",title:P.newWithCwd,description:{description:P.newWithCwd.value,args:[{name:"args",schema:{type:"object",required:["cwd"],properties:{cwd:{description:(0,a.NC)("workbench.action.terminal.newWithCwd.cwd","The directory to start the terminal at"),type:"string"}}}}]},run:function(){var o=(0,u.Z)(function*(e,t,i){const n=(0,de.Kn)(i)&&"cwd"in i?Ci(i.cwd):void 0,r=yield e.service.createTerminal({cwd:n});r&&(e.service.setActiveInstance(r),yield Ut(r,e))});return function(t,i,n){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.renameWithArg",title:P.renameWithArgs,description:{description:P.renameWithArgs.value,args:[{name:"args",schema:{type:"object",required:["name"],properties:{name:{description:(0,a.NC)("workbench.action.terminal.renameWithArg.name","The new name for the terminal"),type:"string",minLength:1}}}}]},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t,i,n){const r=i.get(R.lT),s=(0,de.Kn)(n)&&"name"in n?Ci(n.name):void 0;s?e.rename(s):r.warn((0,a.NC)("workbench.action.terminal.renameWithArg.noName","No name argument provided"))});return function(t,i,n,r){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.relaunch",title:{value:(0,a.NC)("workbench.action.terminal.relaunch","Relaunch Active Terminal"),original:"Relaunch Active Terminal"},run:o=>o.relaunch()}),B({id:"workbench.action.terminal.split",title:P.split,precondition:g.Ao.or(m.r.processSupported,m.r.webExtensionContributedProfile),keybinding:{primary:3098,weight:200,mac:{primary:2141,secondary:[1306]},when:m.r.focus},icon:E.lA.splitHorizontal,run:function(){var o=(0,u.Z)(function*(e,t,i){const n=(0,de.Kn)(i)?i:void 0,r=t.get(se.H),s=t.get(be.ec),l=Io(n),d=e.service.getInstanceHost(l?.location).activeInstance;if(!d)return;const h=yield Co(e.service.configHelper,d,s.getWorkspace().folders,r);if(void 0===h)return;const f=yield e.service.createTerminal({location:{parentTerminal:d},config:l?.config,cwd:h});yield Ut(f,e)});return function(t,i,n){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.splitInstance",title:P.split,f1:!1,keybinding:{primary:3098,mac:{primary:2141,secondary:[1306]},weight:200,when:m.r.tabsFocus},run:function(){var o=(0,u.Z)(function*(e,t){const i=Ve(t);if(i){const n=[];for(const r of i)n.push((0,u.Z)(function*(){yield e.service.createTerminal({location:{parentTerminal:r}}),yield e.groupService.showPanel(!0)})());yield Promise.all(n)}});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.unsplit",title:P.unsplit,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e)=>e.groupService.unsplitInstance(o)}),B({id:"workbench.action.terminal.unsplitInstance",title:P.unsplit,f1:!1,precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t){const i=Ve(t);if(1===i?.length){const n=e.groupService.getGroupForInstance(i[0]);n&&n?.terminalInstances.length>1&&e.groupService.unsplitInstance(i[0])}});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.joinInstance",title:{value:(0,a.NC)("workbench.action.terminal.joinInstance","Join Terminals"),original:"Join Terminals"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.tabsSingularSelection.toNegated()),run:function(){var o=(0,u.Z)(function*(e,t){const i=Ve(t);i&&i.length>1&&e.groupService.joinInstances(i)});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.join",title:{value:(0,a.NC)("workbench.action.terminal.join","Join Terminals"),original:"Join Terminals"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated)),run:function(){var o=(0,u.Z)(function*(e,t){const i=t.get(me.XE),n=t.get(R.lT),r=t.get(we.eJ),s=[];if(e.groupService.instances.length<=1)return void n.warn((0,a.NC)("workbench.action.terminal.join.insufficientTerminals","Insufficient terminals for the join action"));const l=e.groupService.instances.filter(h=>h.instanceId!==e.groupService.activeInstance?.instanceId);for(const h of l)if(1===e.groupService.getGroupForInstance(h)?.terminalInstances.length){const b=`$(${(0,ae.yX)(t,h)}): ${h.title}`,_=[],C=(0,ae.pv)(h);C&&_.push(C);const y=(0,ae.A5)(h,i.getColorTheme().type);y&&_.push(...y),s.push({terminal:h,label:b,iconClasses:_})}if(0===s.length)return void n.warn((0,a.NC)("workbench.action.terminal.join.onlySplits","All terminals are joined already"));const d=yield r.pick(s,{});d&&e.groupService.joinInstances([d.terminal,e.groupService.activeInstance])});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.splitInActiveWorkspace",title:{value:(0,a.NC)("workbench.action.terminal.splitInActiveWorkspace","Split Terminal (In Active Workspace)"),original:"Split Terminal (In Active Workspace)"},run:function(){var o=(0,u.Z)(function*(e,t){(yield t.service.createTerminal({location:{parentTerminal:e}}))?.target!==D.i2.Editor&&(yield t.groupService.showPanel(!0))});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.selectAll",title:{value:(0,a.NC)("workbench.action.terminal.selectAll","Select All"),original:"Select All"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:[{primary:0,mac:{primary:2079},weight:200,when:m.r.focus}],run:o=>o.selectAll()}),B({id:"workbench.action.terminal.new",title:{value:(0,a.NC)("workbench.action.terminal.new","Create New Terminal"),original:"Create New Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.webExtensionContributedProfile),icon:Ls,keybinding:{primary:3163,mac:{primary:1371},weight:200},run:function(){var o=(0,u.Z)(function*(e,t,i){let n=(0,de.Kn)(i)?i:void 0;const r=t.get(be.ec),s=t.get(se.H),l=r.getWorkspace().folders;if(n&&n instanceof MouseEvent&&(n.altKey||n.ctrlKey))yield e.service.createTerminal({location:{splitActiveTerminal:!0}});else if(e.service.isProcessSupportRegistered){let d;if(n=!n||n instanceof MouseEvent?{}:n,l.length<=1)d=yield e.service.createTerminal(n);else{const h=(yield function aa(o,e){return wn.apply(this,arguments)}(t))?.cwd;if(!h)return;n.cwd=h,d=yield e.service.createTerminal(n)}e.service.setActiveInstance(d),yield Ut(d,e)}else s.executeCommand(e.profileService.contributedProfiles.length>0?"workbench.action.terminal.newWithProfile":"workbench.action.terminal.toggleTerminal")});return function(t,i,n){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.kill",title:{value:(0,a.NC)("workbench.action.terminal.kill","Kill the Active Terminal Instance"),original:"Kill the Active Terminal Instance"},precondition:g.Ao.or(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),icon:po,run:function(){var o=(0,u.Z)(function*(e){const t=e.groupService.activeInstance;t&&(yield e.service.safeDisposeTerminal(t),e.groupService.instances.length>0&&(yield e.groupService.showPanel(!0)))});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.killAll",title:{value:(0,a.NC)("workbench.action.terminal.killAll","Kill All Terminals"),original:"Kill All Terminals"},precondition:g.Ao.or(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),icon:E.lA.trash,run:function(){var o=(0,u.Z)(function*(e){const t=[];for(const i of e.service.instances)t.push(e.service.safeDisposeTerminal(i));yield Promise.all(t)});return function(t){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.killEditor",title:{value:(0,a.NC)("workbench.action.terminal.killEditor","Kill the Active Terminal in Editor Area"),original:"Kill the Active Terminal in Editor Area"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:{primary:2101,win:{primary:2110,secondary:[2101]},weight:200,when:g.Ao.and(m.r.focus,Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),m.r.editorFocus)},run:(o,e)=>e.get(se.H).executeCommand(Ms.$Z)}),B({id:"workbench.action.terminal.killInstance",title:P.kill,f1:!1,precondition:g.Ao.or(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),keybinding:{primary:20,mac:{primary:2049,secondary:[20]},weight:200,when:m.r.tabsFocus},run:function(){var o=(0,u.Z)(function*(e,t){const i=Ve(t);if(!i)return;const n=t.get($t.Lw),r=[];for(const s of i)r.push(e.service.safeDisposeTerminal(s));yield Promise.all(r),e.service.instances.length>0&&(e.groupService.focusTabs(),n.lastFocusedList?.focusNext())});return function(t,i){return o.apply(this,arguments)}}()}),B({id:"workbench.action.terminal.focusHover",title:P.focusHover,precondition:g.Ao.or(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),keybinding:{primary:(0,Es.gx)(2089,2087),weight:200,when:g.Ao.or(m.r.tabsFocus,m.r.focus)},run:o=>o.groupService.focusHover()}),K({id:"workbench.action.terminal.clear",title:{value:(0,a.NC)("workbench.action.terminal.clear","Clear"),original:"Clear"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:[{primary:0,mac:{primary:2089},weight:201,when:g.Ao.and(m.r.focus,Ce.U.negate())}],run:o=>o.clearBuffer()}),B({id:"workbench.action.terminal.selectDefaultShell",title:{value:(0,a.NC)("workbench.action.terminal.selectDefaultShell","Select Default Profile"),original:"Select Default Profile"},run:o=>o.service.showProfileQuickPick("setDefault")}),B({id:"workbench.action.terminal.openSettings",title:{value:(0,a.NC)("workbench.action.terminal.openSettings","Configure Terminal Settings"),original:"Configure Terminal Settings"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:(o,e)=>e.get(zt.UP).openSettings({jsonEditor:!1,query:"@feature:terminal"})}),K({id:"workbench.action.terminal.setDimensions",title:{value:(0,a.NC)("workbench.action.terminal.setFixedDimensions","Set Fixed Dimensions"),original:"Set Fixed Dimensions"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),run:o=>o.setFixedDimensions()}),K({id:"workbench.action.terminal.sizeToContentWidth",title:{value:(0,a.NC)("workbench.action.terminal.sizeToContentWidth","Toggle Size to Content Width"),original:"Toggle Size to Content Width"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.isOpen),keybinding:{primary:568,weight:200,when:m.r.focus},run:o=>o.toggleSizeToContentWidth()}),B({id:"workbench.action.terminal.sizeToContentWidthInstance",title:P.toggleSizeToContentWidth,f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus),run:(o,e)=>Ve(e)?.[0].toggleSizeToContentWidth()}),B({id:"workbench.action.terminal.clearPreviousSessionHistory",title:{value:(0,a.NC)("workbench.action.terminal.clearPreviousSessionHistory","Clear Previous Session History"),original:"Clear Previous Session History"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t){_i(t).clear(),function js(){bi.clear()}()});return function(t,i){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.selectPrevSuggestion",title:{value:(0,a.NC)("workbench.action.terminal.selectPrevSuggestion","Select the Previous Suggestion"),original:"Select the Previous Suggestion"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:16,weight:201},run:o=>o.selectPreviousSuggestion()}),K({id:"workbench.action.terminal.selectPrevPageSuggestion",title:{value:(0,a.NC)("workbench.action.terminal.selectPrevPageSuggestion","Select the Previous Page Suggestion"),original:"Select the Previous Page Suggestion"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:11,weight:201},run:o=>o.selectPreviousPageSuggestion()}),K({id:"workbench.action.terminal.selectNextSuggestion",title:{value:(0,a.NC)("workbench.action.terminal.selectNextSuggestion","Select the Next Suggestion"),original:"Select the Next Suggestion"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:18,weight:201},run:o=>o.selectNextSuggestion()}),K({id:"workbench.action.terminal.selectNextPageSuggestion",title:{value:(0,a.NC)("workbench.action.terminal.selectNextPageSuggestion","Select the Next Page Suggestion"),original:"Select the Next Page Suggestion"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:12,weight:201},run:o=>o.selectNextPageSuggestion()}),K({id:"workbench.action.terminal.acceptSelectedSuggestion",title:{value:(0,a.NC)("workbench.action.terminal.acceptSelectedSuggestion","Accept Selected Suggestion"),original:"Accept Selected Suggestion"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:3,secondary:[2],weight:201},run:o=>o.acceptSelectedSuggestion()}),K({id:"workbench.action.terminal.hideSuggestWidget",title:{value:(0,a.NC)("workbench.action.terminal.hideSuggestWidget","Hide Suggest Widget"),original:"Hide Suggest Widget"},f1:!1,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.focus,m.r.isOpen,m.r.suggestWidgetVisible),keybinding:{primary:9,weight:201},run:o=>o.hideSuggestWidget()}),bt.D.clipboard.writeText&&(K({id:"workbench.action.terminal.copySelection",title:{value:(0,a.NC)("workbench.action.terminal.copySelection","Copy Selection"),original:"Copy Selection"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.textSelected),keybinding:[{primary:3105,mac:{primary:2081},weight:200,when:g.Ao.and(m.r.textSelected,m.r.focus)}],run:o=>o.copySelection()}),K({id:"workbench.action.terminal.copyAndClearSelection",title:{value:(0,a.NC)("workbench.action.terminal.copyAndClearSelection","Copy and Clear Selection"),original:"Copy and Clear Selection"},precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.textSelected),keybinding:[{win:{primary:2081},weight:200,when:g.Ao.and(m.r.textSelected,m.r.focus)}],run:function(){var o=(0,u.Z)(function*(e){yield e.copySelection(),e.clearSelection()});return function(t){return o.apply(this,arguments)}}()}),K({id:"workbench.action.terminal.copySelectionAsHtml",title:{value:(0,a.NC)("workbench.action.terminal.copySelectionAsHtml","Copy Selection as HTML"),original:"Copy Selection as HTML"},f1:!0,category:Si,precondition:g.Ao.and(g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),m.r.textSelected),run:o=>o.copySelection(!0)})),bt.D.clipboard.readText&&K({id:"workbench.action.terminal.paste",title:{value:(0,a.NC)("workbench.action.terminal.paste","Paste into Active Terminal"),original:"Paste into Active Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:[{primary:2100,win:{primary:2100,secondary:[3124]},linux:{primary:3124},weight:200,when:m.r.focus}],run:o=>o.paste()}),bt.D.clipboard.readText&&T.IJ&&K({id:"workbench.action.terminal.pasteSelection",title:{value:(0,a.NC)("workbench.action.terminal.pasteSelection","Paste Selection into Active Terminal"),original:"Paste Selection into Active Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),keybinding:[{linux:{primary:1043},weight:200,when:m.r.focus}],run:o=>o.pasteSelection()}),B({id:"workbench.action.terminal.switchTerminal",title:{value:(0,a.NC)("workbench.action.terminal.switchTerminal","Switch Terminal"),original:"Switch Terminal"},precondition:g.Ao.or(m.r.processSupported,m.r.terminalHasBeenCreated),run:function(){var o=(0,u.Z)(function*(e,t,i){const n=Ci(i);if(!n)return;if(n===wo)return void e.service.refreshActiveGroup();if(n===So)return void t.get(ie.Ui).updateValue("terminal.integrated.tabs.enabled",!0);const s=/^([0-9]+): /.exec(n);if(s)return e.groupService.setActiveGroupByIndex(Number(s[1])-1),e.groupService.showPanel(!0);const l=e.profileService.availableProfiles,d=n.substring(4);if(l){const h=l.find(f=>f.profileName===d);if(h){const f=yield e.service.createTerminal({config:h});e.service.setActiveInstance(f)}else console.warn(`No profile with name "${d}"`)}else console.warn(`Unmatched terminal item: "${n}"`)});return function(t,i,n){return o.apply(this,arguments)}}()})}(),T.ED&&fe(String.fromCharCode("V".charCodeAt(0)-64),{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),Ce.U.negate()),primary:2100}),fe("\x1b[24~a",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),m.r.terminalShellIntegrationEnabled,Ce.U.negate()),primary:2058,mac:{primary:266}}),fe("\x1b[24~b",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),m.r.terminalShellIntegrationEnabled,Ce.U.negate()),primary:522}),fe("\x1b[24~c",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),m.r.terminalShellIntegrationEnabled,Ce.U.negate()),primary:1027}),fe("\x1b[24~d",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),m.r.terminalShellIntegrationEnabled,Ce.U.negate()),mac:{primary:3089}}),fe("\x1b[24~e",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh"),m.r.terminalShellIntegrationEnabled,Ce.U.negate(),g.Ao.equals("config.terminal.integrated.shellIntegration.suggestEnabled",!0)),primary:2058,mac:{primary:266}}),fe("\x1b[1;2H",{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","pwsh")),mac:{primary:3087}}),fe("\x12",{when:g.Ao.and(m.r.focus,Ce.U),primary:2608,mac:{primary:816}}),fe("\x07",{when:m.r.focus,primary:2597,mac:{primary:805}}),T.gn&&fe(String.fromCharCode("C".charCodeAt(0)-64),{when:g.Ao.and(m.r.focus),primary:289}),fe(String.fromCharCode("W".charCodeAt(0)-64),{primary:2049,mac:{primary:513}}),T.ED&&fe(String.fromCharCode("H".charCodeAt(0)-64),{when:g.Ao.and(m.r.focus,g.Ao.equals("terminalShellType","cmd")),primary:2049}),fe("\x1bd",{primary:2068,mac:{primary:532}}),fe("\x15",{mac:{primary:2049}}),fe(String.fromCharCode("A".charCodeAt(0)-64),{mac:{primary:2063}}),fe(String.fromCharCode("E".charCodeAt(0)-64),{mac:{primary:2065}}),fe("\0",{primary:3095,mac:{primary:1303}}),fe("\x1e",{primary:3099,mac:{primary:1307}}),fe("\x1f",{primary:2138,mac:{primary:346}}),function Ol(){!function Hl(){for(let o=0;o<9;o++){const e=o;us.W.registerCommandAndKeybindingRule({id:`workbench.action.terminal.focusAtIndex${o+1}`,weight:200,when:void 0,primary:0,handler:i=>(i.get(M.Qy).setActiveInstanceByIndex(e),i.get(M.Qy).showPanel(!0))})}}()}(),function Wl(){x.BH.appendMenuItems([{id:x.eH.MenubarTerminalMenu,item:{group:"1_create",command:{id:"workbench.action.terminal.new",title:(0,a.NC)({key:"miNewTerminal",comment:["&& denotes a mnemonic"]},"&&New Terminal")},order:1}},{id:x.eH.MenubarTerminalMenu,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:(0,a.NC)({key:"miSplitTerminal",comment:["&& denotes a mnemonic"]},"&&Split Terminal"),precondition:g.Ao.has("terminalIsOpen")},order:2,when:m.r.processSupported}},{id:x.eH.MenubarTerminalMenu,item:{group:"2_run",command:{id:"workbench.action.terminal.runActiveFile",title:(0,a.NC)({key:"miRunActiveFile",comment:["&& denotes a mnemonic"]},"Run &&Active File")},order:3,when:m.r.processSupported}},{id:x.eH.MenubarTerminalMenu,item:{group:"2_run",command:{id:"workbench.action.terminal.runSelectedText",title:(0,a.NC)({key:"miRunSelectedText",comment:["&& denotes a mnemonic"]},"Run &&Selected Text")},order:4,when:m.r.processSupported}}]),x.BH.appendMenuItems([{id:x.eH.TerminalInstanceContext,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:P.split.value}}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.new",title:P.new},group:"1_create"}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.kill",title:P.kill.value},group:"4_kill"}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.copySelection",title:(0,a.NC)("workbench.action.terminal.copySelection.short","Copy")},group:"2_edit",order:1}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.copySelectionAsHtml",title:(0,a.NC)("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"2_edit",order:2}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.paste",title:(0,a.NC)("workbench.action.terminal.paste.short","Paste")},group:"2_edit",order:3}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.clear",title:(0,a.NC)("workbench.action.terminal.clear","Clear")},group:"3_clear"}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.showTabs",title:(0,a.NC)("workbench.action.terminal.showsTabs","Show Tabs")},when:g.Ao.not("config.terminal.integrated.tabs.enabled"),group:"5_config"}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidth",title:P.toggleSizeToContentWidth},group:"5_config"}},{id:x.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.selectAll",title:(0,a.NC)("workbench.action.terminal.selectAll","Select All")},group:"2_edit",order:3}}]),x.BH.appendMenuItems([{id:x.eH.TerminalEditorInstanceContext,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:P.split.value}}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.new",title:P.new},group:"1_create"}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.killEditor",title:P.kill.value},group:"4_kill"}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.copySelection",title:(0,a.NC)("workbench.action.terminal.copySelection.short","Copy")},group:"2_edit",order:1}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.copySelectionAsHtml",title:(0,a.NC)("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"2_edit",order:2}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.paste",title:(0,a.NC)("workbench.action.terminal.paste.short","Paste")},group:"2_edit",order:3}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.clear",title:(0,a.NC)("workbench.action.terminal.clear","Clear")},group:"3_clear"}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.selectAll",title:(0,a.NC)("workbench.action.terminal.selectAll","Select All")},group:"2_edit",order:3}},{id:x.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidth",title:P.toggleSizeToContentWidth},group:"5_config"}}]),x.BH.appendMenuItems([{id:x.eH.TerminalTabEmptyAreaContext,item:{command:{id:"workbench.action.terminal.newWithProfile",title:(0,a.NC)("workbench.action.terminal.newWithProfile.short","New Terminal With Profile")},group:"1_create"}},{id:x.eH.TerminalTabEmptyAreaContext,item:{command:{id:"workbench.action.terminal.new",title:P.new},group:"1_create"}}]),x.BH.appendMenuItems([{id:x.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.terminal.selectDefaultShell",title:{value:(0,a.NC)("workbench.action.terminal.selectDefaultProfile","Select Default Profile"),original:"Select Default Profile"}},group:"3_configure"}},{id:x.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.terminal.openSettings",title:(0,a.NC)("workbench.action.terminal.openSettings","Configure Terminal Settings")},group:"3_configure"}},{id:x.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.runTask",title:(0,a.NC)("workbench.action.tasks.runTask","Run Task...")},when:bs.M0,group:"4_tasks",order:1}},{id:x.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.configureTaskRunner",title:(0,a.NC)("workbench.action.tasks.configureTaskRunner","Configure Tasks...")},when:bs.M0,group:"4_tasks",order:2}}]),x.BH.appendMenuItems([{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.switchTerminal",title:{value:(0,a.NC)("workbench.action.terminal.switchTerminal","Switch Terminal"),original:"Switch Terminal"}},group:"navigation",order:0,when:g.Ao.and(g.Ao.equals("view",k.e9),g.Ao.not("config.terminal.integrated.tabs.enabled"))}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.focus",title:P.focus},alt:{id:"workbench.action.terminal.split",title:P.split.value,icon:E.lA.splitHorizontal},group:"navigation",order:0,when:g.Ao.and(g.Ao.equals("view",k.e9),g.Ao.has("config.terminal.integrated.tabs.enabled"),g.Ao.or(g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleTerminal"),g.Ao.equals("terminalCount",1)),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleTerminalOrNarrow"),g.Ao.or(g.Ao.equals("terminalCount",1),g.Ao.has("isTerminalTabsNarrow"))),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleGroup"),g.Ao.equals("terminalGroupCount",1)),g.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","always")))}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.split",title:P.split,icon:E.lA.splitHorizontal},group:"navigation",order:2,when:g.Ao.and(g.Ao.equals("view",k.e9),g.Ao.notEquals("config.terminal.integrated.tabs.hideCondition","never"),g.Ao.or(g.Ao.not("config.terminal.integrated.tabs.enabled"),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminal"),g.Ao.equals("terminalCount",1)),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminalOrNarrow"),g.Ao.or(g.Ao.equals("terminalCount",1),g.Ao.has("isTerminalTabsNarrow"))),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleGroup"),g.Ao.equals("terminalGroupCount",1)),g.Ao.equals("config.terminal.integrated.tabs.showActions","always")))}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.kill",title:P.kill,icon:E.lA.trash},group:"navigation",order:3,when:g.Ao.and(g.Ao.equals("view",k.e9),g.Ao.notEquals("config.terminal.integrated.tabs.hideCondition","never"),g.Ao.or(g.Ao.not("config.terminal.integrated.tabs.enabled"),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminal"),g.Ao.equals("terminalCount",1)),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminalOrNarrow"),g.Ao.or(g.Ao.equals("terminalCount",1),g.Ao.has("isTerminalTabsNarrow"))),g.Ao.and(g.Ao.equals("config.terminal.integrated.tabs.showActions","singleGroup"),g.Ao.equals("terminalGroupCount",1)),g.Ao.equals("config.terminal.integrated.tabs.showActions","always")))}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.new",title:P.new,icon:E.lA.plus},alt:{id:"workbench.action.terminal.split",title:P.split.value,icon:E.lA.splitHorizontal},group:"navigation",order:0,when:g.Ao.and(g.Ao.equals("view",k.e9),g.Ao.or(m.r.webExtensionContributedProfile,m.r.processSupported))}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.clear",title:(0,a.NC)("workbench.action.terminal.clearLong","Clear Terminal"),icon:E.lA.clearAll},group:"navigation",order:4,when:g.Ao.equals("view",k.e9),isHiddenByDefault:!0}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.runActiveFile",title:(0,a.NC)("workbench.action.terminal.runActiveFile","Run Active File"),icon:E.lA.run},group:"navigation",order:5,when:g.Ao.equals("view",k.e9),isHiddenByDefault:!0}},{id:x.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.runSelectedText",title:(0,a.NC)("workbench.action.terminal.runSelectedText","Run Selected Text"),icon:E.lA.selection},group:"navigation",order:6,when:g.Ao.equals("view",k.e9),isHiddenByDefault:!0}}]),x.BH.appendMenuItems([{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.split",title:P.split.value},group:"1_create",order:1}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.moveToEditor",title:P.moveToEditor.value},group:"1_create",order:2}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.changeIconPanel",title:P.changeIcon.value},group:"2_edit"}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.changeColorPanel",title:P.changeColor.value},group:"2_edit"}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.renamePanel",title:P.rename.value},group:"2_edit"}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidthInstance",title:(0,a.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width")},group:"2_edit"}},{id:x.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.kill",title:P.kill.value},group:"4_kill"}}]),x.BH.appendMenuItems([{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.splitInstance",title:P.split.value},group:"1_create",order:1}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.moveToEditorInstance",title:P.moveToEditor.value},group:"1_create",order:2}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.renameInstance",title:(0,a.NC)("workbench.action.terminal.renameInstance","Rename...")},group:"2_edit"}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.changeIconInstance",title:(0,a.NC)("workbench.action.terminal.changeIcon","Change Icon...")},group:"2_edit"}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.changeColorInstance",title:(0,a.NC)("workbench.action.terminal.changeColor","Change Color...")},group:"2_edit"}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidthInstance",title:(0,a.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width")},group:"2_edit"}},{id:x.eH.TerminalTabContext,item:{group:"5_config",command:{id:"workbench.action.terminal.joinInstance",title:(0,a.NC)("workbench.action.terminal.joinInstance","Join Terminals")},when:m.r.tabsSingularSelection.toNegated()}},{id:x.eH.TerminalTabContext,item:{group:"5_config",command:{id:"workbench.action.terminal.unsplitInstance",title:P.unsplit.value},when:g.Ao.and(m.r.tabsSingularSelection,m.r.splitTerminal)}},{id:x.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.killInstance",title:P.kill.value},group:"4_kill"}}]),x.BH.appendMenuItem(x.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.moveToTerminalPanel",title:P.moveToTerminalPanel},when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),group:"2_files"}),x.BH.appendMenuItem(x.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.rename",title:P.rename},when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),group:"3_files"}),x.BH.appendMenuItem(x.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.changeColor",title:P.changeColor},when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),group:"3_files"}),x.BH.appendMenuItem(x.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.changeIcon",title:P.changeIcon},when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),group:"3_files"}),x.BH.appendMenuItem(x.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.sizeToContentWidth",title:P.toggleSizeToContentWidth},when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal),group:"3_files"}),x.BH.appendMenuItem(x.eH.EditorTitle,{command:{id:"workbench.action.createTerminalEditor",title:P.new,icon:E.lA.plus},alt:{id:"workbench.action.terminal.split",title:P.split.value,icon:E.lA.splitHorizontal},group:"navigation",order:0,when:Ue.f1.Scheme.isEqualTo(J.lg.vscodeTerminal)})}(),(0,j.OG)();class Yl{constructor(){this.remoteAuthority=void 0,this.onPtyHostUnresponsive=w.ju.None,this.onPtyHostResponsive=w.ju.None,this.onPtyHostRestart=w.ju.None,this.onDidRequestDetach=w.ju.None,this.attachToProcess=ze.Jc,this.attachToRevivedProcess=ze.Jc,this.listProcesses=ze.Jc,this.getProfiles=(0,u.Z)(function*(){return[]}),this.getWslPath=ze.Jc,this.getEnvironment=(0,u.Z)(function*(){return{}}),this.getShellEnvironment=(0,u.Z)(function*(){}),this.setTerminalLayoutInfo=(0,u.Z)(function*(){}),this.updateTitle=(0,u.Z)(function*(){}),this.updateIcon=(0,u.Z)(function*(){}),this.getTerminalLayoutInfo=(0,u.Z)(function*(){}),this.reduceConnectionGraceTime=ze.Jc,this.requestDetachInstance=ze.Jc,this.acceptDetachInstanceReply=ze.Jc,this.persistTerminalState=ze.Jc}}class ec{constructor(e,t,i,n){this.id=e,this.pid=t,this.cwd=i,this.onData=n,this.onReady=new w.Q5,this.shouldPersist=!1,this.onProcessData=this.onData,this.onProcessReady=this.onReady.event,this.onDidChangeProperty=w.ju.None,this.onProcessExit=w.ju.None,this.processBinary=ze.Jc,this.refreshProperty=(0,u.Z)(function*(){}),setTimeout(()=>{this.onReady.fire({cwd:i,pid:t})})}acknowledgeDataEvent(){}setUnicodeVersion(){return(0,u.Z)(function*(){})()}getInitialCwd(){var e=this;return(0,u.Z)(function*(){return e.cwd})()}getCwd(){var e=this;return(0,u.Z)(function*(){return e.cwd})()}getLatency(){return(0,u.Z)(function*(){return 0})()}updateProperty(){return(0,u.Z)(function*(){})()}}function tc(o){return xe.B.as(k.UU.Backend).registerTerminalBackend(o),{[M.x4.toString()]:new ue.M(Ge),[M.BZ.toString()]:new ue.M(zn),[M.Qy.toString()]:new ue.M(Kn),[M.N4.toString()]:new ue.M(Tr),[k.l5.toString()]:new ue.M(ci),[Nr.e.toString()]:new ue.M(Nr.u),[bl.g.toString()]:new ue.M(wl),[k.if.toString()]:new ue.M(Rr),[Ho.M.toString()]:new ue.M(gt),[Sl.s.toString()]:new ue.M(yl)}}},6640:(uo,_t,p)=>{p.d(_t,{Id:()=>ne,UE:()=>ve,dG:()=>c,gz:()=>S,x8:()=>w});var u=p(12829),rt=p(76972),ue=p(53091),k=p(79026);const M="inQuickOpen",c=new rt.uy(M,!1,(0,u.NC)("inQuickOpen","Whether keyboard focus is inside the quick open control")),S=rt.Ao.has(M),ne="inFilesPicker",ve=rt.Ao.and(S,rt.Ao.has(ne));function w(A,J){return T=>{const N=T.get(ue.d),a=T.get(k.eJ),ie={keybindings:N.lookupKeybindings(A)};a.navigate(!!J,ie)}}},41436:(uo,_t,p)=>{p.d(_t,{A$:()=>A,B5:()=>S,BZ:()=>w,Cd:()=>M,Dc:()=>k,Q0:()=>a,Rg:()=>N,VX:()=>ie,fM:()=>T,g:()=>se,sQ:()=>c,uD:()=>ne,vo:()=>J,xq:()=>ve});var u=p(82344),rt=p(32064),ue=p(93358);const k=(0,u.LO)(rt.XE),M="vs",c="vs-dark",S="hc-black",ne="hc-light",ve="[",w="]",A="*",J=/\[(.+?)\]/g;var T=(()=>((T=T||{}).COLOR_THEME="workbench.colorTheme",T.FILE_ICON_THEME="workbench.iconTheme",T.PRODUCT_ICON_THEME="workbench.productIconTheme",T.COLOR_CUSTOMIZATIONS="workbench.colorCustomizations",T.TOKEN_COLOR_CUSTOMIZATIONS="editor.tokenColorCustomizations",T.SEMANTIC_TOKEN_COLOR_CUSTOMIZATIONS="editor.semanticTokenColorCustomizations",T.PREFERRED_DARK_THEME="workbench.preferredDarkColorTheme",T.PREFERRED_LIGHT_THEME="workbench.preferredLightColorTheme",T.PREFERRED_HC_DARK_THEME="workbench.preferredHighContrastColorTheme",T.PREFERRED_HC_LIGHT_THEME="workbench.preferredHighContrastLightColorTheme",T.DETECT_COLOR_SCHEME="window.autoDetectColorScheme",T.DETECT_HC="window.autoDetectHighContrast",T))(),N=(()=>((N=N||{}).COLOR_THEME_DARK="Default Dark Modern",N.COLOR_THEME_LIGHT="Default Light Modern",N.COLOR_THEME_HC_DARK="Default High Contrast",N.COLOR_THEME_HC_LIGHT="Default High Contrast Light",N.COLOR_THEME_DARK_OLD="Default Dark+",N.COLOR_THEME_LIGHT_OLD="Default Light+",N.FILE_ICON_THEME="vs-seti",N.PRODUCT_ICON_THEME="Default",N))();const a={"activityBar.background":"#181818","statusBar.background":"#181818","statusBar.noFolderBackground":"#1f1f1f"},se={"activityBar.background":"#f8f8f8","statusBar.background":"#f8f8f8","statusBar.noFolderBackground":"#f8f8f8"};var ie,g;(g=ie||(ie={})).toJSONObject=function Be(R){return R&&{_extensionId:R.extensionId,_extensionIsBuiltin:R.extensionIsBuiltin,_extensionName:R.extensionName,_extensionPublisher:R.extensionPublisher}},g.fromJSONObject=function G(R){if(R&&(0,ue.HD)(R._extensionId)&&(0,ue.jn)(R._extensionIsBuiltin)&&(0,ue.HD)(R._extensionName)&&(0,ue.HD)(R._extensionPublisher))return{extensionId:R._extensionId,extensionIsBuiltin:R._extensionIsBuiltin,extensionName:R._extensionName,extensionPublisher:R._extensionPublisher}},g.fromName=function De(R,D,Ze=!1){return{extensionPublisher:R,extensionId:`${R}.${D}`,extensionName:D,extensionIsBuiltin:Ze}}}}]);