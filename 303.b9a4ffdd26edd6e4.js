"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[303],{27303:(ge,O,x)=>{x.r(O),x.d(O,{Adapter:()=>S,CodeActionAdaptor:()=>z,DefinitionAdapter:()=>V,DiagnosticsAdapter:()=>R,DocumentHighlightAdapter:()=>W,FormatAdapter:()=>U,FormatHelper:()=>w,FormatOnTypeAdapter:()=>$,InlayHintsAdapter:()=>G,Kind:()=>u,LibFiles:()=>E,OutlineAdapter:()=>B,QuickInfoAdapter:()=>Z,ReferenceAdapter:()=>j,RenameAdapter:()=>J,SignatureHelpAdapter:()=>H,SuggestAdapter:()=>C,WorkerManager:()=>N,flattenDiagnosticMessageText:()=>F,getJavaScriptWorker:()=>le,getTypeScriptWorker:()=>ue,setupJavaScript:()=>ae,setupTypeScript:()=>oe});var _=x(58054),v=x(41484),q=x(97455),ee=x(94995),I=Object.defineProperty,te=Object.getOwnPropertyDescriptor,re=Object.getOwnPropertyNames,se=Object.prototype.hasOwnProperty,M=(t,e,r,i)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let a of re(e))!se.call(t,a)&&a!==r&&I(t,a,{get:()=>e[a],enumerable:!(i=te(e,a))||i.enumerable});return t},h=(t,e,r)=>(((t,e,r)=>{e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r),o={};M(o,q,"default");var N=class{constructor(e,r){(0,v.Z)(this,"_configChangeListener",void 0),(0,v.Z)(this,"_updateExtraLibsToken",void 0),(0,v.Z)(this,"_extraLibsChangeListener",void 0),(0,v.Z)(this,"_worker",void 0),(0,v.Z)(this,"_client",void 0),this._modeId=e,this._defaults=r,this._worker=null,this._client=null,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker()),this._updateExtraLibsToken=0,this._extraLibsChangeListener=this._defaults.onDidExtraLibsChange(()=>this._updateExtraLibs())}dispose(){this._configChangeListener.dispose(),this._extraLibsChangeListener.dispose(),this._stopWorker()}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}_updateExtraLibs(){var e=this;return(0,_.Z)(function*(){if(!e._worker)return;const r=++e._updateExtraLibsToken,i=yield e._worker.getProxy();e._updateExtraLibsToken===r&&i.updateExtraLibs(e._defaults.getExtraLibs())})()}_getClient(){var e=this;return this._client||(this._client=(0,_.Z)(function*(){return e._worker=o.editor.createWebWorker({moduleId:"vs/language/typescript/tsWorker",label:e._modeId,keepIdleModels:!0,createData:{compilerOptions:e._defaults.getCompilerOptions(),extraLibs:e._defaults.getExtraLibs(),customWorkerPath:e._defaults.workerOptions.customWorkerPath,inlayHintsOptions:e._defaults.inlayHintsOptions}}),e._defaults.getEagerModelSync()?yield e._worker.withSyncedResources(o.editor.getModels().filter(r=>r.getLanguageId()===e._modeId).map(r=>r.uri)):yield e._worker.getProxy()})()),this._client}getLanguageServiceWorker(...e){var r=this;return(0,_.Z)(function*(){const i=yield r._getClient();return r._worker&&(yield r._worker.withSyncedResources(e)),i})()}},n={};function F(t,e,r=0){if("string"==typeof t)return t;if(void 0===t)return"";let i="";if(r){i+=e;for(let a=0;a<r;a++)i+="  "}if(i+=t.messageText,r++,t.next)for(const a of t.next)i+=F(a,e,r);return i}function k(t){return t?t.map(e=>e.text).join(""):""}n["lib.d.ts"]=!0,n["lib.decorators.d.ts"]=!0,n["lib.decorators.legacy.d.ts"]=!0,n["lib.dom.d.ts"]=!0,n["lib.dom.iterable.d.ts"]=!0,n["lib.es2015.collection.d.ts"]=!0,n["lib.es2015.core.d.ts"]=!0,n["lib.es2015.d.ts"]=!0,n["lib.es2015.generator.d.ts"]=!0,n["lib.es2015.iterable.d.ts"]=!0,n["lib.es2015.promise.d.ts"]=!0,n["lib.es2015.proxy.d.ts"]=!0,n["lib.es2015.reflect.d.ts"]=!0,n["lib.es2015.symbol.d.ts"]=!0,n["lib.es2015.symbol.wellknown.d.ts"]=!0,n["lib.es2016.array.include.d.ts"]=!0,n["lib.es2016.d.ts"]=!0,n["lib.es2016.full.d.ts"]=!0,n["lib.es2017.d.ts"]=!0,n["lib.es2017.full.d.ts"]=!0,n["lib.es2017.intl.d.ts"]=!0,n["lib.es2017.object.d.ts"]=!0,n["lib.es2017.sharedmemory.d.ts"]=!0,n["lib.es2017.string.d.ts"]=!0,n["lib.es2017.typedarrays.d.ts"]=!0,n["lib.es2018.asyncgenerator.d.ts"]=!0,n["lib.es2018.asynciterable.d.ts"]=!0,n["lib.es2018.d.ts"]=!0,n["lib.es2018.full.d.ts"]=!0,n["lib.es2018.intl.d.ts"]=!0,n["lib.es2018.promise.d.ts"]=!0,n["lib.es2018.regexp.d.ts"]=!0,n["lib.es2019.array.d.ts"]=!0,n["lib.es2019.d.ts"]=!0,n["lib.es2019.full.d.ts"]=!0,n["lib.es2019.intl.d.ts"]=!0,n["lib.es2019.object.d.ts"]=!0,n["lib.es2019.string.d.ts"]=!0,n["lib.es2019.symbol.d.ts"]=!0,n["lib.es2020.bigint.d.ts"]=!0,n["lib.es2020.d.ts"]=!0,n["lib.es2020.date.d.ts"]=!0,n["lib.es2020.full.d.ts"]=!0,n["lib.es2020.intl.d.ts"]=!0,n["lib.es2020.number.d.ts"]=!0,n["lib.es2020.promise.d.ts"]=!0,n["lib.es2020.sharedmemory.d.ts"]=!0,n["lib.es2020.string.d.ts"]=!0,n["lib.es2020.symbol.wellknown.d.ts"]=!0,n["lib.es2021.d.ts"]=!0,n["lib.es2021.full.d.ts"]=!0,n["lib.es2021.intl.d.ts"]=!0,n["lib.es2021.promise.d.ts"]=!0,n["lib.es2021.string.d.ts"]=!0,n["lib.es2021.weakref.d.ts"]=!0,n["lib.es2022.array.d.ts"]=!0,n["lib.es2022.d.ts"]=!0,n["lib.es2022.error.d.ts"]=!0,n["lib.es2022.full.d.ts"]=!0,n["lib.es2022.intl.d.ts"]=!0,n["lib.es2022.object.d.ts"]=!0,n["lib.es2022.regexp.d.ts"]=!0,n["lib.es2022.sharedmemory.d.ts"]=!0,n["lib.es2022.string.d.ts"]=!0,n["lib.es2023.array.d.ts"]=!0,n["lib.es2023.d.ts"]=!0,n["lib.es2023.full.d.ts"]=!0,n["lib.es5.d.ts"]=!0,n["lib.es6.d.ts"]=!0,n["lib.esnext.d.ts"]=!0,n["lib.esnext.full.d.ts"]=!0,n["lib.esnext.intl.d.ts"]=!0,n["lib.scripthost.d.ts"]=!0,n["lib.webworker.d.ts"]=!0,n["lib.webworker.importscripts.d.ts"]=!0,n["lib.webworker.iterable.d.ts"]=!0;var S=class{constructor(t){this._worker=t}_textSpanToRange(t,e){let r=t.getPositionAt(e.start),i=t.getPositionAt(e.start+e.length),{lineNumber:a,column:l}=r,{lineNumber:c,column:g}=i;return{startLineNumber:a,startColumn:l,endLineNumber:c,endColumn:g}}},E=class{constructor(e){(0,v.Z)(this,"_libFiles",void 0),(0,v.Z)(this,"_hasFetchedLibFiles",void 0),(0,v.Z)(this,"_fetchLibFilesPromise",void 0),this._worker=e,this._libFiles={},this._hasFetchedLibFiles=!1,this._fetchLibFilesPromise=null}isLibFile(e){return!(!e||0!==e.path.indexOf("/lib.")||!n[e.path.slice(1)])}getOrCreateModel(e){const r=o.Uri.parse(e),i=o.editor.getModel(r);if(i)return i;if(this.isLibFile(r)&&this._hasFetchedLibFiles)return o.editor.createModel(this._libFiles[r.path.slice(1)],"typescript",r);const a=ee.typescriptDefaults.getExtraLibs()[e];return a?o.editor.createModel(a.content,"typescript",r):null}_containsLibFile(e){for(let r of e)if(this.isLibFile(r))return!0;return!1}fetchLibFilesIfNecessary(e){var r=this;return(0,_.Z)(function*(){r._containsLibFile(e)&&(yield r._fetchLibFiles())})()}_fetchLibFiles(){return this._fetchLibFilesPromise||(this._fetchLibFilesPromise=this._worker().then(e=>e.getLibFiles()).then(e=>{this._hasFetchedLibFiles=!0,this._libFiles=e})),this._fetchLibFilesPromise}},R=class extends S{constructor(e,r,i,a){super(a),(0,v.Z)(this,"_disposables",[]),(0,v.Z)(this,"_listener",Object.create(null)),this._libFiles=e,this._defaults=r,this._selector=i;const l=s=>{if(s.getLanguageId()!==i)return;const d=()=>{const{onlyVisible:m}=this._defaults.getDiagnosticsOptions();m?s.isAttachedToEditor()&&this._doValidate(s):this._doValidate(s)};let f;const p=s.onDidChangeContent(()=>{clearTimeout(f),f=window.setTimeout(d,500)}),b=s.onDidChangeAttached(()=>{const{onlyVisible:m}=this._defaults.getDiagnosticsOptions();m&&(s.isAttachedToEditor()?d():o.editor.setModelMarkers(s,this._selector,[]))});this._listener[s.uri.toString()]={dispose(){p.dispose(),b.dispose(),clearTimeout(f)}},d()},c=s=>{o.editor.setModelMarkers(s,this._selector,[]);const d=s.uri.toString();this._listener[d]&&(this._listener[d].dispose(),delete this._listener[d])};this._disposables.push(o.editor.onDidCreateModel(s=>l(s))),this._disposables.push(o.editor.onWillDisposeModel(c)),this._disposables.push(o.editor.onDidChangeModelLanguage(s=>{c(s.model),l(s.model)})),this._disposables.push({dispose(){for(const s of o.editor.getModels())c(s)}});const g=()=>{for(const s of o.editor.getModels())c(s),l(s)};this._disposables.push(this._defaults.onDidChange(g)),this._disposables.push(this._defaults.onDidExtraLibsChange(g)),o.editor.getModels().forEach(s=>l(s))}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}_doValidate(e){var r=this;return(0,_.Z)(function*(){const i=yield r._worker(e.uri);if(e.isDisposed())return;const a=[],{noSyntaxValidation:l,noSemanticValidation:c,noSuggestionDiagnostics:g}=r._defaults.getDiagnosticsOptions();l||a.push(i.getSyntacticDiagnostics(e.uri.toString())),c||a.push(i.getSemanticDiagnostics(e.uri.toString())),g||a.push(i.getSuggestionDiagnostics(e.uri.toString()));const s=yield Promise.all(a);if(!s||e.isDisposed())return;const d=s.reduce((p,b)=>b.concat(p),[]).filter(p=>-1===(r._defaults.getDiagnosticsOptions().diagnosticCodesToIgnore||[]).indexOf(p.code)),f=d.map(p=>p.relatedInformation||[]).reduce((p,b)=>b.concat(p),[]).map(p=>p.file?o.Uri.parse(p.file.fileName):null);yield r._libFiles.fetchLibFilesIfNecessary(f),!e.isDisposed()&&o.editor.setModelMarkers(e,r._selector,d.map(p=>r._convertDiagnostics(e,p)))})()}_convertDiagnostics(e,r){const i=r.start||0,a=r.length||1,{lineNumber:l,column:c}=e.getPositionAt(i),{lineNumber:g,column:s}=e.getPositionAt(i+a),d=[];return r.reportsUnnecessary&&d.push(o.MarkerTag.Unnecessary),r.reportsDeprecated&&d.push(o.MarkerTag.Deprecated),{severity:this._tsDiagnosticCategoryToMarkerSeverity(r.category),startLineNumber:l,startColumn:c,endLineNumber:g,endColumn:s,message:F(r.messageText,"\n"),code:r.code.toString(),tags:d,relatedInformation:this._convertRelatedInformation(e,r.relatedInformation)}}_convertRelatedInformation(e,r){if(!r)return[];const i=[];return r.forEach(a=>{let l=e;if(a.file&&(l=this._libFiles.getOrCreateModel(a.file.fileName)),!l)return;const c=a.start||0,g=a.length||1,{lineNumber:s,column:d}=l.getPositionAt(c),{lineNumber:f,column:p}=l.getPositionAt(c+g);i.push({resource:l.uri,startLineNumber:s,startColumn:d,endLineNumber:f,endColumn:p,message:F(a.messageText,"\n")})}),i}_tsDiagnosticCategoryToMarkerSeverity(e){switch(e){case 1:return o.MarkerSeverity.Error;case 3:return o.MarkerSeverity.Info;case 0:return o.MarkerSeverity.Warning;case 2:return o.MarkerSeverity.Hint}return o.MarkerSeverity.Info}},C=class extends S{get triggerCharacters(){return["."]}provideCompletionItems(t,e,r,i){var a=this;return(0,_.Z)(function*(){const l=t.getWordUntilPosition(e),c=new o.Range(e.lineNumber,l.startColumn,e.lineNumber,l.endColumn),g=t.uri,s=t.getOffsetAt(e),d=yield a._worker(g);if(t.isDisposed())return;const f=yield d.getCompletionsAtPosition(g.toString(),s);return!f||t.isDisposed()?void 0:{suggestions:f.entries.map(b=>{let m=c;if(b.replacementSpan){const T=t.getPositionAt(b.replacementSpan.start),D=t.getPositionAt(b.replacementSpan.start+b.replacementSpan.length);m=new o.Range(T.lineNumber,T.column,D.lineNumber,D.column)}const A=[];return void 0!==b.kindModifiers&&-1!==b.kindModifiers.indexOf("deprecated")&&A.push(o.languages.CompletionItemTag.Deprecated),{uri:g,position:e,offset:s,range:m,label:b.name,insertText:b.name,sortText:b.sortText,kind:C.convertKind(b.kind),tags:A}})}})()}resolveCompletionItem(t,e){var r=this;return(0,_.Z)(function*(){const i=t,a=i.uri,l=i.position,c=i.offset,s=yield(yield r._worker(a)).getCompletionEntryDetails(a.toString(),c,i.label);return s?{uri:a,position:l,label:s.name,kind:C.convertKind(s.kind),detail:k(s.displayParts),documentation:{value:C.createDocumentationString(s)}}:i})()}static convertKind(t){switch(t){case u.primitiveType:case u.keyword:return o.languages.CompletionItemKind.Keyword;case u.variable:case u.localVariable:return o.languages.CompletionItemKind.Variable;case u.memberVariable:case u.memberGetAccessor:case u.memberSetAccessor:return o.languages.CompletionItemKind.Field;case u.function:case u.memberFunction:case u.constructSignature:case u.callSignature:case u.indexSignature:return o.languages.CompletionItemKind.Function;case u.enum:return o.languages.CompletionItemKind.Enum;case u.module:return o.languages.CompletionItemKind.Module;case u.class:return o.languages.CompletionItemKind.Class;case u.interface:return o.languages.CompletionItemKind.Interface;case u.warning:return o.languages.CompletionItemKind.File}return o.languages.CompletionItemKind.Property}static createDocumentationString(t){let e=k(t.documentation);if(t.tags)for(const r of t.tags)e+=`\n\n${K(r)}`;return e}};function K(t){let e=`*@${t.name}*`;if("param"===t.name&&t.text){const[r,...i]=t.text;e+=`\`${r.text}\``,i.length>0&&(e+=` \u2014 ${i.map(a=>a.text).join(" ")}`)}else Array.isArray(t.text)?e+=` \u2014 ${t.text.map(r=>r.text).join(" ")}`:t.text&&(e+=` \u2014 ${t.text}`);return e}var H=class Y extends S{constructor(...e){super(...e),(0,v.Z)(this,"signatureHelpTriggerCharacters",["(",","])}static _toSignatureHelpTriggerReason(e){switch(e.triggerKind){case o.languages.SignatureHelpTriggerKind.TriggerCharacter:return e.triggerCharacter?e.isRetrigger?{kind:"retrigger",triggerCharacter:e.triggerCharacter}:{kind:"characterTyped",triggerCharacter:e.triggerCharacter}:{kind:"invoked"};case o.languages.SignatureHelpTriggerKind.ContentChange:return e.isRetrigger?{kind:"retrigger"}:{kind:"invoked"};default:return{kind:"invoked"}}}provideSignatureHelp(e,r,i,a){var l=this;return(0,_.Z)(function*(){const c=e.uri,g=e.getOffsetAt(r),s=yield l._worker(c);if(e.isDisposed())return;const d=yield s.getSignatureHelpItems(c.toString(),g,{triggerReason:Y._toSignatureHelpTriggerReason(a)});if(!d||e.isDisposed())return;const f={activeSignature:d.selectedItemIndex,activeParameter:d.argumentIndex,signatures:[]};return d.items.forEach(p=>{const b={label:"",parameters:[]};b.documentation={value:k(p.documentation)},b.label+=k(p.prefixDisplayParts),p.parameters.forEach((m,A,T)=>{const D=k(m.displayParts),de={label:D,documentation:{value:k(m.documentation)}};b.label+=D,b.parameters.push(de),A<T.length-1&&(b.label+=k(p.separatorDisplayParts))}),b.label+=k(p.suffixDisplayParts),f.signatures.push(b)}),{value:f,dispose(){}}})()}},Z=class extends S{provideHover(t,e,r){var i=this;return(0,_.Z)(function*(){const a=t.uri,l=t.getOffsetAt(e),c=yield i._worker(a);if(t.isDisposed())return;const g=yield c.getQuickInfoAtPosition(a.toString(),l);if(!g||t.isDisposed())return;const s=k(g.documentation),d=g.tags?g.tags.map(p=>K(p)).join("  \n\n"):"",f=k(g.displayParts);return{range:i._textSpanToRange(t,g.textSpan),contents:[{value:"```typescript\n"+f+"\n```\n"},{value:s+(d?"\n\n"+d:"")}]}})()}},W=class extends S{provideDocumentHighlights(t,e,r){var i=this;return(0,_.Z)(function*(){const a=t.uri,l=t.getOffsetAt(e),c=yield i._worker(a);if(t.isDisposed())return;const g=yield c.getDocumentHighlights(a.toString(),l,[a.toString()]);return g&&!t.isDisposed()?g.flatMap(s=>s.highlightSpans.map(d=>({range:i._textSpanToRange(t,d.textSpan),kind:"writtenReference"===d.kind?o.languages.DocumentHighlightKind.Write:o.languages.DocumentHighlightKind.Text}))):void 0})()}},V=class extends S{constructor(t,e){super(e),this._libFiles=t}provideDefinition(t,e,r){var i=this;return(0,_.Z)(function*(){const a=t.uri,l=t.getOffsetAt(e),c=yield i._worker(a);if(t.isDisposed())return;const g=yield c.getDefinitionAtPosition(a.toString(),l);if(!g||t.isDisposed()||(yield i._libFiles.fetchLibFilesIfNecessary(g.map(d=>o.Uri.parse(d.fileName))),t.isDisposed()))return;const s=[];for(let d of g){const f=i._libFiles.getOrCreateModel(d.fileName);f&&s.push({uri:f.uri,range:i._textSpanToRange(f,d.textSpan)})}return s})()}},j=class extends S{constructor(t,e){super(e),this._libFiles=t}provideReferences(t,e,r,i){var a=this;return(0,_.Z)(function*(){const l=t.uri,c=t.getOffsetAt(e),g=yield a._worker(l);if(t.isDisposed())return;const s=yield g.getReferencesAtPosition(l.toString(),c);if(!s||t.isDisposed()||(yield a._libFiles.fetchLibFilesIfNecessary(s.map(f=>o.Uri.parse(f.fileName))),t.isDisposed()))return;const d=[];for(let f of s){const p=a._libFiles.getOrCreateModel(f.fileName);p&&d.push({uri:p.uri,range:a._textSpanToRange(p,f.textSpan)})}return d})()}},B=class extends S{provideDocumentSymbols(t,e){var r=this;return(0,_.Z)(function*(){const i=t.uri,a=yield r._worker(i);if(t.isDisposed())return;const l=yield a.getNavigationTree(i.toString());if(!l||t.isDisposed())return;const c=(s,d)=>({name:s.text,detail:"",kind:y[s.kind]||o.languages.SymbolKind.Variable,range:r._textSpanToRange(t,s.spans[0]),selectionRange:r._textSpanToRange(t,s.spans[0]),tags:[],children:s.childItems?.map(p=>c(p,s.text)),containerName:d});return l.childItems?l.childItems.map(s=>c(s)):[]})()}},u=class{};h(u,"unknown",""),h(u,"keyword","keyword"),h(u,"script","script"),h(u,"module","module"),h(u,"class","class"),h(u,"interface","interface"),h(u,"type","type"),h(u,"enum","enum"),h(u,"variable","var"),h(u,"localVariable","local var"),h(u,"function","function"),h(u,"localFunction","local function"),h(u,"memberFunction","method"),h(u,"memberGetAccessor","getter"),h(u,"memberSetAccessor","setter"),h(u,"memberVariable","property"),h(u,"constructorImplementation","constructor"),h(u,"callSignature","call"),h(u,"indexSignature","index"),h(u,"constructSignature","construct"),h(u,"parameter","parameter"),h(u,"typeParameter","type parameter"),h(u,"primitiveType","primitive type"),h(u,"label","label"),h(u,"alias","alias"),h(u,"const","const"),h(u,"let","let"),h(u,"warning","warning");var y=Object.create(null);y[u.module]=o.languages.SymbolKind.Module,y[u.class]=o.languages.SymbolKind.Class,y[u.enum]=o.languages.SymbolKind.Enum,y[u.interface]=o.languages.SymbolKind.Interface,y[u.memberFunction]=o.languages.SymbolKind.Method,y[u.memberVariable]=o.languages.SymbolKind.Property,y[u.memberGetAccessor]=o.languages.SymbolKind.Property,y[u.memberSetAccessor]=o.languages.SymbolKind.Property,y[u.variable]=o.languages.SymbolKind.Variable,y[u.const]=o.languages.SymbolKind.Variable,y[u.localVariable]=o.languages.SymbolKind.Variable,y[u.variable]=o.languages.SymbolKind.Variable,y[u.function]=o.languages.SymbolKind.Function,y[u.localFunction]=o.languages.SymbolKind.Function;var P,L,w=class extends S{static _convertOptions(t){return{ConvertTabsToSpaces:t.insertSpaces,TabSize:t.tabSize,IndentSize:t.tabSize,IndentStyle:2,NewLineCharacter:"\n",InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,PlaceOpenBraceOnNewLineForFunctions:!1}}_convertTextChanges(t,e){return{text:e.newText,range:this._textSpanToRange(t,e.span)}}},U=class extends w{constructor(...e){super(...e),(0,v.Z)(this,"canFormatMultipleRanges",!1)}provideDocumentRangeFormattingEdits(e,r,i,a){var l=this;return(0,_.Z)(function*(){const c=e.uri,g=e.getOffsetAt({lineNumber:r.startLineNumber,column:r.startColumn}),s=e.getOffsetAt({lineNumber:r.endLineNumber,column:r.endColumn}),d=yield l._worker(c);if(e.isDisposed())return;const f=yield d.getFormattingEditsForRange(c.toString(),g,s,w._convertOptions(i));return f&&!e.isDisposed()?f.map(p=>l._convertTextChanges(e,p)):void 0})()}},$=class extends w{get autoFormatTriggerCharacters(){return[";","}","\n"]}provideOnTypeFormattingEdits(t,e,r,i,a){var l=this;return(0,_.Z)(function*(){const c=t.uri,g=t.getOffsetAt(e),s=yield l._worker(c);if(t.isDisposed())return;const d=yield s.getFormattingEditsAfterKeystroke(c.toString(),g,r,w._convertOptions(i));return d&&!t.isDisposed()?d.map(f=>l._convertTextChanges(t,f)):void 0})()}},z=class extends w{provideCodeActions(t,e,r,i){var a=this;return(0,_.Z)(function*(){const l=t.uri,c=t.getOffsetAt({lineNumber:e.startLineNumber,column:e.startColumn}),g=t.getOffsetAt({lineNumber:e.endLineNumber,column:e.endColumn}),s=w._convertOptions(t.getOptions()),d=r.markers.filter(m=>m.code).map(m=>m.code).map(Number),f=yield a._worker(l);if(t.isDisposed())return;const p=yield f.getCodeFixesAtPosition(l.toString(),c,g,d,s);return!p||t.isDisposed()?{actions:[],dispose:()=>{}}:{actions:p.filter(m=>0===m.changes.filter(A=>A.isNewFile).length).map(m=>a._tsCodeFixActionToMonacoCodeAction(t,r,m)),dispose:()=>{}}})()}_tsCodeFixActionToMonacoCodeAction(t,e,r){const i=[];for(const l of r.changes)for(const c of l.textChanges)i.push({resource:t.uri,versionId:void 0,textEdit:{range:this._textSpanToRange(t,c.span),text:c.newText}});return{title:r.description,edit:{edits:i},diagnostics:e.markers,kind:"quickfix"}}},J=class extends S{constructor(t,e){super(e),this._libFiles=t}provideRenameEdits(t,e,r,i){var a=this;return(0,_.Z)(function*(){const l=t.uri,c=l.toString(),g=t.getOffsetAt(e),s=yield a._worker(l);if(t.isDisposed())return;const d=yield s.getRenameInfo(c,g,{allowRenameOfImportPath:!1});if(!1===d.canRename)return{edits:[],rejectReason:d.localizedErrorMessage};if(void 0!==d.fileToRename)throw new Error("Renaming files is not supported.");const f=yield s.findRenameLocations(c,g,!1,!1,!1);if(!f||t.isDisposed())return;const p=[];for(const b of f){const m=a._libFiles.getOrCreateModel(b.fileName);if(!m)throw new Error(`Unknown file ${b.fileName}.`);p.push({resource:m.uri,versionId:void 0,textEdit:{range:a._textSpanToRange(m,b.textSpan),text:r}})}return{edits:p}})()}},G=class extends S{provideInlayHints(t,e,r){var i=this;return(0,_.Z)(function*(){const a=t.uri,l=a.toString(),c=t.getOffsetAt({lineNumber:e.startLineNumber,column:e.startColumn}),g=t.getOffsetAt({lineNumber:e.endLineNumber,column:e.endColumn}),s=yield i._worker(a);return t.isDisposed()?null:{hints:(yield s.provideInlayHints(l,c,g)).map(p=>({...p,label:p.text,position:t.getPositionAt(p.position),kind:i._convertHintKind(p.kind)})),dispose:()=>{}}})()}_convertHintKind(t){return"Parameter"===t?o.languages.InlayHintKind.Parameter:o.languages.InlayHintKind.Type}};function oe(t){L=Q(t,"typescript")}function ae(t){P=Q(t,"javascript")}function le(){return new Promise((t,e)=>{if(!P)return e("JavaScript not registered!");t(P)})}function ue(){return new Promise((t,e)=>{if(!L)return e("TypeScript not registered!");t(L)})}function Q(t,e){const r=[],i=[],a=new N(e,t);r.push(a);const l=(...s)=>a.getLanguageServiceWorker(...s),c=new E(l);return function g(){const{modeConfiguration:s}=t;X(i),s.completionItems&&i.push(o.languages.registerCompletionItemProvider(e,new C(l))),s.signatureHelp&&i.push(o.languages.registerSignatureHelpProvider(e,new H(l))),s.hovers&&i.push(o.languages.registerHoverProvider(e,new Z(l))),s.documentHighlights&&i.push(o.languages.registerDocumentHighlightProvider(e,new W(l))),s.definitions&&i.push(o.languages.registerDefinitionProvider(e,new V(c,l))),s.references&&i.push(o.languages.registerReferenceProvider(e,new j(c,l))),s.documentSymbols&&i.push(o.languages.registerDocumentSymbolProvider(e,new B(l))),s.rename&&i.push(o.languages.registerRenameProvider(e,new J(c,l))),s.documentRangeFormattingEdits&&i.push(o.languages.registerDocumentRangeFormattingEditProvider(e,new U(l))),s.onTypeFormattingEdits&&i.push(o.languages.registerOnTypeFormattingEditProvider(e,new $(l))),s.codeActions&&i.push(o.languages.registerCodeActionProvider(e,new z(l))),s.inlayHints&&i.push(o.languages.registerInlayHintsProvider(e,new G(l))),s.diagnostics&&i.push(new R(c,t,e,l))}(),r.push(function ce(t){return{dispose:()=>X(t)}}(i)),l}function X(t){for(;t.length;)t.pop().dispose()}}}]);